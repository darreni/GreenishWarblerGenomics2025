<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Darren Irwin">
<meta name="dcterms.date" content="2025-01-12">

<title>Greenish Warbler heterozygosity variance analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="GW_Heterozygosity_Variance_files/libs/clipboard/clipboard.min.js"></script>
<script src="GW_Heterozygosity_Variance_files/libs/quarto-html/quarto.js"></script>
<script src="GW_Heterozygosity_Variance_files/libs/quarto-html/popper.min.js"></script>
<script src="GW_Heterozygosity_Variance_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GW_Heterozygosity_Variance_files/libs/quarto-html/anchor.min.js"></script>
<link href="GW_Heterozygosity_Variance_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GW_Heterozygosity_Variance_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GW_Heterozygosity_Variance_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GW_Heterozygosity_Variance_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GW_Heterozygosity_Variance_files/libs/bootstrap/bootstrap-973236bd072d72a04ee9cd82dcc9cb29.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Greenish Warbler heterozygosity variance analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Darren Irwin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 12, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>The scripts, data, and figures shown in this document were used as part of the analysis for the paper listed below, which should be cited as the source of information from this document:</p>
<p>Irwin, D., S. Bensch, C. Charlebois, G. David, A. Geraldes, S.K. Gupta, B. Harr, P. Holt, J.H. Irwin, V.V. Ivanitskii, I.M. Marova, Y. Niu, S. Seneviratne, A. Singh, Y. Wu, S. Zhang, T.D. Price. 2025. The distribution and dispersal of large haploblocks in a superspecies. <em>Molecular Ecology</em>.</p>
<p>This page shows the code used to generate PCA plots for the whole genome (and also for each chromosome, although those aren’t shown in the paper).</p>
<p>Prior to examining the code on this page, readers should look at <code>GreenishWarblerGenomics.qmd</code> (or <code>.html</code>) and <code>GW_Zchromosome_analysis.qmd</code> (or <code>.html</code>), as this current page depends on the code on those pages being run first.</p>
<section id="a-note-about-plots-in-this-document" class="level5">
<h5 class="anchored" data-anchor-id="a-note-about-plots-in-this-document">A note about plots in this document</h5>
<p>The plots shown below may different somewhat in appearance between the version produced by Quarto (i.e., in this published document) and the version you would get if you run this code without using Quarto. In particular, the dimensions and font sizes of labels and titles may differ. So if you want the versions identical to those used in the paper, run the code directly in the Julia REPL (or using an environment such as VS Code) without using Quarto.</p>
<p>In the rendered (<code>.html</code>) version of this Quarto notebook, each figure may be accompanied by a warning caused by an interaction between Quarto and the Makie plotting package. Ignore these warnings as they do not affect the calculations or plots.</p>
</section>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load packages</h2>
<div id="81b2837b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JLD2</span> <span class="co"># for loading saved data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span> <span class="co"># for storing data as type DataFrame</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CairoMakie</span> <span class="co"># for plots</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Impute</span> <span class="co"># for imputing missing genotypes</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span> <span class="co"># for var() function</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MultivariateStats</span> <span class="co"># for getting variances from PCA model</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CSV</span> <span class="co"># for reading in delimited files</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DelimitedFiles</span> <span class="co"># for reading delimited files (the genotypic data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load my custom package <code>GenomicDiversity</code>:</p>
<div id="3ef2ca7b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">GenomicDiversity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="choose-working-directory" class="level2">
<h2 class="anchored" data-anchor-id="choose-working-directory">Choose working directory</h2>
<div id="5fcac3f9" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dataDirectory <span class="op">=</span> <span class="st">"/Users/darrenirwin/Dropbox/Darren's current work/"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cd</span>(dataDirectory)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-the-filtered-dataset" class="level2">
<h2 class="anchored" data-anchor-id="load-the-filtered-dataset">Load the filtered dataset</h2>
<p>This dataset was produced through filtering in GreenishWarblerGenomics2023.qmd</p>
<div id="1d9cb164" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>baseName <span class="op">=</span> <span class="st">"GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tagName <span class="op">=</span> <span class="st">".Jan2025."</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="fu">string</span>(baseName, tagName, <span class="st">"ind_SNP_ind_filtered.jld2"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load info into a dictionary:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> <span class="fu">load</span>(filename)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> baseName <span class="op">!=</span> d[<span class="st">"baseName"</span>]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"WARNING: baseNames don't match between that defined above and in the saved file"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> tagName <span class="op">!=</span> d[<span class="st">"tagName"</span>]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"WARNING: tagNames don't match don't match between that defined above and in the saved file"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>genosOnly <span class="op">=</span> d[<span class="st">"genosOnly_ind_SNP_ind_filtered"</span>]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_indFiltered <span class="op">=</span> d[<span class="st">"ind_with_metadata_indFiltered"</span>]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>pos_SNP_filtered <span class="op">=</span> d[<span class="st">"pos_SNP_filtered"</span>]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>repoDirectory <span class="op">=</span> d[<span class="st">"repoDirectory"</span>]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>dataDirectory <span class="op">=</span> d[<span class="st">"dataDirectory"</span>]</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>scaffold_info <span class="op">=</span> d[<span class="st">"scaffold_info"</span>]</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>scaffold_lengths <span class="op">=</span> d[<span class="st">"scaffold_lengths"</span>]</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>filenameTextMiddle <span class="op">=</span> d[<span class="st">"filenameTextMiddle"</span>]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>missingGenotypeThreshold <span class="op">=</span> d[<span class="st">"missingGenotypeThreshold"</span>]</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>filenameTextEnd <span class="op">=</span> d[<span class="st">"filenameTextEnd"</span>]</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>chromosomes_to_process <span class="op">=</span>d[<span class="st">"chromosomes_to_process"</span>]</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>metadataFile <span class="op">=</span> d[<span class="st">"metadataFile"</span>]</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Loaded the filtered data."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded the filtered data.</code></pre>
</div>
</div>
<p>Also define <code>correctNames()</code> function as in main script, to correct some names:</p>
<div id="223d4c2c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">correctNames</span>(metadataColumn)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>        metadataColumn_corrected <span class="op">=</span> <span class="fu">replace</span>(metadataColumn, <span class="st">"GW_Armando_plate1_TTGW05_rep2"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW05r2"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Lane5_NA3-3ul"</span> <span class="op">=&gt;</span> <span class="st">"GW_Lane5_NA3"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_05"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-05"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_07"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-07"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_08"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-08"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_09"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-09"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_01"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-01"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_02"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-02"</span>,   </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_03"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-03"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_04"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-04"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_06"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-06"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate1_TTGW_15_10"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate1_TTGW-15-10"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate2_TTGW_15_01"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate2_TTGW-15-01"</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate2_TTGW_15_02"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate2_TTGW-15-02"</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate2_TTGW_15_03"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate2_TTGW-15-03"</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate2_TTGW_15_04"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate2_TTGW-15-04"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate2_TTGW_15_06"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate2_TTGW-15-06"</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GW_Armando_plate2_TTGW_15_10"</span> <span class="op">=&gt;</span> <span class="st">"GW_Armando_plate2_TTGW-15-10"</span>) </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>correctNames (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="replace-the-z-chromosome-snps-with-the-filtered-z-chromosome-snps" class="level2">
<h2 class="anchored" data-anchor-id="replace-the-z-chromosome-snps-with-the-filtered-z-chromosome-snps">Replace the Z chromosome SNPs with the filtered Z chromosome SNPs</h2>
<div id="d4f7c05b" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the Z SNPs from the big dataset loaded above:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> (pos_SNP_filtered.chrom <span class="op">.!=</span> <span class="st">"gwZ"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pos_SNP_filtered <span class="op">=</span> pos_SNP_filtered[selection, <span class="op">:</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>genosOnly <span class="op">=</span> genosOnly[<span class="op">:</span>,selection]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load and add the Z filtered SNPs:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="fu">string</span>(baseName, tagName, <span class="st">"chrgwZ_cleaned.notImputed.jld2"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>genosOnly_chrgwZ_cleaned <span class="op">=</span> <span class="fu">load</span>(filename, <span class="st">"genotypes_gwZ_SNPfiltered"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_indFiltered_chrgwZ_cleaned <span class="op">=</span> <span class="fu">load</span>(filename, <span class="st">"ind_with_metadata_indFiltered"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>pos_SNP_filtered_chrgwZ_cleaned <span class="op">=</span> <span class="fu">load</span>(filename, <span class="st">"pos_SNP_filtered_region"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ind_with_metadata_indFiltered.ind <span class="op">!=</span> ind_with_metadata_indFiltered_chrgwZ_cleaned.ind</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: the list of individuals in the big file and Z file are not completely identical."</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>pos_SNP_filtered <span class="op">=</span> <span class="fu">vcat</span>(pos_SNP_filtered, pos_SNP_filtered_chrgwZ_cleaned)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>genosOnly <span class="op">=</span> <span class="fu">hcat</span>(genosOnly, genosOnly_chrgwZ_cleaned)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Replaced the Z chromosome data with the filtered Z data."</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># copy the sex column so we can use later:</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_indFiltered.sex <span class="op">=</span> ind_with_metadata_indFiltered_chrgwZ_cleaned.sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Replaced the Z chromosome data with the filtered Z data.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>257-element Vector{String}:
 "M"
 "M"
 "M"
 "M"
 "M"
 "M"
 "M"
 "M"
 "M"
 "M"
 "M"
 "M"
 "M"
 ⋮
 "M"
 "M"
 "M"
 "M"
 "M"
 "F"
 "M"
 "M"
 "F"
 "M"
 "M"
 "M"</code></pre>
</div>
</div>
</section>
<section id="switch-plot-order-to-ring_km-and-set-nitidus-set-to--2500-km-and-the-siberian-hybrid-set-to-5000-km-plot-order" class="level2">
<h2 class="anchored" data-anchor-id="switch-plot-order-to-ring_km-and-set-nitidus-set-to--2500-km-and-the-siberian-hybrid-set-to-5000-km-plot-order">switch plot order to ring_km, and set nitidus (set to -2500 km) and the Siberian hybrid (set to 5000 km) plot order:</h2>
<div id="cedd7c52" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_indFiltered.original_plot_order <span class="op">=</span> ind_with_metadata_indFiltered.plot_order</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_indFiltered.plot_order <span class="op">=</span> ind_with_metadata_indFiltered.ring_km</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_indFiltered.plot_order[ind_with_metadata_indFiltered.Fst_group <span class="op">.==</span> <span class="st">"nit"</span>] <span class="op">.=</span> <span class="op">-</span><span class="fl">2500</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_indFiltered.plot_order[ind_with_metadata_indFiltered.Fst_group <span class="op">.==</span> <span class="st">"plumb_vir"</span>] <span class="op">.=</span> <span class="fl">5000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>1-element view(::Vector{Float64}, [8]) with eltype Float64:
 5000.0</code></pre>
</div>
</div>
</section>
<section id="prepare-data-for-genotype-by-individual-plots-and-pca" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data-for-genotype-by-individual-plots-and-pca">Prepare data for Genotype-by-individual plots and PCA</h2>
<p>For missing genotypes, change our code of <code>-1</code> to <code>missing</code>:</p>
<div id="d6311468" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>genosOnly_with_missing <span class="op">=</span> <span class="fu">Matrix</span><span class="dt">{Union{Missing, Int16}}</span>(genosOnly)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>genosOnly_with_missing <span class="op">=</span> <span class="fu">replace</span>(genosOnly_with_missing, <span class="op">-</span><span class="fl">1</span> <span class="op">=&gt;</span> <span class="cn">missing</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>257×1015750 Matrix{Union{Missing, Int16}}:
 0  0  0  0  0  1  0  0         0  0  …  0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0  …  0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  1         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0  …  0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 ⋮              ⋮                     ⋱        ⋮              ⋮           
 0  0  0  0  0  0  0  0         0  0  …  0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0   missing  0  0  …  0  0  0  2  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0  …  0  0  0  1  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0         0  0     0  0  0  0  0  0  0  0  0  0  0  0</code></pre>
</div>
</div>
</section>
<section id="make-list-of-scaffolds-to-plot" class="level2">
<h2 class="anchored" data-anchor-id="make-list-of-scaffolds-to-plot">Make list of scaffolds to plot:</h2>
<div id="e42c7966" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>scaffolds_to_plot <span class="op">=</span> <span class="st">"gw"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fu">vcat</span>(<span class="fl">1</span>, <span class="st">"1A"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="st">"4A"</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">17</span><span class="op">:</span><span class="fl">28</span>, <span class="st">"Z"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>30-element Vector{String}:
 "gw1"
 "gw1A"
 "gw2"
 "gw3"
 "gw4"
 "gw4A"
 "gw5"
 "gw6"
 "gw7"
 "gw8"
 "gw9"
 "gw10"
 "gw11"
 ⋮
 "gw18"
 "gw19"
 "gw20"
 "gw21"
 "gw22"
 "gw23"
 "gw24"
 "gw25"
 "gw26"
 "gw27"
 "gw28"
 "gwZ"</code></pre>
</div>
</div>
</section>
<section id="determine-number-of-snps-in-the-chromosomes-above" class="level2">
<h2 class="anchored" data-anchor-id="determine-number-of-snps-in-the-chromosomes-above">Determine number of SNPs in the chromosomes above</h2>
<div id="1dc94623" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">map</span>(<span class="fu">in</span>(scaffolds_to_plot), pos_SNP_filtered.chrom))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>1003924</code></pre>
</div>
</div>
<p>This reports that 1003924 SNPs are within the listed chromosomes. (Good because that matches the number as determined in GW_PCAplots.qmd)</p>
</section>
<section id="choose-groups-and-colors" class="level2">
<h2 class="anchored" data-anchor-id="choose-groups-and-colors">Choose groups and colors</h2>
<div id="500df2a4" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>groups_to_plot_PCA <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_S"</span>,<span class="st">"nit"</span>, <span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>,<span class="st">"troch_west"</span>,<span class="st">"troch_LN"</span>,<span class="st">"troch_EM"</span>,<span class="st">"obs"</span>,<span class="st">"plumb_BJ"</span>,<span class="st">"plumb"</span>,<span class="st">"plumb_vir"</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>group_colors_PCA <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>,<span class="st">"grey"</span>,<span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>,<span class="st">"gold"</span>,<span class="st">"orange"</span>,<span class="st">"pink"</span>,<span class="st">"red"</span>,<span class="st">"purple"</span>];</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="section" class="level15">
<p class="heading"></p>
</section>
</section>
<section id="show-windowed-heterozygosity-for-individuals" class="level2">
<h2 class="anchored" data-anchor-id="show-windowed-heterozygosity-for-individuals">Show windowed heterozygosity for individuals</h2>
<div id="10a8ec5e" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># option to select a subset of individuals</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>filterGroups <span class="op">=</span> <span class="cn">false</span>  <span class="co"># false means include all individuals</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>groupsToInclude <span class="op">=</span> [<span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>,<span class="st">"troch_west"</span>]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> [<span class="fl">1000</span>, <span class="fl">1000</span>, <span class="fl">1000</span>, <span class="fl">1000</span>, <span class="fl">1000</span>, <span class="fl">1000</span>]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> filterGroups</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    genosOnly_included, ind_with_metadata_included <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(groupsToInclude, numIndsToPlot, genosOnly_with_missing, ind_with_metadata_indFiltered)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    genosOnly_included <span class="op">=</span> genosOnly_with_missing</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    ind_with_metadata_included <span class="op">=</span> ind_with_metadata_indFiltered</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw15"</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>windowSize <span class="op">=</span> <span class="fl">500</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>loci_selection <span class="op">=</span> (pos_SNP_filtered.chrom <span class="op">.==</span> chr)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>pos_region <span class="op">=</span> pos_SNP_filtered[loci_selection, <span class="op">:</span>]</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>genotypes_region <span class="op">=</span> genosOnly_included[<span class="op">:</span>, loci_selection]</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>windowedPos, windowedIndHet <span class="op">=</span> <span class="fu">getWindowedIndHet</span>(genotypes_region, pos_region, windowSize)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>plotTitle <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Windowed heterozygosity of "</span>, <span class="fu">size</span>(windowedIndHet, <span class="fl">1</span>), <span class="st">" individuals"</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>titleSize <span class="op">=</span> <span class="fl">24</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Location on scaffold "</span>, chr)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>yLabelText <span class="op">=</span> <span class="st">"Heterozygosity"</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>labelSize <span class="op">=</span> <span class="fl">24</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>plotTitle, titlesize<span class="op">=</span>titleSize,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span>xLabelText, xlabelsize<span class="op">=</span>labelSize,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span>yLabelText, ylabelsize<span class="op">=</span>labelSize)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines!</span>(windowedPos, windowedIndHet[<span class="fl">1</span>, <span class="op">:</span>])</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu">size</span>(windowedIndHet, <span class="fl">1</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines!</span>(windowedPos, windowedIndHet[i, <span class="op">:</span>])</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>meanPerWindow_windowedIndHet <span class="op">=</span> <span class="fu">sum</span>(windowedIndHet, dims<span class="op">=</span><span class="fl">1</span>) <span class="op">./</span> <span class="fu">size</span>(windowedIndHet, <span class="fl">1</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lines!</span>(windowedPos, <span class="fu">vec</span>(meanPerWindow_windowedIndHet), linewidth<span class="op">=</span><span class="fl">10</span>, color<span class="op">=:</span>red)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>windowedIndHet_standardized <span class="op">=</span> <span class="fu">standardizeIndHet</span>(windowedIndHet)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>plotTitle <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Standardized heterozygosity of "</span>, <span class="fu">size</span>(windowedIndHet, <span class="fl">1</span>), <span class="st">" individuals"</span>)</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>titleSize <span class="op">=</span> <span class="fl">24</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Location on scaffold "</span>, chr)</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>yLabelText <span class="op">=</span> <span class="st">"Standardized heterozygosity"</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>labelSize <span class="op">=</span> <span class="fl">24</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(g[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>plotTitle, titlesize<span class="op">=</span>titleSize,</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span>xLabelText, xlabelsize<span class="op">=</span>labelSize,</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span>yLabelText, ylabelsize<span class="op">=</span>labelSize)</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">size</span>(windowedIndHet_standardized, <span class="fl">1</span>)</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines!</span>(windowedPos, windowedIndHet_standardized[i, <span class="op">:</span>])</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a><span class="co">#lines!(windowedPos, windowedIndHet[21,:], linewidth = 10, color = :red)</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(g)</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Now graph the variance in standardized heterozygosity</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>windowedViSHet <span class="op">=</span> <span class="fu">getWindowedViSHet</span>(windowedIndHet_standardized)</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>plotTitle <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Var. in Stand. Het. (ViSHet) among "</span>, <span class="fu">size</span>(windowedIndHet, <span class="fl">1</span>), <span class="st">" individuals"</span>)</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>titleSize <span class="op">=</span> <span class="fl">18</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Location on scaffold "</span>, chr)</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>yLabelText <span class="op">=</span> <span class="st">"ViSHet"</span></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>labelSize <span class="op">=</span> <span class="fl">18</span></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(h[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>plotTitle, titlesize<span class="op">=</span>titleSize,</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span>xLabelText, xlabelsize<span class="op">=</span>labelSize,</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span>yLabelText, ylabelsize<span class="op">=</span>labelSize)</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a><span class="fu">lines!</span>(windowedPos, windowedViSHet)</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-13-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-13-output-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-13-output-6.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="make-heterozygosity-variance-plot-for-whole-genome" class="level2">
<h2 class="anchored" data-anchor-id="make-heterozygosity-variance-plot-for-whole-genome">Make heterozygosity variance plot for whole genome:</h2>
<div id="9c6a284a" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># option to select a subset of individuals</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>filterGroups <span class="op">=</span> <span class="cn">false</span>  <span class="co"># false means include all individuals</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>groupsToInclude <span class="op">=</span> [<span class="st">"vir"</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> [<span class="fl">1000</span>]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> filterGroups</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    genosOnly_included, ind_with_metadata_included <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(groupsToInclude, numIndsToPlot, genosOnly_with_missing, ind_with_metadata_indFiltered)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    genosOnly_included <span class="op">=</span> genosOnly_with_missing</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    ind_with_metadata_included <span class="op">=</span> ind_with_metadata_indFiltered</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>scaffolds_for_ViSHet <span class="op">=</span> scaffolds_to_plot</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize data structures</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>windowed_pos_all <span class="op">=</span> <span class="fu">DataFrame</span>(chrom <span class="op">=</span> <span class="dt">String</span>[], mean_position <span class="op">=</span> <span class="dt">Float64</span>[], first_position <span class="op">=</span> <span class="dt">Int</span>[], last_position <span class="op">=</span> <span class="dt">Int</span>[])</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>windowed_ViSHet_all <span class="op">=</span> <span class="fu">Vector</span><span class="dt">{Float32}</span>(<span class="cn">undef</span>, <span class="fl">0</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chrom <span class="kw">in</span> scaffolds_for_ViSHet</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    regionText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr"</span>, chrom)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    loci_selection <span class="op">=</span> (pos_SNP_filtered.chrom <span class="op">.==</span> chrom)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    pos_region <span class="op">=</span> pos_SNP_filtered[loci_selection, <span class="op">:</span>]</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    genotypes_region <span class="op">=</span> genosOnly_included[<span class="op">:</span>, loci_selection]</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> chrom <span class="op">==</span> <span class="st">"gwZ"</span> <span class="co">#include only males (because females have only one Z)</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        genotypes_region_males <span class="op">=</span> genotypes_region[ind_with_metadata_included.sex <span class="op">.==</span> <span class="st">"M"</span>, <span class="op">:</span>]</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        windowedPos, windowedIndHet <span class="op">=</span> <span class="fu">getWindowedIndHet</span>(genotypes_region_males, pos_region, windowSize)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="co"># for all other chromosomes, include all individuals</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        windowedPos, windowedIndHet <span class="op">=</span> <span class="fu">getWindowedIndHet</span>(genotypes_region, pos_region, windowSize)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    windowBoundaries <span class="op">=</span> <span class="fu">getWindowBoundaries</span>(pos_region.position, windowSize)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    windowedIndHet_standardized <span class="op">=</span> <span class="fu">standardizeIndHet</span>(windowedIndHet)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    windowed_ViSHet_scaffold <span class="op">=</span> <span class="fu">getWindowedViSHet</span>(windowedIndHet_standardized)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    windowed_pos_chrom <span class="op">=</span> <span class="fu">DataFrame</span>(chrom <span class="op">=</span> <span class="fu">repeat</span>([chrom], <span class="fu">length</span>(windowedPos)), mean_position <span class="op">=</span> windowedPos, first_position <span class="op">=</span> windowBoundaries[<span class="op">:</span>,<span class="fl">1</span>], last_position <span class="op">=</span> windowBoundaries[<span class="op">:</span>,<span class="fl">2</span>])</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    windowed_pos_all <span class="op">=</span> <span class="fu">vcat</span>(windowed_pos_all, windowed_pos_chrom)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    windowed_ViSHet_all <span class="op">=</span> [windowed_ViSHet_all; windowed_ViSHet_scaffold]</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick test plot (overlapping all chromosomes, so not good)</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(windowed_pos_all.mean_position, windowed_ViSHet_all)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="identify-haploblock-regions-as-those-that-have-high-vishet" class="level2">
<h2 class="anchored" data-anchor-id="identify-haploblock-regions-as-those-that-have-high-vishet">Identify “haploblock regions” as those that have high ViSHet</h2>
<div id="a977302b" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>threshold_ViSHet <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> windowed_ViSHet_all <span class="op">.&gt;=</span> threshold_ViSHet</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>windowed_pos_all.high_ViSHet <span class="op">=</span> selection <span class="co"># adds true/false column to dataframe indicating high ViSHet windows</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make list of contiguous high ViSHet region:</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>highViSHetRegions <span class="op">=</span> <span class="fu">DataFrame</span>(regionChrom <span class="op">=</span> <span class="dt">String</span>[], regionStart <span class="op">=</span> <span class="dt">Int</span>[], regionEnd <span class="op">=</span> <span class="dt">Int</span>[])</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>lastWindow <span class="op">=</span> <span class="fu">nrow</span>(windowed_pos_all)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> i <span class="op">&lt;=</span> lastWindow <span class="co"># eachindex(windowed_pos_all[:,1])</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> windowed_pos_all.high_ViSHet[i] <span class="op">==</span> <span class="cn">true</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        regionChrom <span class="op">=</span> windowed_pos_all.chrom[i]</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        regionStart <span class="op">=</span> windowed_pos_all.first_position[i]</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        regionEnd <span class="op">=</span> windowed_pos_all.last_position[i]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># check whether contiguous with next</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        next <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> i <span class="op">+</span> next <span class="op">&lt;=</span> lastWindow <span class="op">&amp;&amp;</span> windowed_pos_all.chrom[i <span class="op">+</span> next] <span class="op">==</span> regionChrom</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> windowed_pos_all.high_ViSHet[i <span class="op">+</span> next] <span class="op">==</span> <span class="cn">true</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                regionEnd <span class="op">=</span> windowed_pos_all.last_position[i <span class="op">+</span> next]</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                next <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        highViSHetRegions <span class="op">=</span> <span class="fu">push!</span>(highViSHetRegions, [regionChrom, regionStart, regionEnd])</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> next <span class="op">+</span> <span class="fl">1</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="fl">1</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> </span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    i</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>highViSHetRegions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div><div style="float: left;"><span>39×3 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">14 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionChrom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionStart</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionEnd</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">gw1</td>
<td style="text-align: right;">15689747</td>
<td style="text-align: right;">23478124</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">gw1A</td>
<td style="text-align: right;">4674</td>
<td style="text-align: right;">3771263</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">gw1A</td>
<td style="text-align: right;">23592559</td>
<td style="text-align: right;">30616953</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">gw2</td>
<td style="text-align: right;">54537375</td>
<td style="text-align: right;">59262130</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">gw2</td>
<td style="text-align: right;">60234161</td>
<td style="text-align: right;">61533451</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">gw3</td>
<td style="text-align: right;">101192949</td>
<td style="text-align: right;">103495514</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">gw3</td>
<td style="text-align: right;">104554714</td>
<td style="text-align: right;">108279595</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">gw4</td>
<td style="text-align: right;">5295912</td>
<td style="text-align: right;">5438270</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">gw4</td>
<td style="text-align: right;">14837641</td>
<td style="text-align: right;">16117455</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">gw4</td>
<td style="text-align: right;">20930552</td>
<td style="text-align: right;">23610800</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">gw4A</td>
<td style="text-align: right;">379058</td>
<td style="text-align: right;">730094</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">gw5</td>
<td style="text-align: right;">10095304</td>
<td style="text-align: right;">10956815</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">gw6</td>
<td style="text-align: right;">34584054</td>
<td style="text-align: right;">35259663</td>
</tr>
<tr class="even">
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">28</td>
<td style="text-align: left;">gw19</td>
<td style="text-align: right;">43362</td>
<td style="text-align: right;">1006242</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">29</td>
<td style="text-align: left;">gw20</td>
<td style="text-align: right;">27354</td>
<td style="text-align: right;">721651</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">30</td>
<td style="text-align: left;">gw20</td>
<td style="text-align: right;">5852254</td>
<td style="text-align: right;">6671670</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">31</td>
<td style="text-align: left;">gw21</td>
<td style="text-align: right;">3275121</td>
<td style="text-align: right;">3731689</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">32</td>
<td style="text-align: left;">gw22</td>
<td style="text-align: right;">5214430</td>
<td style="text-align: right;">5775824</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">33</td>
<td style="text-align: left;">gw23</td>
<td style="text-align: right;">4135459</td>
<td style="text-align: right;">4774426</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">34</td>
<td style="text-align: left;">gw24</td>
<td style="text-align: right;">3468239</td>
<td style="text-align: right;">4001782</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">35</td>
<td style="text-align: left;">gw25</td>
<td style="text-align: right;">5185626</td>
<td style="text-align: right;">5473966</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">36</td>
<td style="text-align: left;">gw26</td>
<td style="text-align: right;">4153299</td>
<td style="text-align: right;">5549635</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">37</td>
<td style="text-align: left;">gw27</td>
<td style="text-align: right;">41621</td>
<td style="text-align: right;">541081</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">38</td>
<td style="text-align: left;">gw28</td>
<td style="text-align: right;">1822776</td>
<td style="text-align: right;">2522648</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">39</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">68372986</td>
<td style="text-align: right;">73749599</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="determine-fraction-of-genome-that-has-high-vishet" class="level2">
<h2 class="anchored" data-anchor-id="determine-fraction-of-genome-that-has-high-vishet">Determine fraction of genome that has high ViSHet</h2>
<div id="e367dcf6" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get total length of high ViSHet regions </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>sum_highViSHetRegions <span class="op">=</span> <span class="fu">sum</span>(highViSHetRegions.regionEnd <span class="op">.-</span> highViSHetRegions.regionStart)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get total lengths of all scaffolds</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>sum_scaffold_lengths <span class="op">=</span> <span class="fl">0</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> scaffold_name <span class="kw">in</span> scaffolds_to_plot</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(scaffold_name)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    sum_scaffold_lengths <span class="op">+=</span> scaffold_lengths[scaffold_name]</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>sum_scaffold_lengths</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate percent of genome in high ViSHet regions</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>percentGenomeHighViSHet <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> sum_highViSHetRegions <span class="op">/</span> sum_scaffold_lengths</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The percent of the genome in high ViSHet regions is </span><span class="sc">$</span>percentGenomeHighViSHet<span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gw1
gw1A
gw2
gw3
gw4
gw4A
gw5
gw6
gw7
gw8
gw9
gw10
gw11
gw12
gw13
gw14
gw15
gw17
gw18
gw19
gw20
gw21
gw22
gw23
gw24
gw25
gw26
gw27
gw28
gwZ
The percent of the genome in high ViSHet regions is 5.799030328440733</code></pre>
</div>
</div>
</section>
<section id="plot-haploblock-regions-for-whole-genome" class="level2">
<h2 class="anchored" data-anchor-id="plot-haploblock-regions-for-whole-genome">Plot “haploblock regions” for whole genome</h2>
<div id="d5ca0a23" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#= """</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">    plotGenomeViSHet(scaffolds_to_plot, </span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">                    windowed_ViSHet_all,</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">                    windowed_pos_all;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">                    fillColor = "purple",</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">                    lineTransparency = 0.8,</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">                    fillTransparency = 0.2,</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">                    figureSize = (1200, 1200),</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">                    plotRegions = false,</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">                    regionsToPlot = [],</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">                    regionColor = "red")</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">Plot windowed Variance in Standardized Heterozygosity (ViSHet) along multiple scaffolds.</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">​# Arguments</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co">- `scaffolds_to_plot`: a vector of the scaffold names to include in the plot.</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co">- `windowed_ViSHet_all`: a vector of ViSHet values for windows of the genome.</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co">- `windowed_pos_all`: dataframe containing genomic locations of windows (must have columns `chrom` and `mean_position`).</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co">- `fillColor` (optional): the color for the lines and fill (default `"purple"`).</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co">- `lineTransparency` (optional): transparency of the lines.</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="co">- `fillTransparency` (optional): transparency of the fill color.</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co">- `figureSize` (optional): size of the figure (height, width).</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co">- `plotRegions` (optional): choose `true` to highlight regions.</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co">- `regionsToPlot` (optional): a DataFrame with three columns: `regionChrom` containing names of scaffolds, `regionStart` and `regionEnd` giving start and end of regions to highlight.</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="co">- `regionColor` (optional): the color for the highlighted regions.</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Notes</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="co">- Returns the figure.</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="co">function plotGenomeViSHet(scaffolds_to_plot, </span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="co">                            windowed_ViSHet_all,</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="co">                            windowed_pos_all;</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co">                            fillColor = "purple",</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="co">                            lineTransparency = 0.8,</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="co">                            fillTransparency = 0.2,</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="co">                            figureSize = (1200, 1200),</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="co">                            plotRegions = false,</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="co">                            regionsToPlot = [],</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="co">                            regionColor = "red")</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="co">    # get sizes of chromosomes (note this actually isn't the true length, just the mean position of the rightmost window):</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="co">    scaffoldLengths = repeat([-1], length(scaffolds_to_plot))   # vector of Int64</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="co">    for i in 1:length(scaffolds_to_plot)</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="co">        selection = windowed_pos_all.chrom .== scaffolds_to_plot[i]</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a><span class="co">        if sum(selection) == 0</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a><span class="co">            scaffoldLengths[i] = 0</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="co">        else</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a><span class="co">            scaffoldLengths[i] = round(Int, maximum(windowed_pos_all.mean_position[selection]))</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a><span class="co">        end</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a><span class="co">    end</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a><span class="co">    # my plan is to use the layout feature of Makie to make one axis per row, and then plot</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a><span class="co">    # multiple scaffolds to each row</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="co">    scaffoldPlottedAlready = falses(length(scaffolds_to_plot))</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a><span class="co">    bpPerRow = 200_000_000</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a><span class="co">    bpGapBetweenScaffolds = 10_000_000</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a><span class="co">    scaffoldInRow = Vector{Vector{String}}() # declare a vector of vectors to store the chromosome names per row</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a><span class="co">    scaffoldBpStartInRow = Vector{Vector{Int}}()</span></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a><span class="co">    row = 1</span></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a><span class="co">    while sum(scaffoldPlottedAlready .== false) &gt; 0  # repeat until all chr have a row to be plotted in</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a><span class="co">        bpStart = 0</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a><span class="co">        remainingRowLength = bpPerRow</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a><span class="co">        push!(scaffoldInRow, []) # initialize an empty vector for the next row</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a><span class="co">        push!(scaffoldBpStartInRow, []) # initialize an empty vector for the next row</span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a><span class="co">        placeInRow = 1</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a><span class="co">        # look through chromosomes and find some to go in this row</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="co">        for i in 1:length(scaffolds_to_plot)</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a><span class="co">            # if not plotted and short enough, add to row:</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a><span class="co">            if scaffoldPlottedAlready[i] .== false .&amp;&amp; scaffoldLengths[i] .&lt;= remainingRowLength</span></span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a><span class="co">                push!(scaffoldInRow[row], scaffolds_to_plot[i])</span></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a><span class="co">                push!(scaffoldBpStartInRow[row], bpStart)</span></span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a><span class="co">                remainingRowLength = remainingRowLength - scaffoldLengths[i] - bpGapBetweenScaffolds</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a><span class="co">                scaffoldPlottedAlready[i] = true</span></span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a><span class="co">                placeInRow += 1</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a><span class="co">                bpStart = bpStart + scaffoldLengths[i] + bpGapBetweenScaffolds</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a><span class="co">            end </span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a><span class="co">        end</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a><span class="co">        row += 1</span></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a><span class="co">    end</span></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a><span class="co">    println(scaffoldInRow)</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a><span class="co">    # the above works. I have the scaffolds arranged for plotting.</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a><span class="co">    # Plot in the order defined above</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a><span class="co">    f = CairoMakie.Figure(size=figureSize)</span></span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a><span class="co">    numRows = length(scaffoldInRow)</span></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a><span class="co">    # make one axis object per row:</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a><span class="co">    axs = [Axis(f[i, 1], limits=(0, bpPerRow,</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a><span class="co">            -0.45, 2.0), ylabel = "ViSHet") for i in 1:numRows]</span></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a><span class="co">    for i in 1:numRows</span></span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a><span class="co">        hidexdecorations!(axs[i]) #hide background lattice and axis labels</span></span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a><span class="co">        hidespines!(axs[i], :t, :r, :b) # hide box around plot</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a><span class="co">    end</span></span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a><span class="co">    for rowNum in 1:numRows</span></span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a><span class="co">        numScaffoldsInRow = length(scaffoldInRow[rowNum])</span></span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a><span class="co">        nextPlotShiftBP = 0</span></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a><span class="co">        for orderNum in 1:numScaffoldsInRow </span></span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a><span class="co">            scaffoldName = scaffoldInRow[rowNum][orderNum]</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a><span class="co">            plotBpLength = scaffoldLengths[findfirst(scaffolds_to_plot .== scaffoldName)]</span></span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a><span class="co">            # select one scaffold from the whole genome:</span></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a><span class="co">            selection = windowed_pos_all.chrom .== scaffoldName </span></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a><span class="co">            windowed_pos_selected = view(windowed_pos_all.mean_position, selection)</span></span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a><span class="co">            windowed_ViSHet_selected = view(windowed_ViSHet_all, selection)</span></span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a><span class="co">            if length(windowed_pos_selected) &gt; 0  # only plot if there is data for that scaffold        </span></span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a><span class="co">                text!(axs[rowNum], scaffoldBpStartInRow[rowNum][orderNum] + 0.005bpPerRow, -0.2; text=scaffoldName, align=(:left, :center), fontsize=20)</span></span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a><span class="co">                xx = vcat(first(windowed_pos_selected), windowed_pos_selected, last(windowed_pos_selected)) .+ scaffoldBpStartInRow[rowNum][orderNum]</span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a><span class="co">                yy = vcat(0, windowed_ViSHet_selected, 0)</span></span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a><span class="co">                poly!(axs[rowNum], Point2f.(xx, yy), color = (fillColor, fillTransparency), strokecolor = (fillColor, lineTransparency), strokewidth = 1)</span></span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a><span class="co">                # if indicating regions (e.g. that have high ViSHet)</span></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a><span class="co">                if plotRegions</span></span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a><span class="co">                    regionsToPlot_thisScaffold = regionsToPlot[regionsToPlot.regionChrom .== scaffoldName, :]</span></span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a><span class="co">                    for i in eachindex(regionsToPlot_thisScaffold.regionStart)</span></span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a><span class="co">                        xValues = [regionsToPlot_thisScaffold.regionStart[i], regionsToPlot_thisScaffold.regionEnd[i]] .+ scaffoldBpStartInRow[rowNum][orderNum]</span></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a><span class="co">                        yValues = [0.05, 0.05]</span></span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a><span class="co">                        lines!(axs[rowNum], xValues, yValues, color=regionColor, linewidth=10)</span></span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a><span class="co">                    end</span></span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a><span class="co">                end</span></span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a><span class="co">            end</span></span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a><span class="co">        end</span></span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a><span class="co">    end</span></span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a><span class="co">    display(f)</span></span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a><span class="co">    return f</span></span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a><span class="co">end</span></span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a><span class="co"> =#</span></span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>fig2 <span class="op">=</span> <span class="fu">plotGenomeViSHet</span>(scaffolds_to_plot, </span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>                        windowed_ViSHet_all,</span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a>                        windowed_pos_all;</span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a>                        fillColor <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>                        lineTransparency <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a>                        fillTransparency <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a>                        figureSize<span class="op">=</span>(<span class="fl">1200</span>, <span class="fl">1200</span>),</span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a>                        plotRegions <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a>                        regionsToPlot <span class="op">=</span> highViSHetRegions,</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a>                        regionColor <span class="op">=</span> <span class="st">"magenta"</span>)</span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">"Figure2_ViSHet_allGenome_fromJulia.png"</span></span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(filename, fig2, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Saved "</span>, filename)</span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[["gw1", "gw4A", "gw6"], ["gw1A", "gw4", "gw9"], ["gw2", "gw8"], ["gw3", "gw5"], ["gw7", "gw10", "gw11", "gw12", "gw13", "gw14"], ["gw15", "gw17", "gw18", "gw19", "gw20", "gw21", "gw22", "gw23", "gw24", "gw25"], ["gw26", "gw27", "gw28", "gwZ"]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-17-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="make-a-pca-based-on-all-non-lhbrs-that-is-outside-of-the-identified-large-haploblock-regions" class="level2">
<h2 class="anchored" data-anchor-id="make-a-pca-based-on-all-non-lhbrs-that-is-outside-of-the-identified-large-haploblock-regions">Make a PCA based on all non-LHBRs (that is, outside of the identified Large HaploBlock Regions):</h2>
<section id="first-remove-the-lhbr-regions" class="level4">
<h4 class="anchored" data-anchor-id="first-remove-the-lhbr-regions">First remove the LHBR regions</h4>
<div id="43e21044" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cycle through the LHBRs, determining the SNPs within each to remove from the dataset:</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>lociToRemove <span class="op">=</span> <span class="fu">fill</span>(<span class="cn">false</span>, <span class="fu">nrow</span>(pos_SNP_filtered))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachrow</span>(highViSHetRegions) </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># display(i.regionChrom)</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># display(i.regionStart)</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    lociWithinThisLHBR <span class="op">=</span> (pos_SNP_filtered.chrom <span class="op">.==</span> i.regionChrom) <span class="op">.&amp;&amp;</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                    (pos_SNP_filtered.position <span class="op">.&gt;=</span> i.regionStart) <span class="op">.&amp;&amp;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                    (pos_SNP_filtered.position <span class="op">.&lt;=</span> i.regionEnd)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    lociToRemove <span class="op">=</span> lociToRemove <span class="op">.||</span> lociWithinThisLHBR</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># now actually remove them:</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>genosOnly_included_nonLHBR <span class="op">=</span> genosOnly_included[<span class="op">:</span>, .!lociToRemove]</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>pos_SNP_filtered_nonLHBR <span class="op">=</span> pos_SNP_filtered[.!lociToRemove, <span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div><div style="float: left;"><span>969250×2 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">969225 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">chrom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">position</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058517</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058520</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058521</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058526</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058528</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058535</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058551</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058562</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058566</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058573</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058593</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058594</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">gws103</td>
<td style="text-align: right;">3058597</td>
</tr>
<tr class="even">
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969239</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574744</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969240</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574749</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969241</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574762</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969242</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574774</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969243</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574793</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969244</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574795</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969245</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574814</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969246</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574819</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969247</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574831</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969248</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574832</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969249</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574836</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">969250</td>
<td style="text-align: left;">gwZ</td>
<td style="text-align: right;">89574838</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="make-list-of-scaffolds-to-include-in-the-whole-genome-non_lhbr-pca" class="level4">
<h4 class="anchored" data-anchor-id="make-list-of-scaffolds-to-include-in-the-whole-genome-non_lhbr-pca">Make list of scaffolds to include in the whole-genome non_LHBR PCA:</h4>
<div id="e4949622" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>chromosomes_to_include <span class="op">=</span> <span class="st">"gw"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fu">vcat</span>(<span class="fl">28</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">17</span>, <span class="fl">15</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">push!</span>(chromosomes_to_include, <span class="st">"gw1A"</span>, <span class="st">"gw4A"</span>, <span class="st">"gwZ"</span>)  <span class="co"># add two other scaffolds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>30-element Vector{String}:
 "gw28"
 "gw27"
 "gw26"
 "gw25"
 "gw24"
 "gw23"
 "gw22"
 "gw21"
 "gw20"
 "gw19"
 "gw18"
 "gw17"
 "gw15"
 ⋮
 "gw9"
 "gw8"
 "gw7"
 "gw6"
 "gw5"
 "gw4"
 "gw3"
 "gw2"
 "gw1"
 "gw1A"
 "gw4A"
 "gwZ"</code></pre>
</div>
</div>
</section>
<section id="imputation-using-knn" class="level4">
<h4 class="anchored" data-anchor-id="imputation-using-knn">Imputation using KNN</h4>
<p>Did this on 11Jan2025 and saved files, so inactivated this cell for now (can take up to several minutes for each big scaffold):</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(chromosomes_to_include)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    chrom <span class="op">=</span> chromosomes_to_include[i]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    regionText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr"</span>, chrom, <span class="st">"nonLHBR"</span>) <span class="co"># this is where "nonLHBR will be incorporated in file name"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    loci_selection <span class="op">=</span> (pos_SNP_filtered_nonLHBR.chrom <span class="op">.==</span> chrom)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    pos_SNP_filtered_nonLHBR_region <span class="op">=</span> pos_SNP_filtered_nonLHBR[loci_selection,<span class="op">:</span>]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    genosOnly_nonLHBR_region_for_imputing <span class="op">=</span> <span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genosOnly_included_nonLHBR[<span class="op">:</span>,loci_selection])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@time</span> imputed_genos <span class="op">=</span> Impute.<span class="fu">knn</span>(genosOnly_nonLHBR_region_for_imputing; dims <span class="op">=</span> <span class="op">:</span>rows)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="fu">string</span>(baseName, tagName, regionText, <span class="st">".KNNimputedMissing.jld2"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">jldsave</span>(filename; imputed_genos, ind_with_metadata_indFiltered, pos_SNP_filtered_nonLHBR_region)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="fu">string</span>(regionText, <span class="st">": Saved real and imputed genotypes for non_LHBR parts of genome, for "</span>, <span class="fu">size</span>(pos_SNP_filtered_nonLHBR_region, <span class="fl">1</span>),<span class="st">" SNPs and "</span>, <span class="fu">size</span>(genosOnly_nonLHBR_region_for_imputing, <span class="fl">1</span>),<span class="st">" filtered individuals, in file </span><span class="sc">$</span>filename<span class="st">"</span>))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Load saved imputed data for each chromosome (the non-LHBR part):</p>
<div id="be840b5c" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize data structures</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>genos_imputed_loaded <span class="op">=</span> <span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(<span class="cn">undef</span>, <span class="fu">nrow</span>(ind_with_metadata_indFiltered), <span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>pos_SNP_loaded <span class="op">=</span> <span class="fu">DataFrame</span>(chrom <span class="op">=</span> <span class="dt">String</span>[], position <span class="op">=</span> <span class="dt">Int64</span>[])</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(chromosomes_to_include)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    chrom <span class="op">=</span> chromosomes_to_include[i]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    regionText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr"</span>, chrom, <span class="st">"nonLHBR"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="fu">string</span>(baseName, tagName, regionText, <span class="st">".KNNimputedMissing.jld2"</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    imputed_genos_one_chr <span class="op">=</span> <span class="fu">load</span>(filename, <span class="st">"imputed_genos"</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    genos_imputed_loaded <span class="op">=</span> <span class="fu">hcat</span>(genos_imputed_loaded, imputed_genos_one_chr)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ind_with_metadata_indFiltered.ind <span class="op">!=</span> <span class="fu">load</span>(filename, <span class="st">"ind_with_metadata_indFiltered"</span>)[<span class="op">:</span>, <span class="op">:</span>ind]</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"""Warning: "ind" columns in loaded data and memory data don't match."""</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    pos_SNP_filtered_region <span class="op">=</span> <span class="fu">load</span>(filename, <span class="st">"pos_SNP_filtered_nonLHBR_region"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    pos_SNP_loaded <span class="op">=</span> <span class="fu">vcat</span>(pos_SNP_loaded, pos_SNP_filtered_region)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="fu">string</span>(<span class="st">"Loaded "</span>,filename))</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="fu">string</span>(regionText, <span class="st">": "</span>, <span class="fu">size</span>(imputed_genos_one_chr,<span class="fl">2</span>), <span class="st">" SNPs from "</span>, <span class="fu">size</span>(imputed_genos_one_chr,<span class="fl">1</span>), <span class="st">" individuals"</span>))</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw28nonLHBR.KNNimputedMissing.jld2
chrgw28nonLHBR: 10180 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw27nonLHBR.KNNimputedMissing.jld2
chrgw27nonLHBR: 9184 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw26nonLHBR.KNNimputedMissing.jld2
chrgw26nonLHBR: 11803 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw25nonLHBR.KNNimputedMissing.jld2
chrgw25nonLHBR: 3294 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw24nonLHBR.KNNimputedMissing.jld2
chrgw24nonLHBR: 13321 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw23nonLHBR.KNNimputedMissing.jld2
chrgw23nonLHBR: 12949 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw22nonLHBR.KNNimputedMissing.jld2
chrgw22nonLHBR: 4973 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw21nonLHBR.KNNimputedMissing.jld2
chrgw21nonLHBR: 12821 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw20nonLHBR.KNNimputedMissing.jld2
chrgw20nonLHBR: 30239 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw19nonLHBR.KNNimputedMissing.jld2
chrgw19nonLHBR: 23914 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw18nonLHBR.KNNimputedMissing.jld2
chrgw18nonLHBR: 17359 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw17nonLHBR.KNNimputedMissing.jld2
chrgw17nonLHBR: 24313 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw15nonLHBR.KNNimputedMissing.jld2
chrgw15nonLHBR: 25517 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw14nonLHBR.KNNimputedMissing.jld2
chrgw14nonLHBR: 28469 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw13nonLHBR.KNNimputedMissing.jld2
chrgw13nonLHBR: 30543 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw12nonLHBR.KNNimputedMissing.jld2
chrgw12nonLHBR: 31794 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw11nonLHBR.KNNimputedMissing.jld2
chrgw11nonLHBR: 27183 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw10nonLHBR.KNNimputedMissing.jld2
chrgw10nonLHBR: 26462 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw9nonLHBR.KNNimputedMissing.jld2
chrgw9nonLHBR: 37680 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw8nonLHBR.KNNimputedMissing.jld2
chrgw8nonLHBR: 37318 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw7nonLHBR.KNNimputedMissing.jld2
chrgw7nonLHBR: 35575 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw6nonLHBR.KNNimputedMissing.jld2
chrgw6nonLHBR: 39675 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw5nonLHBR.KNNimputedMissing.jld2
chrgw5nonLHBR: 54829 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw4nonLHBR.KNNimputedMissing.jld2
chrgw4nonLHBR: 47980 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw3nonLHBR.KNNimputedMissing.jld2
chrgw3nonLHBR: 79372 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw2nonLHBR.KNNimputedMissing.jld2
chrgw2nonLHBR: 91292 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw1nonLHBR.KNNimputedMissing.jld2
chrgw1nonLHBR: 77362 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw1AnonLHBR.KNNimputedMissing.jld2
chrgw1AnonLHBR: 44551 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgw4AnonLHBR.KNNimputedMissing.jld2
chrgw4AnonLHBR: 17467 SNPs from 257 individuals
Loaded GW_genomics_2022_with_new_genome/GW2022_GBS_012NA_files/GW2022_all4plates.genotypes.SNPs_only.whole_genome.Jan2025.chrgwZnonLHBR.KNNimputedMissing.jld2
chrgwZnonLHBR: 50005 SNPs from 257 individuals</code></pre>
</div>
</div>
<p>Now do the PCA for non_LHBR parts of genome:</p>
<div id="a54956be" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>PCA_wholeGenome <span class="op">=</span> <span class="fu">plotPCA</span>(genos_imputed_loaded, ind_with_metadata_indFiltered, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> <span class="st">"non-LHBR wholeGenome"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>totalObservationVariance <span class="op">=</span> <span class="fu">var</span>(PCA_wholeGenome.model) </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>PC1_variance, PC2_variance <span class="op">=</span> <span class="fu">principalvars</span>(PCA_wholeGenome.model)[<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>]</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>PC1_prop_variance <span class="op">=</span> PC1_variance <span class="op">/</span> totalObservationVariance</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>PC2_prop_variance <span class="op">=</span> PC2_variance <span class="op">/</span> totalObservationVariance</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"PC1 explains "</span>, <span class="fl">100</span><span class="op">*</span>PC1_prop_variance, <span class="st">"% of the total variance.</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>PC2 explains <span class="st">", 100*PC2_prop_variance, "</span><span class="op">%</span>.<span class="st">")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-21-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>PC1 explains 10.945476% of the total variance.
PC2 explains 5.529751%.</code></pre>
</div>
</div>
<p>The above looks quite similar to the whole-genome PCA including the LHBRs.</p>
</section>
<section id="do-non_lhbr-for-a-specific-chromosome" class="level4">
<h4 class="anchored" data-anchor-id="do-non_lhbr-for-a-specific-chromosome">Do non_LHBR for a specific chromosome:</h4>
<div id="250f4db2" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> pos_SNP_loaded.chrom <span class="op">.==</span> <span class="st">"gw4A"</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>pos_SNP_loaded_oneChr <span class="op">=</span> pos_SNP_loaded[selection, <span class="op">:</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>genos_imputed_loaded_oneChr <span class="op">=</span> genos_imputed_loaded[<span class="op">:</span>, selection]</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>PCA_oneChr <span class="op">=</span> <span class="fu">plotPCA</span>(genos_imputed_loaded_oneChr, ind_with_metadata_indFiltered, </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> <span class="st">"non-LHBR gw4A"</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>totalObservationVariance <span class="op">=</span> <span class="fu">var</span>(PCA_oneChr.model) </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>PC1_variance, PC2_variance <span class="op">=</span> <span class="fu">principalvars</span>(PCA_oneChr.model)[<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>]</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>PC1_prop_variance <span class="op">=</span> PC1_variance <span class="op">/</span> totalObservationVariance</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>PC2_prop_variance <span class="op">=</span> PC2_variance <span class="op">/</span> totalObservationVariance</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"PC1 explains "</span>, <span class="fl">100</span><span class="op">*</span>PC1_prop_variance, <span class="st">"% of the total variance.</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>PC2 explains <span class="st">", 100*PC2_prop_variance, "</span><span class="op">%</span>.<span class="st">")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-22-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>PC1 explains 7.5557256% of the total variance.
PC2 explains 4.751407%.</code></pre>
</div>
</div>
<p>There is a whole lot of signal for population structure in the non-LHBR regions—maybe not surprising given there are high-Fst regions with low ViSHet.</p>
</section>
</section>
<section id="choose-low-het-individuals-in-a-high-vishet-region" class="level2">
<h2 class="anchored" data-anchor-id="choose-low-het-individuals-in-a-high-vishet-region">Choose low-het individuals in a high ViSHet region</h2>
<p>Now that we have high ViSHet regions indicated, we can automate the choosing of essential homozygous individuals in those regions. Below I will do this for chrZ (and later chr15 and chr18).</p>
<p>First, here’s two functions, first for getting the boundaries of the longest high ViSHet region from a scaffold, second for getting a bunch of info about the region:</p>
<div id="eae326c5" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getOneHighViSHetRegion</span>(highViSHetRegions, chr)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (highViSHetRegions.regionChrom <span class="op">.==</span> chr)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">sum</span>(selection) <span class="op">==</span> <span class="fl">1</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"Good news: 1 region on that scaffold"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>        positionMin <span class="op">=</span> highViSHetRegions.regionStart[selection][<span class="fl">1</span>]</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        positionMax <span class="op">=</span> highViSHetRegions.regionEnd[selection][<span class="fl">1</span>]</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        regionText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr "</span>, chr, <span class="st">" "</span>,positionMin,<span class="st">" to "</span>,positionMax)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elseif</span> <span class="fu">sum</span>(selection) <span class="op">&gt;</span> <span class="fl">1</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"More than 1 region on that scaffold. Using just the longest one."</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>        highViSHetRegions_chr <span class="op">=</span> highViSHetRegions[selection, <span class="op">:</span>]</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">display</span>(highViSHetRegions_chr)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get biggest region (first one if tied):</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>        regionSizes <span class="op">=</span> highViSHetRegions_chr.regionEnd <span class="op">.-</span> highViSHetRegions_chr.regionStart</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        indexOfLongest <span class="op">=</span> <span class="fu">findfirst</span>(regionSizes <span class="op">.==</span> <span class="fu">maximum</span>(regionSizes))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        positionMin <span class="op">=</span> highViSHetRegions_chr.regionStart[indexOfLongest]</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        positionMax <span class="op">=</span> highViSHetRegions_chr.regionEnd[indexOfLongest]</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>        regionText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr "</span>, chr, <span class="st">" "</span>,positionMin,<span class="st">" to "</span>,positionMax)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elseif</span> <span class="fu">sum</span>(selection) <span class="op">==</span> <span class="fl">0</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"No high ViSHet regions on that scaffold"</span>)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> positionMin, positionMax, regionText</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getWindowedIndHetStanRegion</span>(genos, pos, </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>                                    highViSHetRegions, chr;</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>                                    windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remake the windowedIndHet_standardized (done above in a different cell)</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    loci_selection <span class="op">=</span> (pos.chrom <span class="op">.==</span> chr)</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    pos_region <span class="op">=</span> pos[loci_selection, <span class="op">:</span>]</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    genotypes_region <span class="op">=</span> genos[<span class="op">:</span>, loci_selection]</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>    windowedPos, windowedIndHet <span class="op">=</span> <span class="fu">getWindowedIndHet</span>(genotypes_region, pos_region, windowSize)</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    windowedIndHet_standardized <span class="op">=</span> <span class="fu">standardizeIndHet</span>(windowedIndHet)</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># look up the boundaries of the high ViSHet region:</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    positionMin, positionMax, regionText <span class="op">=</span> <span class="fu">getOneHighViSHetRegion</span>(highViSHetRegions, chr)</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># choose just the windows that are in the high ViSHet region:</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    window_selection <span class="op">=</span> (positionMin <span class="op">.&lt;</span> windowedPos <span class="op">.&lt;</span> positionMax)</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion <span class="op">=</span> windowedIndHet_standardized[<span class="op">:</span>,window_selection]</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    meanAcrossRegionIndHetStan <span class="op">=</span> <span class="fu">mean</span>.(<span class="fu">eachrow</span>(windowedIndHetStanRegion)) </span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># choose loci in region</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>    lociSelection <span class="op">=</span> (positionMin <span class="op">.&lt;</span> pos_region.position <span class="op">.&lt;</span> positionMax)</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    pos_highViSHetRegion <span class="op">=</span> pos_region[lociSelection, <span class="op">:</span>]</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion <span class="op">=</span> genotypes_region[<span class="op">:</span>, lociSelection]</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert `-1` genotypes (which indicates missing) to `missing`:</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace!</span>(genos_highViSHetRegion, <span class="op">-</span><span class="fl">1</span> <span class="op">=&gt;</span> <span class="cn">missing</span>)</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>    regionInfo <span class="op">=</span> <span class="fu">chooseChrRegion</span>(pos_highViSHetRegion, chr; positionMin<span class="op">=</span>positionMin, positionMax<span class="op">=</span>positionMax) <span class="co"># this makes appropriate text describing the region</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> positionMin, positionMax, regionText, </span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>            windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>            genos_highViSHetRegion, pos_highViSHetRegion, regionInfo</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>getWindowedIndHetStanRegion (generic function with 1 method)</code></pre>
</div>
</div>
<div id="b4c6793d" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gwZ"</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a><span class="co"># also flip PC3:</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">2</span>) </span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals, PC1 to PC2:</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>fig_3A <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig_3A[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"gwZ LHBR PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(fig_3A)</span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"Figure3A_from_Julia.png"</span>, fig_3A, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-24-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-24-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="now-plot-pc1-vs.-pc3-for-low-vishet-individuals" class="level4">
<h4 class="anchored" data-anchor-id="now-plot-pc1-vs.-pc3-for-low-vishet-individuals">Now plot PC1 vs.&nbsp;PC3 for low ViSHet individuals</h4>
<div id="65ddedfa" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals, PC1 to PC2:</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>fig_3B <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig_3B[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"gwZ LHBR PC1 vs. PC3, only low heterozygosity"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(fig_3B)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"Figure3B_from_Julia.png"</span>, fig_3B, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-25-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="save-the-individual-colors-in-the-metadata" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata">Save the individual colors in the metadata</h3>
<div id="e70f0a43" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="a18cf87d" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>fig_3C <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig_3C[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"gwZ LHBR PC1 vs. PC2, all individuals"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(fig_3C)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"Figure3C_from_Julia.png"</span>, fig_3C, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-27-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="6dd80fc5" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>fig_3D <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig_3D[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"gwZ LHBR PC1 vs. PC3, all individuals"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(fig_3D)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"Figure3D_from_Julia.png"</span>, fig_3D, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-28-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="now-it-is-clear-that-there-are-six-clear-haplogroups-of-z-high-vishet-region.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="now-it-is-clear-that-there-are-six-clear-haplogroups-of-z-high-vishet-region.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">Now it is clear that there are six clear haplogroups of Z high ViSHet region. Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="ede298a2" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect Z chromosome PCA of low IndHet (&lt; 2) individuals,</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and specify group boundaries:</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud"</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"seagreen4"</span>,</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>vir <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4.5</span>) <span class="op">.&amp;</span> </span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>        (PCAmodelAll.metadata.PC3 <span class="op">.&gt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span> </span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span> </span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>lud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4.5</span>) <span class="op">.&amp;</span> </span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span> </span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>        (PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span> </span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span> </span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="op">-</span><span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span> </span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>        (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span> </span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[vir]</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit] <span class="co"># note there are two nitidus with nearly identical values</span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[lud]</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [vir nit lud troch obs plumb]</span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a><span class="st">    getFreqsAndSampleSizesBySexForZ(genoData, sex, indGroup, groupsToCalc)</span></span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a><span class="st">Calculate allele frequencies and sample sizes for each group and SNP, taking into account sex for analysis of Z chromosome.</span></span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a><span class="st">​# Arguments</span></span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a><span class="st">- `genoData`: The genotype matrix, where rows are individuals and columns are loci, with genotype codes 0,1,2 meaning homozygous reference, heterozygote, homozygous alternate, and missing genotypes can be either -1 or `missing`.</span></span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a><span class="st">- `sex`: Vector of sexes ('f` or `m`)</span></span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a><span class="st">- `indGroup`: A vector providing the group name each individual belongs to.</span></span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a><span class="st">- `groupsToCalc`: A list of group names to include in calculations.</span></span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a><span class="st"># Notes</span></span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a><span class="st">Returns a tuple containing 1) a matrix of frequencies, and 2) a matrix of samples sizes (in both, rows are groups and columns are loci). </span></span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFreqsAndSampleSizesBySexForZ</span>(genoData, sex, indGroup, groupsToCalc)</span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">any</span>(.!<span class="fu">map</span>(x <span class="op">-&gt;</span> x <span class="kw">in</span> [<span class="st">"F"</span>, <span class="st">"M"</span>], sex))</span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"Warning: not all entries in sex vector are `F` or `M`"</span>)</span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a>    genoData[<span class="fu">ismissing</span>.(genoData)] <span class="op">.=</span> <span class="op">-</span><span class="fl">1</span> <span class="co"># if "missing" datatype is use, convert to -1</span></span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a>    groupCount <span class="op">=</span> <span class="fu">length</span>(groupsToCalc)</span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a>    freqs <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float32,2}</span>(<span class="cn">undef</span>, groupCount, <span class="fu">size</span>(genoData, <span class="fl">2</span>))</span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a>    sampleSizes <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Number,2}</span>(<span class="cn">undef</span>, groupCount, <span class="fu">size</span>(genoData, <span class="fl">2</span>))</span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>groupCount</span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># females:</span></span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a>        selection <span class="op">=</span> (indGroup <span class="op">.==</span> groupsToCalc[i]) <span class="op">.&amp;</span> (sex <span class="op">.==</span> <span class="st">"F"</span>) <span class="co"># gets the correct rows for individuals in the group </span></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a>        geno0countsF <span class="op">=</span> <span class="fu">sum</span>(genoData[selection, <span class="op">:</span>] <span class="op">.==</span> <span class="fl">0</span>, dims<span class="op">=</span><span class="fl">1</span>) <span class="co"># count by column the number of 0 genotypes (homozygous ref)</span></span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a>        geno1countsF <span class="op">=</span> <span class="fu">sum</span>(genoData[selection, <span class="op">:</span>] <span class="op">.==</span> <span class="fl">1</span>, dims<span class="op">=</span><span class="fl">1</span>) <span class="co"># same for 1 genotypes (heterozygous)</span></span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a>        geno2countsF <span class="op">=</span> <span class="fu">sum</span>(genoData[selection, <span class="op">:</span>] <span class="op">.==</span> <span class="fl">2</span>, dims<span class="op">=</span><span class="fl">1</span>) <span class="co"># same for 2 genotypes (homozygous alternate) </span></span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a>        <span class="co"># males: </span></span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a>        selection <span class="op">=</span> (indGroup <span class="op">.==</span> groupsToCalc[i]) <span class="op">.&amp;</span> (sex <span class="op">.==</span> <span class="st">"M"</span>)</span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true" tabindex="-1"></a>        geno0countsM <span class="op">=</span> <span class="fu">sum</span>(genoData[selection, <span class="op">:</span>] <span class="op">.==</span> <span class="fl">0</span>, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true" tabindex="-1"></a>        geno1countsM <span class="op">=</span> <span class="fu">sum</span>(genoData[selection, <span class="op">:</span>] <span class="op">.==</span> <span class="fl">1</span>, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true" tabindex="-1"></a>        geno2countsM <span class="op">=</span> <span class="fu">sum</span>(genoData[selection, <span class="op">:</span>] <span class="op">.==</span> <span class="fl">2</span>, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb58-92"><a href="#cb58-92" aria-hidden="true" tabindex="-1"></a>        allele0counts <span class="op">=</span> (<span class="fl">2</span> <span class="op">.*</span> geno0countsM) <span class="op">.+</span> geno1countsM <span class="op">.+</span> geno0countsF <span class="op">.+</span> (<span class="fl">0.5</span> <span class="op">.*</span> geno1countsF)</span>
<span id="cb58-93"><a href="#cb58-93" aria-hidden="true" tabindex="-1"></a>        allele2counts <span class="op">=</span> (<span class="fl">2</span> <span class="op">.*</span> geno2countsM) <span class="op">.+</span> geno1countsM <span class="op">.+</span> geno2countsF <span class="op">.+</span> (<span class="fl">0.5</span> <span class="op">.*</span> geno1countsF)</span>
<span id="cb58-94"><a href="#cb58-94" aria-hidden="true" tabindex="-1"></a>        sumAlleleCounts <span class="op">=</span> allele0counts <span class="op">.+</span> allele2counts</span>
<span id="cb58-95"><a href="#cb58-95" aria-hidden="true" tabindex="-1"></a>        sampleSizes[i, <span class="op">:</span>] <span class="op">=</span> <span class="fl">0.5</span> <span class="op">.*</span> sumAlleleCounts <span class="co"># sample size in number of individuals</span></span>
<span id="cb58-96"><a href="#cb58-96" aria-hidden="true" tabindex="-1"></a>        freqs[i, <span class="op">:</span>] <span class="op">=</span> allele2counts <span class="op">./</span> sumAlleleCounts</span>
<span id="cb58-97"><a href="#cb58-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb58-98"><a href="#cb58-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> freqs, sampleSizes</span>
<span id="cb58-99"><a href="#cb58-99" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb58-100"><a href="#cb58-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-101"><a href="#cb58-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb58-102"><a href="#cb58-102" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizesBySexForZ</span>(genos_highViSHetRegion, ind_with_metadata_included.sex, clusterMembership, clusterNames)</span>
<span id="cb58-103"><a href="#cb58-103" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb58-104"><a href="#cb58-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-105"><a href="#cb58-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb58-106"><a href="#cb58-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-107"><a href="#cb58-107" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb58-108"><a href="#cb58-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-109"><a href="#cb58-109" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb58-110"><a href="#cb58-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-111"><a href="#cb58-111" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb58-112"><a href="#cb58-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-113"><a href="#cb58-113" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb58-114"><a href="#cb58-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-115"><a href="#cb58-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb58-116"><a href="#cb58-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-117"><a href="#cb58-117" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb58-118"><a href="#cb58-118" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb58-119"><a href="#cb58-119" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb58-120"><a href="#cb58-120" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb58-121"><a href="#cb58-121" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb58-122"><a href="#cb58-122" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ vir      0.00706945</span></span>
<span id="cb58-123"><a href="#cb58-123" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.0035094</span></span>
<span id="cb58-124"><a href="#cb58-124" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ lud      0.00794828</span></span>
<span id="cb58-125"><a href="#cb58-125" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ troch    0.00968743</span></span>
<span id="cb58-126"><a href="#cb58-126" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ obs      0.0112686</span></span>
<span id="cb58-127"><a href="#cb58-127" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ plumb    0.0104236 =#</span></span>
<span id="cb58-128"><a href="#cb58-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-129"><a href="#cb58-129" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb58-130"><a href="#cb58-130" aria-hidden="true" tabindex="-1"></a><span class="co">#=</span></span>
<span id="cb58-131"><a href="#cb58-131" aria-hidden="true" tabindex="-1"></a><span class="co">15×2 DataFrame</span></span>
<span id="cb58-132"><a href="#cb58-132" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb58-133"><a href="#cb58-133" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb58-134"><a href="#cb58-134" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb58-135"><a href="#cb58-135" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ vir_nit       0.0388124</span></span>
<span id="cb58-136"><a href="#cb58-136" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ vir_lud       0.0173121</span></span>
<span id="cb58-137"><a href="#cb58-137" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ vir_troch     0.0410345</span></span>
<span id="cb58-138"><a href="#cb58-138" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ vir_obs       0.037509</span></span>
<span id="cb58-139"><a href="#cb58-139" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ vir_plumb     0.0466843</span></span>
<span id="cb58-140"><a href="#cb58-140" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_lud       0.0365198</span></span>
<span id="cb58-141"><a href="#cb58-141" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_troch     0.0464045</span></span>
<span id="cb58-142"><a href="#cb58-142" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ nit_obs       0.0427296</span></span>
<span id="cb58-143"><a href="#cb58-143" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ nit_plumb     0.0524538</span></span>
<span id="cb58-144"><a href="#cb58-144" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ lud_troch     0.038968</span></span>
<span id="cb58-145"><a href="#cb58-145" aria-hidden="true" tabindex="-1"></a><span class="co">  11 │ lud_obs       0.0354195</span></span>
<span id="cb58-146"><a href="#cb58-146" aria-hidden="true" tabindex="-1"></a><span class="co">  12 │ lud_plumb     0.0445131</span></span>
<span id="cb58-147"><a href="#cb58-147" aria-hidden="true" tabindex="-1"></a><span class="co">  13 │ troch_obs     0.0265615</span></span>
<span id="cb58-148"><a href="#cb58-148" aria-hidden="true" tabindex="-1"></a><span class="co">  14 │ troch_plumb   0.0404278</span></span>
<span id="cb58-149"><a href="#cb58-149" aria-hidden="true" tabindex="-1"></a><span class="co">  15 │ obs_plumb     0.0365139 =#</span></span>
<span id="cb58-150"><a href="#cb58-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-151"><a href="#cb58-151" aria-hidden="true" tabindex="-1"></a><span class="co"># It seems the distances are not very consistent with a bifurcating tree,</span></span>
<span id="cb58-152"><a href="#cb58-152" aria-hidden="true" tabindex="-1"></a><span class="co"># nor 1-D isolation by distance, but something more complex.</span></span>
<span id="cb58-153"><a href="#cb58-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Obscuratus is closer to viridanus than troch is.</span></span>
<span id="cb58-154"><a href="#cb58-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Nitidus quite distant but gets put in centre of PCA because off on its own axis.</span></span>
<span id="cb58-155"><a href="#cb58-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-156"><a href="#cb58-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb58-157"><a href="#cb58-157" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb58-158"><a href="#cb58-158" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb58-159"><a href="#cb58-159" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb58-160"><a href="#cb58-160" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb58-161"><a href="#cb58-161" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb58-162"><a href="#cb58-162" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb58-163"><a href="#cb58-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-164"><a href="#cb58-164" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb58-165"><a href="#cb58-165" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb58-166"><a href="#cb58-166" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb58-167"><a href="#cb58-167" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb58-168"><a href="#cb58-168" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb58-169"><a href="#cb58-169" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb58-170"><a href="#cb58-170" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb58-171"><a href="#cb58-171" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb58-172"><a href="#cb58-172" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb58-173"><a href="#cb58-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-174"><a href="#cb58-174" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb58-175"><a href="#cb58-175" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> [<span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span>]</span>
<span id="cb58-176"><a href="#cb58-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-177"><a href="#cb58-177" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb58-178"><a href="#cb58-178" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb58-179"><a href="#cb58-179" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb58-180"><a href="#cb58-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-181"><a href="#cb58-181" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb58-182"><a href="#cb58-182" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb58-183"><a href="#cb58-183" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb58-184"><a href="#cb58-184" aria-hidden="true" tabindex="-1"></a>                titleFontSize <span class="op">=</span> <span class="fl">20</span>,</span>
<span id="cb58-185"><a href="#cb58-185" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [37 2 38 80 5 73] and the sum of those is 235
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-29-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [68372991, 68434641, 68434654, 68434681, 68506332, 68506385, 68506399, 68533951, 68682243, 68795208  …  73563085, 73563098, 73586599, 73680319, 73743035, 73743078, 73743083, 73743128, 73743136, 73743151], <span class="ansi-bold">67×18 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   3 │ GW_Lane5_AA1               GW_Lane5_AA1               AA        vir_S
   4 │ GW_Lane5_AA5               GW_Lane5_AA5               AA        vir_S
   5 │ GW_Lane5_TL1               GW_Lane5_TL1               TL        vir     ⋯
   6 │ GW_Lane5_TL10              GW_Lane5_TL10              TL        vir
   7 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir
   8 │ GW_Lane5_TL8               GW_Lane5_TL8               TL        vir
   9 │ GW_Lane5_YK5               GW_Lane5_YK5               YK        vir     ⋯
  10 │ GW_Lane5_YK6               GW_Lane5_YK6               YK        vir
  11 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  58 │ GW_Armando_plate1_JF09G02  GW_Armando_plate1_JF09G02  ST        plumb
  59 │ GW_Armando_plate1_JF11G01  GW_Armando_plate1_JF11G01  ST        plumb   ⋯
  60 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
  61 │ GW_Armando_plate1_JF12G02  GW_Armando_plate1_JF12G02  ST        plumb
  62 │ GW_Armando_plate1_JF13G01  GW_Armando_plate1_JF13G01  ST        plumb
  63 │ GW_Armando_plate1_JF22G01  GW_Armando_plate1_JF22G01  MB        plumb   ⋯
  64 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
  65 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb
  66 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb
  67 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb   ⋯
<span class="ansi-cyan-fg">                                                  15 columns and 46 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="9ce4cd9e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_lud"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"lud"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"lud_troch"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>]</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"lightseagreen"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green"</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>]</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>vir_lud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4.5</span>) <span class="op">.&amp;</span> </span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>        (<span class="op">-</span><span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="co"># Note this one has lowIndHetStan but is mix of vir and lud</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>lud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [vir vir_lud nit lud lud_troch troch obs plumb]</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-30-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [68372991, 68434641, 68434654, 68434681, 68506332, 68506385, 68506399, 68533951, 68682243, 68795208  …  73563085, 73563098, 73586599, 73680319, 73743035, 73743078, 73743083, 73743128, 73743136, 73743151], <span class="ansi-bold">83×18 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   3 │ GW_Lane5_AA1               GW_Lane5_AA1               AA        vir_S
   4 │ GW_Lane5_AA5               GW_Lane5_AA5               AA        vir_S
   5 │ GW_Lane5_TL1               GW_Lane5_TL1               TL        vir     ⋯
   6 │ GW_Lane5_TL10              GW_Lane5_TL10              TL        vir
   7 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir
   8 │ GW_Lane5_TL8               GW_Lane5_TL8               TL        vir
   9 │ GW_Lane5_YK5               GW_Lane5_YK5               YK        vir     ⋯
  10 │ GW_Lane5_YK6               GW_Lane5_YK6               YK        vir
  11 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  74 │ GW_Armando_plate1_JF09G02  GW_Armando_plate1_JF09G02  ST        plumb
  75 │ GW_Armando_plate1_JF11G01  GW_Armando_plate1_JF11G01  ST        plumb   ⋯
  76 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
  77 │ GW_Armando_plate1_JF12G02  GW_Armando_plate1_JF12G02  ST        plumb
  78 │ GW_Armando_plate1_JF13G01  GW_Armando_plate1_JF13G01  ST        plumb
  79 │ GW_Armando_plate1_JF22G01  GW_Armando_plate1_JF22G01  MB        plumb   ⋯
  80 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
  81 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb
  82 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb
  83 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb   ⋯
<span class="ansi-cyan-fg">                                                  15 columns and 62 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order">show GBI plot according to original groups and plot order</h3>
<div id="08ad49fa" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-31-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [68372991, 68434641, 68434654, 68434681, 68506332, 68506385, 68506399, 68533951, 68682243, 68795208  …  73563085, 73563098, 73586599, 73680319, 73743035, 73743078, 73743083, 73743128, 73743136, 73743151], <span class="ansi-bold">83×18 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   3 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   4 │ GW_Lane5_YK5               GW_Lane5_YK5               YK        vir
   5 │ GW_Lane5_YK6               GW_Lane5_YK6               YK        vir     ⋯
   6 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir
   7 │ GW_Lane5_TL1               GW_Lane5_TL1               TL        vir
   8 │ GW_Lane5_TL10              GW_Lane5_TL10              TL        vir
   9 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir     ⋯
  10 │ GW_Lane5_TL8               GW_Lane5_TL8               TL        vir
  11 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  74 │ GW_Armando_plate1_JF09G01  GW_Armando_plate1_JF09G01  ST        plumb
  75 │ GW_Armando_plate1_JF09G02  GW_Armando_plate1_JF09G02  ST        plumb   ⋯
  76 │ GW_Armando_plate1_JF11G01  GW_Armando_plate1_JF11G01  ST        plumb
  77 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
  78 │ GW_Armando_plate1_JF12G02  GW_Armando_plate1_JF12G02  ST        plumb
  79 │ GW_Armando_plate1_JF13G01  GW_Armando_plate1_JF13G01  ST        plumb   ⋯
  80 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb
  81 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb
  82 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb
  83 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb   ⋯
<span class="ansi-cyan-fg">                                                  15 columns and 62 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals">show same but with all individuals</h3>
<div id="9e0b254c" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>plotInfo <span class="op">=</span> <span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                indFontSize<span class="op">=</span><span class="fl">6</span>, figureSize<span class="op">=</span>(<span class="fl">1200</span>, <span class="fl">1600</span>),</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">true</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"FigureS1_from_Julia.png"</span>, plotInfo[<span class="fl">1</span>], px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-32-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus">Show just the west area (without nitidus)</h3>
<div id="d7a3abbf" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"lud"</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"lud_troch"</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,]</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green"</span>,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizesBySexForZ</span>(genos_selectedSNPs, ind_with_metadata_included.sex, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-33-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 1 … 2 0; 0 0 … 2 0], [68434641, 68434654, 68434681, 68506332, 68506385, 68533951, 68682243, 68795208, 69062410, 69164105  …  73298332, 73298436, 73347645, 73504646, 73558384, 73563098, 73680319, 73743035, 73743128, 73743151], <span class="ansi-bold">176×18 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK5               GW_Lane5_YK5               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 167 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
 168 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L ⋯
 169 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
 170 │ GW_Lane5_LN6               GW_Lane5_LN6               LN        troch_L
 171 │ GW_Lane5_LN7               GW_Lane5_LN7               LN        troch_L
 172 │ GW_Lane5_LN10              GW_Lane5_LN10              LN        troch_L ⋯
 173 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L
 174 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L
 175 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
 176 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L ⋯
<span class="ansi-cyan-fg">                                                 15 columns and 155 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area">Show just the east area</h3>
<div id="d8505f91" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"troch"</span>,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs"</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"orange"</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizesBySexForZ</span>(genos_selectedSNPs, ind_with_metadata_included.sex, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-34-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 1 1 … 0 0; … ; 2 2 … 0 2; 2 2 … 0 2], [68434641, 68434654, 68533951, 68795208, 69010058, 69062405, 69103733, 69164105, 69293527, 69321751  …  73316610, 73344945, 73389057, 73471732, 73504381, 73504408, 73504704, 73743078, 73743083, 73743128], <span class="ansi-bold">158×18 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW70      GW_Armando_plate1_TTGW70      SA        l ⋯
   2 │ GW_Armando_plate1_TTGW72      GW_Armando_plate1_TTGW72      SA        l
   3 │ GW_Armando_plate1_TTGW78      GW_Armando_plate1_TTGW78      SA        l
   4 │ GW_Armando_plate2_TTGW77      GW_Armando_plate2_TTGW77      SA        l
   5 │ GW_Armando_plate2_TTGW79      GW_Armando_plate2_TTGW79      SA        l ⋯
   6 │ GW_Armando_plate2_TTGW80      GW_Armando_plate2_TTGW80      SA        l
   7 │ GW_Armando_plate2_TTGW73      GW_Armando_plate2_TTGW73      SA        l
   8 │ GW_Armando_plate2_TTGW75      GW_Armando_plate2_TTGW75      SA        l
   9 │ GW_Lane5_PT12                 GW_Lane5_PT12                 KL        l ⋯
  10 │ GW_Armando_plate1_TTGW-15-08  GW_Armando_plate1_TTGW-15-08  SR        l
  11 │ GW_Armando_plate2_TTGW28      GW_Armando_plate2_TTGW28      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 149 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p
 150 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p ⋯
 151 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
 152 │ GW_Armando_plate1_JG02G04     GW_Armando_plate1_JG02G04     PR        p
 153 │ GW_Armando_plate2_JG01G01     GW_Armando_plate2_JG01G01     PR        p
 154 │ GW_Armando_plate2_JG02G01     GW_Armando_plate2_JG02G01     PR        p ⋯
 155 │ GW_Armando_plate2_JG02G03     GW_Armando_plate2_JG02G03     PR        p
 156 │ GW_Lane5_SL1                  GW_Lane5_SL1                  SL        p
 157 │ GW_Lane5_SL2                  GW_Lane5_SL2                  SL        p
 158 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p ⋯
<span class="ansi-cyan-fg">                                                 15 columns and 137 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area">Show just the northern area</h3>
<div id="5547aa99" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-35-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [68434681, 68506332, 68506385, 68682243, 69010058, 69062410, 69103733, 69253971, 69267458, 69275355  …  73309732, 73316610, 73344945, 73347645, 73389057, 73471732, 73504381, 73558384, 73563098, 73743078], <span class="ansi-bold">110×18 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   4 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   5 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK5               GW_Lane5_YK5               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 101 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
 102 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb   ⋯
 103 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 104 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 105 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 106 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 107 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 108 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 109 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 110 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  15 columns and 89 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="do-a-pca-based-on-above-info-on-just-the-west-side-of-the-ring" class="level3">
<h3 class="anchored" data-anchor-id="do-a-pca-based-on-above-info-on-just-the-west-side-of-the-ring">Do a PCA based on above info, on just the west side of the ring</h3>
<div id="dbabe774" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>groups_to_plot_PCA_westside <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_S"</span>,<span class="st">"nit"</span>, <span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>,<span class="st">"troch_west"</span>,<span class="st">"troch_LN"</span>]</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>group_colors_PCA_westside <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>,<span class="st">"grey"</span>,<span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>]</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># without nitidus:</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>groups_to_plot_PCA_westside <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_S"</span>, <span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>,<span class="st">"troch_west"</span>,<span class="st">"troch_LN"</span>]</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>group_colors_PCA_westside <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>,<span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>]</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>PCAmodel <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA_westside, group_colors_PCA_westside; </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers (west side)"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodel.PCAfig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-36-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="do-a-pca-based-on-above-info-on-just-the-east-side-of-the-ring" class="level3">
<h3 class="anchored" data-anchor-id="do-a-pca-based-on-above-info-on-just-the-east-side-of-the-ring">Do a PCA based on above info, on just the east side of the ring</h3>
<div id="52421ea9" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>groups_to_plot_PCA_eastside <span class="op">=</span> [<span class="st">"troch_LN"</span>,<span class="st">"troch_EM"</span>,<span class="st">"obs"</span>,<span class="st">"plumb_BJ"</span>,<span class="st">"plumb"</span>,<span class="st">"plumb_vir"</span>]</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>group_colors_PCA_eastside <span class="op">=</span> [<span class="st">"yellow"</span>,<span class="st">"gold"</span>,<span class="st">"orange"</span>,<span class="st">"pink"</span>,<span class="st">"red"</span>,<span class="st">"purple"</span>];</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>PCAmodel <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA_eastside, group_colors_PCA_eastside; </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers (east side)"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodel.PCAfig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-37-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="show-pca-for-just-the-western-haploblocks-of-the-ring-for-just-chr-z" class="level3">
<h3 class="anchored" data-anchor-id="show-pca-for-just-the-western-haploblocks-of-the-ring-for-just-chr-z">Show PCA for just the western haploblocks of the ring, for just chr Z</h3>
<div id="6bfc5b05" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included_temp <span class="op">=</span> <span class="fu">copy</span>(ind_with_metadata_included)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Leave out the individuals that don't have western haplogroup genotypes</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>hapGroups_to_plot_PCA_westside <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_lud"</span>, <span class="st">"nit"</span>, <span class="st">"lud"</span>]</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> <span class="fu">map</span>(<span class="fu">in</span>(hapGroups_to_plot_PCA_westside), clusterMembershipWithHets)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included_temp.Fst_group[.!selection] <span class="op">.=</span> <span class="st">"ignore"</span> <span class="co"># write over the group name so function below won't plot that individual</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>groups_to_plot_PCA_westside <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_S"</span>,<span class="st">"nit"</span>, <span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>,<span class="st">"troch_west"</span>,<span class="st">"troch_LN"</span>]</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>group_colors_PCA_westside <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>,<span class="st">"grey"</span>,<span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>]</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>PCAmodelHapWest <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included_temp, </span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA_westside, group_colors_PCA_westside; </span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers west haps"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelHapWest.PCAfig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-38-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="show-pca-for-just-the-eastern-haploblocks-of-the-ring-for-just-chr-z" class="level3">
<h3 class="anchored" data-anchor-id="show-pca-for-just-the-eastern-haploblocks-of-the-ring-for-just-chr-z">Show PCA for just the eastern haploblocks of the ring, for just chr Z</h3>
<div id="bacf0829" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included_temp <span class="op">=</span> <span class="fu">copy</span>(ind_with_metadata_included)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Leave out the individuals that don't have western haplogroup genotypes</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>hapGroups_to_plot_PCA_eastside <span class="op">=</span> [<span class="st">"troch"</span>, <span class="st">"obs"</span>, <span class="st">"plumb"</span>]</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> <span class="fu">map</span>(<span class="fu">in</span>(hapGroups_to_plot_PCA_eastside), clusterMembershipWithHets)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included_temp.Fst_group[.!selection] <span class="op">.=</span> <span class="st">"ignore"</span> <span class="co"># write over the group name so function below won't plot that individual</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>groups_to_plot_PCA_eastside <span class="op">=</span> [<span class="st">"troch_LN"</span>,<span class="st">"troch_EM"</span>,<span class="st">"obs"</span>,<span class="st">"plumb"</span>,<span class="st">"plumb_vir"</span>,<span class="st">"plumb_BJ"</span>]</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>group_colors_PCA_eastside <span class="op">=</span> [<span class="st">"yellow"</span>,<span class="st">"gold"</span>,<span class="st">"orange"</span>,<span class="st">"red"</span>,<span class="st">"purple"</span>,<span class="st">"pink"</span>];</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>PCAmodelHapEast <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included_temp, </span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA_eastside, group_colors_PCA_eastside; </span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers east haps"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelHapEast.PCAfig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-39-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="do-a-pca-based-on-a-same-size-region-elsewhere-on-the-z-with-low-vishet" class="level3">
<h3 class="anchored" data-anchor-id="do-a-pca-based-on-a-same-size-region-elsewhere-on-the-z-with-low-vishet">Do a PCA based on a same-size region elsewhere on the Z (with low ViSHet):</h3>
<div id="293a68ab" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get length of region</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>lengthHighViSHetRegion <span class="op">=</span> positionMax <span class="op">-</span> positionMin</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>leftLocus <span class="op">=</span> <span class="fl">1_000_000</span> <span class="co"># start at 1 Mb from left side</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>rightLocus <span class="op">=</span> leftLocus <span class="op">+</span> lengthHighViSHetRegion</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>regionText_lowViSHetRegion <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr "</span>, chr, <span class="st">" "</span>,leftLocus,<span class="st">" to "</span>,rightLocus)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>lociSelection <span class="op">=</span> (leftLocus <span class="op">.&lt;=</span> pos_region.position <span class="op">.&lt;=</span> rightLocus)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>genotypes_lowViSHetRegion <span class="op">=</span> genotypes_region[<span class="op">:</span>, lociSelection]</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="co"># impute missing genotypes:</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>genotypes_lowViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genotypes_lowViSHetRegion))</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>PCAmodel <span class="op">=</span> <span class="fu">plotPCA</span>(genotypes_lowViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText_lowViSHetRegion,</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodel.PCAfig)</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"FigureS2A_gwZ_nonHLBRarbitrary_from_Julia.png"</span>, PCAmodel.PCAfig, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-40-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="do-similar-as-above-but-for-chr-15" class="level2">
<h2 class="anchored" data-anchor-id="do-similar-as-above-but-for-chr-15">Do similar as above but for chr 15:</h2>
<div id="d3d4dfeb" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw15"</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb92-53"><a href="#cb92-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb92-54"><a href="#cb92-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb92-55"><a href="#cb92-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-56"><a href="#cb92-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb92-57"><a href="#cb92-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb92-58"><a href="#cb92-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-59"><a href="#cb92-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb92-60"><a href="#cb92-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.75</span>) </span>
<span id="cb92-61"><a href="#cb92-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-62"><a href="#cb92-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb92-63"><a href="#cb92-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-64"><a href="#cb92-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb92-65"><a href="#cb92-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb92-66"><a href="#cb92-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb92-67"><a href="#cb92-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb92-68"><a href="#cb92-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb92-69"><a href="#cb92-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb92-70"><a href="#cb92-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb92-71"><a href="#cb92-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb92-72"><a href="#cb92-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb92-73"><a href="#cb92-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb92-74"><a href="#cb92-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb92-75"><a href="#cb92-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-41-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-41-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-1" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-1">Save the individual colors in the metadata</h3>
<div id="63031399" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-1" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-1">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="7ffcc7c0" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-43-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-1" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-1">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="30642a9e" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-44-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-15-high-vishet-region-there-are-only-5-clear-haplogroups-pc3-does-not-distinguish-vir-and-lud.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-15-high-vishet-region-there-are-only-5-clear-haplogroups-pc3-does-not-distinguish-vir-and-lud.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 15 high ViSHet region, there are only 5 clear haplogroups (PC3 does not distinguish vir and lud). Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="16cb242a" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"green"</span>,</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellowgreen"</span>,</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span> </span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="op">-</span><span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="fl">0</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">5.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">3</span>) <span class="op">.&amp;</span> </span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">7</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit troch obs plumb]</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a><span class="co">#= 5×2 DataFrame</span></span>
<span id="cb105-64"><a href="#cb105-64" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb105-65"><a href="#cb105-65" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb105-66"><a href="#cb105-66" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb105-67"><a href="#cb105-67" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud   0.00892738</span></span>
<span id="cb105-68"><a href="#cb105-68" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.00677711</span></span>
<span id="cb105-69"><a href="#cb105-69" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch    0.00725483</span></span>
<span id="cb105-70"><a href="#cb105-70" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obs      0.0083953</span></span>
<span id="cb105-71"><a href="#cb105-71" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ plumb    0.00673292 =#</span></span>
<span id="cb105-72"><a href="#cb105-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-73"><a href="#cb105-73" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb105-74"><a href="#cb105-74" aria-hidden="true" tabindex="-1"></a><span class="co">#= 10×2 DataFrame</span></span>
<span id="cb105-75"><a href="#cb105-75" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb105-76"><a href="#cb105-76" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb105-77"><a href="#cb105-77" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb105-78"><a href="#cb105-78" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit    0.032793</span></span>
<span id="cb105-79"><a href="#cb105-79" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch  0.0326016</span></span>
<span id="cb105-80"><a href="#cb105-80" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obs    0.0334515</span></span>
<span id="cb105-81"><a href="#cb105-81" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ virLud_plumb  0.041869</span></span>
<span id="cb105-82"><a href="#cb105-82" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_troch     0.0389012</span></span>
<span id="cb105-83"><a href="#cb105-83" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_obs       0.0393449</span></span>
<span id="cb105-84"><a href="#cb105-84" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_plumb     0.0476769</span></span>
<span id="cb105-85"><a href="#cb105-85" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ troch_obs     0.0150895</span></span>
<span id="cb105-86"><a href="#cb105-86" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ troch_plumb   0.0294242</span></span>
<span id="cb105-87"><a href="#cb105-87" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ obs_plumb     0.0297807 =#</span></span>
<span id="cb105-88"><a href="#cb105-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-89"><a href="#cb105-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb105-90"><a href="#cb105-90" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb105-91"><a href="#cb105-91" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb105-92"><a href="#cb105-92" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb105-93"><a href="#cb105-93" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb105-94"><a href="#cb105-94" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb105-95"><a href="#cb105-95" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb105-96"><a href="#cb105-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-97"><a href="#cb105-97" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb105-98"><a href="#cb105-98" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb105-99"><a href="#cb105-99" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb105-100"><a href="#cb105-100" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb105-101"><a href="#cb105-101" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb105-102"><a href="#cb105-102" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb105-103"><a href="#cb105-103" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb105-104"><a href="#cb105-104" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb105-105"><a href="#cb105-105" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb105-106"><a href="#cb105-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-107"><a href="#cb105-107" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb105-108"><a href="#cb105-108" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb105-109"><a href="#cb105-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-110"><a href="#cb105-110" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb105-111"><a href="#cb105-111" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb105-112"><a href="#cb105-112" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb105-113"><a href="#cb105-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-114"><a href="#cb105-114" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb105-115"><a href="#cb105-115" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb105-116"><a href="#cb105-116" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb105-117"><a href="#cb105-117" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [78 2 71 5 70] and the sum of those is 226
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-45-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 1 … 0 0; … ; 0 2 … 2 0; 0 2 … 2 0], [5282897, 5282956, 5309350, 5337401, 5354821, 5354857, 5490417, 5522381, 5528891, 5684034  …  7539351, 7539368, 7571024, 7598479, 7598515, 7620519, 7678099, 7790537, 7813358, 7832029], <span class="ansi-bold">52×20 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   4 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   5 │ GW_Armando_plate1_TTGW10      GW_Armando_plate1_TTGW10      SU        l ⋯
   6 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l
   7 │ GW_Armando_plate1_TTGW59      GW_Armando_plate1_TTGW59      NG        l
   8 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l
   9 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v ⋯
  10 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
  11 │ GW_Armando_plate2_TTGW09      GW_Armando_plate2_TTGW09      SU        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  43 │ GW_Armando_plate1_JF13G01     GW_Armando_plate1_JF13G01     ST        p
  44 │ GW_Armando_plate1_JF15G03     GW_Armando_plate1_JF15G03     DV        p ⋯
  45 │ GW_Armando_plate1_JF22G01     GW_Armando_plate1_JF22G01     MB        p
  46 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p
  47 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
  48 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p ⋯
  49 │ GW_Armando_plate1_JF26G01     GW_Armando_plate1_JF26G01     ST        p
  50 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  51 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p
  52 │ GW_Armando_plate1_JG02G04     GW_Armando_plate1_JG02G04     PR        p ⋯
<span class="ansi-cyan-fg">                                                  17 columns and 31 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-1" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-1">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="c1b4422b" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs"</span>,</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>,</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_plumb"</span>]</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"purple"</span>]</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>virLud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">5.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5.5</span>) <span class="op">.&amp;</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit virLud_troch troch obs plumb vir_plumb]</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb108-52"><a href="#cb108-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-53"><a href="#cb108-53" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb108-54"><a href="#cb108-54" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb108-55"><a href="#cb108-55" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb108-56"><a href="#cb108-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-57"><a href="#cb108-57" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb108-58"><a href="#cb108-58" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb108-59"><a href="#cb108-59" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb108-60"><a href="#cb108-60" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb108-61"><a href="#cb108-61" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-46-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 1 … 0 0; … ; 0 1 … 1 0; 0 1 … 2 0], [5282897, 5282956, 5309350, 5337401, 5354821, 5354857, 5490417, 5522381, 5528891, 5684034  …  7539351, 7539368, 7571024, 7598479, 7598515, 7620519, 7678099, 7790537, 7813358, 7832029], <span class="ansi-bold">70×20 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   4 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   5 │ GW_Armando_plate1_TTGW10      GW_Armando_plate1_TTGW10      SU        l ⋯
   6 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l
   7 │ GW_Armando_plate1_TTGW59      GW_Armando_plate1_TTGW59      NG        l
   8 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l
   9 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v ⋯
  10 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
  11 │ GW_Armando_plate2_TTGW09      GW_Armando_plate2_TTGW09      SU        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  61 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p
  62 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p ⋯
  63 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p
  64 │ GW_Armando_plate1_JF26G01     GW_Armando_plate1_JF26G01     ST        p
  65 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  66 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p ⋯
  67 │ GW_Armando_plate1_JG02G04     GW_Armando_plate1_JG02G04     PR        p
  68 │ GW_Armando_plate2_JF07G01     GW_Armando_plate2_JF07G01     ST        p
  69 │ GW_Armando_plate2_JG01G01     GW_Armando_plate2_JG01G01     PR        p
  70 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p ⋯
<span class="ansi-cyan-fg">                                                  17 columns and 49 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus-1" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-1">Show just the west area (without nitidus)</h3>
<div id="79b473fc" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>]</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-47-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 1 … 0 0; … ; 2 2 … 101 2; 0 2 … 2 101], [5282897, 5282956, 5309350, 5354821, 5522381, 5692997, 5693003, 5697689, 5774179, 5777672  …  7339982, 7371724, 7371744, 7539368, 7598479, 7598515, 7620519, 7678099, 7790537, 7813358], <span class="ansi-bold">177×20 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   4 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   5 │ GW_Armando_plate1_TTGW10      GW_Armando_plate1_TTGW10      SU        l ⋯
   6 │ GW_Armando_plate1_TTGW17      GW_Armando_plate1_TTGW17      TH        l
   7 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l
   8 │ GW_Armando_plate1_TTGW59      GW_Armando_plate1_TTGW59      NG        l
   9 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l ⋯
  10 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
  11 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 168 │ GW_Lane5_PT2                  GW_Lane5_PT2                  ML        l
 169 │ GW_Liz_GBS_Liz5190            GW_Liz_GBS_Liz5190            ML        l ⋯
 170 │ GW_Liz_GBS_Liz6008            GW_Liz_GBS_Liz6008            ML        l
 171 │ GW_Liz_GBS_Liz6478            GW_Liz_GBS_Liz6478            ML        l
 172 │ GW_Lane5_LN12                 GW_Lane5_LN12                 LN        t
 173 │ GW_Liz_GBS_Liz5178            GW_Liz_GBS_Liz5178            ML        l ⋯
 174 │ GW_Liz_GBS_Liz5179            GW_Liz_GBS_Liz5179            ML        l
 175 │ GW_Liz_GBS_Liz5194            GW_Liz_GBS_Liz5194            ML        l
 176 │ GW_Lane5_MN1                  GW_Lane5_MN1                  MN        t
 177 │ GW_Liz_GBS_Liz5144            GW_Liz_GBS_Liz5144            ML        l ⋯
<span class="ansi-cyan-fg">                                                 17 columns and 156 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-1" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area-1">Show just the east area</h3>
<div id="87eaaf23" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"troch"</span>,</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs"</span>,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"orange"</span>,</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-48-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[2 1 … 0 1; 0 0 … 0 1; … ; 2 2 … 0 2; 2 2 … 1 2], [5282897, 5309350, 5337401, 5490417, 5522381, 5528891, 5684034, 5692997, 5693003, 5693043  …  7120357, 7161643, 7189896, 7286852, 7293716, 7374312, 7414344, 7539351, 7571024, 7598515], <span class="ansi-bold">146×20 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                        </span><span class="ansi-bold"> ID                         </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group</span> ⋯
     │<span class="ansi-bright-black-fg"> String                     </span><span class="ansi-bright-black-fg"> String                     </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> Strin</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW01    GW_Armando_plate1_TTGW01    MN        troch ⋯
   2 │ GW_Armando_plate1_TTGW05r2  GW_Armando_plate1_TTGW05r2  MN        troch
   3 │ GW_Armando_plate1_TTGW63    GW_Armando_plate1_TTGW63    SP        lud_S
   4 │ GW_Armando_plate1_TTGW65    GW_Armando_plate1_TTGW65    SP        lud_S
   5 │ GW_Armando_plate1_TTGW70    GW_Armando_plate1_TTGW70    SA        lud_S ⋯
   6 │ GW_Armando_plate1_TTGW72    GW_Armando_plate1_TTGW72    SA        lud_S
   7 │ GW_Armando_plate1_TTGW78    GW_Armando_plate1_TTGW78    SA        lud_S
   8 │ GW_Armando_plate2_LN2       GW_Armando_plate2_LN2       LN        troch
   9 │ GW_Armando_plate2_TTGW03    GW_Armando_plate2_TTGW03    MN        troch ⋯
  10 │ GW_Armando_plate2_TTGW61    GW_Armando_plate2_TTGW61    SP        lud_S
  11 │ GW_Armando_plate2_TTGW62    GW_Armando_plate2_TTGW62    SP        lud_S
  ⋮  │             ⋮                           ⋮                  ⋮            ⋱
 137 │ GW_Lane5_SL2                GW_Lane5_SL2                SL        plumb
 138 │ GW_Lane5_ST12               GW_Lane5_ST12               ST        plumb ⋯
 139 │ GW_Lane5_ST3                GW_Lane5_ST3                ST        plumb
 140 │ GW_Lane5_TA1                GW_Lane5_TA1                TA        plumb
 141 │ GW_Armando_plate1_JF09G01   GW_Armando_plate1_JF09G01   ST        plumb
 142 │ GW_Armando_plate1_JG02G02   GW_Armando_plate1_JG02G02   PR        plumb ⋯
 143 │ GW_Armando_plate1_JG12G01   GW_Armando_plate1_JG12G01   ST        plumb
 144 │ GW_Armando_plate2_JF15G02   GW_Armando_plate2_JF15G02   DV        plumb
 145 │ GW_Lane5_AN1                GW_Lane5_AN1                AN        plumb
 146 │ GW_Lane5_UY6                GW_Lane5_UY6                UY        plumb ⋯
<span class="ansi-cyan-fg">                                                 17 columns and 125 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-1" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area-1">Show just the northern area</h3>
<div id="be0a795c" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-49-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 1 0 … 0 0; … ; 1 1 … 1 1; 1 1 … 1 2], [5282956, 5354821, 5490417, 5528891, 5684034, 5697689, 5701683, 5704379, 5774179, 5777672  …  7371744, 7414344, 7539351, 7539368, 7571024, 7598479, 7620519, 7678099, 7790537, 7813358], <span class="ansi-bold">151×20 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   4 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   5 │ GW_Armando_plate1_TTGW10      GW_Armando_plate1_TTGW10      SU        l ⋯
   6 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l
   7 │ GW_Armando_plate1_TTGW59      GW_Armando_plate1_TTGW59      NG        l
   8 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l
   9 │ GW_Armando_plate1_TTGW-15-09  GW_Armando_plate1_TTGW-15-09  SR        l ⋯
  10 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
  11 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 142 │ GW_Lane5_BK3                  GW_Lane5_BK3                  BK        p
 143 │ GW_Lane5_SL2                  GW_Lane5_SL2                  SL        p ⋯
 144 │ GW_Lane5_ST12                 GW_Lane5_ST12                 ST        p
 145 │ GW_Lane5_ST3                  GW_Lane5_ST3                  ST        p
 146 │ GW_Lane5_UY2                  GW_Lane5_UY2                  UY        p
 147 │ GW_Lane5_UY6                  GW_Lane5_UY6                  UY        p ⋯
 148 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
 149 │ GW_Armando_plate2_JF07G01     GW_Armando_plate2_JF07G01     ST        p
 150 │ GW_Armando_plate2_JG01G01     GW_Armando_plate2_JG01G01     PR        p
 151 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p ⋯
<span class="ansi-cyan-fg">                                                 17 columns and 130 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="now-do-the-same-for-chr-28" class="level2">
<h2 class="anchored" data-anchor-id="now-do-the-same-for-chr-28">Now do the same for chr 28</h2>
<div id="80799c43" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw28"</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb120-52"><a href="#cb120-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb120-53"><a href="#cb120-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb120-54"><a href="#cb120-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb120-55"><a href="#cb120-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-56"><a href="#cb120-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb120-57"><a href="#cb120-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb120-58"><a href="#cb120-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-59"><a href="#cb120-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb120-60"><a href="#cb120-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">2</span>) </span>
<span id="cb120-61"><a href="#cb120-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-62"><a href="#cb120-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb120-63"><a href="#cb120-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-64"><a href="#cb120-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb120-65"><a href="#cb120-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb120-66"><a href="#cb120-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb120-67"><a href="#cb120-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb120-68"><a href="#cb120-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb120-69"><a href="#cb120-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb120-70"><a href="#cb120-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb120-71"><a href="#cb120-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb120-72"><a href="#cb120-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb120-73"><a href="#cb120-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb120-74"><a href="#cb120-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb120-75"><a href="#cb120-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-50-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-50-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-2" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-2">Save the individual colors in the metadata</h3>
<div id="4b2c14ad" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-2" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-2">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="14ef42c0" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-52-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-2" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-2">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="85c85d88" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-53-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-28-high-vishet-region-there-are-only-5-clear-haplogroups-yellow-and-orange-are-close.-vir-and-lud-dont-distinguish-along-pc3-as-nitidus-varies-there.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-28-high-vishet-region-there-are-only-5-clear-haplogroups-yellow-and-orange-are-close.-vir-and-lud-dont-distinguish-along-pc3-as-nitidus-varies-there.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 28 high ViSHet region, there are only 5 clear haplogroups (yellow and orange are close). Vir and lud don’t distinguish along PC3, as nitidus varies there. Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="d1416203" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellowgreen"</span>,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">1</span>) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span> </span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>        (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">3.2</span>) <span class="op">.&amp;</span> </span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2.5</span>) <span class="op">.&amp;</span> </span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>        (<span class="op">-</span><span class="fl">3.2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.PC2) <span class="op">.&amp;</span></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>        indSelection_lowIndHetStan</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit troch obs plumb]</span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb133-40"><a href="#cb133-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb133-41"><a href="#cb133-41" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb133-42"><a href="#cb133-42" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb133-43"><a href="#cb133-43" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb133-44"><a href="#cb133-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-45"><a href="#cb133-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb133-46"><a href="#cb133-46" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb133-47"><a href="#cb133-47" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb133-48"><a href="#cb133-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-49"><a href="#cb133-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb133-50"><a href="#cb133-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-51"><a href="#cb133-51" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb133-52"><a href="#cb133-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-53"><a href="#cb133-53" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb133-54"><a href="#cb133-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-55"><a href="#cb133-55" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb133-56"><a href="#cb133-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-57"><a href="#cb133-57" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb133-58"><a href="#cb133-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-59"><a href="#cb133-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb133-60"><a href="#cb133-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-61"><a href="#cb133-61" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb133-62"><a href="#cb133-62" aria-hidden="true" tabindex="-1"></a><span class="co">#= 5×2 DataFrame</span></span>
<span id="cb133-63"><a href="#cb133-63" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb133-64"><a href="#cb133-64" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb133-65"><a href="#cb133-65" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb133-66"><a href="#cb133-66" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud   0.00792304</span></span>
<span id="cb133-67"><a href="#cb133-67" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.00320189</span></span>
<span id="cb133-68"><a href="#cb133-68" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch    0.00734994</span></span>
<span id="cb133-69"><a href="#cb133-69" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obs      0.0101536</span></span>
<span id="cb133-70"><a href="#cb133-70" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ plumb    0.00270239 =#</span></span>
<span id="cb133-71"><a href="#cb133-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-72"><a href="#cb133-72" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb133-73"><a href="#cb133-73" aria-hidden="true" tabindex="-1"></a><span class="co">#= 10×2 DataFrame</span></span>
<span id="cb133-74"><a href="#cb133-74" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb133-75"><a href="#cb133-75" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb133-76"><a href="#cb133-76" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb133-77"><a href="#cb133-77" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit    0.0334156</span></span>
<span id="cb133-78"><a href="#cb133-78" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch  0.0318841</span></span>
<span id="cb133-79"><a href="#cb133-79" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obs    0.0351279</span></span>
<span id="cb133-80"><a href="#cb133-80" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ virLud_plumb  0.0330054</span></span>
<span id="cb133-81"><a href="#cb133-81" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_troch     0.0314387</span></span>
<span id="cb133-82"><a href="#cb133-82" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_obs       0.0344624</span></span>
<span id="cb133-83"><a href="#cb133-83" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_plumb     0.0307517</span></span>
<span id="cb133-84"><a href="#cb133-84" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ troch_obs     0.0188902</span></span>
<span id="cb133-85"><a href="#cb133-85" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ troch_plumb   0.0234771</span></span>
<span id="cb133-86"><a href="#cb133-86" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ obs_plumb     0.0265753 =#</span></span>
<span id="cb133-87"><a href="#cb133-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-88"><a href="#cb133-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb133-89"><a href="#cb133-89" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb133-90"><a href="#cb133-90" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb133-91"><a href="#cb133-91" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb133-92"><a href="#cb133-92" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb133-93"><a href="#cb133-93" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb133-94"><a href="#cb133-94" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb133-95"><a href="#cb133-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-96"><a href="#cb133-96" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb133-97"><a href="#cb133-97" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb133-98"><a href="#cb133-98" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb133-99"><a href="#cb133-99" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb133-100"><a href="#cb133-100" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb133-101"><a href="#cb133-101" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb133-102"><a href="#cb133-102" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb133-103"><a href="#cb133-103" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb133-104"><a href="#cb133-104" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb133-105"><a href="#cb133-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-106"><a href="#cb133-106" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb133-107"><a href="#cb133-107" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb133-108"><a href="#cb133-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-109"><a href="#cb133-109" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb133-110"><a href="#cb133-110" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb133-111"><a href="#cb133-111" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb133-112"><a href="#cb133-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-113"><a href="#cb133-113" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb133-114"><a href="#cb133-114" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb133-115"><a href="#cb133-115" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb133-116"><a href="#cb133-116" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [74 2 65 3 67] and the sum of those is 211
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-54-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 2 … 2 2; 0 2 … 2 2], [1825835, 1828808, 1835122, 1857465, 1857494, 1871762, 1872060, 1872112, 1872224, 1872436  …  2195993, 2200040, 2239778, 2242803, 2245870, 2264261, 2265267, 2424032, 2430336, 2430428], <span class="ansi-bold">50×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   3 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l
   4 │ GW_Armando_plate1_TTGW53      GW_Armando_plate1_TTGW53      NG        l
   5 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l ⋯
   6 │ GW_Armando_plate1_TTGW58      GW_Armando_plate1_TTGW58      NG        l
   7 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l
   8 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   9 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p ⋯
  10 │ GW_Armando_plate2_JF30G01     GW_Armando_plate2_JF30G01     ST_vi     v
  11 │ GW_Armando_plate2_TTGW08      GW_Armando_plate2_TTGW08      SU        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  41 │ GW_Armando_plate1_JF12G01     GW_Armando_plate1_JF12G01     ST        p
  42 │ GW_Armando_plate1_JF12G02     GW_Armando_plate1_JF12G02     ST        p ⋯
  43 │ GW_Armando_plate1_JF13G01     GW_Armando_plate1_JF13G01     ST        p
  44 │ GW_Armando_plate1_JF15G03     GW_Armando_plate1_JF15G03     DV        p
  45 │ GW_Armando_plate1_JF20G01     GW_Armando_plate1_JF20G01     MB        p
  46 │ GW_Armando_plate1_JF22G01     GW_Armando_plate1_JF22G01     MB        p ⋯
  47 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p
  48 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
  49 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  50 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p ⋯
<span class="ansi-cyan-fg">                                                  19 columns and 29 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-2" class="level2">
<h2 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-2">Now show a GBI plot like above, but with heterozygotes:</h2>
<div id="f401d24e" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_nit"</span>,</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs"</span>,</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obsHet"</span>,</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs_plumb"</span>,</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>,</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_plumb"</span>]</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"slateblue1"</span>,</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"darkgoldenrod1"</span>,</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"darkorange1"</span>,</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"purple"</span>]</span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>virLud_nit <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">0</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>virLud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>obsHet <span class="op">=</span> (<span class="fl">1.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a>obs_plumb <span class="op">=</span> (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb136-37"><a href="#cb136-37" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb136-38"><a href="#cb136-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-39"><a href="#cb136-39" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb136-40"><a href="#cb136-40" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb136-41"><a href="#cb136-41" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud_nit]</span>
<span id="cb136-42"><a href="#cb136-42" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb136-43"><a href="#cb136-43" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud_troch]</span>
<span id="cb136-44"><a href="#cb136-44" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb136-45"><a href="#cb136-45" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb136-46"><a href="#cb136-46" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obsHet]</span>
<span id="cb136-47"><a href="#cb136-47" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs_plumb]</span>
<span id="cb136-48"><a href="#cb136-48" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb136-49"><a href="#cb136-49" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[vir_plumb]</span>
<span id="cb136-50"><a href="#cb136-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-51"><a href="#cb136-51" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud virLud_nit nit virLud_troch troch obs obsHet obs_plumb plumb vir_plumb]</span>
<span id="cb136-52"><a href="#cb136-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-53"><a href="#cb136-53" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb136-54"><a href="#cb136-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-55"><a href="#cb136-55" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb136-56"><a href="#cb136-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb136-57"><a href="#cb136-57" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb136-58"><a href="#cb136-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-59"><a href="#cb136-59" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb136-60"><a href="#cb136-60" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb136-61"><a href="#cb136-61" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb136-62"><a href="#cb136-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb136-63"><a href="#cb136-63" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb136-64"><a href="#cb136-64" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb136-65"><a href="#cb136-65" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb136-66"><a href="#cb136-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-67"><a href="#cb136-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb136-68"><a href="#cb136-68" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb136-69"><a href="#cb136-69" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb136-70"><a href="#cb136-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-71"><a href="#cb136-71" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb136-72"><a href="#cb136-72" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb136-73"><a href="#cb136-73" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb136-74"><a href="#cb136-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-75"><a href="#cb136-75" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb136-76"><a href="#cb136-76" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb136-77"><a href="#cb136-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-78"><a href="#cb136-78" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb136-79"><a href="#cb136-79" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb136-80"><a href="#cb136-80" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb136-81"><a href="#cb136-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-82"><a href="#cb136-82" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb136-83"><a href="#cb136-83" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb136-84"><a href="#cb136-84" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb136-85"><a href="#cb136-85" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb136-86"><a href="#cb136-86" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-55-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; -99 1 … 1 1; 0 1 … 1 1], [1825835, 1828808, 1835122, 1857465, 1857494, 1871762, 1872060, 1872112, 1872224, 1872436  …  2195993, 2200040, 2239778, 2242803, 2245870, 2264261, 2265267, 2424032, 2430336, 2430428], <span class="ansi-bold">74×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   3 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l
   4 │ GW_Armando_plate1_TTGW53      GW_Armando_plate1_TTGW53      NG        l
   5 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l ⋯
   6 │ GW_Armando_plate1_TTGW58      GW_Armando_plate1_TTGW58      NG        l
   7 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l
   8 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   9 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p ⋯
  10 │ GW_Armando_plate2_JF30G01     GW_Armando_plate2_JF30G01     ST_vi     v
  11 │ GW_Armando_plate2_TTGW08      GW_Armando_plate2_TTGW08      SU        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  65 │ GW_Armando_plate1_JF22G01     GW_Armando_plate1_JF22G01     MB        p
  66 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p ⋯
  67 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
  68 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  69 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p
  70 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p ⋯
  71 │ GW_Armando_plate2_JF15G02     GW_Armando_plate2_JF15G02     DV        p
  72 │ GW_Armando_plate2_JF27G02     GW_Armando_plate2_JF27G02     ST        p
  73 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p
  74 │ GW_Armando_plate1_JF09G01     GW_Armando_plate1_JF09G01     ST        p ⋯
<span class="ansi-cyan-fg">                                                  19 columns and 53 rows omitted</span>)</pre>
</div>
</div>
</div>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order-1" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order-1">show GBI plot according to original groups and plot order</h3>
<div id="f226fa31" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-56-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 1 … 1 1; -99 1 … 1 1], [1825835, 1828808, 1835122, 1857465, 1857494, 1871762, 1872060, 1872112, 1872224, 1872436  …  2195993, 2200040, 2239778, 2242803, 2245870, 2264261, 2265267, 2424032, 2430336, 2430428], <span class="ansi-bold">74×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   4 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   5 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir     ⋯
   6 │ GW_Lane5_AA1               GW_Lane5_AA1               AA        vir_S
   7 │ GW_Lane5_TU1               GW_Lane5_TU1               TU        nit
   8 │ GW_Lane5_TU2               GW_Lane5_TU2               TU        nit
   9 │ GW_Armando_plate1_TTGW70   GW_Armando_plate1_TTGW70   SA        lud_Sat ⋯
  10 │ GW_Armando_plate1_TTGW72   GW_Armando_plate1_TTGW72   SA        lud_Sat
  11 │ GW_Armando_plate1_TTGW78   GW_Armando_plate1_TTGW78   SA        lud_Sat
  ⋮  │             ⋮                          ⋮                 ⋮            ⋮ ⋱
  65 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb
  66 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb   ⋯
  67 │ GW_Armando_plate2_JF27G02  GW_Armando_plate2_JF27G02  ST        plumb
  68 │ GW_Armando_plate1_JF09G01  GW_Armando_plate1_JF09G01  ST        plumb
  69 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
  70 │ GW_Armando_plate2_JF15G02  GW_Armando_plate2_JF15G02  DV        plumb   ⋯
  71 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
  72 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  73 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
  74 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  19 columns and 53 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals-1" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals-1">show same but with all individuals</h3>
<div id="3b3118b7" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-57-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 2 … 2 2; -99 1 … 1 1], [1825835, 1828808, 1835122, 1857465, 1857494, 1871762, 1872060, 1872112, 1872224, 1872436  …  2195993, 2200040, 2239778, 2242803, 2245870, 2264261, 2265267, 2424032, 2430336, 2430428], <span class="ansi-bold">257×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 248 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb
 249 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb   ⋯
 250 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 251 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 252 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 253 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 254 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 255 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 256 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 257 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 19 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-vir-and-plumb-pops" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-vir-and-plumb-pops">show same but with only vir and plumb pops</h3>
<div id="e10ec1b9" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"virLud"</span>, <span class="st">"plumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"plumb"</span>, <span class="st">"plumb_vir"</span>] <span class="co"># these are the original Fst_groups</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>]</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>                genosForGBI, metadataForGBI, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-58-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="58">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 1 1 … 1 1], [1828808, 1871762, 1872060, 1872224, 1872436, 1877640, 1879000, 1879179, 1879284, 1946507  …  2111032, 2122636, 2188531, 2188581, 2190739, 2195551, 2195993, 2200040, 2430336, 2430428], <span class="ansi-bold">100×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  91 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  92 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  93 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  94 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  95 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  96 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
  97 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  98 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  99 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 100 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  19 columns and 79 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-vir-lud-troch-pops" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-vir-lud-troch-pops">show same but with only vir lud troch pops</h3>
<div id="327d9f12" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"virLud"</span>, <span class="st">"troch"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"plumb"</span>, <span class="st">"plumb_vir"</span>] <span class="co"># these are the original Fst_groups</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>]</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"vir_S"</span>, <span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>, <span class="st">"troch_west"</span>, <span class="st">"troch_LN"</span>]</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>, <span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>]</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">10</span>, <span class="fu">length</span>(plotGroups))</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>genosForGBI_limited, indMetadataforGBI_limited <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(plotGroups,</span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>                                            numIndsToPlotWithHets, </span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>                                            genosForGBI, metadataForGBI;</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>                genosForGBI_limited, indMetadataforGBI_limited, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-59-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 1 … 2 2; 2 0 … 2 2], [1828808, 1857465, 1857494, 1871762, 1872112, 1872224, 1872436, 1877640, 1879179, 1879284  …  2111032, 2122636, 2147415, 2179072, 2188581, 2195551, 2195993, 2239778, 2424032, 2430428], <span class="ansi-bold">74×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   5 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v ⋯
   6 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   7 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
   8 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir
   9 │ GW_Lane5_AB2               GW_Lane5_AB2               AB        vir     ⋯
  10 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
  11 │ GW_Lane5_AA1               GW_Lane5_AA1               AA        vir_S
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  65 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L
  66 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L ⋯
  67 │ GW_Lane5_LN10              GW_Lane5_LN10              LN        troch_L
  68 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
  69 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L
  70 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L ⋯
  71 │ GW_Lane5_LN18              GW_Lane5_LN18              LN        troch_L
  72 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
  73 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L
  74 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L ⋯
<span class="ansi-cyan-fg">                                                  19 columns and 53 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-troch-plumb-pops" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-troch-plumb-pops">show same but with only troch plumb pops</h3>
<div id="c988e534" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"troch"</span>, <span class="st">"obs"</span>, <span class="st">"plumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a><span class="co"># remove individuals that have vir haplotypes, as this could otherwise be mistaken for introgression from obscuratus:</span></span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>removeTheseInds <span class="op">=</span> [<span class="st">"GW_Armando_plate1_JF24G02"</span>, <span class="co"># gw19 hetero from plumb </span></span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"GW_Armando_plate1_JF07G03"</span>, <span class="co"># gw19 hetero from plumb</span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"GW_Armando_plate1_JF12G02"</span>, <span class="co"># gw19 hetero from plumb</span></span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"GW_Armando_plate1_JF09G01"</span>] <span class="co"># gw28 is hetero from plumb </span></span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> <span class="fu">map</span>(<span class="fu">in</span>(removeTheseInds), metadataForGBI.ind)</span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> metadataForGBI[.!selection, <span class="op">:</span>]</span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genosForGBI[.!selection, <span class="op">:</span>]</span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"troch_LN"</span>,<span class="st">"troch_EM"</span>,<span class="st">"obs"</span>,<span class="st">"plumb_BJ"</span>,<span class="st">"plumb"</span>]</span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"yellow"</span>,<span class="st">"gold"</span>,<span class="st">"orange"</span>,<span class="st">"pink"</span>,<span class="st">"red"</span>]</span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Set  limit on the number of individuals per group to plot</span></span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(plotGroups))</span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a><span class="co"># metadataForGBI[metadataForGBI.Fst_group .== "plumb", :]</span></span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a>genosForGBI_limited, indMetadataforGBI_limited <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(plotGroups,</span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a>                                            numIndsToPlotWithHets, </span>
<span id="cb147-38"><a href="#cb147-38" aria-hidden="true" tabindex="-1"></a>                                            genosForGBI, metadataForGBI;</span>
<span id="cb147-39"><a href="#cb147-39" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb147-40"><a href="#cb147-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-41"><a href="#cb147-41" aria-hidden="true" tabindex="-1"></a><span class="co"># indMetadataforGBI_limited[indMetadataforGBI_limited.Fst_group .== "plumb", :]</span></span>
<span id="cb147-42"><a href="#cb147-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-43"><a href="#cb147-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb147-44"><a href="#cb147-44" aria-hidden="true" tabindex="-1"></a>                genosForGBI_limited, indMetadataforGBI_limited, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb147-45"><a href="#cb147-45" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-60-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[1 1 … 0 0; 1 1 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [1857465, 1857494, 1872060, 1872112, 1879000, 1946511, 1948810, 1963744, 1963988, 1979848  …  2155255, 2179072, 2188531, 2190736, 2190739, 2200040, 2239778, 2245870, 2424032, 2430336], <span class="ansi-bold">37×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L ⋯
   2 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L
   3 │ GW_Lane5_LN10              GW_Lane5_LN10              LN        troch_L
   4 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
   5 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L ⋯
   6 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L
   7 │ GW_Lane5_LN18              GW_Lane5_LN18              LN        troch_L
   8 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
   9 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L ⋯
  10 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L
  11 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
  ⋮  │             ⋮                          ⋮                 ⋮         ⋮    ⋱
  28 │ GW_Armando_plate1_JF09G02  GW_Armando_plate1_JF09G02  ST        plumb
  29 │ GW_Armando_plate1_JF11G01  GW_Armando_plate1_JF11G01  ST        plumb   ⋯
  30 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
  31 │ GW_Armando_plate1_JF13G01  GW_Armando_plate1_JF13G01  ST        plumb
  32 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb
  33 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb   ⋯
  34 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb
  35 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
  36 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
  37 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb   ⋯
<span class="ansi-cyan-fg">                                                  19 columns and 16 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="show-just-the-west-area-without-nitidus-2" class="level2">
<h2 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-2">Show just the west area (without nitidus)</h2>
<div id="d9ba3fd1" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>]</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-61-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 1 … 0 0; … ; 2 0 … 2 2; 2 1 … 2 2], [1828808, 1857465, 1857494, 1871762, 1872112, 1872224, 1872436, 1877640, 1879179, 1879284  …  2111032, 2122636, 2147415, 2179072, 2188581, 2195551, 2195993, 2239778, 2424032, 2430428], <span class="ansi-bold">176×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 167 │ GW_Lane5_LN18              GW_Lane5_LN18              LN        troch_L
 168 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L ⋯
 169 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L
 170 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L
 171 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
 172 │ GW_Lane5_LN6               GW_Lane5_LN6               LN        troch_L ⋯
 173 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L
 174 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L
 175 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L
 176 │ GW_Lane5_LN7               GW_Lane5_LN7               LN        troch_L ⋯
<span class="ansi-cyan-fg">                                                 19 columns and 155 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-2" class="level2">
<h2 class="anchored" data-anchor-id="show-just-the-east-area-2">Show just the east area</h2>
<div id="1597305f" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"troch"</span>,</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs"</span>,</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obsHet"</span>,</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs_plumb"</span>,</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"orange"</span>,</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"darkgoldenrod1"</span>,</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"darkorange1"</span>,</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-25"><a href="#cb152-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb152-26"><a href="#cb152-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-27"><a href="#cb152-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb152-28"><a href="#cb152-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb152-29"><a href="#cb152-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb152-30"><a href="#cb152-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-31"><a href="#cb152-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb152-32"><a href="#cb152-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb152-33"><a href="#cb152-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb152-34"><a href="#cb152-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb152-35"><a href="#cb152-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-62-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[2 2 … 0 0; 1 1 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [1857465, 1857494, 1872060, 1872112, 1879000, 1946511, 1948810, 1963744, 1963988, 1979848  …  2155255, 2179072, 2188531, 2190736, 2190739, 2200040, 2239778, 2245870, 2424032, 2430336], <span class="ansi-bold">138×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW70   GW_Armando_plate1_TTGW70   SA        lud_Sat ⋯
   2 │ GW_Armando_plate1_TTGW72   GW_Armando_plate1_TTGW72   SA        lud_Sat
   3 │ GW_Armando_plate1_TTGW78   GW_Armando_plate1_TTGW78   SA        lud_Sat
   4 │ GW_Armando_plate2_TTGW73   GW_Armando_plate2_TTGW73   SA        lud_Sat
   5 │ GW_Armando_plate2_TTGW75   GW_Armando_plate2_TTGW75   SA        lud_Sat ⋯
   6 │ GW_Armando_plate2_TTGW77   GW_Armando_plate2_TTGW77   SA        lud_Sat
   7 │ GW_Armando_plate2_TTGW80   GW_Armando_plate2_TTGW80   SA        lud_Sat
   8 │ GW_Armando_plate2_TTGW79   GW_Armando_plate2_TTGW79   SA        lud_Sat
   9 │ GW_Armando_plate1_TTGW55   GW_Armando_plate1_TTGW55   NG        lud_Nai ⋯
  10 │ GW_Armando_plate1_TTGW59   GW_Armando_plate1_TTGW59   NG        lud_Nai
  11 │ GW_Lane5_PT2               GW_Lane5_PT2               ML        lud_ML
  ⋮  │             ⋮                          ⋮                 ⋮            ⋮ ⋱
 129 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
 130 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb   ⋯
 131 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb
 132 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 133 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 134 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb   ⋯
 135 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 136 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 137 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 138 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb   ⋯
<span class="ansi-cyan-fg">                                                 19 columns and 117 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-2" class="level2">
<h2 class="anchored" data-anchor-id="show-just-the-northern-area-2">Show just the northern area</h2>
<div id="1812a76f" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-63-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 1 1 … 1 1], [1828808, 1871762, 1872060, 1872224, 1872436, 1877640, 1879000, 1879179, 1879284, 1946507  …  2111032, 2122636, 2188531, 2188581, 2190739, 2195551, 2195993, 2200040, 2430336, 2430428], <span class="ansi-bold">146×22 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 137 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 138 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 139 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 140 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 141 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 142 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 143 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 144 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 145 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 146 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 19 columns and 125 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-do-the-same-for-chr-26" class="level2">
<h2 class="anchored" data-anchor-id="now-do-the-same-for-chr-26">Now do the same for chr 26</h2>
<div id="bb92a273" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw26"</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb158-34"><a href="#cb158-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb158-35"><a href="#cb158-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb158-36"><a href="#cb158-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb158-37"><a href="#cb158-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb158-38"><a href="#cb158-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb158-39"><a href="#cb158-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb158-40"><a href="#cb158-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-41"><a href="#cb158-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb158-42"><a href="#cb158-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-43"><a href="#cb158-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb158-44"><a href="#cb158-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb158-45"><a href="#cb158-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb158-46"><a href="#cb158-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb158-47"><a href="#cb158-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb158-48"><a href="#cb158-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb158-49"><a href="#cb158-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb158-50"><a href="#cb158-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb158-51"><a href="#cb158-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb158-52"><a href="#cb158-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb158-53"><a href="#cb158-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb158-54"><a href="#cb158-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb158-55"><a href="#cb158-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-56"><a href="#cb158-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb158-57"><a href="#cb158-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb158-58"><a href="#cb158-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-59"><a href="#cb158-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb158-60"><a href="#cb158-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.5</span>) </span>
<span id="cb158-61"><a href="#cb158-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-62"><a href="#cb158-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb158-63"><a href="#cb158-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-64"><a href="#cb158-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb158-65"><a href="#cb158-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb158-66"><a href="#cb158-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb158-67"><a href="#cb158-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb158-68"><a href="#cb158-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb158-69"><a href="#cb158-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb158-70"><a href="#cb158-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb158-71"><a href="#cb158-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb158-72"><a href="#cb158-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb158-73"><a href="#cb158-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb158-74"><a href="#cb158-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb158-75"><a href="#cb158-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-64-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-64-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-3" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-3">Save the individual colors in the metadata</h3>
<div id="aece9200" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-3" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-3">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="21aaddf6" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-66-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-3" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-3">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="30297483" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-67-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
</section>
<section id="at-chr-26-high-vishet-region-there-are-only-5-clear-haplogroups-one-green-is-somewhat-away.-vir-and-lud-vary-along-pc3-but-cannot-be-clearly-grouped.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level2">
<h2 class="anchored" data-anchor-id="at-chr-26-high-vishet-region-there-are-only-5-clear-haplogroups-one-green-is-somewhat-away.-vir-and-lud-vary-along-pc3-but-cannot-be-clearly-grouped.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 26 high ViSHet region, there are only 5 clear haplogroups (one green is somewhat away). Vir and lud vary along PC3 but cannot be clearly grouped. Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h2>
<div id="cf6d8f60" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect chromosome 26 PCA of low IndHet (&lt; 1.5) individuals,</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and specify group boundaries:</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5.5</span>) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">5.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">6</span>) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="op">-</span><span class="fl">6</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">6</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.PC2) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit troch obs plumb]</span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-31"><a href="#cb171-31" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb171-32"><a href="#cb171-32" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb171-33"><a href="#cb171-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-34"><a href="#cb171-34" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb171-35"><a href="#cb171-35" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb171-36"><a href="#cb171-36" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb171-37"><a href="#cb171-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb171-38"><a href="#cb171-38" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb171-39"><a href="#cb171-39" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb171-40"><a href="#cb171-40" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb171-41"><a href="#cb171-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-42"><a href="#cb171-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb171-43"><a href="#cb171-43" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb171-44"><a href="#cb171-44" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb171-45"><a href="#cb171-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-46"><a href="#cb171-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb171-47"><a href="#cb171-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-48"><a href="#cb171-48" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb171-49"><a href="#cb171-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-50"><a href="#cb171-50" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb171-51"><a href="#cb171-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-52"><a href="#cb171-52" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb171-53"><a href="#cb171-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-54"><a href="#cb171-54" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb171-55"><a href="#cb171-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-56"><a href="#cb171-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb171-57"><a href="#cb171-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-58"><a href="#cb171-58" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb171-59"><a href="#cb171-59" aria-hidden="true" tabindex="-1"></a><span class="co">#= 5×2 DataFrame</span></span>
<span id="cb171-60"><a href="#cb171-60" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb171-61"><a href="#cb171-61" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb171-62"><a href="#cb171-62" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb171-63"><a href="#cb171-63" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud   0.0135205</span></span>
<span id="cb171-64"><a href="#cb171-64" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.00548557</span></span>
<span id="cb171-65"><a href="#cb171-65" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch    0.00975861</span></span>
<span id="cb171-66"><a href="#cb171-66" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obs      0.00902527</span></span>
<span id="cb171-67"><a href="#cb171-67" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ plumb    0.00510553 =#</span></span>
<span id="cb171-68"><a href="#cb171-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-69"><a href="#cb171-69" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb171-70"><a href="#cb171-70" aria-hidden="true" tabindex="-1"></a><span class="co">#= 10×2 DataFrame</span></span>
<span id="cb171-71"><a href="#cb171-71" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb171-72"><a href="#cb171-72" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb171-73"><a href="#cb171-73" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb171-74"><a href="#cb171-74" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit    0.0243846</span></span>
<span id="cb171-75"><a href="#cb171-75" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch  0.0324256</span></span>
<span id="cb171-76"><a href="#cb171-76" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obs    0.0332749</span></span>
<span id="cb171-77"><a href="#cb171-77" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ virLud_plumb  0.0390193</span></span>
<span id="cb171-78"><a href="#cb171-78" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_troch     0.0341654</span></span>
<span id="cb171-79"><a href="#cb171-79" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_obs       0.0344734</span></span>
<span id="cb171-80"><a href="#cb171-80" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_plumb     0.0403857</span></span>
<span id="cb171-81"><a href="#cb171-81" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ troch_obs     0.0176458</span></span>
<span id="cb171-82"><a href="#cb171-82" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ troch_plumb   0.0296574</span></span>
<span id="cb171-83"><a href="#cb171-83" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ obs_plumb     0.0300157 =#</span></span>
<span id="cb171-84"><a href="#cb171-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-85"><a href="#cb171-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb171-86"><a href="#cb171-86" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb171-87"><a href="#cb171-87" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb171-88"><a href="#cb171-88" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb171-89"><a href="#cb171-89" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb171-90"><a href="#cb171-90" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb171-91"><a href="#cb171-91" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb171-92"><a href="#cb171-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-93"><a href="#cb171-93" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb171-94"><a href="#cb171-94" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb171-95"><a href="#cb171-95" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb171-96"><a href="#cb171-96" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb171-97"><a href="#cb171-97" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb171-98"><a href="#cb171-98" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb171-99"><a href="#cb171-99" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb171-100"><a href="#cb171-100" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb171-101"><a href="#cb171-101" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb171-102"><a href="#cb171-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-103"><a href="#cb171-103" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb171-104"><a href="#cb171-104" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb171-105"><a href="#cb171-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-106"><a href="#cb171-106" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb171-107"><a href="#cb171-107" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb171-108"><a href="#cb171-108" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb171-109"><a href="#cb171-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-110"><a href="#cb171-110" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb171-111"><a href="#cb171-111" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb171-112"><a href="#cb171-112" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb171-113"><a href="#cb171-113" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [71 2 62 3 67] and the sum of those is 205
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-68-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 0 … 2 2; 2 0 … 2 2], [4175655, 4190847, 4195006, 4201372, 4201950, 4201984, 4202662, 4220609, 4223822, 4269946  …  5519564, 5519744, 5524191, 5524276, 5530753, 5530774, 5535422, 5540526, 5549587, 5549602], <span class="ansi-bold">50×24 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate2_TTGW16      GW_Armando_plate2_TTGW16      TH        l
   3 │ GW_Lane5_TL10                 GW_Lane5_TL10                 TL        v
   4 │ GW_Lane5_TL11                 GW_Lane5_TL11                 TL        v
   5 │ GW_Lane5_TL12                 GW_Lane5_TL12                 TL        v ⋯
   6 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v
   7 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l
   8 │ GW_Armando_plate1_TTGW22      GW_Armando_plate1_TTGW22      SR        l
   9 │ GW_Armando_plate1_TTGW58      GW_Armando_plate1_TTGW58      NG        l ⋯
  10 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
  11 │ GW_Armando_plate2_TTGW-15-01  GW_Armando_plate2_TTGW-15-01  SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  41 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p
  42 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p ⋯
  43 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p
  44 │ GW_Armando_plate1_JF26G01     GW_Armando_plate1_JF26G01     ST        p
  45 │ GW_Armando_plate1_JF29G02     GW_Armando_plate1_JF29G02     ST        p
  46 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p ⋯
  47 │ GW_Armando_plate1_JG08G01     GW_Armando_plate1_JG08G01     ST        p
  48 │ GW_Armando_plate1_RF20G01     GW_Armando_plate1_RF20G01     BJ        o
  49 │ GW_Armando_plate1_RF29G02     GW_Armando_plate1_RF29G02     BJ        o
  50 │ GW_Armando_plate1_UY1         GW_Armando_plate1_UY1         UY        p ⋯
<span class="ansi-cyan-fg">                                                  21 columns and 29 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-3" class="level2">
<h2 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-3">Now show a GBI plot like above, but with heterozygotes:</h2>
<div id="5b2b7fc1" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs"</span>,</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs_plumb"</span>,</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>,</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_plumb"</span>]</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"darkorange1"</span>,</span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"purple"</span>]</span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a>virLud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">5.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2.2</span>) <span class="op">.&amp;</span></span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a>obs_plumb <span class="op">=</span> (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb174-28"><a href="#cb174-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-29"><a href="#cb174-29" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb174-30"><a href="#cb174-30" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb174-31"><a href="#cb174-31" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb174-32"><a href="#cb174-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud_troch]</span>
<span id="cb174-33"><a href="#cb174-33" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb174-34"><a href="#cb174-34" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb174-35"><a href="#cb174-35" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs_plumb]</span>
<span id="cb174-36"><a href="#cb174-36" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb174-37"><a href="#cb174-37" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[vir_plumb]</span>
<span id="cb174-38"><a href="#cb174-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-39"><a href="#cb174-39" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit virLud_troch troch obs obs_plumb plumb vir_plumb]</span>
<span id="cb174-40"><a href="#cb174-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-41"><a href="#cb174-41" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb174-42"><a href="#cb174-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-43"><a href="#cb174-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb174-44"><a href="#cb174-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb174-45"><a href="#cb174-45" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb174-46"><a href="#cb174-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-47"><a href="#cb174-47" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb174-48"><a href="#cb174-48" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb174-49"><a href="#cb174-49" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb174-50"><a href="#cb174-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb174-51"><a href="#cb174-51" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb174-52"><a href="#cb174-52" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb174-53"><a href="#cb174-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb174-54"><a href="#cb174-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-55"><a href="#cb174-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb174-56"><a href="#cb174-56" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb174-57"><a href="#cb174-57" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb174-58"><a href="#cb174-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-59"><a href="#cb174-59" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb174-60"><a href="#cb174-60" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb174-61"><a href="#cb174-61" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb174-62"><a href="#cb174-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-63"><a href="#cb174-63" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb174-64"><a href="#cb174-64" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb174-65"><a href="#cb174-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-66"><a href="#cb174-66" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb174-67"><a href="#cb174-67" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb174-68"><a href="#cb174-68" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb174-69"><a href="#cb174-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-70"><a href="#cb174-70" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb174-71"><a href="#cb174-71" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb174-72"><a href="#cb174-72" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb174-73"><a href="#cb174-73" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb174-74"><a href="#cb174-74" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-69-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 0 … 1 1; 1 0 … 1 1], [4175655, 4190847, 4195006, 4201372, 4201950, 4201984, 4202662, 4220609, 4223822, 4269946  …  5519564, 5519744, 5524191, 5524276, 5530753, 5530774, 5535422, 5540526, 5549587, 5549602], <span class="ansi-bold">72×24 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate2_TTGW16      GW_Armando_plate2_TTGW16      TH        l
   3 │ GW_Lane5_TL10                 GW_Lane5_TL10                 TL        v
   4 │ GW_Lane5_TL11                 GW_Lane5_TL11                 TL        v
   5 │ GW_Lane5_TL12                 GW_Lane5_TL12                 TL        v ⋯
   6 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v
   7 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l
   8 │ GW_Armando_plate1_TTGW22      GW_Armando_plate1_TTGW22      SR        l
   9 │ GW_Armando_plate1_TTGW58      GW_Armando_plate1_TTGW58      NG        l ⋯
  10 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
  11 │ GW_Armando_plate2_TTGW-15-01  GW_Armando_plate2_TTGW-15-01  SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  63 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p
  64 │ GW_Armando_plate1_JG08G01     GW_Armando_plate1_JG08G01     ST        p ⋯
  65 │ GW_Armando_plate1_RF20G01     GW_Armando_plate1_RF20G01     BJ        o
  66 │ GW_Armando_plate1_RF29G02     GW_Armando_plate1_RF29G02     BJ        o
  67 │ GW_Armando_plate1_UY1         GW_Armando_plate1_UY1         UY        p
  68 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p ⋯
  69 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p
  70 │ GW_Armando_plate2_JF07G01     GW_Armando_plate2_JF07G01     ST        p
  71 │ GW_Armando_plate2_JG01G01     GW_Armando_plate2_JG01G01     PR        p
  72 │ GW_Armando_plate1_JF09G01     GW_Armando_plate1_JF09G01     ST        p ⋯
<span class="ansi-cyan-fg">                                                  21 columns and 51 rows omitted</span>)</pre>
</div>
</div>
</div>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order-2" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order-2">show GBI plot according to original groups and plot order</h3>
<div id="48ce8fab" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-70-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 2 0; … ; 1 0 … 1 1; 2 0 … 0 0], [4175655, 4190847, 4195006, 4201372, 4201950, 4201984, 4202662, 4220609, 4223822, 4269946  …  5519564, 5519744, 5524191, 5524276, 5530753, 5530774, 5535422, 5540526, 5549587, 5549602], <span class="ansi-bold">72×24 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   3 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir
   4 │ GW_Lane5_TL10              GW_Lane5_TL10              TL        vir
   5 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir     ⋯
   6 │ GW_Lane5_TL12              GW_Lane5_TL12              TL        vir
   7 │ GW_Lane5_AA1               GW_Lane5_AA1               AA        vir_S
   8 │ GW_Lane5_AA4               GW_Lane5_AA4               AA        vir_S
   9 │ GW_Lane5_TU2               GW_Lane5_TU2               TU        nit     ⋯
  10 │ GW_Lane5_TU1               GW_Lane5_TU1               TU        nit
  11 │ GW_Lane5_NA1               GW_Lane5_NA1               NR        lud_PK
  ⋮  │             ⋮                          ⋮                 ⋮            ⋮ ⋱
  63 │ GW_Armando_plate1_JF29G03  GW_Armando_plate1_JF29G03  ST        plumb
  64 │ GW_Armando_plate1_JG08G01  GW_Armando_plate1_JG08G01  ST        plumb   ⋯
  65 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb
  66 │ GW_Armando_plate2_JF07G01  GW_Armando_plate2_JF07G01  ST        plumb
  67 │ GW_Armando_plate1_JF09G01  GW_Armando_plate1_JF09G01  ST        plumb
  68 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb   ⋯
  69 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  70 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
  71 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  72 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  21 columns and 51 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals-2" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals-2">show same but with all individuals</h3>
<div id="a64f2c58" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-71-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 0 … 2 2; 2 0 … 0 0], [4175655, 4190847, 4195006, 4201372, 4201950, 4201984, 4202662, 4220609, 4223822, 4269946  …  5519564, 5519744, 5524191, 5524276, 5530753, 5530774, 5535422, 5540526, 5549587, 5549602], <span class="ansi-bold">257×24 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK3               GW_Lane5_YK3               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 248 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 249 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 250 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 251 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 252 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 253 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb   ⋯
 254 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 255 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 256 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 257 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 21 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-vir-and-plumb-pops-1" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-vir-and-plumb-pops-1">show same but with only vir and plumb pops</h3>
<div id="e72e4c28" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"virLud"</span>, <span class="st">"plumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"plumb"</span>, <span class="st">"plumb_vir"</span>] <span class="co"># these are the original Fst_groups</span></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>]</span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a>                genosForGBI, metadataForGBI, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-72-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 1 0; … ; 2 2 … 2 2; 2 1 … 0 0], [4175655, 4201372, 4202662, 4220609, 4269946, 4272732, 4280387, 4397231, 4397235, 4411591  …  5519560, 5519564, 5524191, 5524276, 5530753, 5530774, 5535422, 5540526, 5549587, 5549602], <span class="ansi-bold">100×24 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  91 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  92 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  93 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  94 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  95 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  96 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
  97 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  98 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  99 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 100 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  21 columns and 79 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="show-just-the-west-clusters-without-nitidus" class="level2">
<h2 class="anchored" data-anchor-id="show-just-the-west-clusters-without-nitidus">Show just the west clusters (without nitidus)</h2>
<div id="ea083dc3" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>]</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-21"><a href="#cb183-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb183-22"><a href="#cb183-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-23"><a href="#cb183-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb183-24"><a href="#cb183-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb183-25"><a href="#cb183-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb183-26"><a href="#cb183-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-27"><a href="#cb183-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb183-28"><a href="#cb183-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb183-29"><a href="#cb183-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb183-30"><a href="#cb183-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb183-31"><a href="#cb183-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-73-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 101 2 … 2 2; 0 101 … 0 0], [4175655, 4195006, 4201372, 4201950, 4201984, 4202662, 4220609, 4272842, 4280387, 4397235  …  5462347, 5485541, 5485558, 5493066, 5494683, 5519564, 5524191, 5524276, 5530753, 5549587], <span class="ansi-bold">178×24 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   3 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 169 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L
 170 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L ⋯
 171 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
 172 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
 173 │ GW_Lane5_LN6               GW_Lane5_LN6               LN        troch_L
 174 │ GW_Lane5_LN7               GW_Lane5_LN7               LN        troch_L ⋯
 175 │ GW_Lane5_LN18              GW_Lane5_LN18              LN        troch_L
 176 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L
 177 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
 178 │ GW_Armando_plate1_JF11G01  GW_Armando_plate1_JF11G01  ST        plumb   ⋯
<span class="ansi-cyan-fg">                                                 21 columns and 157 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-3" class="level2">
<h2 class="anchored" data-anchor-id="show-just-the-east-area-3">Show just the east area</h2>
<div id="41a984e9" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"troch"</span>,</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs"</span>,</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs_plumb"</span>,</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>,]</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"orange"</span>,</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"darkorange1"</span>,</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb186-27"><a href="#cb186-27" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb186-28"><a href="#cb186-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-29"><a href="#cb186-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb186-30"><a href="#cb186-30" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb186-31"><a href="#cb186-31" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb186-32"><a href="#cb186-32" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb186-33"><a href="#cb186-33" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-74-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 2; … ; 2 2 … 2 2; -99 2 … 2 2], [4195006, 4201950, 4201984, 4269946, 4272732, 4272842, 4336840, 4397231, 4398942, 4411760  …  5471609, 5478884, 5499176, 5509392, 5519560, 5519744, 5530774, 5535422, 5540526, 5549602], <span class="ansi-bold">134×24 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW72      GW_Armando_plate1_TTGW72      SA        l ⋯
   2 │ GW_Armando_plate1_TTGW78      GW_Armando_plate1_TTGW78      SA        l
   3 │ GW_Armando_plate2_TTGW73      GW_Armando_plate2_TTGW73      SA        l
   4 │ GW_Armando_plate2_TTGW77      GW_Armando_plate2_TTGW77      SA        l
   5 │ GW_Armando_plate2_TTGW79      GW_Armando_plate2_TTGW79      SA        l ⋯
   6 │ GW_Armando_plate2_TTGW80      GW_Armando_plate2_TTGW80      SA        l
   7 │ GW_Armando_plate2_TTGW75      GW_Armando_plate2_TTGW75      SA        l
   8 │ GW_Armando_plate2_TTGW28      GW_Armando_plate2_TTGW28      SR        l
   9 │ GW_Armando_plate1_TTGW-15-08  GW_Armando_plate1_TTGW-15-08  SR        l ⋯
  10 │ GW_Armando_plate2_TTGW-15-04  GW_Armando_plate2_TTGW-15-04  SR        l
  11 │ GW_Armando_plate1_TTGW13      GW_Armando_plate1_TTGW13      TH        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 125 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
 126 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p ⋯
 127 │ GW_Armando_plate2_JF24G01     GW_Armando_plate2_JF24G01     VB        p
 128 │ GW_Armando_plate2_JF25G01     GW_Armando_plate2_JF25G01     VB        p
 129 │ GW_Armando_plate1_JG02G04     GW_Armando_plate1_JG02G04     PR        p
 130 │ GW_Armando_plate2_JG02G01     GW_Armando_plate2_JG02G01     PR        p ⋯
 131 │ GW_Armando_plate2_JG02G03     GW_Armando_plate2_JG02G03     PR        p
 132 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
 133 │ GW_Lane5_SL2                  GW_Lane5_SL2                  SL        p
 134 │ GW_Lane5_SL1                  GW_Lane5_SL1                  SL        p ⋯
<span class="ansi-cyan-fg">                                                 21 columns and 113 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-3" class="level2">
<h2 class="anchored" data-anchor-id="show-just-the-northern-area-3">Show just the northern area</h2>
<div id="41780498" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb189-28"><a href="#cb189-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb189-29"><a href="#cb189-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb189-30"><a href="#cb189-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb189-31"><a href="#cb189-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-75-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="75">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 1 … 0 0], [4175655, 4201372, 4202662, 4220609, 4269946, 4272732, 4280387, 4397231, 4397235, 4411591  …  5519560, 5519564, 5524191, 5524276, 5530753, 5530774, 5535422, 5540526, 5549587, 5549602], <span class="ansi-bold">143×24 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   3 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   4 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   5 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
  11 │ GW_Lane5_YK3               GW_Lane5_YK3               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 134 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 135 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 136 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 137 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 138 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 139 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb   ⋯
 140 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 141 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 142 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 143 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 21 columns and 122 rows omitted</span>)</pre>
</div>
</div>
</div>
<section id="do-a-pca-based-on-a-same-size-region-elsewhere-on-gw26-with-low-vishet" class="level3">
<h3 class="anchored" data-anchor-id="do-a-pca-based-on-a-same-size-region-elsewhere-on-gw26-with-low-vishet">Do a PCA based on a same-size region elsewhere on gw26 (with low ViSHet):</h3>
<div id="a4cbba83" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get length of region</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>lengthHighViSHetRegion <span class="op">=</span> positionMax <span class="op">-</span> positionMin</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>leftLocus <span class="op">=</span> <span class="fl">1_000_000</span> <span class="co"># start at 1 Mb from left side</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>rightLocus <span class="op">=</span> leftLocus <span class="op">+</span> lengthHighViSHetRegion</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>regionText_lowViSHetRegion <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr "</span>, chr, <span class="st">" "</span>,leftLocus,<span class="st">" to "</span>,rightLocus)</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>lociSelection <span class="op">=</span> (leftLocus <span class="op">.&lt;=</span> pos_region.position <span class="op">.&lt;=</span> rightLocus)</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>genotypes_lowViSHetRegion <span class="op">=</span> genotypes_region[<span class="op">:</span>, lociSelection]</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="co"># impute missing genotypes:</span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>genotypes_lowViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genotypes_lowViSHetRegion))</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>PCAmodel <span class="op">=</span> <span class="fu">plotPCA</span>(genotypes_lowViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText_lowViSHetRegion,</span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-27"><a href="#cb192-27" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodel.PCAfig)</span>
<span id="cb192-28"><a href="#cb192-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb192-29"><a href="#cb192-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"FigureS2C_gw26_nonHLBRarbitrary_from_Julia.png"</span>, PCAmodel.PCAfig, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb192-30"><a href="#cb192-30" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-76-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="do-similar-as-above-but-for-chr-1a" class="level2">
<h2 class="anchored" data-anchor-id="do-similar-as-above-but-for-chr-1a">Do similar as above but for chr 1A:</h2>
<p>(Tried chr 1 but seems to be some recomb that makes it less clear to assign to groups)</p>
<div id="d22fb4c8" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw1A"</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb194-52"><a href="#cb194-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb194-53"><a href="#cb194-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb194-54"><a href="#cb194-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb194-55"><a href="#cb194-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-56"><a href="#cb194-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb194-57"><a href="#cb194-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb194-58"><a href="#cb194-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-59"><a href="#cb194-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb194-60"><a href="#cb194-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.5</span>) </span>
<span id="cb194-61"><a href="#cb194-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-62"><a href="#cb194-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb194-63"><a href="#cb194-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-64"><a href="#cb194-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb194-65"><a href="#cb194-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb194-66"><a href="#cb194-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb194-67"><a href="#cb194-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb194-68"><a href="#cb194-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb194-69"><a href="#cb194-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb194-70"><a href="#cb194-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb194-71"><a href="#cb194-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb194-72"><a href="#cb194-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb194-73"><a href="#cb194-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb194-74"><a href="#cb194-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb194-75"><a href="#cb194-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>More than 1 region on that scaffold. Using just the longest one.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><div style="float: left;"><span>2×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionChrom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionStart</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionEnd</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">gw1A</td>
<td style="text-align: right;">4674</td>
<td style="text-align: right;">3771263</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">gw1A</td>
<td style="text-align: right;">23592559</td>
<td style="text-align: right;">30616953</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-77-output-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-77-output-6.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-4" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-4">Save the individual colors in the metadata</h3>
<div id="710b175f" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-4" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-4">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="59713a75" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-79-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-4" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-4">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="7bdb0761" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-80-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-1a-high-vishet-region-there-are-only-5-clear-haplogroups-checked-that-vir-and-lud-dont-form-distinct-groups-on-pc3.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-1a-high-vishet-region-there-are-only-5-clear-haplogroups-checked-that-vir-and-lud-dont-form-distinct-groups-on-pc3.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 1A high ViSHet region, there are only 5 clear haplogroups (checked that vir and lud don’t form distinct groups on PC3). Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="c62787c9" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"green"</span>,</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellowgreen"</span>,</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">8</span>) <span class="op">.&amp;</span> </span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">8</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">9</span>) <span class="op">.&amp;</span></span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">6</span>) <span class="op">.&amp;</span></span>
<span id="cb207-21"><a href="#cb207-21" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span> </span>
<span id="cb207-22"><a href="#cb207-22" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb207-23"><a href="#cb207-23" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb207-24"><a href="#cb207-24" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">7.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb207-25"><a href="#cb207-25" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb207-26"><a href="#cb207-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-27"><a href="#cb207-27" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb207-28"><a href="#cb207-28" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb207-29"><a href="#cb207-29" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb207-30"><a href="#cb207-30" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb207-31"><a href="#cb207-31" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb207-32"><a href="#cb207-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb207-33"><a href="#cb207-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-34"><a href="#cb207-34" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit troch obs plumb]</span>
<span id="cb207-35"><a href="#cb207-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-36"><a href="#cb207-36" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb207-37"><a href="#cb207-37" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb207-38"><a href="#cb207-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-39"><a href="#cb207-39" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb207-40"><a href="#cb207-40" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb207-41"><a href="#cb207-41" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb207-42"><a href="#cb207-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb207-43"><a href="#cb207-43" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb207-44"><a href="#cb207-44" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb207-45"><a href="#cb207-45" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb207-46"><a href="#cb207-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-47"><a href="#cb207-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb207-48"><a href="#cb207-48" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb207-49"><a href="#cb207-49" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb207-50"><a href="#cb207-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-51"><a href="#cb207-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb207-52"><a href="#cb207-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-53"><a href="#cb207-53" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb207-54"><a href="#cb207-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-55"><a href="#cb207-55" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb207-56"><a href="#cb207-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-57"><a href="#cb207-57" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb207-58"><a href="#cb207-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-59"><a href="#cb207-59" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb207-60"><a href="#cb207-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-61"><a href="#cb207-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb207-62"><a href="#cb207-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-63"><a href="#cb207-63" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb207-64"><a href="#cb207-64" aria-hidden="true" tabindex="-1"></a><span class="co">#= 5×2 DataFrame</span></span>
<span id="cb207-65"><a href="#cb207-65" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb207-66"><a href="#cb207-66" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb207-67"><a href="#cb207-67" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb207-68"><a href="#cb207-68" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud   0.00559696</span></span>
<span id="cb207-69"><a href="#cb207-69" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.00458482</span></span>
<span id="cb207-70"><a href="#cb207-70" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch    0.00470781</span></span>
<span id="cb207-71"><a href="#cb207-71" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obs      0.00524545</span></span>
<span id="cb207-72"><a href="#cb207-72" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ plumb    0.00659452 =#</span></span>
<span id="cb207-73"><a href="#cb207-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-74"><a href="#cb207-74" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb207-75"><a href="#cb207-75" aria-hidden="true" tabindex="-1"></a><span class="co">#= 10×2 DataFrame</span></span>
<span id="cb207-76"><a href="#cb207-76" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb207-77"><a href="#cb207-77" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb207-78"><a href="#cb207-78" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb207-79"><a href="#cb207-79" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit    0.0234051</span></span>
<span id="cb207-80"><a href="#cb207-80" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch  0.0303858</span></span>
<span id="cb207-81"><a href="#cb207-81" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obs    0.0285612</span></span>
<span id="cb207-82"><a href="#cb207-82" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ virLud_plumb  0.0298279</span></span>
<span id="cb207-83"><a href="#cb207-83" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_troch     0.036893</span></span>
<span id="cb207-84"><a href="#cb207-84" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_obs       0.0346282</span></span>
<span id="cb207-85"><a href="#cb207-85" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_plumb     0.0363109</span></span>
<span id="cb207-86"><a href="#cb207-86" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ troch_obs     0.0169886</span></span>
<span id="cb207-87"><a href="#cb207-87" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ troch_plumb   0.0274903</span></span>
<span id="cb207-88"><a href="#cb207-88" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ obs_plumb     0.0256253 =#</span></span>
<span id="cb207-89"><a href="#cb207-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-90"><a href="#cb207-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb207-91"><a href="#cb207-91" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb207-92"><a href="#cb207-92" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb207-93"><a href="#cb207-93" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb207-94"><a href="#cb207-94" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb207-95"><a href="#cb207-95" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb207-96"><a href="#cb207-96" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb207-97"><a href="#cb207-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-98"><a href="#cb207-98" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb207-99"><a href="#cb207-99" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb207-100"><a href="#cb207-100" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb207-101"><a href="#cb207-101" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb207-102"><a href="#cb207-102" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb207-103"><a href="#cb207-103" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb207-104"><a href="#cb207-104" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb207-105"><a href="#cb207-105" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb207-106"><a href="#cb207-106" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb207-107"><a href="#cb207-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-108"><a href="#cb207-108" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb207-109"><a href="#cb207-109" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb207-110"><a href="#cb207-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-111"><a href="#cb207-111" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb207-112"><a href="#cb207-112" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb207-113"><a href="#cb207-113" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb207-114"><a href="#cb207-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-115"><a href="#cb207-115" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb207-116"><a href="#cb207-116" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb207-117"><a href="#cb207-117" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb207-118"><a href="#cb207-118" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [75 2 65 5 68] and the sum of those is 215
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-81-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="81">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 2 … 0 0; 0 2 … 0 0], [23611461, 23653527, 23686609, 23686624, 23799577, 23812654, 23824078, 23832306, 23832308, 23868434  …  29356320, 29415681, 29627465, 29627471, 29738988, 29903377, 29993850, 30023875, 30023911, 30306067], <span class="ansi-bold">52×26 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   3 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   4 │ GW_Armando_plate1_TTGW13      GW_Armando_plate1_TTGW13      TH        l
   5 │ GW_Armando_plate1_TTGW29      GW_Armando_plate1_TTGW29      SR        l ⋯
   6 │ GW_Armando_plate1_TTGW65      GW_Armando_plate1_TTGW65      SP        l
   7 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   8 │ GW_Armando_plate2_TTGW12      GW_Armando_plate2_TTGW12      TH        l
   9 │ GW_Armando_plate2_TTGW16      GW_Armando_plate2_TTGW16      TH        l ⋯
  10 │ GW_Armando_plate2_TTGW18      GW_Armando_plate2_TTGW18      TH        l
  11 │ GW_Armando_plate2_TTGW24      GW_Armando_plate2_TTGW24      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  43 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p
  44 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p ⋯
  45 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p
  46 │ GW_Armando_plate1_JF26G01     GW_Armando_plate1_JF26G01     ST        p
  47 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  48 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p ⋯
  49 │ GW_Armando_plate1_JF29G02     GW_Armando_plate1_JF29G02     ST        p
  50 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p
  51 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
  52 │ GW_Armando_plate1_JG08G01     GW_Armando_plate1_JG08G01     ST        p ⋯
<span class="ansi-cyan-fg">                                                  23 columns and 31 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-4" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-4">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="65963c84" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs"</span>,</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>,</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_plumb"</span>]</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"purple"</span>]</span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>virLud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">8</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">7</span>) <span class="op">.&amp;</span></span>
<span id="cb210-22"><a href="#cb210-22" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb210-23"><a href="#cb210-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-24"><a href="#cb210-24" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit virLud_troch troch obs plumb vir_plumb]</span>
<span id="cb210-25"><a href="#cb210-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-26"><a href="#cb210-26" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb210-27"><a href="#cb210-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-28"><a href="#cb210-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb210-29"><a href="#cb210-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb210-30"><a href="#cb210-30" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb210-31"><a href="#cb210-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb210-32"><a href="#cb210-32" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb210-33"><a href="#cb210-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-34"><a href="#cb210-34" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb210-35"><a href="#cb210-35" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb210-36"><a href="#cb210-36" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb210-37"><a href="#cb210-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb210-38"><a href="#cb210-38" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb210-39"><a href="#cb210-39" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb210-40"><a href="#cb210-40" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb210-41"><a href="#cb210-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-42"><a href="#cb210-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb210-43"><a href="#cb210-43" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb210-44"><a href="#cb210-44" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb210-45"><a href="#cb210-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-46"><a href="#cb210-46" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb210-47"><a href="#cb210-47" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb210-48"><a href="#cb210-48" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb210-49"><a href="#cb210-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-50"><a href="#cb210-50" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb210-51"><a href="#cb210-51" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb210-52"><a href="#cb210-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-53"><a href="#cb210-53" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb210-54"><a href="#cb210-54" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb210-55"><a href="#cb210-55" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb210-56"><a href="#cb210-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-57"><a href="#cb210-57" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb210-58"><a href="#cb210-58" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb210-59"><a href="#cb210-59" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb210-60"><a href="#cb210-60" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb210-61"><a href="#cb210-61" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-82-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 1 … 0 0; 0 1 … 0 0], [23611461, 23653527, 23686609, 23686624, 23799577, 23812654, 23824078, 23832306, 23832308, 23868434  …  29356320, 29415681, 29627465, 29627471, 29738988, 29903377, 29993850, 30023875, 30023911, 30306067], <span class="ansi-bold">72×26 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   3 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   4 │ GW_Armando_plate1_TTGW13      GW_Armando_plate1_TTGW13      TH        l
   5 │ GW_Armando_plate1_TTGW29      GW_Armando_plate1_TTGW29      SR        l ⋯
   6 │ GW_Armando_plate1_TTGW65      GW_Armando_plate1_TTGW65      SP        l
   7 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   8 │ GW_Armando_plate2_TTGW12      GW_Armando_plate2_TTGW12      TH        l
   9 │ GW_Armando_plate2_TTGW16      GW_Armando_plate2_TTGW16      TH        l ⋯
  10 │ GW_Armando_plate2_TTGW18      GW_Armando_plate2_TTGW18      TH        l
  11 │ GW_Armando_plate2_TTGW24      GW_Armando_plate2_TTGW24      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  63 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p
  64 │ GW_Armando_plate1_JF29G02     GW_Armando_plate1_JF29G02     ST        p ⋯
  65 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p
  66 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
  67 │ GW_Armando_plate1_JG08G01     GW_Armando_plate1_JG08G01     ST        p
  68 │ GW_Armando_plate2_JF19G01     GW_Armando_plate2_JF19G01     MB        p ⋯
  69 │ GW_Armando_plate2_JF25G01     GW_Armando_plate2_JF25G01     VB        p
  70 │ GW_Lane5_TA1                  GW_Lane5_TA1                  TA        p
  71 │ GW_Lane5_UY2                  GW_Lane5_UY2                  UY        p
  72 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p ⋯
<span class="ansi-cyan-fg">                                                  23 columns and 51 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus-3" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-3">Show just the west area (without nitidus)</h3>
<div id="88ec4e19" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>]</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb213-25"><a href="#cb213-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb213-26"><a href="#cb213-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-27"><a href="#cb213-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb213-28"><a href="#cb213-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb213-29"><a href="#cb213-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb213-30"><a href="#cb213-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb213-31"><a href="#cb213-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-83-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="83">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 0; 2 2 … 1 0], [23653527, 23799577, 23812654, 23868434, 23880674, 23939747, 23970643, 24177835, 24200934, 24212017  …  28910551, 29072016, 29087210, 29415681, 29627465, 29738988, 29993850, 30023875, 30023911, 30306067], <span class="ansi-bold">177×26 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   3 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   4 │ GW_Armando_plate1_TTGW13      GW_Armando_plate1_TTGW13      TH        l
   5 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l ⋯
   6 │ GW_Armando_plate1_TTGW29      GW_Armando_plate1_TTGW29      SR        l
   7 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l
   8 │ GW_Armando_plate1_TTGW65      GW_Armando_plate1_TTGW65      SP        l
   9 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v ⋯
  10 │ GW_Armando_plate2_TTGW12      GW_Armando_plate2_TTGW12      TH        l
  11 │ GW_Armando_plate2_TTGW16      GW_Armando_plate2_TTGW16      TH        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 168 │ GW_Lane5_LN8                  GW_Lane5_LN8                  LN        t
 169 │ GW_Liz_GBS_Liz5144            GW_Liz_GBS_Liz5144            ML        l ⋯
 170 │ GW_Liz_GBS_Liz5175            GW_Liz_GBS_Liz5175            ML        l
 171 │ GW_Armando_plate2_TTGW79      GW_Armando_plate2_TTGW79      SA        l
 172 │ GW_Lane5_LN10                 GW_Lane5_LN10                 LN        t
 173 │ GW_Lane5_MN8                  GW_Lane5_MN8                  MN        t ⋯
 174 │ GW_Lane5_MN1                  GW_Lane5_MN1                  MN        t
 175 │ GW_Lane5_LN12                 GW_Lane5_LN12                 LN        t
 176 │ GW_Lane5_MN9                  GW_Lane5_MN9                  MN        t
 177 │ GW_Lane5_MN3                  GW_Lane5_MN3                  MN        t ⋯
<span class="ansi-cyan-fg">                                                 23 columns and 156 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-4" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area-4">Show just the east area</h3>
<div id="19ca7d35" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"troch"</span>,</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs"</span>,</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"orange"</span>,</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb216-29"><a href="#cb216-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb216-30"><a href="#cb216-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb216-31"><a href="#cb216-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-84-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 2; 0 0 … 2 1; … ; 2 0 … 2 2; 2 0 … 2 2], [23824078, 23832308, 23868434, 23970643, 24176699, 24177835, 24185673, 24230071, 24246102, 24307431  …  29072016, 29256987, 29256988, 29356294, 29356307, 29627465, 29738988, 29903377, 30023911, 30306067], <span class="ansi-bold">138×26 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW01   GW_Armando_plate1_TTGW01   MN        troch_M ⋯
   2 │ GW_Armando_plate1_TTGW11   GW_Armando_plate1_TTGW11   SU        lud_Suk
   3 │ GW_Armando_plate1_TTGW78   GW_Armando_plate1_TTGW78   SA        lud_Sat
   4 │ GW_Armando_plate2_TTGW75   GW_Armando_plate2_TTGW75   SA        lud_Sat
   5 │ GW_Armando_plate2_TTGW77   GW_Armando_plate2_TTGW77   SA        lud_Sat ⋯
   6 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
   7 │ GW_Liz_GBS_Liz5179         GW_Liz_GBS_Liz5179         ML        lud_chi
   8 │ GW_Liz_GBS_Liz5191         GW_Liz_GBS_Liz5191         ML        lud_chi
   9 │ GW_Liz_GBS_Liz6204         GW_Liz_GBS_Liz6204         ML        lud_chi ⋯
  10 │ GW_Armando_plate1_TTGW06   GW_Armando_plate1_TTGW06   SU        lud_Suk
  11 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L
  ⋮  │             ⋮                          ⋮                 ⋮            ⋮ ⋱
 129 │ GW_Lane5_BK2               GW_Lane5_BK2               BK        plumb
 130 │ GW_Lane5_UY5               GW_Lane5_UY5               UY        plumb   ⋯
 131 │ GW_Armando_plate1_JF12G02  GW_Armando_plate1_JF12G02  ST        plumb
 132 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
 133 │ GW_Lane5_ST1               GW_Lane5_ST1               ST        plumb
 134 │ GW_Lane5_UY3               GW_Lane5_UY3               UY        plumb   ⋯
 135 │ GW_Lane5_UY6               GW_Lane5_UY6               UY        plumb
 136 │ GW_Lane5_UY4               GW_Lane5_UY4               UY        plumb
 137 │ GW_Lane5_ST3               GW_Lane5_ST3               ST        plumb
 138 │ GW_Lane5_AN2               GW_Lane5_AN2               AN        plumb   ⋯
<span class="ansi-cyan-fg">                                                 23 columns and 117 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-4" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area-4">Show just the northern area</h3>
<div id="abc2bac8" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span>]</span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb219-25"><a href="#cb219-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb219-26"><a href="#cb219-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-27"><a href="#cb219-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb219-28"><a href="#cb219-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb219-29"><a href="#cb219-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb219-30"><a href="#cb219-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb219-31"><a href="#cb219-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-85-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="85">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 1 … 1 1; 1 1 … 1 101], [23653527, 23799577, 23812654, 23824078, 23880674, 23939747, 24176699, 24200934, 24212017, 24246102  …  28504703, 28878541, 28910551, 29052457, 29087210, 29356307, 29415681, 29903377, 29993850, 30023875], <span class="ansi-bold">148×26 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   3 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   4 │ GW_Armando_plate1_TTGW13      GW_Armando_plate1_TTGW13      TH        l
   5 │ GW_Armando_plate1_TTGW19      GW_Armando_plate1_TTGW19      TH        l ⋯
   6 │ GW_Armando_plate1_TTGW29      GW_Armando_plate1_TTGW29      SR        l
   7 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l
   8 │ GW_Armando_plate1_TTGW65      GW_Armando_plate1_TTGW65      SP        l
   9 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v ⋯
  10 │ GW_Armando_plate2_TTGW12      GW_Armando_plate2_TTGW12      TH        l
  11 │ GW_Armando_plate2_TTGW16      GW_Armando_plate2_TTGW16      TH        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 139 │ GW_Lane5_UY5                  GW_Lane5_UY5                  UY        p
 140 │ GW_Lane5_AN2                  GW_Lane5_AN2                  AN        p ⋯
 141 │ GW_Lane5_ST12                 GW_Lane5_ST12                 ST        p
 142 │ GW_Lane5_UY4                  GW_Lane5_UY4                  UY        p
 143 │ GW_Lane5_ST3                  GW_Lane5_ST3                  ST        p
 144 │ GW_Armando_plate2_JF19G01     GW_Armando_plate2_JF19G01     MB        p ⋯
 145 │ GW_Armando_plate2_JF25G01     GW_Armando_plate2_JF25G01     VB        p
 146 │ GW_Lane5_TA1                  GW_Lane5_TA1                  TA        p
 147 │ GW_Lane5_UY2                  GW_Lane5_UY2                  UY        p
 148 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p ⋯
<span class="ansi-cyan-fg">                                                 23 columns and 127 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="do-similar-as-above-but-for-chr-2" class="level2">
<h2 class="anchored" data-anchor-id="do-similar-as-above-but-for-chr-2">Do similar as above but for chr 2:</h2>
<p>This one doesn’t look like a super clear pattern (in terms of assigning homozygous and heterozygous haploblock genotypes), but will see what it shows:</p>
<div id="5765cf48" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw2"</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb222-24"><a href="#cb222-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-25"><a href="#cb222-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb222-26"><a href="#cb222-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-27"><a href="#cb222-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb222-28"><a href="#cb222-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-29"><a href="#cb222-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb222-30"><a href="#cb222-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb222-31"><a href="#cb222-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-32"><a href="#cb222-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb222-33"><a href="#cb222-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb222-34"><a href="#cb222-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb222-35"><a href="#cb222-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb222-36"><a href="#cb222-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb222-37"><a href="#cb222-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb222-38"><a href="#cb222-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb222-39"><a href="#cb222-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb222-40"><a href="#cb222-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-41"><a href="#cb222-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb222-42"><a href="#cb222-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-43"><a href="#cb222-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb222-44"><a href="#cb222-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb222-45"><a href="#cb222-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb222-46"><a href="#cb222-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb222-47"><a href="#cb222-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb222-48"><a href="#cb222-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb222-49"><a href="#cb222-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb222-50"><a href="#cb222-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb222-51"><a href="#cb222-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb222-52"><a href="#cb222-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb222-53"><a href="#cb222-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb222-54"><a href="#cb222-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb222-55"><a href="#cb222-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-56"><a href="#cb222-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb222-57"><a href="#cb222-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb222-58"><a href="#cb222-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-59"><a href="#cb222-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb222-60"><a href="#cb222-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.25</span>) </span>
<span id="cb222-61"><a href="#cb222-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-62"><a href="#cb222-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb222-63"><a href="#cb222-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-64"><a href="#cb222-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb222-65"><a href="#cb222-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb222-66"><a href="#cb222-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb222-67"><a href="#cb222-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb222-68"><a href="#cb222-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb222-69"><a href="#cb222-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb222-70"><a href="#cb222-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb222-71"><a href="#cb222-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb222-72"><a href="#cb222-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb222-73"><a href="#cb222-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb222-74"><a href="#cb222-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb222-75"><a href="#cb222-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>More than 1 region on that scaffold. Using just the longest one.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><div style="float: left;"><span>2×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionChrom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionStart</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionEnd</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">gw2</td>
<td style="text-align: right;">54537375</td>
<td style="text-align: right;">59262130</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">gw2</td>
<td style="text-align: right;">60234161</td>
<td style="text-align: right;">61533451</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-86-output-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-86-output-6.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-5" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-5">Save the individual colors in the metadata</h3>
<div id="13b65be9" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-5" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-5">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="55c870f9" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-88-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-5" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-5">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="aa25d536" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-89-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-2-high-vishet-region-there-are-5-clear-haplogroups.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-2-high-vishet-region-there-are-5-clear-haplogroups.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 2 high ViSHet region, there are 5 clear haplogroups. Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="dfdcc07e" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"green"</span>,</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellowgreen"</span>,</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span> </span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">0</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="op">-</span><span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="op">-</span><span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">3</span>) <span class="op">.&amp;</span> </span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">6</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb235-26"><a href="#cb235-26" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb235-27"><a href="#cb235-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-28"><a href="#cb235-28" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb235-29"><a href="#cb235-29" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb235-30"><a href="#cb235-30" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb235-31"><a href="#cb235-31" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb235-32"><a href="#cb235-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb235-33"><a href="#cb235-33" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb235-34"><a href="#cb235-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-35"><a href="#cb235-35" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit troch obs plumb]</span>
<span id="cb235-36"><a href="#cb235-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-37"><a href="#cb235-37" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb235-38"><a href="#cb235-38" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb235-39"><a href="#cb235-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-40"><a href="#cb235-40" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb235-41"><a href="#cb235-41" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb235-42"><a href="#cb235-42" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb235-43"><a href="#cb235-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb235-44"><a href="#cb235-44" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb235-45"><a href="#cb235-45" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb235-46"><a href="#cb235-46" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb235-47"><a href="#cb235-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-48"><a href="#cb235-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb235-49"><a href="#cb235-49" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb235-50"><a href="#cb235-50" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb235-51"><a href="#cb235-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-52"><a href="#cb235-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb235-53"><a href="#cb235-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-54"><a href="#cb235-54" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb235-55"><a href="#cb235-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-56"><a href="#cb235-56" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb235-57"><a href="#cb235-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-58"><a href="#cb235-58" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb235-59"><a href="#cb235-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-60"><a href="#cb235-60" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb235-61"><a href="#cb235-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-62"><a href="#cb235-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb235-63"><a href="#cb235-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-64"><a href="#cb235-64" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb235-65"><a href="#cb235-65" aria-hidden="true" tabindex="-1"></a><span class="co">#= 5×2 DataFrame</span></span>
<span id="cb235-66"><a href="#cb235-66" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb235-67"><a href="#cb235-67" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb235-68"><a href="#cb235-68" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb235-69"><a href="#cb235-69" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud   0.0123364</span></span>
<span id="cb235-70"><a href="#cb235-70" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.00557103</span></span>
<span id="cb235-71"><a href="#cb235-71" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch    0.00911341</span></span>
<span id="cb235-72"><a href="#cb235-72" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obs      0.00891506</span></span>
<span id="cb235-73"><a href="#cb235-73" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ plumb    0.0086287 =#</span></span>
<span id="cb235-74"><a href="#cb235-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-75"><a href="#cb235-75" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb235-76"><a href="#cb235-76" aria-hidden="true" tabindex="-1"></a><span class="co">#= 10×2 DataFrame</span></span>
<span id="cb235-77"><a href="#cb235-77" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb235-78"><a href="#cb235-78" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb235-79"><a href="#cb235-79" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb235-80"><a href="#cb235-80" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit    0.0328534</span></span>
<span id="cb235-81"><a href="#cb235-81" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch  0.0337586</span></span>
<span id="cb235-82"><a href="#cb235-82" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obs    0.0328064</span></span>
<span id="cb235-83"><a href="#cb235-83" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ virLud_plumb  0.0416095</span></span>
<span id="cb235-84"><a href="#cb235-84" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_troch     0.0376123</span></span>
<span id="cb235-85"><a href="#cb235-85" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_obs       0.0363568</span></span>
<span id="cb235-86"><a href="#cb235-86" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_plumb     0.0456889</span></span>
<span id="cb235-87"><a href="#cb235-87" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ troch_obs     0.0144702</span></span>
<span id="cb235-88"><a href="#cb235-88" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ troch_plumb   0.0331178</span></span>
<span id="cb235-89"><a href="#cb235-89" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ obs_plumb     0.0318128 =#</span></span>
<span id="cb235-90"><a href="#cb235-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-91"><a href="#cb235-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb235-92"><a href="#cb235-92" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb235-93"><a href="#cb235-93" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb235-94"><a href="#cb235-94" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb235-95"><a href="#cb235-95" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb235-96"><a href="#cb235-96" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb235-97"><a href="#cb235-97" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb235-98"><a href="#cb235-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-99"><a href="#cb235-99" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb235-100"><a href="#cb235-100" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb235-101"><a href="#cb235-101" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb235-102"><a href="#cb235-102" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb235-103"><a href="#cb235-103" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb235-104"><a href="#cb235-104" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb235-105"><a href="#cb235-105" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb235-106"><a href="#cb235-106" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb235-107"><a href="#cb235-107" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb235-108"><a href="#cb235-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-109"><a href="#cb235-109" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb235-110"><a href="#cb235-110" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb235-111"><a href="#cb235-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-112"><a href="#cb235-112" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb235-113"><a href="#cb235-113" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb235-114"><a href="#cb235-114" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb235-115"><a href="#cb235-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-116"><a href="#cb235-116" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb235-117"><a href="#cb235-117" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb235-118"><a href="#cb235-118" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb235-119"><a href="#cb235-119" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [59 1 72 4 69] and the sum of those is 205
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-90-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="90">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 2 … 2 0; 0 2 … 2 0], [54765846, 54905388, 54954528, 54954575, 55151909, 55151945, 55176856, 55200024, 55200062, 55200114  …  59023396, 59058874, 59071396, 59075668, 59075686, 59133380, 59154238, 59154281, 59210193, 59210220], <span class="ansi-bold">50×28 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW13      GW_Armando_plate1_TTGW13      TH        l ⋯
   2 │ GW_Armando_plate1_TTGW22      GW_Armando_plate1_TTGW22      SR        l
   3 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   4 │ GW_Armando_plate2_JF03G01     GW_Armando_plate2_JF03G01     ST_vi     v
   5 │ GW_Armando_plate2_TTGW25      GW_Armando_plate2_TTGW25      SR        l ⋯
   6 │ GW_Armando_plate2_TTGW27      GW_Armando_plate2_TTGW27      SR        l
   7 │ GW_Armando_plate2_TTGW56      GW_Armando_plate2_TTGW56      NG        l
   8 │ GW_Armando_plate2_TTGW-15-03  GW_Armando_plate2_TTGW-15-03  SR        l
   9 │ GW_Lane5_AA4                  GW_Lane5_AA4                  AA        v ⋯
  10 │ GW_Lane5_PT4                  GW_Lane5_PT4                  PA        l
  11 │ GW_Lane5_TL9                  GW_Lane5_TL9                  TL        v
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  41 │ GW_Armando_plate1_JF12G01     GW_Armando_plate1_JF12G01     ST        p
  42 │ GW_Armando_plate1_JF13G01     GW_Armando_plate1_JF13G01     ST        p ⋯
  43 │ GW_Armando_plate1_JF15G03     GW_Armando_plate1_JF15G03     DV        p
  44 │ GW_Armando_plate1_JF20G01     GW_Armando_plate1_JF20G01     MB        p
  45 │ GW_Armando_plate1_JF22G01     GW_Armando_plate1_JF22G01     MB        p
  46 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p ⋯
  47 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p
  48 │ GW_Armando_plate1_JF26G01     GW_Armando_plate1_JF26G01     ST        p
  49 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  50 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p ⋯
<span class="ansi-cyan-fg">                                                  25 columns and 29 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-5" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-5">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="5b90ab79" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLudHet"</span>,</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nitHet"</span>,</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"trochHet"</span>,</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs"</span>,</span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs_plumb"</span>,</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>,</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumbHet"</span>,</span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_plumb"</span>]</span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"blue"</span>,</span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb238-21"><a href="#cb238-21" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb238-22"><a href="#cb238-22" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"darkorange1"</span>,</span>
<span id="cb238-23"><a href="#cb238-23" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb238-24"><a href="#cb238-24" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb238-25"><a href="#cb238-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"purple"</span>]</span>
<span id="cb238-26"><a href="#cb238-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-27"><a href="#cb238-27" aria-hidden="true" tabindex="-1"></a>virLudHet <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span> </span>
<span id="cb238-28"><a href="#cb238-28" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">7</span>) <span class="op">.&amp;</span></span>
<span id="cb238-29"><a href="#cb238-29" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb238-30"><a href="#cb238-30" aria-hidden="true" tabindex="-1"></a>nitHet <span class="op">=</span> (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb238-31"><a href="#cb238-31" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">0.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb238-32"><a href="#cb238-32" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb238-33"><a href="#cb238-33" aria-hidden="true" tabindex="-1"></a>virLud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb238-34"><a href="#cb238-34" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb238-35"><a href="#cb238-35" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb238-36"><a href="#cb238-36" aria-hidden="true" tabindex="-1"></a>trochHet <span class="op">=</span> (<span class="op">-</span><span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb238-37"><a href="#cb238-37" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb238-38"><a href="#cb238-38" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb238-39"><a href="#cb238-39" aria-hidden="true" tabindex="-1"></a>obs_plumb <span class="op">=</span> (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb238-40"><a href="#cb238-40" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb238-41"><a href="#cb238-41" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb238-42"><a href="#cb238-42" aria-hidden="true" tabindex="-1"></a>plumbHet <span class="op">=</span> (<span class="fl">6</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb238-43"><a href="#cb238-43" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb238-44"><a href="#cb238-44" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb238-45"><a href="#cb238-45" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb238-46"><a href="#cb238-46" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb238-47"><a href="#cb238-47" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb238-48"><a href="#cb238-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-49"><a href="#cb238-49" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud virLudHet nit nitHet virLud_troch troch trochHet obs obs_plumb plumb plumbHet vir_plumb]</span>
<span id="cb238-50"><a href="#cb238-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-51"><a href="#cb238-51" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb238-52"><a href="#cb238-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-53"><a href="#cb238-53" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb238-54"><a href="#cb238-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb238-55"><a href="#cb238-55" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb238-56"><a href="#cb238-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb238-57"><a href="#cb238-57" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb238-58"><a href="#cb238-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-59"><a href="#cb238-59" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb238-60"><a href="#cb238-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-61"><a href="#cb238-61" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb238-62"><a href="#cb238-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-63"><a href="#cb238-63" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb238-64"><a href="#cb238-64" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb238-65"><a href="#cb238-65" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb238-66"><a href="#cb238-66" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb238-67"><a href="#cb238-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-68"><a href="#cb238-68" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb238-69"><a href="#cb238-69" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb238-70"><a href="#cb238-70" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb238-71"><a href="#cb238-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb238-72"><a href="#cb238-72" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb238-73"><a href="#cb238-73" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb238-74"><a href="#cb238-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb238-75"><a href="#cb238-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-76"><a href="#cb238-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb238-77"><a href="#cb238-77" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb238-78"><a href="#cb238-78" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb238-79"><a href="#cb238-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-80"><a href="#cb238-80" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb238-81"><a href="#cb238-81" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb238-82"><a href="#cb238-82" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb238-83"><a href="#cb238-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-84"><a href="#cb238-84" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb238-85"><a href="#cb238-85" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb238-86"><a href="#cb238-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-87"><a href="#cb238-87" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb238-88"><a href="#cb238-88" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb238-89"><a href="#cb238-89" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb238-90"><a href="#cb238-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-91"><a href="#cb238-91" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb238-92"><a href="#cb238-92" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb238-93"><a href="#cb238-93" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb238-94"><a href="#cb238-94" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb238-95"><a href="#cb238-95" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-91-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="91">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; -99 0 … 2 0], [54765846, 54905388, 54954528, 54954575, 55151909, 55151945, 55176856, 55200024, 55200062, 55200114  …  59023396, 59058874, 59071396, 59075668, 59075686, 59133380, 59154238, 59154281, 59210193, 59210220], <span class="ansi-bold">88×28 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW13      GW_Armando_plate1_TTGW13      TH        l ⋯
   2 │ GW_Armando_plate1_TTGW22      GW_Armando_plate1_TTGW22      SR        l
   3 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   4 │ GW_Armando_plate2_JF03G01     GW_Armando_plate2_JF03G01     ST_vi     v
   5 │ GW_Armando_plate2_TTGW25      GW_Armando_plate2_TTGW25      SR        l ⋯
   6 │ GW_Armando_plate2_TTGW27      GW_Armando_plate2_TTGW27      SR        l
   7 │ GW_Armando_plate2_TTGW56      GW_Armando_plate2_TTGW56      NG        l
   8 │ GW_Armando_plate2_TTGW-15-03  GW_Armando_plate2_TTGW-15-03  SR        l
   9 │ GW_Lane5_AA4                  GW_Lane5_AA4                  AA        v ⋯
  10 │ GW_Lane5_PT4                  GW_Lane5_PT4                  PA        l
  11 │ GW_Lane5_TL9                  GW_Lane5_TL9                  TL        v
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  79 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
  80 │ GW_Armando_plate2_TTGW-15-06  GW_Armando_plate2_TTGW-15-06  SR        l ⋯
  81 │ GW_Lane5_SL2                  GW_Lane5_SL2                  SL        p
  82 │ GW_Armando_plate2_TTGW28      GW_Armando_plate2_TTGW28      SR        l
  83 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p
  84 │ GW_Lane5_PT6                  GW_Lane5_PT6                  KL        l ⋯
  85 │ GW_Lane5_AA6                  GW_Lane5_AA6                  AA        v
  86 │ GW_Lane5_TL2                  GW_Lane5_TL2                  TL        v
  87 │ GW_Lane5_AB2                  GW_Lane5_AB2                  AB        v
  88 │ GW_Lane5_NA1                  GW_Lane5_NA1                  NR        l ⋯
<span class="ansi-cyan-fg">                                                  25 columns and 67 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order-3" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order-3">show GBI plot according to original groups and plot order</h3>
<div id="c32e1214" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PCAmodelAll.metadata.Fst_group = PCAmodelAll.metadata.original_Fst_group</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-92-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="92">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 1 … 1 0; 0 1 … 1 0], [54765846, 54905388, 54954528, 54954575, 55151909, 55151945, 55176856, 55200024, 55200062, 55200114  …  59023396, 59058874, 59071396, 59075668, 59075686, 59133380, 59154238, 59154281, 59210193, 59210220], <span class="ansi-bold">88×28 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   2 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir
   3 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   4 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   5 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
   6 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
   7 │ GW_Lane5_YK6               GW_Lane5_YK6               YK        vir
   8 │ GW_Lane5_AB2               GW_Lane5_AB2               AB        vir
   9 │ GW_Lane5_TL9               GW_Lane5_TL9               TL        vir     ⋯
  10 │ GW_Lane5_TL12              GW_Lane5_TL12              TL        vir
  11 │ GW_Lane5_TL2               GW_Lane5_TL2               TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  79 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb
  80 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb   ⋯
  81 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb
  82 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
  83 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
  84 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb   ⋯
  85 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  86 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  87 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
  88 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  25 columns and 67 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals-3" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals-3">show same but with all individuals</h3>
<div id="f4028d22" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PCAmodelAll.metadata.Fst_group = PCAmodelAll.metadata.original_Fst_group</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-93-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="93">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 1 … 1 0; 0 1 … 1 0], [54765846, 54905388, 54954528, 54954575, 55151909, 55151945, 55176856, 55200024, 55200062, 55200114  …  59023396, 59058874, 59071396, 59075668, 59075686, 59133380, 59154238, 59154281, 59210193, 59210220], <span class="ansi-bold">256×28 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   2 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 247 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 248 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb   ⋯
 249 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 250 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 251 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 252 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb   ⋯
 253 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 254 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 255 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 256 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 25 columns and 235 rows omitted</span>)</pre>
</div>
</div>
</div>
<p>Chr 2 is complicated, shows recomb and perhaps some haploblock sharing between east Siberia and the southwestern area. Hard to show in summary figure but should perhaps mention.</p>
</section>
</section>
<section id="same-for-chr-3" class="level2">
<h2 class="anchored" data-anchor-id="same-for-chr-3">Same for chr 3</h2>
<div id="80c6d956" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw3"</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb245-17"><a href="#cb245-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb245-18"><a href="#cb245-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb245-19"><a href="#cb245-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-20"><a href="#cb245-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb245-21"><a href="#cb245-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-22"><a href="#cb245-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb245-23"><a href="#cb245-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb245-24"><a href="#cb245-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-25"><a href="#cb245-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb245-26"><a href="#cb245-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-27"><a href="#cb245-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb245-28"><a href="#cb245-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-29"><a href="#cb245-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb245-30"><a href="#cb245-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb245-31"><a href="#cb245-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-32"><a href="#cb245-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb245-33"><a href="#cb245-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb245-34"><a href="#cb245-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb245-35"><a href="#cb245-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb245-36"><a href="#cb245-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb245-37"><a href="#cb245-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb245-38"><a href="#cb245-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb245-39"><a href="#cb245-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb245-40"><a href="#cb245-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-41"><a href="#cb245-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb245-42"><a href="#cb245-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-43"><a href="#cb245-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb245-44"><a href="#cb245-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb245-45"><a href="#cb245-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb245-46"><a href="#cb245-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb245-47"><a href="#cb245-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb245-48"><a href="#cb245-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb245-49"><a href="#cb245-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb245-50"><a href="#cb245-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb245-51"><a href="#cb245-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb245-52"><a href="#cb245-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb245-53"><a href="#cb245-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb245-54"><a href="#cb245-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb245-55"><a href="#cb245-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-56"><a href="#cb245-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb245-57"><a href="#cb245-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb245-58"><a href="#cb245-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-59"><a href="#cb245-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb245-60"><a href="#cb245-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.25</span>) </span>
<span id="cb245-61"><a href="#cb245-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-62"><a href="#cb245-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb245-63"><a href="#cb245-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-64"><a href="#cb245-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb245-65"><a href="#cb245-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb245-66"><a href="#cb245-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb245-67"><a href="#cb245-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb245-68"><a href="#cb245-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb245-69"><a href="#cb245-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb245-70"><a href="#cb245-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb245-71"><a href="#cb245-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb245-72"><a href="#cb245-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb245-73"><a href="#cb245-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb245-74"><a href="#cb245-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb245-75"><a href="#cb245-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>More than 1 region on that scaffold. Using just the longest one.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><div style="float: left;"><span>2×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionChrom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionStart</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionEnd</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">gw3</td>
<td style="text-align: right;">101192949</td>
<td style="text-align: right;">103495514</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">gw3</td>
<td style="text-align: right;">104554714</td>
<td style="text-align: right;">108279595</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-94-output-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-94-output-6.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-6" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-6">Save the individual colors in the metadata</h3>
<div id="55250def" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-6" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-6">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="ba665d82" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-96-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-6" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-6">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="b3b8cd31" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-97-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-3-high-vishet-region-there-are-only-4-clear-haplogroups-vir-and-lud-separated-though-on-pc3-but-not-in-a-clean-way-that-i-can-distinguish-clearly.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-3-high-vishet-region-there-are-only-4-clear-haplogroups-vir-and-lud-separated-though-on-pc3-but-not-in-a-clean-way-that-i-can-distinguish-clearly.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 3 high ViSHet region, there are only 4 clear haplogroups (vir and lud separated though on PC3, but not in a clean way that I can distinguish clearly). Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="6b4575b1" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"trochObs"</span>,</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a>trochObs <span class="op">=</span> (<span class="op">-</span><span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb258-17"><a href="#cb258-17" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb258-18"><a href="#cb258-18" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb258-19"><a href="#cb258-19" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb258-20"><a href="#cb258-20" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb258-21"><a href="#cb258-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-22"><a href="#cb258-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb258-23"><a href="#cb258-23" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb258-24"><a href="#cb258-24" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb258-25"><a href="#cb258-25" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[trochObs]</span>
<span id="cb258-26"><a href="#cb258-26" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb258-27"><a href="#cb258-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-28"><a href="#cb258-28" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit trochObs plumb]</span>
<span id="cb258-29"><a href="#cb258-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-30"><a href="#cb258-30" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb258-31"><a href="#cb258-31" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb258-32"><a href="#cb258-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-33"><a href="#cb258-33" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb258-34"><a href="#cb258-34" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb258-35"><a href="#cb258-35" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb258-36"><a href="#cb258-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb258-37"><a href="#cb258-37" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb258-38"><a href="#cb258-38" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb258-39"><a href="#cb258-39" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb258-40"><a href="#cb258-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-41"><a href="#cb258-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb258-42"><a href="#cb258-42" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb258-43"><a href="#cb258-43" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb258-44"><a href="#cb258-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-45"><a href="#cb258-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb258-46"><a href="#cb258-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-47"><a href="#cb258-47" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb258-48"><a href="#cb258-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-49"><a href="#cb258-49" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb258-50"><a href="#cb258-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-51"><a href="#cb258-51" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb258-52"><a href="#cb258-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-53"><a href="#cb258-53" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb258-54"><a href="#cb258-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-55"><a href="#cb258-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb258-56"><a href="#cb258-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-57"><a href="#cb258-57" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb258-58"><a href="#cb258-58" aria-hidden="true" tabindex="-1"></a><span class="co">#= 4×2 DataFrame</span></span>
<span id="cb258-59"><a href="#cb258-59" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster   pi         </span></span>
<span id="cb258-60"><a href="#cb258-60" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String    Float64    </span></span>
<span id="cb258-61"><a href="#cb258-61" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼──────────────────────</span></span>
<span id="cb258-62"><a href="#cb258-62" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud    0.00950795</span></span>
<span id="cb258-63"><a href="#cb258-63" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit       0.00509165</span></span>
<span id="cb258-64"><a href="#cb258-64" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ trochObs  0.00992915</span></span>
<span id="cb258-65"><a href="#cb258-65" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ plumb     0.00992294 =#</span></span>
<span id="cb258-66"><a href="#cb258-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-67"><a href="#cb258-67" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb258-68"><a href="#cb258-68" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb258-69"><a href="#cb258-69" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair     Dxy       </span></span>
<span id="cb258-70"><a href="#cb258-70" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String           Float64   </span></span>
<span id="cb258-71"><a href="#cb258-71" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼────────────────────────────</span></span>
<span id="cb258-72"><a href="#cb258-72" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit       0.0234761</span></span>
<span id="cb258-73"><a href="#cb258-73" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_trochObs  0.0309999</span></span>
<span id="cb258-74"><a href="#cb258-74" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_plumb     0.0345515</span></span>
<span id="cb258-75"><a href="#cb258-75" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ nit_trochObs     0.0320461</span></span>
<span id="cb258-76"><a href="#cb258-76" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_plumb        0.0351086</span></span>
<span id="cb258-77"><a href="#cb258-77" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ trochObs_plumb   0.0305924 =#</span></span>
<span id="cb258-78"><a href="#cb258-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-79"><a href="#cb258-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb258-80"><a href="#cb258-80" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb258-81"><a href="#cb258-81" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb258-82"><a href="#cb258-82" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb258-83"><a href="#cb258-83" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb258-84"><a href="#cb258-84" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb258-85"><a href="#cb258-85" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb258-86"><a href="#cb258-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-87"><a href="#cb258-87" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb258-88"><a href="#cb258-88" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb258-89"><a href="#cb258-89" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb258-90"><a href="#cb258-90" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb258-91"><a href="#cb258-91" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb258-92"><a href="#cb258-92" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb258-93"><a href="#cb258-93" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb258-94"><a href="#cb258-94" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb258-95"><a href="#cb258-95" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb258-96"><a href="#cb258-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-97"><a href="#cb258-97" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb258-98"><a href="#cb258-98" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">150</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb258-99"><a href="#cb258-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-100"><a href="#cb258-100" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb258-101"><a href="#cb258-101" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb258-102"><a href="#cb258-102" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb258-103"><a href="#cb258-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-104"><a href="#cb258-104" aria-hidden="true" tabindex="-1"></a><span class="co"># sort based on original_plot_order, and then together with function below will arrange individuals in population order within clusters:</span></span>
<span id="cb258-105"><a href="#cb258-105" aria-hidden="true" tabindex="-1"></a>sortOrder <span class="op">=</span> <span class="fu">sortperm</span>(indMetadataforGBI.original_plot_order, rev<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb258-106"><a href="#cb258-106" aria-hidden="true" tabindex="-1"></a>indMetadataforGBI <span class="op">=</span> indMetadataforGBI[sortOrder, <span class="op">:</span>]</span>
<span id="cb258-107"><a href="#cb258-107" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genosForGBI[sortOrder, <span class="op">:</span>]</span>
<span id="cb258-108"><a href="#cb258-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-109"><a href="#cb258-109" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb258-110"><a href="#cb258-110" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb258-111"><a href="#cb258-111" aria-hidden="true" tabindex="-1"></a>                indFontSize<span class="op">=</span><span class="fl">6</span>, figureSize<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">1800</span>),</span>
<span id="cb258-112"><a href="#cb258-112" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb258-113"><a href="#cb258-113" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb258-114"><a href="#cb258-114" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [64 2 72 63] and the sum of those is 201
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-98-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="98">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [104582339, 104582348, 104582352, 104654170, 104654177, 104654201, 104654235, 104655357, 104795328, 104795382  …  107808537, 107822070, 107822104, 107822186, 107920230, 108037413, 108050478, 108079656, 108089665, 108202755], <span class="ansi-bold">201×30 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   9 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis ⋯
  10 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  11 │ GW_Lane5_YK3               GW_Lane5_YK3               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 192 │ GW_Armando_plate2_JF15G02  GW_Armando_plate2_JF15G02  DV        plumb
 193 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb   ⋯
 194 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
 195 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
 196 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 197 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 198 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 199 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 200 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 201 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 27 columns and 180 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-6" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-6">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="d8b4dfd9" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLudHet"</span>,</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_trochObs"</span>,</span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"trochObs"</span>,</span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"trochObsHet"</span>,</span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>,</span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumbHet"</span>,</span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_plumb"</span>]</span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"blue"</span>,</span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green"</span>,</span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb261-18"><a href="#cb261-18" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb261-19"><a href="#cb261-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"purple"</span>]</span>
<span id="cb261-20"><a href="#cb261-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-21"><a href="#cb261-21" aria-hidden="true" tabindex="-1"></a>virLudHet <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span> </span>
<span id="cb261-22"><a href="#cb261-22" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb261-23"><a href="#cb261-23" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb261-24"><a href="#cb261-24" aria-hidden="true" tabindex="-1"></a>virLud_trochObs <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb261-25"><a href="#cb261-25" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb261-26"><a href="#cb261-26" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb261-27"><a href="#cb261-27" aria-hidden="true" tabindex="-1"></a>trochObsHet <span class="op">=</span> (<span class="op">-</span><span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb261-28"><a href="#cb261-28" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb261-29"><a href="#cb261-29" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb261-30"><a href="#cb261-30" aria-hidden="true" tabindex="-1"></a>plumbHet <span class="op">=</span> (<span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb261-31"><a href="#cb261-31" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb261-32"><a href="#cb261-32" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb261-33"><a href="#cb261-33" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb261-34"><a href="#cb261-34" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb261-35"><a href="#cb261-35" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb261-36"><a href="#cb261-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-37"><a href="#cb261-37" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud virLudHet nit virLud_trochObs trochObs trochObsHet plumb plumbHet vir_plumb]</span>
<span id="cb261-38"><a href="#cb261-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-39"><a href="#cb261-39" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb261-40"><a href="#cb261-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-41"><a href="#cb261-41" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb261-42"><a href="#cb261-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb261-43"><a href="#cb261-43" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb261-44"><a href="#cb261-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb261-45"><a href="#cb261-45" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb261-46"><a href="#cb261-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-47"><a href="#cb261-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-48"><a href="#cb261-48" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb261-49"><a href="#cb261-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-50"><a href="#cb261-50" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb261-51"><a href="#cb261-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-52"><a href="#cb261-52" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb261-53"><a href="#cb261-53" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb261-54"><a href="#cb261-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb261-55"><a href="#cb261-55" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb261-56"><a href="#cb261-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-57"><a href="#cb261-57" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb261-58"><a href="#cb261-58" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb261-59"><a href="#cb261-59" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb261-60"><a href="#cb261-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb261-61"><a href="#cb261-61" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb261-62"><a href="#cb261-62" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb261-63"><a href="#cb261-63" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb261-64"><a href="#cb261-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-65"><a href="#cb261-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb261-66"><a href="#cb261-66" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb261-67"><a href="#cb261-67" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb261-68"><a href="#cb261-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-69"><a href="#cb261-69" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb261-70"><a href="#cb261-70" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb261-71"><a href="#cb261-71" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb261-72"><a href="#cb261-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-73"><a href="#cb261-73" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb261-74"><a href="#cb261-74" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb261-75"><a href="#cb261-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-76"><a href="#cb261-76" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb261-77"><a href="#cb261-77" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb261-78"><a href="#cb261-78" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb261-79"><a href="#cb261-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-80"><a href="#cb261-80" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb261-81"><a href="#cb261-81" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb261-82"><a href="#cb261-82" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb261-83"><a href="#cb261-83" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb261-84"><a href="#cb261-84" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-99-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="99">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [104582339, 104582348, 104582352, 104654170, 104654177, 104654201, 104654235, 104655357, 104795328, 104795382  …  107808537, 107822070, 107822104, 107822186, 107920230, 108037413, 108050478, 108079656, 108089665, 108202755], <span class="ansi-bold">82×30 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   4 │ GW_Armando_plate1_TTGW06      GW_Armando_plate1_TTGW06      SU        l
   5 │ GW_Armando_plate1_TTGW17      GW_Armando_plate1_TTGW17      TH        l ⋯
   6 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l
   7 │ GW_Armando_plate1_TTGW-15-08  GW_Armando_plate1_TTGW-15-08  SR        l
   8 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   9 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p ⋯
  10 │ GW_Armando_plate2_TTGW18      GW_Armando_plate2_TTGW18      TH        l
  11 │ GW_Armando_plate2_TTGW20      GW_Armando_plate2_TTGW20      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  73 │ GW_Armando_plate1_JF12G01     GW_Armando_plate1_JF12G01     ST        p
  74 │ GW_Armando_plate2_JF25G01     GW_Armando_plate2_JF25G01     VB        p ⋯
  75 │ GW_Armando_plate2_JF26G02     GW_Armando_plate2_JF26G02     ST        p
  76 │ GW_Armando_plate2_JG01G01     GW_Armando_plate2_JG01G01     PR        p
  77 │ GW_Armando_plate2_JF11G02     GW_Armando_plate2_JF11G02     ST        p
  78 │ GW_Armando_plate2_JF24G01     GW_Armando_plate2_JF24G01     VB        p ⋯
  79 │ GW_Armando_plate1_JF09G02     GW_Armando_plate1_JF09G02     ST        p
  80 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
  81 │ GW_Armando_plate2_JF14G02     GW_Armando_plate2_JF14G02     DV        p
  82 │ GW_Armando_plate2_JG10G03     GW_Armando_plate2_JG10G03     ST        p ⋯
<span class="ansi-cyan-fg">                                                  27 columns and 61 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus-4" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-4">Show just the west area (without nitidus)</h3>
<div id="0f2a4fc2" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLudHet"</span>,</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_trochObs"</span>,</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"trochObs"</span>,</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"trochObsHet"</span>]</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"blue"</span>,</span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellowgreen"</span>,</span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb264-21"><a href="#cb264-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb264-22"><a href="#cb264-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb264-23"><a href="#cb264-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb264-24"><a href="#cb264-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-25"><a href="#cb264-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb264-26"><a href="#cb264-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-27"><a href="#cb264-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb264-28"><a href="#cb264-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb264-29"><a href="#cb264-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb264-30"><a href="#cb264-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-31"><a href="#cb264-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb264-32"><a href="#cb264-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb264-33"><a href="#cb264-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb264-34"><a href="#cb264-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb264-35"><a href="#cb264-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-100-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="100">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [104795328, 104795382, 104897991, 104924031, 105304008, 105412338, 105418462, 105460577, 105631673, 105659380  …  107406780, 107426628, 107480270, 107822070, 107822104, 107920230, 108037413, 108050478, 108079656, 108089665], <span class="ansi-bold">182×30 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   4 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   5 │ GW_Armando_plate1_TTGW06      GW_Armando_plate1_TTGW06      SU        l ⋯
   6 │ GW_Armando_plate1_TTGW17      GW_Armando_plate1_TTGW17      TH        l
   7 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l
   8 │ GW_Armando_plate1_TTGW-15-08  GW_Armando_plate1_TTGW-15-08  SR        l
   9 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v ⋯
  10 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
  11 │ GW_Armando_plate2_TTGW18      GW_Armando_plate2_TTGW18      TH        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 173 │ GW_Lane5_LN10                 GW_Lane5_LN10                 LN        t
 174 │ GW_Lane5_LN19                 GW_Lane5_LN19                 LN        t ⋯
 175 │ GW_Lane5_LN8                  GW_Lane5_LN8                  LN        t
 176 │ GW_Lane5_MN9                  GW_Lane5_MN9                  MN        t
 177 │ GW_Liz_GBS_Liz5190            GW_Liz_GBS_Liz5190            ML        l
 178 │ GW_Lane5_MN1                  GW_Lane5_MN1                  MN        t ⋯
 179 │ GW_Lane5_LN12                 GW_Lane5_LN12                 LN        t
 180 │ GW_Armando_plate2_TTGW60      GW_Armando_plate2_TTGW60      SP        l
 181 │ GW_Armando_plate2_TTGW73      GW_Armando_plate2_TTGW73      SA        l
 182 │ GW_Liz_GBS_Liz5193            GW_Liz_GBS_Liz5193            ML        l ⋯
<span class="ansi-cyan-fg">                                                 27 columns and 161 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-5" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area-5">Show just the east area</h3>
<div id="240434ff" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"trochObs"</span>,</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"trochObsHet"</span>,</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>,</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumbHet"</span>]</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"yellow"</span>,</span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>,</span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb267-17"><a href="#cb267-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb267-18"><a href="#cb267-18" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb267-19"><a href="#cb267-19" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb267-20"><a href="#cb267-20" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb267-21"><a href="#cb267-21" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb267-22"><a href="#cb267-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-23"><a href="#cb267-23" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb267-24"><a href="#cb267-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-25"><a href="#cb267-25" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb267-26"><a href="#cb267-26" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb267-27"><a href="#cb267-27" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb267-28"><a href="#cb267-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-29"><a href="#cb267-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb267-30"><a href="#cb267-30" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb267-31"><a href="#cb267-31" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb267-32"><a href="#cb267-32" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb267-33"><a href="#cb267-33" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-101-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="101">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 2 … 2 2; 1 2 … 2 2], [104582352, 104655357, 104864925, 104975314, 105059216, 105203277, 105386932, 105410394, 105596913, 105596914  …  107406686, 107406738, 107426628, 107480270, 107808537, 107822070, 107822104, 107920230, 108050478, 108089665], <span class="ansi-bold">145×30 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW01   GW_Armando_plate1_TTGW01   MN        troch_M ⋯
   2 │ GW_Armando_plate1_TTGW55   GW_Armando_plate1_TTGW55   NG        lud_Nai
   3 │ GW_Armando_plate1_TTGW63   GW_Armando_plate1_TTGW63   SP        lud_Spi
   4 │ GW_Armando_plate1_TTGW64   GW_Armando_plate1_TTGW64   SP        lud_Spi
   5 │ GW_Armando_plate1_TTGW65   GW_Armando_plate1_TTGW65   SP        lud_Spi ⋯
   6 │ GW_Armando_plate1_TTGW66   GW_Armando_plate1_TTGW66   SP        lud_Spi
   7 │ GW_Armando_plate1_TTGW68   GW_Armando_plate1_TTGW68   SP        lud_Spi
   8 │ GW_Armando_plate1_TTGW70   GW_Armando_plate1_TTGW70   SA        lud_Sat
   9 │ GW_Armando_plate1_TTGW72   GW_Armando_plate1_TTGW72   SA        lud_Sat ⋯
  10 │ GW_Armando_plate1_TTGW78   GW_Armando_plate1_TTGW78   SA        lud_Sat
  11 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L
  ⋮  │             ⋮                          ⋮                 ⋮            ⋮ ⋱
 136 │ GW_Lane5_AN1               GW_Lane5_AN1               AN        plumb
 137 │ GW_Lane5_BK2               GW_Lane5_BK2               BK        plumb   ⋯
 138 │ GW_Lane5_ST12              GW_Lane5_ST12              ST        plumb
 139 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
 140 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb
 141 │ GW_Armando_plate2_JF26G02  GW_Armando_plate2_JF26G02  ST        plumb   ⋯
 142 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 143 │ GW_Armando_plate1_JF09G02  GW_Armando_plate1_JF09G02  ST        plumb
 144 │ GW_Armando_plate2_JF11G02  GW_Armando_plate2_JF11G02  ST        plumb
 145 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb   ⋯
<span class="ansi-cyan-fg">                                                 27 columns and 124 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-5" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area-5">Show just the northern area</h3>
<div id="0f9698ea" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"virLudHet"</span>,</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>,</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumbHet"</span>]</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"blue"</span>,</span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>,</span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb270-21"><a href="#cb270-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb270-22"><a href="#cb270-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb270-23"><a href="#cb270-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb270-24"><a href="#cb270-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-25"><a href="#cb270-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsNorth))</span>
<span id="cb270-26"><a href="#cb270-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-27"><a href="#cb270-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb270-28"><a href="#cb270-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb270-29"><a href="#cb270-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb270-30"><a href="#cb270-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-31"><a href="#cb270-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb270-32"><a href="#cb270-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb270-33"><a href="#cb270-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb270-34"><a href="#cb270-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb270-35"><a href="#cb270-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-102-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="102">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 1 … 0 0; … ; 0 1 … 1 1; 0 1 … 1 1], [104582352, 104655357, 104795328, 104795382, 104864925, 104897991, 104924031, 104975314, 105059216, 105203277  …  106994418, 106994484, 107109035, 107109045, 107251168, 107406738, 107406780, 107808537, 108037413, 108079656], <span class="ansi-bold">144×30 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_JF16G01     GW_Armando_plate1_JF16G01     DV_vi     p
   4 │ GW_Armando_plate1_TTGW06      GW_Armando_plate1_TTGW06      SU        l
   5 │ GW_Armando_plate1_TTGW17      GW_Armando_plate1_TTGW17      TH        l ⋯
   6 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l
   7 │ GW_Armando_plate1_TTGW-15-08  GW_Armando_plate1_TTGW-15-08  SR        l
   8 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   9 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p ⋯
  10 │ GW_Armando_plate2_TTGW18      GW_Armando_plate2_TTGW18      TH        l
  11 │ GW_Armando_plate2_TTGW20      GW_Armando_plate2_TTGW20      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 135 │ GW_Armando_plate1_JF12G01     GW_Armando_plate1_JF12G01     ST        p
 136 │ GW_Armando_plate2_JF25G01     GW_Armando_plate2_JF25G01     VB        p ⋯
 137 │ GW_Armando_plate2_JF26G02     GW_Armando_plate2_JF26G02     ST        p
 138 │ GW_Armando_plate2_JG01G01     GW_Armando_plate2_JG01G01     PR        p
 139 │ GW_Armando_plate1_JF09G02     GW_Armando_plate1_JF09G02     ST        p
 140 │ GW_Armando_plate2_JF11G02     GW_Armando_plate2_JF11G02     ST        p ⋯
 141 │ GW_Armando_plate2_JF24G01     GW_Armando_plate2_JF24G01     VB        p
 142 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
 143 │ GW_Armando_plate2_JF14G02     GW_Armando_plate2_JF14G02     DV        p
 144 │ GW_Armando_plate2_JG10G03     GW_Armando_plate2_JG10G03     ST        p ⋯
<span class="ansi-cyan-fg">                                                 27 columns and 123 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="same-for-chr-18" class="level2">
<h2 class="anchored" data-anchor-id="same-for-chr-18">Same for chr 18</h2>
<div id="783ad038" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw18"</span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb273-16"><a href="#cb273-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb273-17"><a href="#cb273-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb273-18"><a href="#cb273-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb273-19"><a href="#cb273-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-20"><a href="#cb273-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb273-21"><a href="#cb273-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-22"><a href="#cb273-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb273-23"><a href="#cb273-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb273-24"><a href="#cb273-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-25"><a href="#cb273-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb273-26"><a href="#cb273-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-27"><a href="#cb273-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb273-28"><a href="#cb273-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-29"><a href="#cb273-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb273-30"><a href="#cb273-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb273-31"><a href="#cb273-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-32"><a href="#cb273-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb273-33"><a href="#cb273-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb273-34"><a href="#cb273-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb273-35"><a href="#cb273-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb273-36"><a href="#cb273-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb273-37"><a href="#cb273-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb273-38"><a href="#cb273-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb273-39"><a href="#cb273-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb273-40"><a href="#cb273-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-41"><a href="#cb273-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb273-42"><a href="#cb273-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-43"><a href="#cb273-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb273-44"><a href="#cb273-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb273-45"><a href="#cb273-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb273-46"><a href="#cb273-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb273-47"><a href="#cb273-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb273-48"><a href="#cb273-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb273-49"><a href="#cb273-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb273-50"><a href="#cb273-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb273-51"><a href="#cb273-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb273-52"><a href="#cb273-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb273-53"><a href="#cb273-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb273-54"><a href="#cb273-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb273-55"><a href="#cb273-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-56"><a href="#cb273-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb273-57"><a href="#cb273-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb273-58"><a href="#cb273-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-59"><a href="#cb273-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb273-60"><a href="#cb273-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.55</span>) </span>
<span id="cb273-61"><a href="#cb273-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-62"><a href="#cb273-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb273-63"><a href="#cb273-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-64"><a href="#cb273-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb273-65"><a href="#cb273-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb273-66"><a href="#cb273-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb273-67"><a href="#cb273-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb273-68"><a href="#cb273-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb273-69"><a href="#cb273-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb273-70"><a href="#cb273-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb273-71"><a href="#cb273-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb273-72"><a href="#cb273-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb273-73"><a href="#cb273-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb273-74"><a href="#cb273-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb273-75"><a href="#cb273-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-103-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-103-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-7" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-7">Save the individual colors in the metadata</h3>
<div id="55fd6fbe" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-7" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-7">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="5610ce1e" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-105-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-7" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-7">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="415012cb" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-106-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-18-high-vishet-region-there-are-5-clear-haplogroups-vir-and-lud-separated-though-on-pc3-though-not-clearly-enough-to-indicate-as-different-in-summary-plot.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-18-high-vishet-region-there-are-5-clear-haplogroups-vir-and-lud-separated-though-on-pc3-though-not-clearly-enough-to-indicate-as-different-in-summary-plot.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 18 high ViSHet region, there are 5 clear haplogroups (vir and lud separated though on PC3, though not clearly enough to indicate as different in summary plot). Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="9c7252d1" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">7</span>) <span class="op">.&amp;</span> </span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb286-15"><a href="#cb286-15" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">6</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb286-16"><a href="#cb286-16" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb286-17"><a href="#cb286-17" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb286-18"><a href="#cb286-18" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb286-19"><a href="#cb286-19" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb286-20"><a href="#cb286-20" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb286-21"><a href="#cb286-21" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb286-22"><a href="#cb286-22" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb286-23"><a href="#cb286-23" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb286-24"><a href="#cb286-24" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb286-25"><a href="#cb286-25" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb286-26"><a href="#cb286-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-27"><a href="#cb286-27" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb286-28"><a href="#cb286-28" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb286-29"><a href="#cb286-29" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb286-30"><a href="#cb286-30" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb286-31"><a href="#cb286-31" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb286-32"><a href="#cb286-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb286-33"><a href="#cb286-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-34"><a href="#cb286-34" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit troch obs plumb]</span>
<span id="cb286-35"><a href="#cb286-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-36"><a href="#cb286-36" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb286-37"><a href="#cb286-37" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb286-38"><a href="#cb286-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-39"><a href="#cb286-39" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb286-40"><a href="#cb286-40" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb286-41"><a href="#cb286-41" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb286-42"><a href="#cb286-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb286-43"><a href="#cb286-43" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb286-44"><a href="#cb286-44" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb286-45"><a href="#cb286-45" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb286-46"><a href="#cb286-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-47"><a href="#cb286-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb286-48"><a href="#cb286-48" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb286-49"><a href="#cb286-49" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb286-50"><a href="#cb286-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-51"><a href="#cb286-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb286-52"><a href="#cb286-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-53"><a href="#cb286-53" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb286-54"><a href="#cb286-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-55"><a href="#cb286-55" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb286-56"><a href="#cb286-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-57"><a href="#cb286-57" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb286-58"><a href="#cb286-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-59"><a href="#cb286-59" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb286-60"><a href="#cb286-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-61"><a href="#cb286-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb286-62"><a href="#cb286-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-63"><a href="#cb286-63" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb286-64"><a href="#cb286-64" aria-hidden="true" tabindex="-1"></a><span class="co">#= 5×2 DataFrame</span></span>
<span id="cb286-65"><a href="#cb286-65" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb286-66"><a href="#cb286-66" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb286-67"><a href="#cb286-67" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb286-68"><a href="#cb286-68" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud   0.0110074</span></span>
<span id="cb286-69"><a href="#cb286-69" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.00453689</span></span>
<span id="cb286-70"><a href="#cb286-70" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch    0.00973106</span></span>
<span id="cb286-71"><a href="#cb286-71" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obs      0.0123218</span></span>
<span id="cb286-72"><a href="#cb286-72" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ plumb    0.00925472 =#</span></span>
<span id="cb286-73"><a href="#cb286-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-74"><a href="#cb286-74" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb286-75"><a href="#cb286-75" aria-hidden="true" tabindex="-1"></a><span class="co">#= 10×2 DataFrame</span></span>
<span id="cb286-76"><a href="#cb286-76" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb286-77"><a href="#cb286-77" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb286-78"><a href="#cb286-78" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb286-79"><a href="#cb286-79" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit    0.0263493</span></span>
<span id="cb286-80"><a href="#cb286-80" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch  0.0361335</span></span>
<span id="cb286-81"><a href="#cb286-81" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obs    0.0359267</span></span>
<span id="cb286-82"><a href="#cb286-82" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ virLud_plumb  0.0395363</span></span>
<span id="cb286-83"><a href="#cb286-83" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_troch     0.0371472</span></span>
<span id="cb286-84"><a href="#cb286-84" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_obs       0.0377076</span></span>
<span id="cb286-85"><a href="#cb286-85" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_plumb     0.0400618</span></span>
<span id="cb286-86"><a href="#cb286-86" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ troch_obs     0.0169656</span></span>
<span id="cb286-87"><a href="#cb286-87" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ troch_plumb   0.0287838</span></span>
<span id="cb286-88"><a href="#cb286-88" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ obs_plumb     0.0290661 =#</span></span>
<span id="cb286-89"><a href="#cb286-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-90"><a href="#cb286-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb286-91"><a href="#cb286-91" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb286-92"><a href="#cb286-92" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb286-93"><a href="#cb286-93" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb286-94"><a href="#cb286-94" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb286-95"><a href="#cb286-95" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb286-96"><a href="#cb286-96" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb286-97"><a href="#cb286-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-98"><a href="#cb286-98" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb286-99"><a href="#cb286-99" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb286-100"><a href="#cb286-100" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb286-101"><a href="#cb286-101" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb286-102"><a href="#cb286-102" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb286-103"><a href="#cb286-103" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb286-104"><a href="#cb286-104" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb286-105"><a href="#cb286-105" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb286-106"><a href="#cb286-106" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb286-107"><a href="#cb286-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-108"><a href="#cb286-108" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb286-109"><a href="#cb286-109" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb286-110"><a href="#cb286-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-111"><a href="#cb286-111" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb286-112"><a href="#cb286-112" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb286-113"><a href="#cb286-113" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb286-114"><a href="#cb286-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-115"><a href="#cb286-115" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb286-116"><a href="#cb286-116" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb286-117"><a href="#cb286-117" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb286-118"><a href="#cb286-118" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [72 2 76 4 70] and the sum of those is 224
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-107-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="107">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 0 … 0 2; 2 0 … 0 2], [6108876, 6190195, 6293642, 6345626, 6386615, 6414325, 6414334, 6456723, 6456819, 6477300  …  8750639, 8750642, 8772183, 8773241, 8773281, 8773283, 8784596, 8797460, 8829892, 8833826], <span class="ansi-bold">51×32 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_TTGW17      GW_Armando_plate1_TTGW17      TH        l
   4 │ GW_Armando_plate1_TTGW29      GW_Armando_plate1_TTGW29      SR        l
   5 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l ⋯
   6 │ GW_Armando_plate1_TTGW-15-09  GW_Armando_plate1_TTGW-15-09  SR        l
   7 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   8 │ GW_Armando_plate2_JF30G01     GW_Armando_plate2_JF30G01     ST_vi     v
   9 │ GW_Armando_plate2_TTGW08      GW_Armando_plate2_TTGW08      SU        l ⋯
  10 │ GW_Armando_plate2_TTGW12      GW_Armando_plate2_TTGW12      TH        l
  11 │ GW_Armando_plate2_TTGW24      GW_Armando_plate2_TTGW24      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  42 │ GW_Armando_plate1_JF15G03     GW_Armando_plate1_JF15G03     DV        p
  43 │ GW_Armando_plate1_JF20G01     GW_Armando_plate1_JF20G01     MB        p ⋯
  44 │ GW_Armando_plate1_JF22G01     GW_Armando_plate1_JF22G01     MB        p
  45 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p
  46 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
  47 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p ⋯
  48 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  49 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p
  50 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p
  51 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p ⋯
<span class="ansi-cyan-fg">                                                  29 columns and 30 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-7" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-7">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="812e369b" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs"</span>,</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs_plumb"</span>,</span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>,</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_plumb"</span>]</span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green"</span>,</span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"darkorange1"</span>,</span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"purple"</span>]</span>
<span id="cb289-18"><a href="#cb289-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-19"><a href="#cb289-19" aria-hidden="true" tabindex="-1"></a>virLud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">5.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">0.5</span>) <span class="op">.&amp;</span></span>
<span id="cb289-20"><a href="#cb289-20" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">0.25</span>) <span class="op">.&amp;</span></span>
<span id="cb289-21"><a href="#cb289-21" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb289-22"><a href="#cb289-22" aria-hidden="true" tabindex="-1"></a><span class="co">#trochObsHet = (-2 .&lt; PCAmodelAll.metadata.PC1 .&lt; 2.5) .&amp;</span></span>
<span id="cb289-23"><a href="#cb289-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (PCAmodelAll.metadata.PC2 .&lt; -3) .&amp;</span></span>
<span id="cb289-24"><a href="#cb289-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># .!indSelection_lowIndHetStan</span></span>
<span id="cb289-25"><a href="#cb289-25" aria-hidden="true" tabindex="-1"></a>obs_plumb <span class="op">=</span> (<span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span> </span>
<span id="cb289-26"><a href="#cb289-26" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">0</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb289-27"><a href="#cb289-27" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb289-28"><a href="#cb289-28" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb289-29"><a href="#cb289-29" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb289-30"><a href="#cb289-30" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb289-31"><a href="#cb289-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-32"><a href="#cb289-32" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit virLud_troch troch obs obs_plumb plumb vir_plumb]</span>
<span id="cb289-33"><a href="#cb289-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-34"><a href="#cb289-34" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb289-35"><a href="#cb289-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-36"><a href="#cb289-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb289-37"><a href="#cb289-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb289-38"><a href="#cb289-38" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb289-39"><a href="#cb289-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb289-40"><a href="#cb289-40" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb289-41"><a href="#cb289-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-42"><a href="#cb289-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-43"><a href="#cb289-43" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb289-44"><a href="#cb289-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-45"><a href="#cb289-45" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb289-46"><a href="#cb289-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-47"><a href="#cb289-47" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb289-48"><a href="#cb289-48" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb289-49"><a href="#cb289-49" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb289-50"><a href="#cb289-50" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb289-51"><a href="#cb289-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-52"><a href="#cb289-52" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb289-53"><a href="#cb289-53" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb289-54"><a href="#cb289-54" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb289-55"><a href="#cb289-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb289-56"><a href="#cb289-56" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb289-57"><a href="#cb289-57" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb289-58"><a href="#cb289-58" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb289-59"><a href="#cb289-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-60"><a href="#cb289-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb289-61"><a href="#cb289-61" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb289-62"><a href="#cb289-62" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb289-63"><a href="#cb289-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-64"><a href="#cb289-64" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb289-65"><a href="#cb289-65" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb289-66"><a href="#cb289-66" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb289-67"><a href="#cb289-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-68"><a href="#cb289-68" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb289-69"><a href="#cb289-69" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb289-70"><a href="#cb289-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-71"><a href="#cb289-71" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb289-72"><a href="#cb289-72" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb289-73"><a href="#cb289-73" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb289-74"><a href="#cb289-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-75"><a href="#cb289-75" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb289-76"><a href="#cb289-76" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb289-77"><a href="#cb289-77" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb289-78"><a href="#cb289-78" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb289-79"><a href="#cb289-79" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-108-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="108">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 0 … 0 1; 1 0 … 0 -99], [6108876, 6190195, 6293642, 6345626, 6386615, 6414325, 6414334, 6456723, 6456819, 6477300  …  8750639, 8750642, 8772183, 8773241, 8773281, 8773283, 8784596, 8797460, 8829892, 8833826], <span class="ansi-bold">70×32 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v
   3 │ GW_Armando_plate1_TTGW17      GW_Armando_plate1_TTGW17      TH        l
   4 │ GW_Armando_plate1_TTGW29      GW_Armando_plate1_TTGW29      SR        l
   5 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l ⋯
   6 │ GW_Armando_plate1_TTGW-15-09  GW_Armando_plate1_TTGW-15-09  SR        l
   7 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   8 │ GW_Armando_plate2_JF30G01     GW_Armando_plate2_JF30G01     ST_vi     v
   9 │ GW_Armando_plate2_TTGW08      GW_Armando_plate2_TTGW08      SU        l ⋯
  10 │ GW_Armando_plate2_TTGW12      GW_Armando_plate2_TTGW12      TH        l
  11 │ GW_Armando_plate2_TTGW24      GW_Armando_plate2_TTGW24      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  61 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p
  62 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p ⋯
  63 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p
  64 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  65 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p
  66 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p ⋯
  67 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
  68 │ GW_Armando_plate2_JF13G02     GW_Armando_plate2_JF13G02     ST        p
  69 │ GW_Armando_plate1_JF08G02     GW_Armando_plate1_JF08G02     ST        p
  70 │ GW_Lane5_UY4                  GW_Lane5_UY4                  UY        p ⋯
<span class="ansi-cyan-fg">                                                  29 columns and 49 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order-4" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order-4">show GBI plot according to original groups and plot order</h3>
<div id="becbd6b9" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-109-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="109">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 0 … 0 2; 2 0 … 0 2], [6108876, 6190195, 6293642, 6345626, 6386615, 6414325, 6414334, 6456723, 6456819, 6477300  …  8750639, 8750642, 8772183, 8773241, 8773281, 8773283, 8784596, 8797460, 8829892, 8833826], <span class="ansi-bold">70×32 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate2_JF30G01     GW_Armando_plate2_JF30G01     ST_vi     v
   3 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v
   4 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v
   5 │ GW_Lane5_TU2                  GW_Lane5_TU2                  TU        n ⋯
   6 │ GW_Lane5_TU1                  GW_Lane5_TU1                  TU        n
   7 │ GW_Armando_plate1_TTGW70      GW_Armando_plate1_TTGW70      SA        l
   8 │ GW_Armando_plate1_TTGW72      GW_Armando_plate1_TTGW72      SA        l
   9 │ GW_Armando_plate2_TTGW73      GW_Armando_plate2_TTGW73      SA        l ⋯
  10 │ GW_Armando_plate2_TTGW75      GW_Armando_plate2_TTGW75      SA        l
  11 │ GW_Armando_plate1_TTGW29      GW_Armando_plate1_TTGW29      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  61 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  62 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p ⋯
  63 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p
  64 │ GW_Armando_plate2_JF13G02     GW_Armando_plate2_JF13G02     ST        p
  65 │ GW_Armando_plate1_JF08G02     GW_Armando_plate1_JF08G02     ST        p
  66 │ GW_Armando_plate1_JF15G03     GW_Armando_plate1_JF15G03     DV        p ⋯
  67 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p
  68 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
  69 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p
  70 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p ⋯
<span class="ansi-cyan-fg">                                                  29 columns and 49 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals-4" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals-4">show same but with all individuals</h3>
<div id="d98c2bb4" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb294-14"><a href="#cb294-14" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-110-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="110">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 0 … 0 2; 2 0 … 0 2], [6108876, 6190195, 6293642, 6345626, 6386615, 6414325, 6414334, 6456723, 6456819, 6477300  …  8750639, 8750642, 8772183, 8773241, 8773281, 8773283, 8784596, 8797460, 8829892, 8833826], <span class="ansi-bold">257×32 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   5 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK7               GW_Lane5_YK7               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 248 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 249 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 250 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 251 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 252 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 253 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb   ⋯
 254 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 255 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 256 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 257 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 29 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-vir-and-plumb-pops-2" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-vir-and-plumb-pops-2">show same but with only vir and plumb pops</h3>
<div id="08c4a695" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"virLud"</span>, <span class="st">"plumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"plumb"</span>, <span class="st">"plumb_vir"</span>] <span class="co"># these are the original Fst_groups</span></span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>]</span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb296-19"><a href="#cb296-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-20"><a href="#cb296-20" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb296-21"><a href="#cb296-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-22"><a href="#cb296-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb296-23"><a href="#cb296-23" aria-hidden="true" tabindex="-1"></a>                genosForGBI, metadataForGBI, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb296-24"><a href="#cb296-24" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-111-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="111">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 0 2; 2 2 … 1 2], [6108876, 6293642, 6414325, 6456723, 6456819, 6477300, 6631300, 6812016, 6812064, 6838561  …  8668147, 8681264, 8750618, 8750639, 8750642, 8772183, 8773241, 8773281, 8784596, 8833826], <span class="ansi-bold">100×32 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  91 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  92 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  93 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  94 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  95 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  96 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
  97 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  98 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  99 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 100 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  29 columns and 79 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus-5" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-5">Show just the west area (without nitidus)</h3>
<div id="af11f282" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>]</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green"</span>,</span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb298-16"><a href="#cb298-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb298-17"><a href="#cb298-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb298-18"><a href="#cb298-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb298-19"><a href="#cb298-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb298-20"><a href="#cb298-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-21"><a href="#cb298-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsWest))</span>
<span id="cb298-22"><a href="#cb298-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-23"><a href="#cb298-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb298-24"><a href="#cb298-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb298-25"><a href="#cb298-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb298-26"><a href="#cb298-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-27"><a href="#cb298-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb298-28"><a href="#cb298-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb298-29"><a href="#cb298-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb298-30"><a href="#cb298-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb298-31"><a href="#cb298-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-112-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="112">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 1 2; 2 2 … 2 2], [6108876, 6414325, 6414334, 6456723, 6485917, 6812016, 6812064, 6838561, 6838565, 6945805  …  8647967, 8661608, 8668147, 8681264, 8681284, 8750618, 8750639, 8750642, 8797460, 8829892], <span class="ansi-bold">177×32 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK7               GW_Lane5_YK7               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 168 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L
 169 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L ⋯
 170 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
 171 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L
 172 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L
 173 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L ⋯
 174 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L
 175 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
 176 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L
 177 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L ⋯
<span class="ansi-cyan-fg">                                                 29 columns and 156 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-6" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area-6">Show just the east area</h3>
<div id="eb5f49d1" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"obs"</span>,</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs_plumb"</span>,</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"darkorange1"</span>,</span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb301-14"><a href="#cb301-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb301-15"><a href="#cb301-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb301-16"><a href="#cb301-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb301-17"><a href="#cb301-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb301-18"><a href="#cb301-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb301-19"><a href="#cb301-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb301-20"><a href="#cb301-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-21"><a href="#cb301-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb301-22"><a href="#cb301-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-23"><a href="#cb301-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb301-24"><a href="#cb301-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb301-25"><a href="#cb301-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb301-26"><a href="#cb301-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-27"><a href="#cb301-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb301-28"><a href="#cb301-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb301-29"><a href="#cb301-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb301-30"><a href="#cb301-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb301-31"><a href="#cb301-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-113-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="113">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 1; … ; 2 2 … 2 2; 2 2 … 2 2], [6293642, 6414334, 6456819, 6477300, 6485917, 6631300, 6812081, 7047936, 7172541, 7435797  …  8636680, 8643165, 8661565, 8739750, 8772183, 8773241, 8773281, 8784596, 8829892, 8833826], <span class="ansi-bold">75×32 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Lane5_EM1               GW_Lane5_EM1               EM        troch_E ⋯
   2 │ GW_Lane5_DA4               GW_Lane5_DA4               XN        obs
   3 │ GW_Lane5_DA7               GW_Lane5_DA7               XN        obs
   4 │ GW_Lane5_DA2               GW_Lane5_DA2               XN        obs
   5 │ GW_Lane5_DA3               GW_Lane5_DA3               XN        obs     ⋯
   6 │ GW_Armando_plate1_RF20G01  GW_Armando_plate1_RF20G01  BJ        obs_plu
   7 │ GW_Armando_plate1_RF29G02  GW_Armando_plate1_RF29G02  BJ        obs_plu
   8 │ GW_Armando_plate2_RF29G01  GW_Armando_plate2_RF29G01  BJ        obs_plu
   9 │ GW_Lane5_BK2               GW_Lane5_BK2               BK        plumb   ⋯
  10 │ GW_Lane5_BK3               GW_Lane5_BK3               BK        plumb
  11 │ GW_Lane5_AN2               GW_Lane5_AN2               AN        plumb
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  66 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  67 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  68 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  69 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  70 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
  71 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb   ⋯
  72 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  73 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  74 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
  75 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  29 columns and 54 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-6" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area-6">Show just the northern area</h3>
<div id="7840a5eb" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb304-16"><a href="#cb304-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb304-17"><a href="#cb304-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb304-18"><a href="#cb304-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb304-19"><a href="#cb304-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb304-20"><a href="#cb304-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-21"><a href="#cb304-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsNorth))</span>
<span id="cb304-22"><a href="#cb304-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-23"><a href="#cb304-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb304-24"><a href="#cb304-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb304-25"><a href="#cb304-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb304-26"><a href="#cb304-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-27"><a href="#cb304-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb304-28"><a href="#cb304-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb304-29"><a href="#cb304-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb304-30"><a href="#cb304-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb304-31"><a href="#cb304-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-114-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="114">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 0 2; 2 2 … 1 2], [6108876, 6293642, 6414325, 6456723, 6456819, 6477300, 6631300, 6812016, 6812064, 6838561  …  8668147, 8681264, 8750618, 8750639, 8750642, 8772183, 8773241, 8773281, 8784596, 8833826], <span class="ansi-bold">145×32 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   4 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK7               GW_Lane5_YK7               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 136 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 137 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 138 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 139 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 140 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 141 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb   ⋯
 142 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 143 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 144 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 145 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 29 columns and 124 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="tried-chr-12-but-sort-of-a-mess.-the-ludlowi-samples-fall-in-all-clusters-even-plumb" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-12-but-sort-of-a-mess.-the-ludlowi-samples-fall-in-all-clusters-even-plumb">Tried chr 12 but sort of a mess. The ludlowi samples fall in all clusters, even plumb!</h2>
</section>
<section id="same-for-chr-13" class="level2">
<h2 class="anchored" data-anchor-id="same-for-chr-13">Same for chr 13</h2>
<div id="79dd32e3" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw13"</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb307-17"><a href="#cb307-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb307-18"><a href="#cb307-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb307-19"><a href="#cb307-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-20"><a href="#cb307-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb307-21"><a href="#cb307-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-22"><a href="#cb307-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb307-23"><a href="#cb307-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb307-24"><a href="#cb307-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-25"><a href="#cb307-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb307-26"><a href="#cb307-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-27"><a href="#cb307-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb307-28"><a href="#cb307-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-29"><a href="#cb307-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb307-30"><a href="#cb307-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb307-31"><a href="#cb307-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-32"><a href="#cb307-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb307-33"><a href="#cb307-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb307-34"><a href="#cb307-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb307-35"><a href="#cb307-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb307-36"><a href="#cb307-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb307-37"><a href="#cb307-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb307-38"><a href="#cb307-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb307-39"><a href="#cb307-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb307-40"><a href="#cb307-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-41"><a href="#cb307-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb307-42"><a href="#cb307-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-43"><a href="#cb307-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb307-44"><a href="#cb307-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb307-45"><a href="#cb307-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb307-46"><a href="#cb307-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb307-47"><a href="#cb307-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb307-48"><a href="#cb307-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb307-49"><a href="#cb307-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb307-50"><a href="#cb307-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb307-51"><a href="#cb307-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb307-52"><a href="#cb307-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb307-53"><a href="#cb307-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb307-54"><a href="#cb307-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb307-55"><a href="#cb307-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-56"><a href="#cb307-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb307-57"><a href="#cb307-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb307-58"><a href="#cb307-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-59"><a href="#cb307-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb307-60"><a href="#cb307-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.75</span>) </span>
<span id="cb307-61"><a href="#cb307-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-62"><a href="#cb307-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb307-63"><a href="#cb307-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-64"><a href="#cb307-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb307-65"><a href="#cb307-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb307-66"><a href="#cb307-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb307-67"><a href="#cb307-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb307-68"><a href="#cb307-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb307-69"><a href="#cb307-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb307-70"><a href="#cb307-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb307-71"><a href="#cb307-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb307-72"><a href="#cb307-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb307-73"><a href="#cb307-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb307-74"><a href="#cb307-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb307-75"><a href="#cb307-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>More than 1 region on that scaffold. Using just the longest one.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><div style="float: left;"><span>3×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionChrom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionStart</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionEnd</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">gw13</td>
<td style="text-align: right;">13574177</td>
<td style="text-align: right;">13722280</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">gw13</td>
<td style="text-align: right;">14099239</td>
<td style="text-align: right;">15243036</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">gw13</td>
<td style="text-align: right;">15413381</td>
<td style="text-align: right;">15607553</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-115-output-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-115-output-6.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="115">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-8" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-8">Save the individual colors in the metadata</h3>
<div id="59043fff" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-8" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-8">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="dbc8a0c0" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-117-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-8" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-8">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="a841ada7" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb317-11"><a href="#cb317-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb317-12"><a href="#cb317-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-118-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-13-high-vishet-region-there-are-6-clear-haplogroups-vir-and-lud-separated-cleanly-on-pc3-with-one-hetero-between-them.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-13-high-vishet-region-there-are-6-clear-haplogroups-vir-and-lud-separated-cleanly-on-pc3-with-one-hetero-between-them.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 13 high ViSHet region, there are 6 clear haplogroups (vir and lud separated cleanly on PC3, with one hetero between them). Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="288bd637" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud"</span>,</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb320-13"><a href="#cb320-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb320-14"><a href="#cb320-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-15"><a href="#cb320-15" aria-hidden="true" tabindex="-1"></a>vir <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb320-16"><a href="#cb320-16" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC3) <span class="op">.&amp;</span> </span>
<span id="cb320-17"><a href="#cb320-17" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb320-18"><a href="#cb320-18" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb320-19"><a href="#cb320-19" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">3.5</span>) <span class="op">.&amp;</span></span>
<span id="cb320-20"><a href="#cb320-20" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb320-21"><a href="#cb320-21" aria-hidden="true" tabindex="-1"></a>lud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb320-22"><a href="#cb320-22" aria-hidden="true" tabindex="-1"></a>        (PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span> </span>
<span id="cb320-23"><a href="#cb320-23" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb320-24"><a href="#cb320-24" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="op">-</span><span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb320-25"><a href="#cb320-25" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5.5</span>) <span class="op">.&amp;</span></span>
<span id="cb320-26"><a href="#cb320-26" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb320-27"><a href="#cb320-27" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="op">-</span><span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb320-28"><a href="#cb320-28" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">5.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb320-29"><a href="#cb320-29" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb320-30"><a href="#cb320-30" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">6</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb320-31"><a href="#cb320-31" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb320-32"><a href="#cb320-32" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb320-33"><a href="#cb320-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-34"><a href="#cb320-34" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb320-35"><a href="#cb320-35" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[vir]</span>
<span id="cb320-36"><a href="#cb320-36" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb320-37"><a href="#cb320-37" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[lud]</span>
<span id="cb320-38"><a href="#cb320-38" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb320-39"><a href="#cb320-39" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb320-40"><a href="#cb320-40" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb320-41"><a href="#cb320-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-42"><a href="#cb320-42" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [vir nit lud troch obs plumb]</span>
<span id="cb320-43"><a href="#cb320-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-44"><a href="#cb320-44" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb320-45"><a href="#cb320-45" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb320-46"><a href="#cb320-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-47"><a href="#cb320-47" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb320-48"><a href="#cb320-48" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb320-49"><a href="#cb320-49" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb320-50"><a href="#cb320-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb320-51"><a href="#cb320-51" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb320-52"><a href="#cb320-52" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb320-53"><a href="#cb320-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb320-54"><a href="#cb320-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-55"><a href="#cb320-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb320-56"><a href="#cb320-56" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb320-57"><a href="#cb320-57" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb320-58"><a href="#cb320-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-59"><a href="#cb320-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb320-60"><a href="#cb320-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-61"><a href="#cb320-61" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb320-62"><a href="#cb320-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-63"><a href="#cb320-63" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb320-64"><a href="#cb320-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-65"><a href="#cb320-65" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb320-66"><a href="#cb320-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-67"><a href="#cb320-67" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb320-68"><a href="#cb320-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-69"><a href="#cb320-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb320-70"><a href="#cb320-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-71"><a href="#cb320-71" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb320-72"><a href="#cb320-72" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb320-73"><a href="#cb320-73" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb320-74"><a href="#cb320-74" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb320-75"><a href="#cb320-75" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb320-76"><a href="#cb320-76" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ vir      0.00875059</span></span>
<span id="cb320-77"><a href="#cb320-77" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.00517962</span></span>
<span id="cb320-78"><a href="#cb320-78" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ lud      0.00819617</span></span>
<span id="cb320-79"><a href="#cb320-79" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ troch    0.00565913</span></span>
<span id="cb320-80"><a href="#cb320-80" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ obs      0.0090813</span></span>
<span id="cb320-81"><a href="#cb320-81" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ plumb    0.00929977 =#</span></span>
<span id="cb320-82"><a href="#cb320-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-83"><a href="#cb320-83" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb320-84"><a href="#cb320-84" aria-hidden="true" tabindex="-1"></a><span class="co">#= 15×2 DataFrame</span></span>
<span id="cb320-85"><a href="#cb320-85" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb320-86"><a href="#cb320-86" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb320-87"><a href="#cb320-87" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb320-88"><a href="#cb320-88" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ vir_nit       0.035675</span></span>
<span id="cb320-89"><a href="#cb320-89" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ vir_lud       0.0188542</span></span>
<span id="cb320-90"><a href="#cb320-90" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ vir_troch     0.0297034</span></span>
<span id="cb320-91"><a href="#cb320-91" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ vir_obs       0.028434</span></span>
<span id="cb320-92"><a href="#cb320-92" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ vir_plumb     0.0382774</span></span>
<span id="cb320-93"><a href="#cb320-93" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_lud       0.0377189</span></span>
<span id="cb320-94"><a href="#cb320-94" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_troch     0.0437711</span></span>
<span id="cb320-95"><a href="#cb320-95" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ nit_obs       0.0424561</span></span>
<span id="cb320-96"><a href="#cb320-96" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ nit_plumb     0.0482994</span></span>
<span id="cb320-97"><a href="#cb320-97" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ lud_troch     0.0303352</span></span>
<span id="cb320-98"><a href="#cb320-98" aria-hidden="true" tabindex="-1"></a><span class="co">  11 │ lud_obs       0.0294719</span></span>
<span id="cb320-99"><a href="#cb320-99" aria-hidden="true" tabindex="-1"></a><span class="co">  12 │ lud_plumb     0.0394332</span></span>
<span id="cb320-100"><a href="#cb320-100" aria-hidden="true" tabindex="-1"></a><span class="co">  13 │ troch_obs     0.0124742</span></span>
<span id="cb320-101"><a href="#cb320-101" aria-hidden="true" tabindex="-1"></a><span class="co">  14 │ troch_plumb   0.0313941</span></span>
<span id="cb320-102"><a href="#cb320-102" aria-hidden="true" tabindex="-1"></a><span class="co">  15 │ obs_plumb     0.0300717 =#</span></span>
<span id="cb320-103"><a href="#cb320-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-104"><a href="#cb320-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb320-105"><a href="#cb320-105" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb320-106"><a href="#cb320-106" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb320-107"><a href="#cb320-107" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb320-108"><a href="#cb320-108" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb320-109"><a href="#cb320-109" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb320-110"><a href="#cb320-110" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb320-111"><a href="#cb320-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-112"><a href="#cb320-112" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb320-113"><a href="#cb320-113" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb320-114"><a href="#cb320-114" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb320-115"><a href="#cb320-115" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb320-116"><a href="#cb320-116" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb320-117"><a href="#cb320-117" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb320-118"><a href="#cb320-118" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb320-119"><a href="#cb320-119" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb320-120"><a href="#cb320-120" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb320-121"><a href="#cb320-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-122"><a href="#cb320-122" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb320-123"><a href="#cb320-123" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb320-124"><a href="#cb320-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-125"><a href="#cb320-125" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb320-126"><a href="#cb320-126" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb320-127"><a href="#cb320-127" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb320-128"><a href="#cb320-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-129"><a href="#cb320-129" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb320-130"><a href="#cb320-130" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb320-131"><a href="#cb320-131" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb320-132"><a href="#cb320-132" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [38 2 41 67 5 68] and the sum of those is 221
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-119-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="119">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 1; 0 0 … 0 0; … ; 0 2 … 2 2; 0 2 … 2 2], [14109120, 14109196, 14109223, 14113908, 14117707, 14117822, 14121642, 14124306, 14127880, 14135008  …  15108025, 15108049, 15108085, 15116504, 15127266, 15129890, 15134320, 15134324, 15177202, 15177253], <span class="ansi-bold">67×34 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir     ⋯
   2 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir
   3 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   4 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
   5 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
   6 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   9 │ GW_Lane5_TL1               GW_Lane5_TL1               TL        vir     ⋯
  10 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir
  11 │ GW_Lane5_TL12              GW_Lane5_TL12              TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  58 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  59 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb   ⋯
  60 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb
  61 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb
  62 │ GW_Armando_plate1_JF29G02  GW_Armando_plate1_JF29G02  ST        plumb
  63 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb   ⋯
  64 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  65 │ GW_Armando_plate1_JG08G01  GW_Armando_plate1_JG08G01  ST        plumb
  66 │ GW_Armando_plate1_JG17G01  GW_Armando_plate1_JG17G01  ST        plumb_v
  67 │ GW_Armando_plate2_JF08G04  GW_Armando_plate2_JF08G04  ST        plumb   ⋯
<span class="ansi-cyan-fg">                                                  31 columns and 46 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-8" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-8">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="6e99ad01" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"vir_lud"</span>,</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud"</span>,</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud_troch"</span>,</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>,</span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumbHet"</span>,</span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"vir_plumb"</span>]</span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"seagreen"</span>,</span>
<span id="cb323-14"><a href="#cb323-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb323-15"><a href="#cb323-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb323-16"><a href="#cb323-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green2"</span>,</span>
<span id="cb323-17"><a href="#cb323-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb323-18"><a href="#cb323-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb323-19"><a href="#cb323-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>,</span>
<span id="cb323-20"><a href="#cb323-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>,</span>
<span id="cb323-21"><a href="#cb323-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">"purple"</span>]</span>
<span id="cb323-22"><a href="#cb323-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-23"><a href="#cb323-23" aria-hidden="true" tabindex="-1"></a>vir_lud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb323-24"><a href="#cb323-24" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="fl">1</span>)</span>
<span id="cb323-25"><a href="#cb323-25" aria-hidden="true" tabindex="-1"></a>lud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb323-26"><a href="#cb323-26" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb323-27"><a href="#cb323-27" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb323-28"><a href="#cb323-28" aria-hidden="true" tabindex="-1"></a>plumbHet <span class="op">=</span> (<span class="fl">7</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb323-29"><a href="#cb323-29" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb323-30"><a href="#cb323-30" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb323-31"><a href="#cb323-31" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb323-32"><a href="#cb323-32" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb323-33"><a href="#cb323-33" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb323-34"><a href="#cb323-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-35"><a href="#cb323-35" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [vir vir_lud nit lud lud_troch troch obs plumb plumbHet vir_plumb]</span>
<span id="cb323-36"><a href="#cb323-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-37"><a href="#cb323-37" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb323-38"><a href="#cb323-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-39"><a href="#cb323-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb323-40"><a href="#cb323-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb323-41"><a href="#cb323-41" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb323-42"><a href="#cb323-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb323-43"><a href="#cb323-43" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb323-44"><a href="#cb323-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-45"><a href="#cb323-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-46"><a href="#cb323-46" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb323-47"><a href="#cb323-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-48"><a href="#cb323-48" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb323-49"><a href="#cb323-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-50"><a href="#cb323-50" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb323-51"><a href="#cb323-51" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb323-52"><a href="#cb323-52" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb323-53"><a href="#cb323-53" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb323-54"><a href="#cb323-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-55"><a href="#cb323-55" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb323-56"><a href="#cb323-56" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb323-57"><a href="#cb323-57" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb323-58"><a href="#cb323-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb323-59"><a href="#cb323-59" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb323-60"><a href="#cb323-60" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb323-61"><a href="#cb323-61" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb323-62"><a href="#cb323-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-63"><a href="#cb323-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb323-64"><a href="#cb323-64" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb323-65"><a href="#cb323-65" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb323-66"><a href="#cb323-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-67"><a href="#cb323-67" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb323-68"><a href="#cb323-68" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb323-69"><a href="#cb323-69" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb323-70"><a href="#cb323-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-71"><a href="#cb323-71" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb323-72"><a href="#cb323-72" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb323-73"><a href="#cb323-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-74"><a href="#cb323-74" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb323-75"><a href="#cb323-75" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb323-76"><a href="#cb323-76" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb323-77"><a href="#cb323-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-78"><a href="#cb323-78" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb323-79"><a href="#cb323-79" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb323-80"><a href="#cb323-80" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb323-81"><a href="#cb323-81" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb323-82"><a href="#cb323-82" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-120-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="120">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 1; 0 0 … 0 0; … ; 0 1 … 1 1; 0 1 … 1 2], [14109120, 14109196, 14109223, 14113908, 14117707, 14117822, 14121642, 14124306, 14127880, 14135008  …  15108025, 15108049, 15108085, 15116504, 15127266, 15129890, 15134320, 15134324, 15177202, 15177253], <span class="ansi-bold">88×34 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir     ⋯
   2 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir
   3 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   4 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
   5 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
   6 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   9 │ GW_Lane5_TL1               GW_Lane5_TL1               TL        vir     ⋯
  10 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir
  11 │ GW_Lane5_TL12              GW_Lane5_TL12              TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  79 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  80 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb   ⋯
  81 │ GW_Armando_plate1_JG08G01  GW_Armando_plate1_JG08G01  ST        plumb
  82 │ GW_Armando_plate1_JG17G01  GW_Armando_plate1_JG17G01  ST        plumb_v
  83 │ GW_Armando_plate2_JF08G04  GW_Armando_plate2_JF08G04  ST        plumb
  84 │ GW_Armando_plate1_JF20G01  GW_Armando_plate1_JF20G01  MB        plumb   ⋯
  85 │ GW_Armando_plate2_JF13G02  GW_Armando_plate2_JF13G02  ST        plumb
  86 │ GW_Armando_plate2_JF12G05  GW_Armando_plate2_JF12G05  ST        plumb
  87 │ GW_Armando_plate2_JF15G01  GW_Armando_plate2_JF15G01  DV        plumb
  88 │ GW_Armando_plate2_JG12G02  GW_Armando_plate2_JG12G02  ST        plumb   ⋯
<span class="ansi-cyan-fg">                                                  31 columns and 67 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order-5" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order-5">show GBI plot according to original groups and plot order</h3>
<div id="1c7408b7" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-121-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="121">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 2 … 2 2; 0 2 … 2 2], [14109120, 14109196, 14109223, 14113908, 14117707, 14117822, 14121642, 14124306, 14127880, 14135008  …  15108025, 15108049, 15108085, 15116504, 15127266, 15129890, 15134320, 15134324, 15177202, 15177253], <span class="ansi-bold">88×34 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   5 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v ⋯
   6 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   7 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
   8 │ GW_Lane5_YK7               GW_Lane5_YK7               YK        vir
   9 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir     ⋯
  10 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
  11 │ GW_Lane5_TL1               GW_Lane5_TL1               TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  79 │ GW_Armando_plate1_JG17G01  GW_Armando_plate1_JG17G01  ST        plumb_v
  80 │ GW_Armando_plate2_JF08G04  GW_Armando_plate2_JF08G04  ST        plumb   ⋯
  81 │ GW_Armando_plate2_JF13G02  GW_Armando_plate2_JF13G02  ST        plumb
  82 │ GW_Armando_plate2_JF12G05  GW_Armando_plate2_JF12G05  ST        plumb
  83 │ GW_Armando_plate2_JG12G02  GW_Armando_plate2_JG12G02  ST        plumb
  84 │ GW_Armando_plate2_JF15G01  GW_Armando_plate2_JF15G01  DV        plumb   ⋯
  85 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  86 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
  87 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  88 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb   ⋯
<span class="ansi-cyan-fg">                                                  31 columns and 67 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals-5" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals-5">show same but with all individuals</h3>
<div id="a42698cf" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb328-14"><a href="#cb328-14" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-122-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="122">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 2 … 2 2; 0 2 … 2 2], [14109120, 14109196, 14109223, 14113908, 14117707, 14117822, 14121642, 14124306, 14127880, 14135008  …  15108025, 15108049, 15108085, 15116504, 15127266, 15129890, 15134320, 15134324, 15177202, 15177253], <span class="ansi-bold">257×34 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 248 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 249 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 250 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 251 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 252 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 253 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 254 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 255 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 256 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 257 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 31 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-vir-and-plumb-pops-3" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-vir-and-plumb-pops-3">show same but with only vir and plumb pops</h3>
<div id="8c839a4b" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"plumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb330-12"><a href="#cb330-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb330-13"><a href="#cb330-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb330-14"><a href="#cb330-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-15"><a href="#cb330-15" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"plumb"</span>, <span class="st">"plumb_vir"</span>] <span class="co"># these are the original Fst_groups</span></span>
<span id="cb330-16"><a href="#cb330-16" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>]</span>
<span id="cb330-17"><a href="#cb330-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-18"><a href="#cb330-18" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb330-19"><a href="#cb330-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-20"><a href="#cb330-20" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb330-21"><a href="#cb330-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-22"><a href="#cb330-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb330-23"><a href="#cb330-23" aria-hidden="true" tabindex="-1"></a>                genosForGBI, metadataForGBI, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb330-24"><a href="#cb330-24" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-123-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="123">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [14109196, 14121642, 14127880, 14152299, 14191715, 14212308, 14234576, 14246931, 14261718, 14282920  …  15059893, 15061446, 15061449, 15084470, 15089863, 15108049, 15127266, 15134320, 15177202, 15177253], <span class="ansi-bold">100×34 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  91 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  92 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  93 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  94 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  95 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  96 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
  97 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  98 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  99 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 100 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  31 columns and 79 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus-6" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-6">Show just the west area (without nitidus)</h3>
<div id="51ca8050" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_lud"</span>,</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"lud"</span>,</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"lud_troch"</span>,</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>]</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"seagreen"</span>,</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green"</span>,</span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green2"</span>,</span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb332-20"><a href="#cb332-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb332-21"><a href="#cb332-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb332-22"><a href="#cb332-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb332-23"><a href="#cb332-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb332-24"><a href="#cb332-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-25"><a href="#cb332-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsWest))</span>
<span id="cb332-26"><a href="#cb332-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-27"><a href="#cb332-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb332-28"><a href="#cb332-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb332-29"><a href="#cb332-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb332-30"><a href="#cb332-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-31"><a href="#cb332-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb332-32"><a href="#cb332-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb332-33"><a href="#cb332-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb332-34"><a href="#cb332-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb332-35"><a href="#cb332-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-124-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="124">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; -99 2 … 2 2; 0 2 … 2 2], [14109120, 14109196, 14109223, 14117707, 14135008, 14152299, 14206380, 14234576, 14234638, 14246931  …  15041158, 15053672, 15059893, 15061446, 15061449, 15090277, 15108025, 15134324, 15177202, 15177253], <span class="ansi-bold">177×34 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 168 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L
 169 │ GW_Lane5_LN6               GW_Lane5_LN6               LN        troch_L ⋯
 170 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L
 171 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
 172 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
 173 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L ⋯
 174 │ GW_Lane5_LN10              GW_Lane5_LN10              LN        troch_L
 175 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L
 176 │ GW_Lane5_LN7               GW_Lane5_LN7               LN        troch_L
 177 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L ⋯
<span class="ansi-cyan-fg">                                                 31 columns and 156 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-7" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area-7">Show just the east area</h3>
<div id="7fdb8ae3" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"obs"</span>,</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>,</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumbHet"</span>]</span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"orange"</span>,</span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>,</span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb335-14"><a href="#cb335-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb335-15"><a href="#cb335-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb335-16"><a href="#cb335-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb335-17"><a href="#cb335-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb335-18"><a href="#cb335-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb335-19"><a href="#cb335-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb335-20"><a href="#cb335-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-21"><a href="#cb335-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb335-22"><a href="#cb335-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-23"><a href="#cb335-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb335-24"><a href="#cb335-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb335-25"><a href="#cb335-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb335-26"><a href="#cb335-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-27"><a href="#cb335-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb335-28"><a href="#cb335-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb335-29"><a href="#cb335-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb335-30"><a href="#cb335-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb335-31"><a href="#cb335-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-125-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="125">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … -99 2], [14121642, 14127880, 14191715, 14206380, 14212308, 14234638, 14261718, 14318327, 14318334, 14327641  …  14985992, 15008548, 15029658, 15034885, 15041158, 15084470, 15089863, 15108049, 15127266, 15134320], <span class="ansi-bold">75×34 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Lane5_EM1               GW_Lane5_EM1               EM        troch_E ⋯
   2 │ GW_Lane5_DA3               GW_Lane5_DA3               XN        obs
   3 │ GW_Lane5_DA7               GW_Lane5_DA7               XN        obs
   4 │ GW_Lane5_DA4               GW_Lane5_DA4               XN        obs
   5 │ GW_Lane5_DA2               GW_Lane5_DA2               XN        obs     ⋯
   6 │ GW_Armando_plate1_RF20G01  GW_Armando_plate1_RF20G01  BJ        obs_plu
   7 │ GW_Armando_plate1_RF29G02  GW_Armando_plate1_RF29G02  BJ        obs_plu
   8 │ GW_Armando_plate2_RF29G01  GW_Armando_plate2_RF29G01  BJ        obs_plu
   9 │ GW_Lane5_BK3               GW_Lane5_BK3               BK        plumb   ⋯
  10 │ GW_Lane5_BK2               GW_Lane5_BK2               BK        plumb
  11 │ GW_Lane5_AN1               GW_Lane5_AN1               AN        plumb
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  66 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  67 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  68 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  69 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  70 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  71 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
  72 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  73 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  74 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
  75 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  31 columns and 54 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-7" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area-7">Show just the northern area</h3>
<div id="16816c26" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>,</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumbHet"</span>]</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>,</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb338-16"><a href="#cb338-16" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb338-17"><a href="#cb338-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb338-18"><a href="#cb338-18" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb338-19"><a href="#cb338-19" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb338-20"><a href="#cb338-20" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb338-21"><a href="#cb338-21" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb338-22"><a href="#cb338-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-23"><a href="#cb338-23" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsNorth))</span>
<span id="cb338-24"><a href="#cb338-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-25"><a href="#cb338-25" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb338-26"><a href="#cb338-26" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb338-27"><a href="#cb338-27" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb338-28"><a href="#cb338-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-29"><a href="#cb338-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb338-30"><a href="#cb338-30" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb338-31"><a href="#cb338-31" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb338-32"><a href="#cb338-32" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb338-33"><a href="#cb338-33" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-126-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="126">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [14109196, 14121642, 14127880, 14152299, 14191715, 14212308, 14234576, 14246931, 14261718, 14282920  …  15059893, 15061446, 15061449, 15084470, 15089863, 15108049, 15127266, 15134320, 15177202, 15177253], <span class="ansi-bold">111×34 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 102 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 103 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 104 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 105 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 106 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 107 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 108 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 109 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 110 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 111 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  31 columns and 90 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="do-a-pca-based-on-a-same-size-region-elsewhere-on-gw13-with-low-vishet" class="level3">
<h3 class="anchored" data-anchor-id="do-a-pca-based-on-a-same-size-region-elsewhere-on-gw13-with-low-vishet">Do a PCA based on a same-size region elsewhere on gw13 (with low ViSHet):</h3>
<div id="5809c24a" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get length of region</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>lengthHighViSHetRegion <span class="op">=</span> positionMax <span class="op">-</span> positionMin</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>leftLocus <span class="op">=</span> <span class="fl">1_000_000</span> <span class="co"># start at 1 Mb from left side</span></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>rightLocus <span class="op">=</span> leftLocus <span class="op">+</span> lengthHighViSHetRegion</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>regionText_lowViSHetRegion <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr "</span>, chr, <span class="st">" "</span>,leftLocus,<span class="st">" to "</span>,rightLocus)</span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>lociSelection <span class="op">=</span> (leftLocus <span class="op">.&lt;=</span> pos_region.position <span class="op">.&lt;=</span> rightLocus)</span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a>genotypes_lowViSHetRegion <span class="op">=</span> genotypes_region[<span class="op">:</span>, lociSelection]</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a><span class="co"># impute missing genotypes:</span></span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a>genotypes_lowViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genotypes_lowViSHetRegion))</span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a>PCAmodel <span class="op">=</span> <span class="fu">plotPCA</span>(genotypes_lowViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText_lowViSHetRegion,</span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb341-26"><a href="#cb341-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-27"><a href="#cb341-27" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodel.PCAfig)</span>
<span id="cb341-28"><a href="#cb341-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb341-29"><a href="#cb341-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"FigureS2B_gw13_nonHLBRarbitrary_from_Julia.png"</span>, PCAmodel.PCAfig, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb341-30"><a href="#cb341-30" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-127-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="tried-chr-14-but-not-very-clearseems-recombination-backcrosses-in-ludlowi" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-14-but-not-very-clearseems-recombination-backcrosses-in-ludlowi">Tried chr 14 but not very clear–seems recombination backcrosses in ludlowi</h2>
</section>
<section id="same-for-chr-17" class="level2">
<h2 class="anchored" data-anchor-id="same-for-chr-17">Same for chr 17</h2>
<section id="shows-a-pattern-seen-in-chr-2-and-others-where-ludlowi-samples-have-some-plumb-haplotypes" class="level3">
<h3 class="anchored" data-anchor-id="shows-a-pattern-seen-in-chr-2-and-others-where-ludlowi-samples-have-some-plumb-haplotypes">Shows a pattern seen in chr 2 (and others) where ludlowi samples have some plumb haplotypes</h3>
<div id="3e883663" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw17"</span></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb343-7"><a href="#cb343-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb343-8"><a href="#cb343-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb343-9"><a href="#cb343-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb343-10"><a href="#cb343-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb343-11"><a href="#cb343-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-12"><a href="#cb343-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb343-13"><a href="#cb343-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb343-14"><a href="#cb343-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-15"><a href="#cb343-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb343-16"><a href="#cb343-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb343-17"><a href="#cb343-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb343-18"><a href="#cb343-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb343-19"><a href="#cb343-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-20"><a href="#cb343-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb343-21"><a href="#cb343-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-22"><a href="#cb343-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb343-23"><a href="#cb343-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb343-24"><a href="#cb343-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-25"><a href="#cb343-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb343-26"><a href="#cb343-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-27"><a href="#cb343-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb343-28"><a href="#cb343-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-29"><a href="#cb343-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb343-30"><a href="#cb343-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb343-31"><a href="#cb343-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-32"><a href="#cb343-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb343-33"><a href="#cb343-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb343-34"><a href="#cb343-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb343-35"><a href="#cb343-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb343-36"><a href="#cb343-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb343-37"><a href="#cb343-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb343-38"><a href="#cb343-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb343-39"><a href="#cb343-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb343-40"><a href="#cb343-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-41"><a href="#cb343-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb343-42"><a href="#cb343-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-43"><a href="#cb343-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb343-44"><a href="#cb343-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb343-45"><a href="#cb343-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb343-46"><a href="#cb343-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb343-47"><a href="#cb343-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb343-48"><a href="#cb343-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb343-49"><a href="#cb343-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb343-50"><a href="#cb343-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb343-51"><a href="#cb343-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb343-52"><a href="#cb343-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb343-53"><a href="#cb343-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb343-54"><a href="#cb343-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb343-55"><a href="#cb343-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-56"><a href="#cb343-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb343-57"><a href="#cb343-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb343-58"><a href="#cb343-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-59"><a href="#cb343-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb343-60"><a href="#cb343-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.4</span>) </span>
<span id="cb343-61"><a href="#cb343-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-62"><a href="#cb343-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb343-63"><a href="#cb343-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-64"><a href="#cb343-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb343-65"><a href="#cb343-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb343-66"><a href="#cb343-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb343-67"><a href="#cb343-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb343-68"><a href="#cb343-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb343-69"><a href="#cb343-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb343-70"><a href="#cb343-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb343-71"><a href="#cb343-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb343-72"><a href="#cb343-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb343-73"><a href="#cb343-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb343-74"><a href="#cb343-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb343-75"><a href="#cb343-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-128-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-128-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="save-the-individual-colors-in-the-metadata-9" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-9">Save the individual colors in the metadata</h3>
<div id="8ffa4d23" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-9" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-9">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="1a633ff3" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-130-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="130">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-9" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-9">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="fc8f895d" class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-131-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<div id="06d40d52" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb356-12"><a href="#cb356-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-13"><a href="#cb356-13" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">6.5</span>) <span class="op">.&amp;</span></span>
<span id="cb356-14"><a href="#cb356-14" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">0.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb356-15"><a href="#cb356-15" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb356-16"><a href="#cb356-16" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">6</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4.5</span>) <span class="op">.&amp;</span></span>
<span id="cb356-17"><a href="#cb356-17" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">0.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb356-18"><a href="#cb356-18" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb356-19"><a href="#cb356-19" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">4.5</span>) <span class="op">.&amp;</span></span>
<span id="cb356-20"><a href="#cb356-20" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb356-21"><a href="#cb356-21" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb356-22"><a href="#cb356-22" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="fl">1.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb356-23"><a href="#cb356-23" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">3.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb356-24"><a href="#cb356-24" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb356-25"><a href="#cb356-25" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">3.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb356-26"><a href="#cb356-26" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb356-27"><a href="#cb356-27" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb356-28"><a href="#cb356-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-29"><a href="#cb356-29" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb356-30"><a href="#cb356-30" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb356-31"><a href="#cb356-31" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb356-32"><a href="#cb356-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb356-33"><a href="#cb356-33" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb356-34"><a href="#cb356-34" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb356-35"><a href="#cb356-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-36"><a href="#cb356-36" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit troch obs plumb]</span>
<span id="cb356-37"><a href="#cb356-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-38"><a href="#cb356-38" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb356-39"><a href="#cb356-39" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb356-40"><a href="#cb356-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-41"><a href="#cb356-41" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb356-42"><a href="#cb356-42" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb356-43"><a href="#cb356-43" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb356-44"><a href="#cb356-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb356-45"><a href="#cb356-45" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb356-46"><a href="#cb356-46" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb356-47"><a href="#cb356-47" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb356-48"><a href="#cb356-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-49"><a href="#cb356-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb356-50"><a href="#cb356-50" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb356-51"><a href="#cb356-51" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb356-52"><a href="#cb356-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-53"><a href="#cb356-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb356-54"><a href="#cb356-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-55"><a href="#cb356-55" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb356-56"><a href="#cb356-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-57"><a href="#cb356-57" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb356-58"><a href="#cb356-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-59"><a href="#cb356-59" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb356-60"><a href="#cb356-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-61"><a href="#cb356-61" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb356-62"><a href="#cb356-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-63"><a href="#cb356-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb356-64"><a href="#cb356-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-65"><a href="#cb356-65" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb356-66"><a href="#cb356-66" aria-hidden="true" tabindex="-1"></a><span class="co">#= 5×2 DataFrame</span></span>
<span id="cb356-67"><a href="#cb356-67" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb356-68"><a href="#cb356-68" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb356-69"><a href="#cb356-69" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb356-70"><a href="#cb356-70" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud   0.0116354</span></span>
<span id="cb356-71"><a href="#cb356-71" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.0010142</span></span>
<span id="cb356-72"><a href="#cb356-72" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch    0.00706002</span></span>
<span id="cb356-73"><a href="#cb356-73" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obs      0.0162496</span></span>
<span id="cb356-74"><a href="#cb356-74" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ plumb    0.00402182 =#</span></span>
<span id="cb356-75"><a href="#cb356-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-76"><a href="#cb356-76" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb356-77"><a href="#cb356-77" aria-hidden="true" tabindex="-1"></a><span class="co">#= 10×2 DataFrame</span></span>
<span id="cb356-78"><a href="#cb356-78" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb356-79"><a href="#cb356-79" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb356-80"><a href="#cb356-80" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb356-81"><a href="#cb356-81" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit    0.021495</span></span>
<span id="cb356-82"><a href="#cb356-82" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch  0.0329751</span></span>
<span id="cb356-83"><a href="#cb356-83" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obs    0.0328026</span></span>
<span id="cb356-84"><a href="#cb356-84" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ virLud_plumb  0.0354124</span></span>
<span id="cb356-85"><a href="#cb356-85" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_troch     0.0339931</span></span>
<span id="cb356-86"><a href="#cb356-86" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_obs       0.0337221</span></span>
<span id="cb356-87"><a href="#cb356-87" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_plumb     0.036556</span></span>
<span id="cb356-88"><a href="#cb356-88" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ troch_obs     0.0201926</span></span>
<span id="cb356-89"><a href="#cb356-89" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ troch_plumb   0.0240156</span></span>
<span id="cb356-90"><a href="#cb356-90" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ obs_plumb     0.0195389 =#</span></span>
<span id="cb356-91"><a href="#cb356-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-92"><a href="#cb356-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb356-93"><a href="#cb356-93" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb356-94"><a href="#cb356-94" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb356-95"><a href="#cb356-95" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb356-96"><a href="#cb356-96" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb356-97"><a href="#cb356-97" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb356-98"><a href="#cb356-98" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb356-99"><a href="#cb356-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-100"><a href="#cb356-100" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb356-101"><a href="#cb356-101" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb356-102"><a href="#cb356-102" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb356-103"><a href="#cb356-103" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb356-104"><a href="#cb356-104" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb356-105"><a href="#cb356-105" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb356-106"><a href="#cb356-106" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb356-107"><a href="#cb356-107" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb356-108"><a href="#cb356-108" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb356-109"><a href="#cb356-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-110"><a href="#cb356-110" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb356-111"><a href="#cb356-111" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb356-112"><a href="#cb356-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-113"><a href="#cb356-113" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb356-114"><a href="#cb356-114" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb356-115"><a href="#cb356-115" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb356-116"><a href="#cb356-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-117"><a href="#cb356-117" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb356-118"><a href="#cb356-118" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb356-119"><a href="#cb356-119" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb356-120"><a href="#cb356-120" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [73 2 62 3 64] and the sum of those is 204
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-132-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="132">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 0 2; 2 2 … 0 2], [11771696, 11771805, 11824912, 11824930, 11840181, 11843613, 11854001, 11854002, 11862254, 11865895  …  12545202, 12545274, 12550749, 12556180, 12562225, 12562314, 12582178, 12584065, 12586755, 12623539], <span class="ansi-bold">50×36 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_TTGW53      GW_Armando_plate1_TTGW53      NG        l
   3 │ GW_Armando_plate1_TTGW58      GW_Armando_plate1_TTGW58      NG        l
   4 │ GW_Armando_plate1_TTGW-15-09  GW_Armando_plate1_TTGW-15-09  SR        l
   5 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v ⋯
   6 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
   7 │ GW_Armando_plate2_JF30G01     GW_Armando_plate2_JF30G01     ST_vi     v
   8 │ GW_Armando_plate2_TTGW16      GW_Armando_plate2_TTGW16      TH        l
   9 │ GW_Armando_plate2_TTGW18      GW_Armando_plate2_TTGW18      TH        l ⋯
  10 │ GW_Armando_plate2_TTGW56      GW_Armando_plate2_TTGW56      NG        l
  11 │ GW_Armando_plate2_TTGW-15-03  GW_Armando_plate2_TTGW-15-03  SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  41 │ GW_Armando_plate1_JF12G02     GW_Armando_plate1_JF12G02     ST        p
  42 │ GW_Armando_plate1_JF13G01     GW_Armando_plate1_JF13G01     ST        p ⋯
  43 │ GW_Armando_plate1_JF15G03     GW_Armando_plate1_JF15G03     DV        p
  44 │ GW_Armando_plate1_JF22G01     GW_Armando_plate1_JF22G01     MB        p
  45 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
  46 │ GW_Armando_plate1_JF26G01     GW_Armando_plate1_JF26G01     ST        p ⋯
  47 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  48 │ GW_Armando_plate1_JF29G02     GW_Armando_plate1_JF29G02     ST        p
  49 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p
  50 │ GW_Armando_plate1_JG02G04     GW_Armando_plate1_JG02G04     PR        p ⋯
<span class="ansi-cyan-fg">                                                  33 columns and 29 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-9" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-9">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="fef6db0f" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"nit"</span>,</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_troch"</span>,</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_obs"</span>,</span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obs"</span>,</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch_plumb"</span>,</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"plumb"</span>,</span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"vir_plumb"</span>]</span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grey"</span>,</span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green"</span>,</span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"olive"</span>,</span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"orange"</span>,</span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"coral"</span>,</span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"red"</span>,</span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"purple"</span>]</span>
<span id="cb359-20"><a href="#cb359-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-21"><a href="#cb359-21" aria-hidden="true" tabindex="-1"></a>virLud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb359-22"><a href="#cb359-22" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">0.7</span>) <span class="op">.&amp;</span></span>
<span id="cb359-23"><a href="#cb359-23" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb359-24"><a href="#cb359-24" aria-hidden="true" tabindex="-1"></a>virLud_obs <span class="op">=</span> (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb359-25"><a href="#cb359-25" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">0.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb359-26"><a href="#cb359-26" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb359-27"><a href="#cb359-27" aria-hidden="true" tabindex="-1"></a>troch_plumb <span class="op">=</span> (<span class="fl">1.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5.5</span>) <span class="op">.&amp;</span></span>
<span id="cb359-28"><a href="#cb359-28" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb359-29"><a href="#cb359-29" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb359-30"><a href="#cb359-30" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb359-31"><a href="#cb359-31" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb359-32"><a href="#cb359-32" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb359-33"><a href="#cb359-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-34"><a href="#cb359-34" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit virLud_troch troch virLud_obs obs troch_plumb plumb vir_plumb]</span>
<span id="cb359-35"><a href="#cb359-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-36"><a href="#cb359-36" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb359-37"><a href="#cb359-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-38"><a href="#cb359-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb359-39"><a href="#cb359-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb359-40"><a href="#cb359-40" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb359-41"><a href="#cb359-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb359-42"><a href="#cb359-42" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb359-43"><a href="#cb359-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-44"><a href="#cb359-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-45"><a href="#cb359-45" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb359-46"><a href="#cb359-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-47"><a href="#cb359-47" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb359-48"><a href="#cb359-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-49"><a href="#cb359-49" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb359-50"><a href="#cb359-50" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb359-51"><a href="#cb359-51" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb359-52"><a href="#cb359-52" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb359-53"><a href="#cb359-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-54"><a href="#cb359-54" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb359-55"><a href="#cb359-55" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb359-56"><a href="#cb359-56" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb359-57"><a href="#cb359-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb359-58"><a href="#cb359-58" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb359-59"><a href="#cb359-59" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb359-60"><a href="#cb359-60" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb359-61"><a href="#cb359-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-62"><a href="#cb359-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb359-63"><a href="#cb359-63" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb359-64"><a href="#cb359-64" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb359-65"><a href="#cb359-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-66"><a href="#cb359-66" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb359-67"><a href="#cb359-67" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb359-68"><a href="#cb359-68" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb359-69"><a href="#cb359-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-70"><a href="#cb359-70" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb359-71"><a href="#cb359-71" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb359-72"><a href="#cb359-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-73"><a href="#cb359-73" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb359-74"><a href="#cb359-74" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb359-75"><a href="#cb359-75" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb359-76"><a href="#cb359-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-77"><a href="#cb359-77" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb359-78"><a href="#cb359-78" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb359-79"><a href="#cb359-79" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb359-80"><a href="#cb359-80" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb359-81"><a href="#cb359-81" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-133-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="133">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 1 … 0 1; 1 2 … 0 1], [11771696, 11771805, 11824912, 11824930, 11840181, 11843613, 11854001, 11854002, 11862254, 11865895  …  12545202, 12545274, 12550749, 12556180, 12562225, 12562314, 12582178, 12584065, 12586755, 12623539], <span class="ansi-bold">257×36 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_TTGW53      GW_Armando_plate1_TTGW53      NG        l
   3 │ GW_Armando_plate1_TTGW58      GW_Armando_plate1_TTGW58      NG        l
   4 │ GW_Armando_plate1_TTGW-15-09  GW_Armando_plate1_TTGW-15-09  SR        l
   5 │ GW_Armando_plate2_JE31G01     GW_Armando_plate2_JE31G01     VB_vi     v ⋯
   6 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
   7 │ GW_Armando_plate2_JF30G01     GW_Armando_plate2_JF30G01     ST_vi     v
   8 │ GW_Armando_plate2_TTGW16      GW_Armando_plate2_TTGW16      TH        l
   9 │ GW_Armando_plate2_TTGW18      GW_Armando_plate2_TTGW18      TH        l ⋯
  10 │ GW_Armando_plate2_TTGW56      GW_Armando_plate2_TTGW56      NG        l
  11 │ GW_Armando_plate2_TTGW-15-03  GW_Armando_plate2_TTGW-15-03  SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 248 │ GW_Armando_plate2_JF10G02     GW_Armando_plate2_JF10G02     ST        p
 249 │ GW_Armando_plate2_JF14G01     GW_Armando_plate2_JF14G01     DV        p ⋯
 250 │ GW_Armando_plate2_JG12G02     GW_Armando_plate2_JG12G02     ST        p
 251 │ GW_Armando_plate2_TTGW24      GW_Armando_plate2_TTGW24      SR        l
 252 │ GW_Armando_plate2_TTGW25      GW_Armando_plate2_TTGW25      SR        l
 253 │ GW_Armando_plate2_TTGW-15-01  GW_Armando_plate2_TTGW-15-01  SR        l ⋯
 254 │ GW_Armando_plate2_JF08G04     GW_Armando_plate2_JF08G04     ST        p
 255 │ GW_Lane5_UY6                  GW_Lane5_UY6                  UY        p
 256 │ GW_Armando_plate2_TTGW-15-10  GW_Armando_plate2_TTGW-15-10  SR        l
 257 │ GW_Lane5_UY3                  GW_Lane5_UY3                  UY        p ⋯
<span class="ansi-cyan-fg">                                                 33 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="chr-17-above-shows-interesting-pattern-with-plumb-haplotype-more-widespreadfound-in-ludlowi-and-the-obscuratus-pattern-complex-with-recombination.-i-checked-chr-17-carefully-in-the-summary-plot-and-it-looks-good." class="level3">
<h3 class="anchored" data-anchor-id="chr-17-above-shows-interesting-pattern-with-plumb-haplotype-more-widespreadfound-in-ludlowi-and-the-obscuratus-pattern-complex-with-recombination.-i-checked-chr-17-carefully-in-the-summary-plot-and-it-looks-good.">Chr 17 above shows interesting pattern with plumb haplotype more widespread–found in ludlowi, and the obscuratus pattern complex with recombination. I checked chr 17 carefully in the summary plot, and it looks good.</h3>
</section>
</section>
<section id="same-for-chr-19" class="level2">
<h2 class="anchored" data-anchor-id="same-for-chr-19">Same for chr 19</h2>
<div id="0769ef36" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw19"</span></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb362-11"><a href="#cb362-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-12"><a href="#cb362-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb362-13"><a href="#cb362-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb362-14"><a href="#cb362-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-15"><a href="#cb362-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb362-16"><a href="#cb362-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb362-17"><a href="#cb362-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb362-18"><a href="#cb362-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb362-19"><a href="#cb362-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-20"><a href="#cb362-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb362-21"><a href="#cb362-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-22"><a href="#cb362-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb362-23"><a href="#cb362-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb362-24"><a href="#cb362-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-25"><a href="#cb362-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb362-26"><a href="#cb362-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-27"><a href="#cb362-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb362-28"><a href="#cb362-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-29"><a href="#cb362-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb362-30"><a href="#cb362-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb362-31"><a href="#cb362-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-32"><a href="#cb362-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb362-33"><a href="#cb362-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb362-34"><a href="#cb362-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb362-35"><a href="#cb362-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb362-36"><a href="#cb362-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb362-37"><a href="#cb362-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb362-38"><a href="#cb362-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb362-39"><a href="#cb362-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb362-40"><a href="#cb362-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-41"><a href="#cb362-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb362-42"><a href="#cb362-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-43"><a href="#cb362-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb362-44"><a href="#cb362-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb362-45"><a href="#cb362-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb362-46"><a href="#cb362-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb362-47"><a href="#cb362-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb362-48"><a href="#cb362-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb362-49"><a href="#cb362-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb362-50"><a href="#cb362-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb362-51"><a href="#cb362-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb362-52"><a href="#cb362-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb362-53"><a href="#cb362-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb362-54"><a href="#cb362-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb362-55"><a href="#cb362-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-56"><a href="#cb362-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb362-57"><a href="#cb362-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb362-58"><a href="#cb362-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-59"><a href="#cb362-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb362-60"><a href="#cb362-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.5</span>) </span>
<span id="cb362-61"><a href="#cb362-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-62"><a href="#cb362-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb362-63"><a href="#cb362-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-64"><a href="#cb362-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb362-65"><a href="#cb362-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb362-66"><a href="#cb362-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb362-67"><a href="#cb362-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb362-68"><a href="#cb362-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb362-69"><a href="#cb362-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb362-70"><a href="#cb362-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb362-71"><a href="#cb362-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb362-72"><a href="#cb362-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb362-73"><a href="#cb362-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb362-74"><a href="#cb362-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb362-75"><a href="#cb362-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-134-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-134-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-10" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-10">Save the individual colors in the metadata</h3>
<div id="c15ab8a4" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-10" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-10">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="b19f8b8b" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-136-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="136">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-10" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-10">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="89f75fa2" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-137-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-19-high-vishet-region-there-are-4-clear-homozygous-haplogroups-vir-and-lud-separated-though-on-pc3-but-not-clearly-enough-to-show-in-summary-plot.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-19-high-vishet-region-there-are-4-clear-homozygous-haplogroups-vir-and-lud-separated-though-on-pc3-but-not-clearly-enough-to-show-in-summary-plot.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 19 high ViSHet region, there are 4 clear homozygous haplogroups (vir and lud separated though on PC3, but not clearly enough to show in summary plot). Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="442405db" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"trochObs"</span>,</span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb375-14"><a href="#cb375-14" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb375-15"><a href="#cb375-15" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb375-16"><a href="#cb375-16" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb375-17"><a href="#cb375-17" aria-hidden="true" tabindex="-1"></a>trochObs <span class="op">=</span> (<span class="op">-</span><span class="fl">1.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb375-18"><a href="#cb375-18" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">3.5</span>) <span class="op">.&amp;</span></span>
<span id="cb375-19"><a href="#cb375-19" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb375-20"><a href="#cb375-20" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span> </span>
<span id="cb375-21"><a href="#cb375-21" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">1.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb375-22"><a href="#cb375-22" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb375-23"><a href="#cb375-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-24"><a href="#cb375-24" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb375-25"><a href="#cb375-25" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb375-26"><a href="#cb375-26" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb375-27"><a href="#cb375-27" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[trochObs]</span>
<span id="cb375-28"><a href="#cb375-28" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb375-29"><a href="#cb375-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-30"><a href="#cb375-30" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit trochObs plumb]</span>
<span id="cb375-31"><a href="#cb375-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-32"><a href="#cb375-32" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb375-33"><a href="#cb375-33" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb375-34"><a href="#cb375-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-35"><a href="#cb375-35" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb375-36"><a href="#cb375-36" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb375-37"><a href="#cb375-37" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb375-38"><a href="#cb375-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb375-39"><a href="#cb375-39" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb375-40"><a href="#cb375-40" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb375-41"><a href="#cb375-41" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb375-42"><a href="#cb375-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-43"><a href="#cb375-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb375-44"><a href="#cb375-44" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb375-45"><a href="#cb375-45" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb375-46"><a href="#cb375-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-47"><a href="#cb375-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb375-48"><a href="#cb375-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-49"><a href="#cb375-49" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb375-50"><a href="#cb375-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-51"><a href="#cb375-51" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb375-52"><a href="#cb375-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-53"><a href="#cb375-53" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb375-54"><a href="#cb375-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-55"><a href="#cb375-55" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb375-56"><a href="#cb375-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-57"><a href="#cb375-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb375-58"><a href="#cb375-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-59"><a href="#cb375-59" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb375-60"><a href="#cb375-60" aria-hidden="true" tabindex="-1"></a><span class="co">#= 4×2 DataFrame</span></span>
<span id="cb375-61"><a href="#cb375-61" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster   pi         </span></span>
<span id="cb375-62"><a href="#cb375-62" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String    Float64    </span></span>
<span id="cb375-63"><a href="#cb375-63" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼──────────────────────</span></span>
<span id="cb375-64"><a href="#cb375-64" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud    0.0144925</span></span>
<span id="cb375-65"><a href="#cb375-65" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit       0.0052608</span></span>
<span id="cb375-66"><a href="#cb375-66" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ trochObs  0.0150341</span></span>
<span id="cb375-67"><a href="#cb375-67" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ plumb     0.00320386 =#</span></span>
<span id="cb375-68"><a href="#cb375-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-69"><a href="#cb375-69" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb375-70"><a href="#cb375-70" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb375-71"><a href="#cb375-71" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair     Dxy       </span></span>
<span id="cb375-72"><a href="#cb375-72" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String           Float64   </span></span>
<span id="cb375-73"><a href="#cb375-73" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼────────────────────────────</span></span>
<span id="cb375-74"><a href="#cb375-74" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit       0.0291485</span></span>
<span id="cb375-75"><a href="#cb375-75" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_trochObs  0.0330435</span></span>
<span id="cb375-76"><a href="#cb375-76" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_plumb     0.0347335</span></span>
<span id="cb375-77"><a href="#cb375-77" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ nit_trochObs     0.0359384</span></span>
<span id="cb375-78"><a href="#cb375-78" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_plumb        0.0373399</span></span>
<span id="cb375-79"><a href="#cb375-79" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ trochObs_plumb   0.0289202 =#</span></span>
<span id="cb375-80"><a href="#cb375-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-81"><a href="#cb375-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb375-82"><a href="#cb375-82" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb375-83"><a href="#cb375-83" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb375-84"><a href="#cb375-84" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb375-85"><a href="#cb375-85" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb375-86"><a href="#cb375-86" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb375-87"><a href="#cb375-87" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb375-88"><a href="#cb375-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-89"><a href="#cb375-89" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb375-90"><a href="#cb375-90" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb375-91"><a href="#cb375-91" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb375-92"><a href="#cb375-92" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb375-93"><a href="#cb375-93" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb375-94"><a href="#cb375-94" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb375-95"><a href="#cb375-95" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb375-96"><a href="#cb375-96" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb375-97"><a href="#cb375-97" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb375-98"><a href="#cb375-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-99"><a href="#cb375-99" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb375-100"><a href="#cb375-100" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb375-101"><a href="#cb375-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-102"><a href="#cb375-102" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb375-103"><a href="#cb375-103" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb375-104"><a href="#cb375-104" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb375-105"><a href="#cb375-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-106"><a href="#cb375-106" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb375-107"><a href="#cb375-107" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb375-108"><a href="#cb375-108" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb375-109"><a href="#cb375-109" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [70 2 67 66] and the sum of those is 205
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-138-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="138">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [63088, 70570, 71423, 74630, 78271, 89983, 89997, 132730, 153219, 167981  …  925752, 925762, 925928, 939829, 945566, 950361, 952095, 975932, 976062, 984894], <span class="ansi-bold">47×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   3 │ GW_Armando_plate1_TTGW10      GW_Armando_plate1_TTGW10      SU        l
   4 │ GW_Armando_plate1_TTGW22      GW_Armando_plate1_TTGW22      SR        l
   5 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l ⋯
   6 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l
   7 │ GW_Armando_plate2_JF03G01     GW_Armando_plate2_JF03G01     ST_vi     v
   8 │ GW_Armando_plate2_JF03G02     GW_Armando_plate2_JF03G02     VB_vi     v
   9 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p ⋯
  10 │ GW_Armando_plate2_TTGW12      GW_Armando_plate2_TTGW12      TH        l
  11 │ GW_Armando_plate2_TTGW14      GW_Armando_plate2_TTGW14      TH        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  38 │ GW_Armando_plate1_JF15G03     GW_Armando_plate1_JF15G03     DV        p
  39 │ GW_Armando_plate1_JF23G01     GW_Armando_plate1_JF23G01     VB        p ⋯
  40 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
  41 │ GW_Armando_plate1_JF26G01     GW_Armando_plate1_JF26G01     ST        p
  42 │ GW_Armando_plate1_JF27G01     GW_Armando_plate1_JF27G01     ST        p
  43 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p ⋯
  44 │ GW_Armando_plate1_JF29G02     GW_Armando_plate1_JF29G02     ST        p
  45 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p
  46 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
  47 │ GW_Armando_plate1_JG12G01     GW_Armando_plate1_JG12G01     ST        p ⋯
<span class="ansi-cyan-fg">                                                  35 columns and 26 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-10" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-10">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="6e7033b8" class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"virLudHet"</span>,</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"virLud_trochObs"</span>,</span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"trochObs"</span>,</span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"trochObsHet"</span>,</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"trochObs_plumb"</span>,</span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>,</span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"vir_plumb"</span>]</span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"blue"</span>,</span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb378-15"><a href="#cb378-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb378-16"><a href="#cb378-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb378-17"><a href="#cb378-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb378-18"><a href="#cb378-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>,</span>
<span id="cb378-19"><a href="#cb378-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">"purple"</span>]</span>
<span id="cb378-20"><a href="#cb378-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-21"><a href="#cb378-21" aria-hidden="true" tabindex="-1"></a>virLudHet <span class="op">=</span> (<span class="op">-</span><span class="fl">8</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb378-22"><a href="#cb378-22" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">1.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb378-23"><a href="#cb378-23" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb378-24"><a href="#cb378-24" aria-hidden="true" tabindex="-1"></a>virLud_trochObs <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb378-25"><a href="#cb378-25" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span></span>
<span id="cb378-26"><a href="#cb378-26" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb378-27"><a href="#cb378-27" aria-hidden="true" tabindex="-1"></a>trochObsHet <span class="op">=</span> (<span class="op">-</span><span class="fl">1.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb378-28"><a href="#cb378-28" aria-hidden="true" tabindex="-1"></a>                (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">3.5</span>) <span class="op">.&amp;</span></span>
<span id="cb378-29"><a href="#cb378-29" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb378-30"><a href="#cb378-30" aria-hidden="true" tabindex="-1"></a>trochObs_plumb <span class="op">=</span> (<span class="fl">1.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb378-31"><a href="#cb378-31" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">3.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb378-32"><a href="#cb378-32" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb378-33"><a href="#cb378-33" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">1</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb378-34"><a href="#cb378-34" aria-hidden="true" tabindex="-1"></a>                (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb378-35"><a href="#cb378-35" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb378-36"><a href="#cb378-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-37"><a href="#cb378-37" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud virLudHet nit virLud_trochObs trochObs trochObsHet trochObs_plumb plumb vir_plumb]</span>
<span id="cb378-38"><a href="#cb378-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-39"><a href="#cb378-39" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb378-40"><a href="#cb378-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-41"><a href="#cb378-41" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb378-42"><a href="#cb378-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb378-43"><a href="#cb378-43" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb378-44"><a href="#cb378-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb378-45"><a href="#cb378-45" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb378-46"><a href="#cb378-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-47"><a href="#cb378-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-48"><a href="#cb378-48" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb378-49"><a href="#cb378-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-50"><a href="#cb378-50" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb378-51"><a href="#cb378-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-52"><a href="#cb378-52" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb378-53"><a href="#cb378-53" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb378-54"><a href="#cb378-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb378-55"><a href="#cb378-55" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb378-56"><a href="#cb378-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-57"><a href="#cb378-57" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb378-58"><a href="#cb378-58" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb378-59"><a href="#cb378-59" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb378-60"><a href="#cb378-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb378-61"><a href="#cb378-61" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb378-62"><a href="#cb378-62" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb378-63"><a href="#cb378-63" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb378-64"><a href="#cb378-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-65"><a href="#cb378-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb378-66"><a href="#cb378-66" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb378-67"><a href="#cb378-67" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb378-68"><a href="#cb378-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-69"><a href="#cb378-69" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb378-70"><a href="#cb378-70" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb378-71"><a href="#cb378-71" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb378-72"><a href="#cb378-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-73"><a href="#cb378-73" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb378-74"><a href="#cb378-74" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb378-75"><a href="#cb378-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-76"><a href="#cb378-76" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb378-77"><a href="#cb378-77" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb378-78"><a href="#cb378-78" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb378-79"><a href="#cb378-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-80"><a href="#cb378-80" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb378-81"><a href="#cb378-81" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb378-82"><a href="#cb378-82" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb378-83"><a href="#cb378-83" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb378-84"><a href="#cb378-84" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-139-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="139">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 1 … 1 1; 2 1 … -99 1], [63088, 70570, 71423, 74630, 78271, 89983, 89997, 132730, 153219, 167981  …  925752, 925762, 925928, 939829, 945566, 950361, 952095, 975932, 976062, 984894], <span class="ansi-bold">82×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1         GW_Armando_plate1_AB1         AB        v ⋯
   2 │ GW_Armando_plate1_TL3         GW_Armando_plate1_TL3         TL        v
   3 │ GW_Armando_plate1_TTGW10      GW_Armando_plate1_TTGW10      SU        l
   4 │ GW_Armando_plate1_TTGW22      GW_Armando_plate1_TTGW22      SR        l
   5 │ GW_Armando_plate1_TTGW57      GW_Armando_plate1_TTGW57      NG        l ⋯
   6 │ GW_Armando_plate1_TTGW-15-07  GW_Armando_plate1_TTGW-15-07  SR        l
   7 │ GW_Armando_plate2_JF03G01     GW_Armando_plate2_JF03G01     ST_vi     v
   8 │ GW_Armando_plate2_JF03G02     GW_Armando_plate2_JF03G02     VB_vi     v
   9 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p ⋯
  10 │ GW_Armando_plate2_TTGW12      GW_Armando_plate2_TTGW12      TH        l
  11 │ GW_Armando_plate2_TTGW14      GW_Armando_plate2_TTGW14      TH        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  73 │ GW_Armando_plate1_JF29G01     GW_Armando_plate1_JF29G01     ST        p
  74 │ GW_Armando_plate1_JF29G02     GW_Armando_plate1_JF29G02     ST        p ⋯
  75 │ GW_Armando_plate1_JF29G03     GW_Armando_plate1_JF29G03     ST        p
  76 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
  77 │ GW_Armando_plate1_JG12G01     GW_Armando_plate1_JG12G01     ST        p
  78 │ GW_Armando_plate1_JF07G03     GW_Armando_plate1_JF07G03     ST        p ⋯
  79 │ GW_Armando_plate1_JF10G03     GW_Armando_plate1_JF10G03     ST        p
  80 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p
  81 │ GW_Armando_plate2_JF15G01     GW_Armando_plate2_JF15G01     DV        p
  82 │ GW_Armando_plate1_JF12G02     GW_Armando_plate1_JF12G02     ST        p ⋯
<span class="ansi-cyan-fg">                                                  35 columns and 61 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order-6" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order-6">show GBI plot according to original groups and plot order</h3>
<div id="a4aa1ae3" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb381-11"><a href="#cb381-11" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-140-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="140">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 0 1 … 1 2], [63088, 70570, 71423, 74630, 78271, 89983, 89997, 132730, 153219, 167981  …  925752, 925762, 925928, 939829, 945566, 950361, 952095, 975932, 976062, 984894], <span class="ansi-bold">82×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   4 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
   5 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir     ⋯
   6 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
   7 │ GW_Lane5_TU1               GW_Lane5_TU1               TU        nit
   8 │ GW_Lane5_TU2               GW_Lane5_TU2               TU        nit
   9 │ GW_Armando_plate1_TTGW72   GW_Armando_plate1_TTGW72   SA        lud_Sat ⋯
  10 │ GW_Armando_plate1_TTGW78   GW_Armando_plate1_TTGW78   SA        lud_Sat
  11 │ GW_Armando_plate2_TTGW77   GW_Armando_plate2_TTGW77   SA        lud_Sat
  ⋮  │             ⋮                          ⋮                 ⋮            ⋮ ⋱
  73 │ GW_Armando_plate1_JG12G01  GW_Armando_plate1_JG12G01  ST        plumb
  74 │ GW_Armando_plate1_JF07G03  GW_Armando_plate1_JF07G03  ST        plumb   ⋯
  75 │ GW_Armando_plate1_JF12G02  GW_Armando_plate1_JF12G02  ST        plumb
  76 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
  77 │ GW_Armando_plate2_JF15G01  GW_Armando_plate2_JF15G01  DV        plumb
  78 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb   ⋯
  79 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  80 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
  81 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  82 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  35 columns and 61 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals-6" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals-6">show same but with all individuals</h3>
<div id="97cf6d3b" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb383-9"><a href="#cb383-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-10"><a href="#cb383-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb383-11"><a href="#cb383-11" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb383-12"><a href="#cb383-12" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb383-13"><a href="#cb383-13" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb383-14"><a href="#cb383-14" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-141-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="141">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 0 1 … 1 2], [63088, 70570, 71423, 74630, 78271, 89983, 89997, 132730, 153219, 167981  …  925752, 925762, 925928, 939829, 945566, 950361, 952095, 975932, 976062, 984894], <span class="ansi-bold">257×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 248 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb
 249 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb   ⋯
 250 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 251 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 252 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 253 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 254 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 255 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 256 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 257 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 35 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-vir-and-plumb-pops-4" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-vir-and-plumb-pops-4">show same but with only vir and plumb pops</h3>
<div id="272c01a8" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"virLud"</span>, <span class="st">"plumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb385-10"><a href="#cb385-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb385-11"><a href="#cb385-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb385-12"><a href="#cb385-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb385-13"><a href="#cb385-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb385-14"><a href="#cb385-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-15"><a href="#cb385-15" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"plumb"</span>, <span class="st">"plumb_vir"</span>] <span class="co"># these are the original Fst_groups</span></span>
<span id="cb385-16"><a href="#cb385-16" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>]</span>
<span id="cb385-17"><a href="#cb385-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-18"><a href="#cb385-18" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb385-19"><a href="#cb385-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-20"><a href="#cb385-20" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb385-21"><a href="#cb385-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-22"><a href="#cb385-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb385-23"><a href="#cb385-23" aria-hidden="true" tabindex="-1"></a>                genosForGBI, metadataForGBI, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb385-24"><a href="#cb385-24" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-142-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="142">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 0 1 … 1 2], [63088, 70570, 71423, 78271, 89983, 153219, 199863, 252463, 296231, 423565  …  882012, 900073, 925752, 925928, 939829, 945566, 952095, 975932, 976062, 984894], <span class="ansi-bold">100×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  91 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  92 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  93 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  94 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  95 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  96 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
  97 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  98 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  99 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 100 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  35 columns and 79 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-vir-lud-troch-pops-1" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-vir-lud-troch-pops-1">show same but with only vir lud troch pops</h3>
<div id="7a21531a" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"virLud"</span>, <span class="st">"trochObs"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb387-10"><a href="#cb387-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb387-11"><a href="#cb387-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb387-12"><a href="#cb387-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb387-13"><a href="#cb387-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb387-14"><a href="#cb387-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-15"><a href="#cb387-15" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb387-16"><a href="#cb387-16" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb387-17"><a href="#cb387-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-18"><a href="#cb387-18" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"vir_S"</span>, <span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>, <span class="st">"troch_west"</span>, <span class="st">"troch_LN"</span>]</span>
<span id="cb387-19"><a href="#cb387-19" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>, <span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>]</span>
<span id="cb387-20"><a href="#cb387-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-21"><a href="#cb387-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb387-22"><a href="#cb387-22" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">10</span>, <span class="fu">length</span>(plotGroups))</span>
<span id="cb387-23"><a href="#cb387-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-24"><a href="#cb387-24" aria-hidden="true" tabindex="-1"></a>genosForGBI_limited, indMetadataforGBI_limited <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(plotGroups,</span>
<span id="cb387-25"><a href="#cb387-25" aria-hidden="true" tabindex="-1"></a>                                            numIndsToPlotWithHets, </span>
<span id="cb387-26"><a href="#cb387-26" aria-hidden="true" tabindex="-1"></a>                                            genosForGBI, metadataForGBI;</span>
<span id="cb387-27"><a href="#cb387-27" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb387-28"><a href="#cb387-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-29"><a href="#cb387-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb387-30"><a href="#cb387-30" aria-hidden="true" tabindex="-1"></a>                genosForGBI_limited, indMetadataforGBI_limited, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb387-31"><a href="#cb387-31" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-143-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="143">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [63088, 153219, 167981, 204946, 252487, 296231, 367641, 423565, 431630, 443933  …  678802, 684399, 741883, 767533, 773736, 792896, 900073, 925762, 939829, 952095], <span class="ansi-bold">74×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   5 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v ⋯
   6 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   7 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
   8 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir
   9 │ GW_Lane5_AB2               GW_Lane5_AB2               AB        vir     ⋯
  10 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
  11 │ GW_Lane5_AA1               GW_Lane5_AA1               AA        vir_S
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  65 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L
  66 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L ⋯
  67 │ GW_Lane5_LN10              GW_Lane5_LN10              LN        troch_L
  68 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
  69 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L
  70 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L ⋯
  71 │ GW_Lane5_LN18              GW_Lane5_LN18              LN        troch_L
  72 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
  73 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L
  74 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L ⋯
<span class="ansi-cyan-fg">                                                  35 columns and 53 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-troch-plumb-pops-1" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-troch-plumb-pops-1">show same but with only troch plumb pops</h3>
<div id="8f074afb" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"trochObs"</span>, <span class="st">"plumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb389-8"><a href="#cb389-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb389-9"><a href="#cb389-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb389-10"><a href="#cb389-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb389-11"><a href="#cb389-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb389-12"><a href="#cb389-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb389-13"><a href="#cb389-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb389-14"><a href="#cb389-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-15"><a href="#cb389-15" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb389-16"><a href="#cb389-16" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb389-17"><a href="#cb389-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-18"><a href="#cb389-18" aria-hidden="true" tabindex="-1"></a><span class="co"># remove individuals that have vir haplotypes, as this could otherwise be mistaken for introgression from obscuratus:</span></span>
<span id="cb389-19"><a href="#cb389-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-20"><a href="#cb389-20" aria-hidden="true" tabindex="-1"></a>removeTheseInds <span class="op">=</span> [<span class="st">"GW_Armando_plate1_JF24G02"</span>, <span class="co"># gw19 hetero from plumb </span></span>
<span id="cb389-21"><a href="#cb389-21" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"GW_Armando_plate1_JF07G03"</span>, <span class="co"># gw19 hetero from plumb</span></span>
<span id="cb389-22"><a href="#cb389-22" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"GW_Armando_plate1_JF12G02"</span>, <span class="co"># gw19 hetero from plumb</span></span>
<span id="cb389-23"><a href="#cb389-23" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"GW_Armando_plate1_JF09G01"</span>] <span class="co"># gw28 is hetero from plumb  </span></span>
<span id="cb389-24"><a href="#cb389-24" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> <span class="fu">map</span>(<span class="fu">in</span>(removeTheseInds), metadataForGBI.ind)</span>
<span id="cb389-25"><a href="#cb389-25" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> metadataForGBI[.!selection, <span class="op">:</span>]</span>
<span id="cb389-26"><a href="#cb389-26" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genosForGBI[.!selection, <span class="op">:</span>]</span>
<span id="cb389-27"><a href="#cb389-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-28"><a href="#cb389-28" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"troch_LN"</span>,<span class="st">"troch_EM"</span>,<span class="st">"obs"</span>,<span class="st">"plumb_BJ"</span>,<span class="st">"plumb"</span>]</span>
<span id="cb389-29"><a href="#cb389-29" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"yellow"</span>,<span class="st">"gold"</span>,<span class="st">"orange"</span>,<span class="st">"pink"</span>,<span class="st">"red"</span>]</span>
<span id="cb389-30"><a href="#cb389-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-31"><a href="#cb389-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Set  limit on the number of individuals per group to plot</span></span>
<span id="cb389-32"><a href="#cb389-32" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(plotGroups))</span>
<span id="cb389-33"><a href="#cb389-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-34"><a href="#cb389-34" aria-hidden="true" tabindex="-1"></a><span class="co"># metadataForGBI[metadataForGBI.Fst_group .== "plumb", :]</span></span>
<span id="cb389-35"><a href="#cb389-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-36"><a href="#cb389-36" aria-hidden="true" tabindex="-1"></a>genosForGBI_limited, indMetadataforGBI_limited <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(plotGroups,</span>
<span id="cb389-37"><a href="#cb389-37" aria-hidden="true" tabindex="-1"></a>                                            numIndsToPlotWithHets, </span>
<span id="cb389-38"><a href="#cb389-38" aria-hidden="true" tabindex="-1"></a>                                            genosForGBI, metadataForGBI;</span>
<span id="cb389-39"><a href="#cb389-39" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb389-40"><a href="#cb389-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-41"><a href="#cb389-41" aria-hidden="true" tabindex="-1"></a><span class="co"># indMetadataforGBI_limited[indMetadataforGBI_limited.Fst_group .== "plumb", :]</span></span>
<span id="cb389-42"><a href="#cb389-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-43"><a href="#cb389-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb389-44"><a href="#cb389-44" aria-hidden="true" tabindex="-1"></a>                genosForGBI_limited, indMetadataforGBI_limited, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb389-45"><a href="#cb389-45" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-144-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="144">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [70570, 71423, 78271, 89983, 167981, 199863, 204946, 252463, 252487, 367641  …  792896, 867410, 881923, 882012, 925752, 925762, 925928, 945566, 976062, 984894], <span class="ansi-bold">37×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate2_LN2      GW_Armando_plate2_LN2      LN        troch_L ⋯
   2 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L
   3 │ GW_Lane5_LN10              GW_Lane5_LN10              LN        troch_L
   4 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
   5 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L ⋯
   6 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L
   7 │ GW_Lane5_LN18              GW_Lane5_LN18              LN        troch_L
   8 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
   9 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L ⋯
  10 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L
  11 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
  ⋮  │             ⋮                          ⋮                 ⋮         ⋮    ⋱
  28 │ GW_Armando_plate1_JF09G02  GW_Armando_plate1_JF09G02  ST        plumb
  29 │ GW_Armando_plate1_JF11G01  GW_Armando_plate1_JF11G01  ST        plumb   ⋯
  30 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
  31 │ GW_Armando_plate1_JF13G01  GW_Armando_plate1_JF13G01  ST        plumb
  32 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb
  33 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb   ⋯
  34 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb
  35 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
  36 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
  37 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb   ⋯
<span class="ansi-cyan-fg">                                                  35 columns and 16 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus-7" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-7">Show just the west area (without nitidus)</h3>
<div id="72eafa08" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLudHet"</span>,</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"virLud_trochObs"</span>,</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"trochObs"</span>,</span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"trochObsHet"</span>]</span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-7"><a href="#cb391-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb391-8"><a href="#cb391-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"blue"</span>,</span>
<span id="cb391-9"><a href="#cb391-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"green"</span>,</span>
<span id="cb391-10"><a href="#cb391-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>,</span>
<span id="cb391-11"><a href="#cb391-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"yellow"</span>]</span>
<span id="cb391-12"><a href="#cb391-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-13"><a href="#cb391-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb391-14"><a href="#cb391-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb391-15"><a href="#cb391-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb391-16"><a href="#cb391-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb391-17"><a href="#cb391-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb391-18"><a href="#cb391-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb391-19"><a href="#cb391-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb391-20"><a href="#cb391-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb391-21"><a href="#cb391-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb391-22"><a href="#cb391-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb391-23"><a href="#cb391-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb391-24"><a href="#cb391-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-25"><a href="#cb391-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsWest))</span>
<span id="cb391-26"><a href="#cb391-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-27"><a href="#cb391-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb391-28"><a href="#cb391-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb391-29"><a href="#cb391-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb391-30"><a href="#cb391-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-31"><a href="#cb391-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb391-32"><a href="#cb391-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb391-33"><a href="#cb391-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb391-34"><a href="#cb391-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb391-35"><a href="#cb391-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-145-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="145">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 0 0 … 0 0], [63088, 153219, 167981, 204946, 252487, 296231, 367641, 423565, 431630, 443933  …  678802, 684399, 741883, 767533, 773736, 792896, 900073, 925762, 939829, 952095], <span class="ansi-bold">180×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   2 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
  11 │ GW_Lane5_YK7               GW_Lane5_YK7               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 171 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
 172 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L ⋯
 173 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
 174 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L
 175 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
 176 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L ⋯
 177 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L
 178 │ GW_Lane5_EM1               GW_Lane5_EM1               EM        troch_E
 179 │ GW_Lane5_DA7               GW_Lane5_DA7               XN        obs
 180 │ GW_Lane5_UY4               GW_Lane5_UY4               UY        plumb   ⋯
<span class="ansi-cyan-fg">                                                 35 columns and 159 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-8" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area-8">Show just the east area</h3>
<div id="6897c000" class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"trochObs"</span>,</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"trochObsHet"</span>,</span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"trochObs_plumb"</span>,</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"yellow"</span>,</span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"orange"</span>,</span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb394-13"><a href="#cb394-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb394-14"><a href="#cb394-14" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb394-15"><a href="#cb394-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb394-16"><a href="#cb394-16" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb394-17"><a href="#cb394-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb394-18"><a href="#cb394-18" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb394-19"><a href="#cb394-19" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb394-20"><a href="#cb394-20" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb394-21"><a href="#cb394-21" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb394-22"><a href="#cb394-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-23"><a href="#cb394-23" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb394-24"><a href="#cb394-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-25"><a href="#cb394-25" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb394-26"><a href="#cb394-26" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb394-27"><a href="#cb394-27" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb394-28"><a href="#cb394-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-29"><a href="#cb394-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb394-30"><a href="#cb394-30" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb394-31"><a href="#cb394-31" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb394-32"><a href="#cb394-32" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb394-33"><a href="#cb394-33" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-146-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="146">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [70570, 71423, 78271, 89983, 167981, 199863, 204946, 252463, 252487, 367641  …  792896, 867410, 881923, 882012, 925752, 925762, 925928, 945566, 976062, 984894], <span class="ansi-bold">146×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW72      GW_Armando_plate1_TTGW72      SA        l ⋯
   2 │ GW_Armando_plate1_TTGW78      GW_Armando_plate1_TTGW78      SA        l
   3 │ GW_Armando_plate2_TTGW73      GW_Armando_plate2_TTGW73      SA        l
   4 │ GW_Armando_plate2_TTGW75      GW_Armando_plate2_TTGW75      SA        l
   5 │ GW_Armando_plate1_TTGW70      GW_Armando_plate1_TTGW70      SA        l ⋯
   6 │ GW_Armando_plate2_TTGW77      GW_Armando_plate2_TTGW77      SA        l
   7 │ GW_Armando_plate2_TTGW80      GW_Armando_plate2_TTGW80      SA        l
   8 │ GW_Armando_plate2_TTGW79      GW_Armando_plate2_TTGW79      SA        l
   9 │ GW_Armando_plate1_TTGW-15-08  GW_Armando_plate1_TTGW-15-08  SR        l ⋯
  10 │ GW_Armando_plate2_TTGW28      GW_Armando_plate2_TTGW28      SR        l
  11 │ GW_Armando_plate2_TTGW25      GW_Armando_plate2_TTGW25      SR        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 137 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
 138 │ GW_Armando_plate2_JF24G01     GW_Armando_plate2_JF24G01     VB        p ⋯
 139 │ GW_Armando_plate2_JF25G01     GW_Armando_plate2_JF25G01     VB        p
 140 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
 141 │ GW_Armando_plate2_JG01G01     GW_Armando_plate2_JG01G01     PR        p
 142 │ GW_Armando_plate2_JG02G01     GW_Armando_plate2_JG02G01     PR        p ⋯
 143 │ GW_Armando_plate2_JG02G03     GW_Armando_plate2_JG02G03     PR        p
 144 │ GW_Armando_plate1_JG02G04     GW_Armando_plate1_JG02G04     PR        p
 145 │ GW_Lane5_SL1                  GW_Lane5_SL1                  SL        p
 146 │ GW_Lane5_SL2                  GW_Lane5_SL2                  SL        p ⋯
<span class="ansi-cyan-fg">                                                 35 columns and 125 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-8" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area-8">Show just the northern area</h3>
<div id="4c48cc1b" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"virLudHet"</span>,</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"blue"</span>,</span>
<span id="cb397-8"><a href="#cb397-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb397-9"><a href="#cb397-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb397-10"><a href="#cb397-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-11"><a href="#cb397-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb397-12"><a href="#cb397-12" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb397-13"><a href="#cb397-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb397-14"><a href="#cb397-14" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb397-15"><a href="#cb397-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb397-16"><a href="#cb397-16" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb397-17"><a href="#cb397-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb397-18"><a href="#cb397-18" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb397-19"><a href="#cb397-19" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb397-20"><a href="#cb397-20" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb397-21"><a href="#cb397-21" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb397-22"><a href="#cb397-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-23"><a href="#cb397-23" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsNorth))</span>
<span id="cb397-24"><a href="#cb397-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-25"><a href="#cb397-25" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb397-26"><a href="#cb397-26" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb397-27"><a href="#cb397-27" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb397-28"><a href="#cb397-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-29"><a href="#cb397-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb397-30"><a href="#cb397-30" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb397-31"><a href="#cb397-31" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb397-32"><a href="#cb397-32" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb397-33"><a href="#cb397-33" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-147-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="147">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 0 1 … 1 2], [63088, 70570, 71423, 78271, 89983, 153219, 199863, 252463, 296231, 423565  …  882012, 900073, 925752, 925928, 939829, 945566, 952095, 975932, 976062, 984894], <span class="ansi-bold">143×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   2 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
  11 │ GW_Lane5_YK7               GW_Lane5_YK7               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 134 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 135 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 136 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 137 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 138 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 139 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb   ⋯
 140 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 141 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 142 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 143 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 35 columns and 122 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="add-chr-4a" class="level2">
<h2 class="anchored" data-anchor-id="add-chr-4a">Add chr 4A</h2>
<div id="3266ce4f" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw4A"</span></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb400-8"><a href="#cb400-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb400-9"><a href="#cb400-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb400-10"><a href="#cb400-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb400-11"><a href="#cb400-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-12"><a href="#cb400-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb400-13"><a href="#cb400-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb400-14"><a href="#cb400-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-15"><a href="#cb400-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb400-16"><a href="#cb400-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb400-17"><a href="#cb400-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb400-18"><a href="#cb400-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb400-19"><a href="#cb400-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-20"><a href="#cb400-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb400-21"><a href="#cb400-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-22"><a href="#cb400-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb400-23"><a href="#cb400-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb400-24"><a href="#cb400-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-25"><a href="#cb400-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb400-26"><a href="#cb400-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-27"><a href="#cb400-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb400-28"><a href="#cb400-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-29"><a href="#cb400-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb400-30"><a href="#cb400-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb400-31"><a href="#cb400-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-32"><a href="#cb400-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb400-33"><a href="#cb400-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb400-34"><a href="#cb400-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb400-35"><a href="#cb400-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb400-36"><a href="#cb400-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb400-37"><a href="#cb400-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb400-38"><a href="#cb400-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb400-39"><a href="#cb400-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb400-40"><a href="#cb400-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-41"><a href="#cb400-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb400-42"><a href="#cb400-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-43"><a href="#cb400-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb400-44"><a href="#cb400-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb400-45"><a href="#cb400-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb400-46"><a href="#cb400-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb400-47"><a href="#cb400-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb400-48"><a href="#cb400-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb400-49"><a href="#cb400-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb400-50"><a href="#cb400-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb400-51"><a href="#cb400-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb400-52"><a href="#cb400-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb400-53"><a href="#cb400-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb400-54"><a href="#cb400-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb400-55"><a href="#cb400-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-56"><a href="#cb400-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb400-57"><a href="#cb400-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb400-58"><a href="#cb400-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-59"><a href="#cb400-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb400-60"><a href="#cb400-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.5</span>) </span>
<span id="cb400-61"><a href="#cb400-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-62"><a href="#cb400-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb400-63"><a href="#cb400-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-64"><a href="#cb400-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb400-65"><a href="#cb400-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb400-66"><a href="#cb400-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb400-67"><a href="#cb400-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb400-68"><a href="#cb400-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb400-69"><a href="#cb400-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb400-70"><a href="#cb400-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb400-71"><a href="#cb400-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb400-72"><a href="#cb400-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb400-73"><a href="#cb400-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb400-74"><a href="#cb400-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb400-75"><a href="#cb400-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-148-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-148-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="148">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-11" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-11">Save the individual colors in the metadata</h3>
<div id="d149d831" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-11" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-11">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="42163472" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb407-11"><a href="#cb407-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb407-12"><a href="#cb407-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-150-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-11" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-11">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="5520b1a9" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb410-12"><a href="#cb410-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-151-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="151">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-4a-high-vishet-region-there-are-4-clear-haplogroups-no-discernment-of-lud-or-obs-on-pc3-which-is-driven-by-nitidus.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-4a-high-vishet-region-there-are-4-clear-haplogroups-no-discernment-of-lud-or-obs-on-pc3-which-is-driven-by-nitidus.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 4A high ViSHet region, there are 4 clear haplogroups (no discernment of lud or obs on PC3, which is driven by nitidus). Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="7aa2d460" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obsPlumb"</span>]</span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb413-13"><a href="#cb413-13" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb413-14"><a href="#cb413-14" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">7</span>) <span class="op">.&amp;</span></span>
<span id="cb413-15"><a href="#cb413-15" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb413-16"><a href="#cb413-16" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span></span>
<span id="cb413-17"><a href="#cb413-17" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb413-18"><a href="#cb413-18" aria-hidden="true" tabindex="-1"></a>obsPlumb <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span> </span>
<span id="cb413-19"><a href="#cb413-19" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb413-20"><a href="#cb413-20" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb413-21"><a href="#cb413-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-22"><a href="#cb413-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb413-23"><a href="#cb413-23" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[virLud]</span>
<span id="cb413-24"><a href="#cb413-24" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb413-25"><a href="#cb413-25" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb413-26"><a href="#cb413-26" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obsPlumb]</span>
<span id="cb413-27"><a href="#cb413-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-28"><a href="#cb413-28" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud nit troch obsPlumb]</span>
<span id="cb413-29"><a href="#cb413-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-30"><a href="#cb413-30" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb413-31"><a href="#cb413-31" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb413-32"><a href="#cb413-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-33"><a href="#cb413-33" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb413-34"><a href="#cb413-34" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb413-35"><a href="#cb413-35" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb413-36"><a href="#cb413-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb413-37"><a href="#cb413-37" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb413-38"><a href="#cb413-38" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb413-39"><a href="#cb413-39" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb413-40"><a href="#cb413-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-41"><a href="#cb413-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb413-42"><a href="#cb413-42" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb413-43"><a href="#cb413-43" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb413-44"><a href="#cb413-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-45"><a href="#cb413-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb413-46"><a href="#cb413-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-47"><a href="#cb413-47" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb413-48"><a href="#cb413-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-49"><a href="#cb413-49" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb413-50"><a href="#cb413-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-51"><a href="#cb413-51" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb413-52"><a href="#cb413-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-53"><a href="#cb413-53" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb413-54"><a href="#cb413-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-55"><a href="#cb413-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb413-56"><a href="#cb413-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-57"><a href="#cb413-57" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb413-58"><a href="#cb413-58" aria-hidden="true" tabindex="-1"></a><span class="co">#= 4×2 DataFrame</span></span>
<span id="cb413-59"><a href="#cb413-59" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster   pi         </span></span>
<span id="cb413-60"><a href="#cb413-60" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String    Float64    </span></span>
<span id="cb413-61"><a href="#cb413-61" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼──────────────────────</span></span>
<span id="cb413-62"><a href="#cb413-62" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud    0.00664772</span></span>
<span id="cb413-63"><a href="#cb413-63" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit       0.00609756</span></span>
<span id="cb413-64"><a href="#cb413-64" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch     0.00614846</span></span>
<span id="cb413-65"><a href="#cb413-65" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obsPlumb  0.00206023 =#</span></span>
<span id="cb413-66"><a href="#cb413-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-67"><a href="#cb413-67" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb413-68"><a href="#cb413-68" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb413-69"><a href="#cb413-69" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair     Dxy       </span></span>
<span id="cb413-70"><a href="#cb413-70" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String           Float64   </span></span>
<span id="cb413-71"><a href="#cb413-71" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼────────────────────────────</span></span>
<span id="cb413-72"><a href="#cb413-72" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit       0.0447451</span></span>
<span id="cb413-73"><a href="#cb413-73" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch     0.0343779</span></span>
<span id="cb413-74"><a href="#cb413-74" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obsPlumb  0.0217185</span></span>
<span id="cb413-75"><a href="#cb413-75" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ nit_troch        0.0373178</span></span>
<span id="cb413-76"><a href="#cb413-76" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_obsPlumb     0.0317873</span></span>
<span id="cb413-77"><a href="#cb413-77" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ troch_obsPlumb   0.0237405 =#</span></span>
<span id="cb413-78"><a href="#cb413-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-79"><a href="#cb413-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb413-80"><a href="#cb413-80" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb413-81"><a href="#cb413-81" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb413-82"><a href="#cb413-82" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb413-83"><a href="#cb413-83" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb413-84"><a href="#cb413-84" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb413-85"><a href="#cb413-85" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb413-86"><a href="#cb413-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-87"><a href="#cb413-87" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb413-88"><a href="#cb413-88" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb413-89"><a href="#cb413-89" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb413-90"><a href="#cb413-90" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb413-91"><a href="#cb413-91" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb413-92"><a href="#cb413-92" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb413-93"><a href="#cb413-93" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb413-94"><a href="#cb413-94" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb413-95"><a href="#cb413-95" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb413-96"><a href="#cb413-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-97"><a href="#cb413-97" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb413-98"><a href="#cb413-98" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">150</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb413-99"><a href="#cb413-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-100"><a href="#cb413-100" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb413-101"><a href="#cb413-101" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb413-102"><a href="#cb413-102" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb413-103"><a href="#cb413-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-104"><a href="#cb413-104" aria-hidden="true" tabindex="-1"></a><span class="co"># sort based on original_plot_order, and then together with function below will arrange individuals in population order within clusters:</span></span>
<span id="cb413-105"><a href="#cb413-105" aria-hidden="true" tabindex="-1"></a>sortOrder <span class="op">=</span> <span class="fu">sortperm</span>(indMetadataforGBI.original_plot_order, rev<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb413-106"><a href="#cb413-106" aria-hidden="true" tabindex="-1"></a>indMetadataforGBI <span class="op">=</span> indMetadataforGBI[sortOrder, <span class="op">:</span>]</span>
<span id="cb413-107"><a href="#cb413-107" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genosForGBI[sortOrder, <span class="op">:</span>]</span>
<span id="cb413-108"><a href="#cb413-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-109"><a href="#cb413-109" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb413-110"><a href="#cb413-110" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb413-111"><a href="#cb413-111" aria-hidden="true" tabindex="-1"></a>                indFontSize<span class="op">=</span><span class="fl">6</span>, figureSize<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">1800</span>),</span>
<span id="cb413-112"><a href="#cb413-112" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb413-113"><a href="#cb413-113" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb413-114"><a href="#cb413-114" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [40 2 62 91] and the sum of those is 195
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-152-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="152">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [387825, 397781, 397824, 405798, 408642, 419198, 425296, 437077, 447665, 454290  …  633803, 637531, 638456, 656257, 676526, 690700, 699577, 706480, 707103, 711862], <span class="ansi-bold">195×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 186 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
 187 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb   ⋯
 188 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
 189 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 190 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb
 191 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb   ⋯
 192 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 193 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 194 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 195 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb   ⋯
<span class="ansi-cyan-fg">                                                 37 columns and 174 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-11" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-11">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="ff626e92" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"virLudHet"</span>,</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"virLud_troch"</span>,</span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb416-6"><a href="#cb416-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"trochHet"</span>,</span>
<span id="cb416-7"><a href="#cb416-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch_obsPlumb"</span>,</span>
<span id="cb416-8"><a href="#cb416-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obsPlumb"</span>,</span>
<span id="cb416-9"><a href="#cb416-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obsPlumbHet"</span>,</span>
<span id="cb416-10"><a href="#cb416-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"virLud_obsPlumb"</span>]</span>
<span id="cb416-11"><a href="#cb416-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-12"><a href="#cb416-12" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb416-13"><a href="#cb416-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"blue"</span>,</span>
<span id="cb416-14"><a href="#cb416-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb416-15"><a href="#cb416-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb416-16"><a href="#cb416-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb416-17"><a href="#cb416-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb416-18"><a href="#cb416-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb416-19"><a href="#cb416-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>,</span>
<span id="cb416-20"><a href="#cb416-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>,</span>
<span id="cb416-21"><a href="#cb416-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">"purple"</span>]</span>
<span id="cb416-22"><a href="#cb416-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-23"><a href="#cb416-23" aria-hidden="true" tabindex="-1"></a>virLud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb416-24"><a href="#cb416-24" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb416-25"><a href="#cb416-25" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb416-26"><a href="#cb416-26" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">7</span>) <span class="op">.&amp;</span></span>
<span id="cb416-27"><a href="#cb416-27" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb416-28"><a href="#cb416-28" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span></span>
<span id="cb416-29"><a href="#cb416-29" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb416-30"><a href="#cb416-30" aria-hidden="true" tabindex="-1"></a>obsPlumb <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span> </span>
<span id="cb416-31"><a href="#cb416-31" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb416-32"><a href="#cb416-32" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb416-33"><a href="#cb416-33" aria-hidden="true" tabindex="-1"></a>virLudHet <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2</span>) <span class="op">.&amp;</span></span>
<span id="cb416-34"><a href="#cb416-34" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb416-35"><a href="#cb416-35" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb416-36"><a href="#cb416-36" aria-hidden="true" tabindex="-1"></a>virLud_troch <span class="op">=</span> (<span class="fl">0</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb416-37"><a href="#cb416-37" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">0.5</span>) <span class="op">.&amp;</span></span>
<span id="cb416-38"><a href="#cb416-38" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb416-39"><a href="#cb416-39" aria-hidden="true" tabindex="-1"></a>trochHet <span class="op">=</span> (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1) <span class="op">.&amp;</span></span>
<span id="cb416-40"><a href="#cb416-40" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb416-41"><a href="#cb416-41" aria-hidden="true" tabindex="-1"></a>troch_obsPlumb <span class="op">=</span> (<span class="fl">0</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">3</span>) <span class="op">.&amp;</span> </span>
<span id="cb416-42"><a href="#cb416-42" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">0</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb416-43"><a href="#cb416-43" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC3) <span class="op">.&amp;</span></span>
<span id="cb416-44"><a href="#cb416-44" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb416-45"><a href="#cb416-45" aria-hidden="true" tabindex="-1"></a>obsPlumbHet <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span> </span>
<span id="cb416-46"><a href="#cb416-46" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb416-47"><a href="#cb416-47" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb416-48"><a href="#cb416-48" aria-hidden="true" tabindex="-1"></a>virLud_obsPlumb <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb416-49"><a href="#cb416-49" aria-hidden="true" tabindex="-1"></a>                (<span class="op">-</span><span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">1.5</span>) <span class="op">.&amp;</span></span>
<span id="cb416-50"><a href="#cb416-50" aria-hidden="true" tabindex="-1"></a>                 .!indSelection_lowIndHetStan</span>
<span id="cb416-51"><a href="#cb416-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-52"><a href="#cb416-52" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [virLud virLudHet nit virLud_troch troch trochHet troch_obsPlumb obsPlumb obsPlumbHet virLud_obsPlumb]</span>
<span id="cb416-53"><a href="#cb416-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-54"><a href="#cb416-54" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb416-55"><a href="#cb416-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-56"><a href="#cb416-56" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb416-57"><a href="#cb416-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb416-58"><a href="#cb416-58" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb416-59"><a href="#cb416-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb416-60"><a href="#cb416-60" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb416-61"><a href="#cb416-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-62"><a href="#cb416-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-63"><a href="#cb416-63" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb416-64"><a href="#cb416-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-65"><a href="#cb416-65" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb416-66"><a href="#cb416-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-67"><a href="#cb416-67" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb416-68"><a href="#cb416-68" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb416-69"><a href="#cb416-69" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb416-70"><a href="#cb416-70" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb416-71"><a href="#cb416-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-72"><a href="#cb416-72" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb416-73"><a href="#cb416-73" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb416-74"><a href="#cb416-74" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb416-75"><a href="#cb416-75" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb416-76"><a href="#cb416-76" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb416-77"><a href="#cb416-77" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb416-78"><a href="#cb416-78" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb416-79"><a href="#cb416-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-80"><a href="#cb416-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb416-81"><a href="#cb416-81" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb416-82"><a href="#cb416-82" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb416-83"><a href="#cb416-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-84"><a href="#cb416-84" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb416-85"><a href="#cb416-85" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb416-86"><a href="#cb416-86" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb416-87"><a href="#cb416-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-88"><a href="#cb416-88" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb416-89"><a href="#cb416-89" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb416-90"><a href="#cb416-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-91"><a href="#cb416-91" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb416-92"><a href="#cb416-92" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb416-93"><a href="#cb416-93" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb416-94"><a href="#cb416-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-95"><a href="#cb416-95" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb416-96"><a href="#cb416-96" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb416-97"><a href="#cb416-97" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb416-98"><a href="#cb416-98" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb416-99"><a href="#cb416-99" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-153-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="153">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [387825, 397781, 397824, 405798, 408642, 419198, 425296, 437077, 447665, 454290  …  633803, 637531, 638456, 656257, 676526, 690700, 699577, 706480, 707103, 711862], <span class="ansi-bold">95×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04     GW_Armando_plate1_JF12G04     ST_vi     v ⋯
   2 │ GW_Armando_plate2_JF03G02     GW_Armando_plate2_JF03G02     VB_vi     v
   3 │ GW_Armando_plate2_JF16G02     GW_Armando_plate2_JF16G02     DV_vi     p
   4 │ GW_Armando_plate2_JF30G01     GW_Armando_plate2_JF30G01     ST_vi     v
   5 │ GW_Lane5_AA5                  GW_Lane5_AA5                  AA        v ⋯
   6 │ GW_Lane5_AA6                  GW_Lane5_AA6                  AA        v
   7 │ GW_Lane5_AA7                  GW_Lane5_AA7                  AA        v
   8 │ GW_Lane5_STvi1                GW_Lane5_STvi1                ST_vi     v
   9 │ GW_Lane5_STvi3                GW_Lane5_STvi3                ST_vi     v ⋯
  10 │ GW_Lane5_TL1                  GW_Lane5_TL1                  TL        v
  11 │ GW_Lane5_TL10                 GW_Lane5_TL10                 TL        v
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
  86 │ GW_Armando_plate1_TTGW53      GW_Armando_plate1_TTGW53      NG        l
  87 │ GW_Armando_plate1_TTGW-15-09  GW_Armando_plate1_TTGW-15-09  SR        l ⋯
  88 │ GW_Armando_plate2_JG01G01     GW_Armando_plate2_JG01G01     PR        p
  89 │ GW_Armando_plate2_TTGW18      GW_Armando_plate2_TTGW18      TH        l
  90 │ GW_Armando_plate2_TTGW20      GW_Armando_plate2_TTGW20      SR        l
  91 │ GW_Armando_plate2_TTGW56      GW_Armando_plate2_TTGW56      NG        l ⋯
  92 │ GW_Armando_plate2_TTGW-15-01  GW_Armando_plate2_TTGW-15-01  SR        l
  93 │ GW_Armando_plate2_TTGW-15-03  GW_Armando_plate2_TTGW-15-03  SR        l
  94 │ GW_Armando_plate2_TTGW-15-06  GW_Armando_plate2_TTGW-15-06  SR        l
  95 │ GW_Lane5_KS1                  GW_Lane5_KS1                  OV        l ⋯
<span class="ansi-cyan-fg">                                                  37 columns and 74 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order-7" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order-7">show GBI plot according to original groups and plot order</h3>
<div id="a718bc3f" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-154-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="154">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [387825, 397781, 397824, 405798, 408642, 419198, 425296, 437077, 447665, 454290  …  633803, 637531, 638456, 656257, 676526, 690700, 699577, 706480, 707103, 711862], <span class="ansi-bold">95×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   5 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v ⋯
   6 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
   7 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
   8 │ GW_Lane5_TL1               GW_Lane5_TL1               TL        vir
   9 │ GW_Lane5_TL10              GW_Lane5_TL10              TL        vir     ⋯
  10 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir
  11 │ GW_Lane5_TL12              GW_Lane5_TL12              TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  86 │ GW_Armando_plate1_JF29G01  GW_Armando_plate1_JF29G01  ST        plumb
  87 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb   ⋯
  88 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb
  89 │ GW_Armando_plate1_JF29G02  GW_Armando_plate1_JF29G02  ST        plumb
  90 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
  91 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb   ⋯
  92 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  93 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
  94 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  95 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb   ⋯
<span class="ansi-cyan-fg">                                                  37 columns and 74 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals-7" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals-7">show same but with all individuals</h3>
<div id="867647fb" class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb421-9"><a href="#cb421-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-10"><a href="#cb421-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb421-11"><a href="#cb421-11" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb421-12"><a href="#cb421-12" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb421-13"><a href="#cb421-13" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb421-14"><a href="#cb421-14" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-155-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="155">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], [387825, 397781, 397824, 405798, 408642, 419198, 425296, 437077, 447665, 454290  …  633803, 637531, 638456, 656257, 676526, 690700, 699577, 706480, 707103, 711862], <span class="ansi-bold">257×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 248 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 249 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 250 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 251 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 252 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 253 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb   ⋯
 254 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 255 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 256 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 257 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 37 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-only-vir-and-plumb-pops-5" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-only-vir-and-plumb-pops-5">show same but with only vir and plumb pops</h3>
<div id="d6ea9827" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"virLud"</span>, <span class="st">"obsPlumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb423-10"><a href="#cb423-10" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb423-11"><a href="#cb423-11" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb423-12"><a href="#cb423-12" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb423-13"><a href="#cb423-13" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb423-14"><a href="#cb423-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-15"><a href="#cb423-15" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>, <span class="st">"plumb"</span>, <span class="st">"plumb_vir"</span>] <span class="co"># these are the original Fst_groups</span></span>
<span id="cb423-16"><a href="#cb423-16" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>]</span>
<span id="cb423-17"><a href="#cb423-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-18"><a href="#cb423-18" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb423-19"><a href="#cb423-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-20"><a href="#cb423-20" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb423-21"><a href="#cb423-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-22"><a href="#cb423-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb423-23"><a href="#cb423-23" aria-hidden="true" tabindex="-1"></a>                genosForGBI, metadataForGBI, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb423-24"><a href="#cb423-24" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-156-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="156">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 1 2 … 1 0], [397824, 447665, 454290, 505522, 510299, 520268, 527334, 531726, 578230, 582505, 587143, 614605, 617468, 617555, 621740, 633718, 633803, 690700], <span class="ansi-bold">100×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  91 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  92 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  93 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  94 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  95 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  96 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
  97 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  98 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  99 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 100 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  37 columns and 79 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-whole-ring-but-not-nit" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-whole-ring-but-not-nit">show same but whole ring (but not nit)</h3>
<div id="ee07d07f" class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>includeTheseClusters <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"troch"</span>,</span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"obsPlumb"</span>] <span class="co"># these are the haplotype clusters to include in the choice below of SNPs to show</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb425-6"><a href="#cb425-6" aria-hidden="true" tabindex="-1"></a>freqs_local, sampleSizes_local <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembership, includeTheseClusters)</span>
<span id="cb425-7"><a href="#cb425-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-8"><a href="#cb425-8" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb425-9"><a href="#cb425-9" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb425-10"><a href="#cb425-10" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb425-11"><a href="#cb425-11" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb425-12"><a href="#cb425-12" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs_local, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb425-13"><a href="#cb425-13" aria-hidden="true" tabindex="-1"></a>genosForGBI <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb425-14"><a href="#cb425-14" aria-hidden="true" tabindex="-1"></a>posForGBI <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb425-15"><a href="#cb425-15" aria-hidden="true" tabindex="-1"></a>freqsForGBI <span class="op">=</span> freqs_local[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb425-16"><a href="#cb425-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-17"><a href="#cb425-17" aria-hidden="true" tabindex="-1"></a>metadataForGBI <span class="op">=</span> <span class="fu">copy</span>(PCAmodelAll.metadata)</span>
<span id="cb425-18"><a href="#cb425-18" aria-hidden="true" tabindex="-1"></a>metadataForGBI.Fst_group <span class="op">=</span> metadataForGBI.original_Fst_groups</span>
<span id="cb425-19"><a href="#cb425-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-20"><a href="#cb425-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plotGroups = ["vir","vir_S","lud_PK", "lud_KS", "lud_central", "lud_Sath", "lud_ML","troch_west","troch_LN","troch_EM","obs","plumb_BJ","plumb","plumb_vir"]</span></span>
<span id="cb425-21"><a href="#cb425-21" aria-hidden="true" tabindex="-1"></a><span class="co"># plotGroupColors = ["blue","turquoise1","seagreen4","seagreen3","seagreen2","olivedrab3","olivedrab2","olivedrab1","yellow","gold","orange","pink","red","purple"]</span></span>
<span id="cb425-22"><a href="#cb425-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-23"><a href="#cb425-23" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_S"</span>,<span class="st">"lud_PK"</span>,<span class="st">"lud_KS"</span>,<span class="st">"lud_central"</span>,<span class="st">"troch_LN"</span>,<span class="st">"troch_EM"</span>,<span class="st">"obs"</span>,<span class="st">"plumb_BJ"</span>,<span class="st">"plumb"</span>,<span class="st">"plumb_vir"</span>]</span>
<span id="cb425-24"><a href="#cb425-24" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>,<span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"yellow"</span>,<span class="st">"gold"</span>,<span class="st">"orange"</span>, <span class="st">"pink"</span>,<span class="st">"red"</span>,<span class="st">"purple"</span>]</span>
<span id="cb425-25"><a href="#cb425-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-26"><a href="#cb425-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Set  limit on the number of individuals per group to plot</span></span>
<span id="cb425-27"><a href="#cb425-27" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> [<span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">1</span>] <span class="co"># maximum number of individuals to plot from each group</span></span>
<span id="cb425-28"><a href="#cb425-28" aria-hidden="true" tabindex="-1"></a><span class="co">#numIndsToPlotWithHets = fill(100, length(plotGroups))</span></span>
<span id="cb425-29"><a href="#cb425-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-30"><a href="#cb425-30" aria-hidden="true" tabindex="-1"></a><span class="co"># metadataForGBI[metadataForGBI.Fst_group .== "plumb", :]</span></span>
<span id="cb425-31"><a href="#cb425-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-32"><a href="#cb425-32" aria-hidden="true" tabindex="-1"></a>genosForGBI_limited, indMetadataforGBI_limited <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(plotGroups,</span>
<span id="cb425-33"><a href="#cb425-33" aria-hidden="true" tabindex="-1"></a>                                            numIndsToPlotWithHets, </span>
<span id="cb425-34"><a href="#cb425-34" aria-hidden="true" tabindex="-1"></a>                                            genosForGBI, metadataForGBI;</span>
<span id="cb425-35"><a href="#cb425-35" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb425-36"><a href="#cb425-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-37"><a href="#cb425-37" aria-hidden="true" tabindex="-1"></a><span class="co"># indMetadataforGBI_limited[indMetadataforGBI_limited.Fst_group .== "plumb", :]</span></span>
<span id="cb425-38"><a href="#cb425-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-39"><a href="#cb425-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, posForGBI,</span>
<span id="cb425-40"><a href="#cb425-40" aria-hidden="true" tabindex="-1"></a>                genosForGBI_limited, indMetadataforGBI_limited, freqsForGBI, plotGroups, plotGroupColors;</span>
<span id="cb425-41"><a href="#cb425-41" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-157-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="157">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 1 … 0 0], [397781, 397824, 405798, 419198, 425296, 447665, 454290, 505522, 510299, 513889  …  617468, 617539, 617555, 621740, 633718, 633787, 633803, 676526, 690700, 711862], <span class="ansi-bold">61×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   5 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v ⋯
   6 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   7 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
   8 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir
   9 │ GW_Lane5_AB2               GW_Lane5_AB2               AB        vir     ⋯
  10 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
  11 │ GW_Lane5_AA1               GW_Lane5_AA1               AA        vir_S
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  52 │ GW_Armando_plate1_JF07G03  GW_Armando_plate1_JF07G03  ST        plumb
  53 │ GW_Armando_plate1_JF07G04  GW_Armando_plate1_JF07G04  ST        plumb   ⋯
  54 │ GW_Armando_plate1_JF08G02  GW_Armando_plate1_JF08G02  ST        plumb
  55 │ GW_Armando_plate1_JF09G01  GW_Armando_plate1_JF09G01  ST        plumb
  56 │ GW_Armando_plate1_JF09G02  GW_Armando_plate1_JF09G02  ST        plumb
  57 │ GW_Armando_plate1_JF11G01  GW_Armando_plate1_JF11G01  ST        plumb   ⋯
  58 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
  59 │ GW_Armando_plate1_JF12G02  GW_Armando_plate1_JF12G02  ST        plumb
  60 │ GW_Armando_plate1_JF13G01  GW_Armando_plate1_JF13G01  ST        plumb
  61 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  37 columns and 40 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus-8" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-8">Show just the west area (without nitidus)</h3>
<div id="3b745295" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"virLudHet"</span>,</span>
<span id="cb427-3"><a href="#cb427-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"virLud_troch"</span>,</span>
<span id="cb427-4"><a href="#cb427-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"troch"</span>,</span>
<span id="cb427-5"><a href="#cb427-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"trochHet"</span>]</span>
<span id="cb427-6"><a href="#cb427-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-7"><a href="#cb427-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb427-8"><a href="#cb427-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"blue"</span>,</span>
<span id="cb427-9"><a href="#cb427-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"green"</span>,</span>
<span id="cb427-10"><a href="#cb427-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"yellow"</span>,</span>
<span id="cb427-11"><a href="#cb427-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"yellow"</span>]</span>
<span id="cb427-12"><a href="#cb427-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-13"><a href="#cb427-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb427-14"><a href="#cb427-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb427-15"><a href="#cb427-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb427-16"><a href="#cb427-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb427-17"><a href="#cb427-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb427-18"><a href="#cb427-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb427-19"><a href="#cb427-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb427-20"><a href="#cb427-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb427-21"><a href="#cb427-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb427-22"><a href="#cb427-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb427-23"><a href="#cb427-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb427-24"><a href="#cb427-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-25"><a href="#cb427-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsWest))</span>
<span id="cb427-26"><a href="#cb427-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-27"><a href="#cb427-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb427-28"><a href="#cb427-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb427-29"><a href="#cb427-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb427-30"><a href="#cb427-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-31"><a href="#cb427-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb427-32"><a href="#cb427-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb427-33"><a href="#cb427-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb427-34"><a href="#cb427-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb427-35"><a href="#cb427-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-158-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="158">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 2 … 2 0; 0 0 … 0 0], [397781, 397824, 405798, 419198, 425296, 447665, 510299, 513889, 520268, 520285  …  614605, 614609, 617539, 617555, 621740, 633718, 633787, 676526, 690700, 711862], <span class="ansi-bold">119×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 110 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L
 111 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L ⋯
 112 │ GW_Lane5_LN1               GW_Lane5_LN1               LN        troch_L
 113 │ GW_Lane5_LN10              GW_Lane5_LN10              LN        troch_L
 114 │ GW_Lane5_LN6               GW_Lane5_LN6               LN        troch_L
 115 │ GW_Lane5_LN7               GW_Lane5_LN7               LN        troch_L ⋯
 116 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L
 117 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L
 118 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L
 119 │ GW_Armando_plate1_JF13G01  GW_Armando_plate1_JF13G01  ST        plumb   ⋯
<span class="ansi-cyan-fg">                                                  37 columns and 98 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-9" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area-9">Show just the east area</h3>
<div id="11c222eb" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"troch"</span>,</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"trochHet"</span>,</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"troch_obsPlumb"</span>,</span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obsPlumb"</span>,</span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obsPlumbHet"</span>]</span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"yellow"</span>,</span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"orange"</span>,</span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>,</span>
<span id="cb430-11"><a href="#cb430-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb430-12"><a href="#cb430-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-13"><a href="#cb430-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb430-14"><a href="#cb430-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb430-15"><a href="#cb430-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb430-16"><a href="#cb430-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb430-17"><a href="#cb430-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb430-18"><a href="#cb430-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb430-19"><a href="#cb430-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb430-20"><a href="#cb430-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb430-21"><a href="#cb430-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb430-22"><a href="#cb430-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb430-23"><a href="#cb430-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb430-24"><a href="#cb430-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-25"><a href="#cb430-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb430-26"><a href="#cb430-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-27"><a href="#cb430-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb430-28"><a href="#cb430-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb430-29"><a href="#cb430-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb430-30"><a href="#cb430-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-31"><a href="#cb430-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb430-32"><a href="#cb430-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb430-33"><a href="#cb430-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb430-34"><a href="#cb430-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb430-35"><a href="#cb430-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-159-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="159">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[2 2 … 2 2; 2 2 … 2 2; … ; 2 2 … 2 2; 2 2 … 2 2], [397781, 405798, 419198, 425296, 454290, 505522, 513889, 520285, 527255, 531214  …  553195, 582581, 587134, 614609, 617468, 617539, 633787, 633803, 676526, 711862], <span class="ansi-bold">180×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                          </span><span class="ansi-bold"> ID                           </span><span class="ansi-bold"> location </span><span class="ansi-bold"> g</span> ⋯
     │<span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String                       </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> S</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Lane5_NA3                  GW_Lane5_NA3                  NR        l ⋯
   2 │ GW_Lane5_SH1                  GW_Lane5_SH1                  SH        l
   3 │ GW_Lane5_SH2                  GW_Lane5_SH2                  SH        l
   4 │ GW_Lane5_SH4                  GW_Lane5_SH4                  SH        l
   5 │ GW_Lane5_SH5                  GW_Lane5_SH5                  SH        l ⋯
   6 │ GW_Armando_plate1_TTGW72      GW_Armando_plate1_TTGW72      SA        l
   7 │ GW_Armando_plate2_TTGW73      GW_Armando_plate2_TTGW73      SA        l
   8 │ GW_Armando_plate2_TTGW77      GW_Armando_plate2_TTGW77      SA        l
   9 │ GW_Armando_plate2_TTGW79      GW_Armando_plate2_TTGW79      SA        l ⋯
  10 │ GW_Armando_plate2_TTGW80      GW_Armando_plate2_TTGW80      SA        l
  11 │ GW_Armando_plate2_TTGW75      GW_Armando_plate2_TTGW75      SA        l
  ⋮  │              ⋮                             ⋮                   ⋮        ⋱
 171 │ GW_Armando_plate1_JF23G02     GW_Armando_plate1_JF23G02     VB        p
 172 │ GW_Armando_plate1_JF24G02     GW_Armando_plate1_JF24G02     VB        p ⋯
 173 │ GW_Armando_plate2_JF24G01     GW_Armando_plate2_JF24G01     VB        p
 174 │ GW_Armando_plate2_JF25G01     GW_Armando_plate2_JF25G01     VB        p
 175 │ GW_Armando_plate1_JG02G02     GW_Armando_plate1_JG02G02     PR        p
 176 │ GW_Armando_plate1_JG02G04     GW_Armando_plate1_JG02G04     PR        p ⋯
 177 │ GW_Armando_plate2_JG02G01     GW_Armando_plate2_JG02G01     PR        p
 178 │ GW_Armando_plate2_JG02G03     GW_Armando_plate2_JG02G03     PR        p
 179 │ GW_Lane5_SL1                  GW_Lane5_SL1                  SL        p
 180 │ GW_Lane5_SL2                  GW_Lane5_SL2                  SL        p ⋯
<span class="ansi-cyan-fg">                                                 37 columns and 159 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-9" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area-9">Show just the northern area</h3>
<div id="a246c09e" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"virLudHet"</span>,</span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"virLud_obsPlumb"</span>,</span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obsPlumb"</span>,</span>
<span id="cb433-5"><a href="#cb433-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obsPlumbHet"</span>]</span>
<span id="cb433-6"><a href="#cb433-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-7"><a href="#cb433-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb433-8"><a href="#cb433-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"blue"</span>,</span>
<span id="cb433-9"><a href="#cb433-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb433-10"><a href="#cb433-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>,</span>
<span id="cb433-11"><a href="#cb433-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb433-12"><a href="#cb433-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-13"><a href="#cb433-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb433-14"><a href="#cb433-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb433-15"><a href="#cb433-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb433-16"><a href="#cb433-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb433-17"><a href="#cb433-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb433-18"><a href="#cb433-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb433-19"><a href="#cb433-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb433-20"><a href="#cb433-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb433-21"><a href="#cb433-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb433-22"><a href="#cb433-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb433-23"><a href="#cb433-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb433-24"><a href="#cb433-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-25"><a href="#cb433-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsNorth))</span>
<span id="cb433-26"><a href="#cb433-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-27"><a href="#cb433-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb433-28"><a href="#cb433-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb433-29"><a href="#cb433-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb433-30"><a href="#cb433-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-31"><a href="#cb433-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb433-32"><a href="#cb433-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb433-33"><a href="#cb433-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb433-34"><a href="#cb433-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb433-35"><a href="#cb433-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-160-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="160">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 1 2 … 1 0], [397824, 447665, 454290, 505522, 510299, 520268, 527334, 531726, 578230, 582505, 587143, 614605, 617468, 617555, 621740, 633718, 633803, 690700], <span class="ansi-bold">157×40 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   3 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   4 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   5 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   8 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 148 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 149 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 150 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 151 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 152 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 153 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 154 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 155 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 156 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 157 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 37 columns and 136 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="do-a-pca-based-on-a-same-size-region-elsewhere-on-gw4a-with-low-vishet" class="level3">
<h3 class="anchored" data-anchor-id="do-a-pca-based-on-a-same-size-region-elsewhere-on-gw4a-with-low-vishet">Do a PCA based on a same-size region elsewhere on gw4A (with low ViSHet):</h3>
<div id="01ac72d3" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get length of region</span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>lengthHighViSHetRegion <span class="op">=</span> positionMax <span class="op">-</span> positionMin</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a><span class="co"># because the region is on the left side of chr 4A, will put the non-interesting region on the right side:</span></span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a>rightLocus <span class="op">=</span> scaffold_lengths[<span class="st">"gw4A"</span>] <span class="op">-</span> <span class="fl">1_000_000</span></span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true" tabindex="-1"></a>leftLocus <span class="op">=</span> rightLocus <span class="op">-</span> lengthHighViSHetRegion</span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-8"><a href="#cb436-8" aria-hidden="true" tabindex="-1"></a>regionText_lowViSHetRegion <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr "</span>, chr, <span class="st">" "</span>,leftLocus,<span class="st">" to "</span>,rightLocus)</span>
<span id="cb436-9"><a href="#cb436-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-10"><a href="#cb436-10" aria-hidden="true" tabindex="-1"></a>lociSelection <span class="op">=</span> (leftLocus <span class="op">.&lt;=</span> pos_region.position <span class="op">.&lt;=</span> rightLocus)</span>
<span id="cb436-11"><a href="#cb436-11" aria-hidden="true" tabindex="-1"></a>genotypes_lowViSHetRegion <span class="op">=</span> genotypes_region[<span class="op">:</span>, lociSelection]</span>
<span id="cb436-12"><a href="#cb436-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-13"><a href="#cb436-13" aria-hidden="true" tabindex="-1"></a><span class="co"># impute missing genotypes:</span></span>
<span id="cb436-14"><a href="#cb436-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-15"><a href="#cb436-15" aria-hidden="true" tabindex="-1"></a>genotypes_lowViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genotypes_lowViSHetRegion))</span>
<span id="cb436-16"><a href="#cb436-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-17"><a href="#cb436-17" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb436-18"><a href="#cb436-18" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb436-19"><a href="#cb436-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-20"><a href="#cb436-20" aria-hidden="true" tabindex="-1"></a>PCAmodel <span class="op">=</span> <span class="fu">plotPCA</span>(genotypes_lowViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb436-21"><a href="#cb436-21" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb436-22"><a href="#cb436-22" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText_lowViSHetRegion,</span>
<span id="cb436-23"><a href="#cb436-23" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb436-24"><a href="#cb436-24" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb436-25"><a href="#cb436-25" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb436-26"><a href="#cb436-26" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb436-27"><a href="#cb436-27" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb436-28"><a href="#cb436-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-29"><a href="#cb436-29" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodel.PCAfig)</span>
<span id="cb436-30"><a href="#cb436-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">true</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb436-31"><a href="#cb436-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"FigureS2D_gw4A_nonHLBRarbitrary_from_Julia.png"</span>, PCAmodel.PCAfig, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb436-32"><a href="#cb436-32" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-161-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
<section id="chr-4a-shows-really-remarkable-patterns.-absolutely-must-be-selective-sweeps." class="level4">
<h4 class="anchored" data-anchor-id="chr-4a-shows-really-remarkable-patterns.-absolutely-must-be-selective-sweeps.">Chr 4A shows really remarkable patterns. Absolutely must be selective sweeps.</h4>
</section>
</section>
</section>
<section id="add-chr-20" class="level2">
<h2 class="anchored" data-anchor-id="add-chr-20">Add chr 20</h2>
<div id="688db0c3" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw20"</span></span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb439-6"><a href="#cb439-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb439-7"><a href="#cb439-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb439-8"><a href="#cb439-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb439-9"><a href="#cb439-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb439-10"><a href="#cb439-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb439-11"><a href="#cb439-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-12"><a href="#cb439-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb439-13"><a href="#cb439-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb439-14"><a href="#cb439-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-15"><a href="#cb439-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb439-16"><a href="#cb439-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb439-17"><a href="#cb439-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb439-18"><a href="#cb439-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb439-19"><a href="#cb439-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-20"><a href="#cb439-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb439-21"><a href="#cb439-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-22"><a href="#cb439-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb439-23"><a href="#cb439-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb439-24"><a href="#cb439-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-25"><a href="#cb439-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb439-26"><a href="#cb439-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-27"><a href="#cb439-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb439-28"><a href="#cb439-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-29"><a href="#cb439-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb439-30"><a href="#cb439-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb439-31"><a href="#cb439-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-32"><a href="#cb439-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb439-33"><a href="#cb439-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb439-34"><a href="#cb439-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb439-35"><a href="#cb439-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb439-36"><a href="#cb439-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb439-37"><a href="#cb439-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb439-38"><a href="#cb439-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb439-39"><a href="#cb439-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb439-40"><a href="#cb439-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-41"><a href="#cb439-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb439-42"><a href="#cb439-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-43"><a href="#cb439-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb439-44"><a href="#cb439-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb439-45"><a href="#cb439-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb439-46"><a href="#cb439-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb439-47"><a href="#cb439-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb439-48"><a href="#cb439-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb439-49"><a href="#cb439-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb439-50"><a href="#cb439-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb439-51"><a href="#cb439-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb439-52"><a href="#cb439-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb439-53"><a href="#cb439-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb439-54"><a href="#cb439-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb439-55"><a href="#cb439-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-56"><a href="#cb439-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb439-57"><a href="#cb439-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb439-58"><a href="#cb439-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-59"><a href="#cb439-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb439-60"><a href="#cb439-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.5</span>) </span>
<span id="cb439-61"><a href="#cb439-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-62"><a href="#cb439-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb439-63"><a href="#cb439-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-64"><a href="#cb439-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb439-65"><a href="#cb439-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb439-66"><a href="#cb439-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb439-67"><a href="#cb439-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb439-68"><a href="#cb439-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb439-69"><a href="#cb439-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb439-70"><a href="#cb439-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb439-71"><a href="#cb439-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb439-72"><a href="#cb439-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb439-73"><a href="#cb439-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb439-74"><a href="#cb439-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb439-75"><a href="#cb439-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span>
<span id="cb439-76"><a href="#cb439-76" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">false</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb439-77"><a href="#cb439-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(<span class="st">"Figure6_top_gw28GBIplotEast_from_Julia.png"</span>, plotInfo[<span class="fl">1</span>], px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb439-78"><a href="#cb439-78" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>More than 1 region on that scaffold. Using just the longest one.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><div style="float: left;"><span>2×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionChrom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionStart</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionEnd</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">gw20</td>
<td style="text-align: right;">27354</td>
<td style="text-align: right;">721651</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">gw20</td>
<td style="text-align: right;">5852254</td>
<td style="text-align: right;">6671670</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-162-output-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-162-output-6.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="save-the-individual-colors-in-the-metadata-12" class="level3">
<h3 class="anchored" data-anchor-id="save-the-individual-colors-in-the-metadata-12">Save the individual colors in the metadata</h3>
<div id="20959243" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>indColors <span class="op">=</span> <span class="fu">fill</span>(<span class="st">""</span>, <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))</span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">axes</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a>    indColors[i] <span class="op">=</span> group_colors_PCA[<span class="fu">findfirst</span>(groups_to_plot_PCA <span class="op">.==</span> PCAmodelAll.metadata.Fst_group[i])]</span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb443-5"><a href="#cb443-5" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorLeft <span class="op">=</span> indColors</span>
<span id="cb443-6"><a href="#cb443-6" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.indColorRight <span class="op">=</span> indColors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="163">
<pre><code>257-element Vector{String}:
 "blue"
 "red"
 "red"
 "red"
 "red"
 "red"
 "red"
 "purple"
 "red"
 "red"
 "red"
 "blue"
 "red"
 ⋮
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"
 "olivedrab2"</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc2-12" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc2-12">Plot PC1 vs.&nbsp;PC2:</h3>
<div id="7b19eccd" class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb445-9"><a href="#cb445-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb445-10"><a href="#cb445-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb445-11"><a href="#cb445-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb445-12"><a href="#cb445-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-164-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="164">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="plot-pc1-vs.-pc3-12" class="level3">
<h3 class="anchored" data-anchor-id="plot-pc1-vs.-pc3-12">Plot PC1 vs.&nbsp;PC3:</h3>
<div id="69b50db0" class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>,</span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC3"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb448-10"><a href="#cb448-10" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC3[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb448-11"><a href="#cb448-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb448-12"><a href="#cb448-12" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-165-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="165">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="at-chr-20-high-vishet-region-there-are-6-clear-haplogroups-with-vir-and-lud-clearly-different-on-pc3.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between" class="level3">
<h3 class="anchored" data-anchor-id="at-chr-20-high-vishet-region-there-are-6-clear-haplogroups-with-vir-and-lud-clearly-different-on-pc3.-divide-samples-into-those-groups-based-on-pca-scores-and-then-calculate-pi-within-and-pi-between">At chr 20 high ViSHet region, there are 6 clear haplogroups (with vir and lud clearly different on PC3). Divide samples into those groups, based on PCA scores, and then calculate pi within and pi between</h3>
<div id="32b7705d" class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>clusterNames <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud"</span>,</span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>]</span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true" tabindex="-1"></a>clusterColors <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb451-9"><a href="#cb451-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb451-10"><a href="#cb451-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb451-11"><a href="#cb451-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb451-12"><a href="#cb451-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb451-13"><a href="#cb451-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>]</span>
<span id="cb451-14"><a href="#cb451-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-15"><a href="#cb451-15" aria-hidden="true" tabindex="-1"></a>vir <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb451-16"><a href="#cb451-16" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">0.5</span>) <span class="op">.&amp;</span></span>
<span id="cb451-17"><a href="#cb451-17" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb451-18"><a href="#cb451-18" aria-hidden="true" tabindex="-1"></a>nit <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">3</span>) <span class="op">.&amp;</span></span>
<span id="cb451-19"><a href="#cb451-19" aria-hidden="true" tabindex="-1"></a>        (PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb451-20"><a href="#cb451-20" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb451-21"><a href="#cb451-21" aria-hidden="true" tabindex="-1"></a>lud <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb451-22"><a href="#cb451-22" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">0.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="fl">7</span>) <span class="op">.&amp;</span></span>
<span id="cb451-23"><a href="#cb451-23" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb451-24"><a href="#cb451-24" aria-hidden="true" tabindex="-1"></a>troch <span class="op">=</span> (<span class="fl">2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb451-25"><a href="#cb451-25" aria-hidden="true" tabindex="-1"></a>            (PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4.2</span>) <span class="op">.&amp;</span></span>
<span id="cb451-26"><a href="#cb451-26" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb451-27"><a href="#cb451-27" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb451-28"><a href="#cb451-28" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">4.2</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">2.5</span>) <span class="op">.&amp;</span></span>
<span id="cb451-29"><a href="#cb451-29" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb451-30"><a href="#cb451-30" aria-hidden="true" tabindex="-1"></a>plumb <span class="op">=</span> (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">6</span>) <span class="op">.&amp;</span> </span>
<span id="cb451-31"><a href="#cb451-31" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2) <span class="op">.&amp;</span></span>
<span id="cb451-32"><a href="#cb451-32" aria-hidden="true" tabindex="-1"></a>            indSelection_lowIndHetStan</span>
<span id="cb451-33"><a href="#cb451-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-34"><a href="#cb451-34" aria-hidden="true" tabindex="-1"></a><span class="co"># check the individuals in each group</span></span>
<span id="cb451-35"><a href="#cb451-35" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[vir]</span>
<span id="cb451-36"><a href="#cb451-36" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[nit]</span>
<span id="cb451-37"><a href="#cb451-37" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[lud]</span>
<span id="cb451-38"><a href="#cb451-38" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[troch]</span>
<span id="cb451-39"><a href="#cb451-39" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[obs]</span>
<span id="cb451-40"><a href="#cb451-40" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group[plumb]</span>
<span id="cb451-41"><a href="#cb451-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-42"><a href="#cb451-42" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [vir nit lud troch obs plumb]</span>
<span id="cb451-43"><a href="#cb451-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-44"><a href="#cb451-44" aria-hidden="true" tabindex="-1"></a><span class="co"># show numbers in each group</span></span>
<span id="cb451-45"><a href="#cb451-45" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"The numbers in each group are </span><span class="sc">$</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>))<span class="st"> and the sum of those is </span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">"</span>)</span>
<span id="cb451-46"><a href="#cb451-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-47"><a href="#cb451-47" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb451-48"><a href="#cb451-48" aria-hidden="true" tabindex="-1"></a>clusterMembership <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb451-49"><a href="#cb451-49" aria-hidden="true" tabindex="-1"></a>plotOrder <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb451-50"><a href="#cb451-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb451-51"><a href="#cb451-51" aria-hidden="true" tabindex="-1"></a>    clusterMembership[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNames[i]</span>
<span id="cb451-52"><a href="#cb451-52" aria-hidden="true" tabindex="-1"></a>    plotOrder[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb451-53"><a href="#cb451-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb451-54"><a href="#cb451-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-55"><a href="#cb451-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb451-56"><a href="#cb451-56" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_highViSHetRegion, clusterMembership, clusterNames)</span>
<span id="cb451-57"><a href="#cb451-57" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb451-58"><a href="#cb451-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-59"><a href="#cb451-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb451-60"><a href="#cb451-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-61"><a href="#cb451-61" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb451-62"><a href="#cb451-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-63"><a href="#cb451-63" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb451-64"><a href="#cb451-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-65"><a href="#cb451-65" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames)</span>
<span id="cb451-66"><a href="#cb451-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-67"><a href="#cb451-67" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames; among<span class="op">=</span><span class="cn">false</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb451-68"><a href="#cb451-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-69"><a href="#cb451-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb451-70"><a href="#cb451-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-71"><a href="#cb451-71" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb451-72"><a href="#cb451-72" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb451-73"><a href="#cb451-73" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster  pi         </span></span>
<span id="cb451-74"><a href="#cb451-74" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String   Float64    </span></span>
<span id="cb451-75"><a href="#cb451-75" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────</span></span>
<span id="cb451-76"><a href="#cb451-76" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ vir      0.0132903</span></span>
<span id="cb451-77"><a href="#cb451-77" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit      0.00761773</span></span>
<span id="cb451-78"><a href="#cb451-78" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ lud      0.014873</span></span>
<span id="cb451-79"><a href="#cb451-79" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ troch    0.0101873</span></span>
<span id="cb451-80"><a href="#cb451-80" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ obs      0.00904222</span></span>
<span id="cb451-81"><a href="#cb451-81" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ plumb    0.00593251 =#</span></span>
<span id="cb451-82"><a href="#cb451-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-83"><a href="#cb451-83" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb451-84"><a href="#cb451-84" aria-hidden="true" tabindex="-1"></a><span class="co">#= 15×2 DataFrame</span></span>
<span id="cb451-85"><a href="#cb451-85" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair  Dxy       </span></span>
<span id="cb451-86"><a href="#cb451-86" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String        Float64   </span></span>
<span id="cb451-87"><a href="#cb451-87" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────</span></span>
<span id="cb451-88"><a href="#cb451-88" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ vir_nit       0.0280243</span></span>
<span id="cb451-89"><a href="#cb451-89" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ vir_lud       0.0204941</span></span>
<span id="cb451-90"><a href="#cb451-90" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ vir_troch     0.0394257</span></span>
<span id="cb451-91"><a href="#cb451-91" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ vir_obs       0.0403572</span></span>
<span id="cb451-92"><a href="#cb451-92" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ vir_plumb     0.0376188</span></span>
<span id="cb451-93"><a href="#cb451-93" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ nit_lud       0.0288021</span></span>
<span id="cb451-94"><a href="#cb451-94" aria-hidden="true" tabindex="-1"></a><span class="co">   7 │ nit_troch     0.0377964</span></span>
<span id="cb451-95"><a href="#cb451-95" aria-hidden="true" tabindex="-1"></a><span class="co">   8 │ nit_obs       0.0389254</span></span>
<span id="cb451-96"><a href="#cb451-96" aria-hidden="true" tabindex="-1"></a><span class="co">   9 │ nit_plumb     0.0359742</span></span>
<span id="cb451-97"><a href="#cb451-97" aria-hidden="true" tabindex="-1"></a><span class="co">  10 │ lud_troch     0.0390498</span></span>
<span id="cb451-98"><a href="#cb451-98" aria-hidden="true" tabindex="-1"></a><span class="co">  11 │ lud_obs       0.0398045</span></span>
<span id="cb451-99"><a href="#cb451-99" aria-hidden="true" tabindex="-1"></a><span class="co">  12 │ lud_plumb     0.0371989</span></span>
<span id="cb451-100"><a href="#cb451-100" aria-hidden="true" tabindex="-1"></a><span class="co">  13 │ troch_obs     0.015702</span></span>
<span id="cb451-101"><a href="#cb451-101" aria-hidden="true" tabindex="-1"></a><span class="co">  14 │ troch_plumb   0.0285113</span></span>
<span id="cb451-102"><a href="#cb451-102" aria-hidden="true" tabindex="-1"></a><span class="co">  15 │ obs_plumb     0.0286543 =#</span></span>
<span id="cb451-103"><a href="#cb451-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-104"><a href="#cb451-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a genotype-by-individual plot using all variable loci in the region,</span></span>
<span id="cb451-105"><a href="#cb451-105" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb451-106"><a href="#cb451-106" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb451-107"><a href="#cb451-107" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_Fst_groups <span class="op">=</span> PCAmodelAll.metadata.Fst_group <span class="co"># store the Fst_groups in this</span></span>
<span id="cb451-108"><a href="#cb451-108" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembership</span>
<span id="cb451-109"><a href="#cb451-109" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.original_plot_order <span class="op">=</span> PCAmodelAll.metadata.plot_order <span class="co"># store the original plot_order in this</span></span>
<span id="cb451-110"><a href="#cb451-110" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrder</span>
<span id="cb451-111"><a href="#cb451-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-112"><a href="#cb451-112" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb451-113"><a href="#cb451-113" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb451-114"><a href="#cb451-114" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb451-115"><a href="#cb451-115" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb451-116"><a href="#cb451-116" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb451-117"><a href="#cb451-117" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs <span class="op">=</span> genos_highViSHetRegion[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb451-118"><a href="#cb451-118" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs <span class="op">=</span> pos_highViSHetRegion[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb451-119"><a href="#cb451-119" aria-hidden="true" tabindex="-1"></a>Fst_selectedSNPs <span class="op">=</span> Fst[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb451-120"><a href="#cb451-120" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb451-121"><a href="#cb451-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-122"><a href="#cb451-122" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb451-123"><a href="#cb451-123" aria-hidden="true" tabindex="-1"></a>numIndsToPlot <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNames))</span>
<span id="cb451-124"><a href="#cb451-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-125"><a href="#cb451-125" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNames, numIndsToPlot, </span>
<span id="cb451-126"><a href="#cb451-126" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb451-127"><a href="#cb451-127" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb451-128"><a href="#cb451-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-129"><a href="#cb451-129" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb451-130"><a href="#cb451-130" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNames, clusterColors;</span>
<span id="cb451-131"><a href="#cb451-131" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb451-132"><a href="#cb451-132" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The numbers in each group are [38 2 29 68 4 66] and the sum of those is 207
Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-166-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="166">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 0 0; 2 2 … 0 0], [5852400, 5876520, 5876593, 5882337, 5882559, 5893275, 5901011, 5923576, 5923618, 5932214  …  6525018, 6533933, 6538226, 6559702, 6559912, 6582488, 6582518, 6594141, 6611772, 6618858], <span class="ansi-bold">66×42 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir     ⋯
   2 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir
   3 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   4 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   5 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   6 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   7 │ GW_Lane5_AA3               GW_Lane5_AA3               AA        vir_S
   8 │ GW_Lane5_AA5               GW_Lane5_AA5               AA        vir_S
   9 │ GW_Lane5_AA9               GW_Lane5_AA9               AA        vir_S   ⋯
  10 │ GW_Lane5_TL10              GW_Lane5_TL10              TL        vir
  11 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  57 │ GW_Armando_plate1_JF11G01  GW_Armando_plate1_JF11G01  ST        plumb
  58 │ GW_Armando_plate1_JF12G02  GW_Armando_plate1_JF12G02  ST        plumb   ⋯
  59 │ GW_Armando_plate1_JF13G01  GW_Armando_plate1_JF13G01  ST        plumb
  60 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
  61 │ GW_Armando_plate1_JF20G01  GW_Armando_plate1_JF20G01  MB        plumb
  62 │ GW_Armando_plate1_JF22G01  GW_Armando_plate1_JF22G01  MB        plumb   ⋯
  63 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
  64 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  65 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb
  66 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb   ⋯
<span class="ansi-cyan-fg">                                                  39 columns and 45 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-12" class="level3">
<h3 class="anchored" data-anchor-id="now-show-a-gbi-plot-like-above-but-with-heterozygotes-12">Now show a GBI plot like above, but with heterozygotes:</h3>
<div id="7b360f96" class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHets <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud"</span>,</span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"ludHet"</span>,</span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud_troch"</span>,</span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs_plumb"</span>,</span>
<span id="cb454-9"><a href="#cb454-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span>,</span>
<span id="cb454-10"><a href="#cb454-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"vir_plumb"</span>]</span>
<span id="cb454-11"><a href="#cb454-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-12"><a href="#cb454-12" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHets <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb454-13"><a href="#cb454-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"grey"</span>,</span>
<span id="cb454-14"><a href="#cb454-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb454-15"><a href="#cb454-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb454-16"><a href="#cb454-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"seagreen"</span>,</span>
<span id="cb454-17"><a href="#cb454-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>,</span>
<span id="cb454-18"><a href="#cb454-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"orange"</span>,</span>
<span id="cb454-19"><a href="#cb454-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">"darkorange1"</span>,</span>
<span id="cb454-20"><a href="#cb454-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">"red"</span>,</span>
<span id="cb454-21"><a href="#cb454-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">"purple"</span>]</span>
<span id="cb454-22"><a href="#cb454-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-23"><a href="#cb454-23" aria-hidden="true" tabindex="-1"></a>ludHet <span class="op">=</span> (PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">4</span>) <span class="op">.&amp;</span></span>
<span id="cb454-24"><a href="#cb454-24" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">0.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC3 <span class="op">.&lt;</span> <span class="fl">7</span>) <span class="op">.&amp;</span></span>
<span id="cb454-25"><a href="#cb454-25" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb454-26"><a href="#cb454-26" aria-hidden="true" tabindex="-1"></a>lud_troch <span class="op">=</span> (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb454-27"><a href="#cb454-27" aria-hidden="true" tabindex="-1"></a>            (<span class="op">-</span><span class="fl">4</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb454-28"><a href="#cb454-28" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb454-29"><a href="#cb454-29" aria-hidden="true" tabindex="-1"></a>obs_plumb <span class="op">=</span> (<span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb454-30"><a href="#cb454-30" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">0</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">1</span>) <span class="op">.&amp;</span></span>
<span id="cb454-31"><a href="#cb454-31" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb454-32"><a href="#cb454-32" aria-hidden="true" tabindex="-1"></a>vir_plumb <span class="op">=</span> (<span class="op">-</span><span class="fl">3</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC1 <span class="op">.&lt;</span> <span class="fl">0</span>) <span class="op">.&amp;</span></span>
<span id="cb454-33"><a href="#cb454-33" aria-hidden="true" tabindex="-1"></a>            (<span class="fl">2.5</span> <span class="op">.&lt;</span> PCAmodelAll.metadata.PC2 <span class="op">.&lt;</span> <span class="fl">5</span>) <span class="op">.&amp;</span></span>
<span id="cb454-34"><a href="#cb454-34" aria-hidden="true" tabindex="-1"></a>            .!indSelection_lowIndHetStan</span>
<span id="cb454-35"><a href="#cb454-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-36"><a href="#cb454-36" aria-hidden="true" tabindex="-1"></a>clusterArray <span class="op">=</span> [vir nit lud ludHet lud_troch troch obs obs_plumb plumb vir_plumb]</span>
<span id="cb454-37"><a href="#cb454-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-38"><a href="#cb454-38" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb454-39"><a href="#cb454-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-40"><a href="#cb454-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">==</span> <span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>)</span>
<span id="cb454-41"><a href="#cb454-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Good news: Individuals included in a group matches total number of individuals"</span>)</span>
<span id="cb454-42"><a href="#cb454-42" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb454-43"><a href="#cb454-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Warning: Individuals included in a group (</span><span class="sc">$</span>(<span class="fu">sum</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">1</span>)))<span class="st">) do NOT match total number of individuals (</span><span class="sc">$</span>(<span class="fu">size</span>(PCAmodelAll.metadata, <span class="fl">1</span>))<span class="st">)"</span>)</span>
<span id="cb454-44"><a href="#cb454-44" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb454-45"><a href="#cb454-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-46"><a href="#cb454-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-47"><a href="#cb454-47" aria-hidden="true" tabindex="-1"></a><span class="co"># check which individuals left out:</span></span>
<span id="cb454-48"><a href="#cb454-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-49"><a href="#cb454-49" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb454-50"><a href="#cb454-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-51"><a href="#cb454-51" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.ind[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb454-52"><a href="#cb454-52" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC1[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb454-53"><a href="#cb454-53" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC2[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb454-54"><a href="#cb454-54" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan[<span class="fu">vec</span>(<span class="fu">sum</span>(clusterArray, dims<span class="op">=</span><span class="fl">2</span>) <span class="op">.==</span> <span class="fl">0</span>)]</span>
<span id="cb454-55"><a href="#cb454-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-56"><a href="#cb454-56" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors that indicate the groups and plot order for this analysis:</span></span>
<span id="cb454-57"><a href="#cb454-57" aria-hidden="true" tabindex="-1"></a>clusterMembershipWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="st">"none"</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb454-58"><a href="#cb454-58" aria-hidden="true" tabindex="-1"></a>plotOrderWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">9</span>, <span class="fu">nrow</span>(PCAmodelAll.metadata))</span>
<span id="cb454-59"><a href="#cb454-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(clusterArray[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb454-60"><a href="#cb454-60" aria-hidden="true" tabindex="-1"></a>    clusterMembershipWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> clusterNamesWithHets[i]</span>
<span id="cb454-61"><a href="#cb454-61" aria-hidden="true" tabindex="-1"></a>    plotOrderWithHets[clusterArray[<span class="op">:</span>,i]] <span class="op">.=</span> i</span>
<span id="cb454-62"><a href="#cb454-62" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb454-63"><a href="#cb454-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-64"><a href="#cb454-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to main metadata object containing the cluster membership for this highHet region:</span></span>
<span id="cb454-65"><a href="#cb454-65" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_cluster = clusterMembershipWithHets"</span></span>
<span id="cb454-66"><a href="#cb454-66" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb454-67"><a href="#cb454-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-68"><a href="#cb454-68" aria-hidden="true" tabindex="-1"></a><span class="co"># in metadata, replace `Fst_group` column with cluster info (needed for the function below):</span></span>
<span id="cb454-69"><a href="#cb454-69" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.Fst_group <span class="op">=</span> clusterMembershipWithHets</span>
<span id="cb454-70"><a href="#cb454-70" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> plotOrderWithHets</span>
<span id="cb454-71"><a href="#cb454-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-72"><a href="#cb454-72" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the number of individuals per group to plot</span></span>
<span id="cb454-73"><a href="#cb454-73" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">15</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb454-74"><a href="#cb454-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-75"><a href="#cb454-75" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb454-76"><a href="#cb454-76" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb454-77"><a href="#cb454-77" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb454-78"><a href="#cb454-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-79"><a href="#cb454-79" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb454-80"><a href="#cb454-80" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb454-81"><a href="#cb454-81" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb454-82"><a href="#cb454-82" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb454-83"><a href="#cb454-83" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: Individuals included in a group matches total number of individuals</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-167-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="167">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 1 … 0 0; 1 1 … 0 0], [5852400, 5876520, 5876593, 5882337, 5882559, 5893275, 5901011, 5923576, 5923618, 5932214  …  6525018, 6533933, 6538226, 6559702, 6559912, 6582488, 6582518, 6594141, 6611772, 6618858], <span class="ansi-bold">91×42 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir     ⋯
   2 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir
   3 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   4 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   5 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis ⋯
   6 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   7 │ GW_Lane5_AA3               GW_Lane5_AA3               AA        vir_S
   8 │ GW_Lane5_AA5               GW_Lane5_AA5               AA        vir_S
   9 │ GW_Lane5_AA9               GW_Lane5_AA9               AA        vir_S   ⋯
  10 │ GW_Lane5_TL10              GW_Lane5_TL10              TL        vir
  11 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  82 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  83 │ GW_Armando_plate1_JF26G01  GW_Armando_plate1_JF26G01  ST        plumb   ⋯
  84 │ GW_Armando_plate1_JF27G01  GW_Armando_plate1_JF27G01  ST        plumb
  85 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
  86 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
  87 │ GW_Armando_plate2_JF14G02  GW_Armando_plate2_JF14G02  DV        plumb   ⋯
  88 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v
  89 │ GW_Armando_plate2_JF15G01  GW_Armando_plate2_JF15G01  DV        plumb
  90 │ GW_Armando_plate2_JF24G03  GW_Armando_plate2_JF24G03  ST        plumb
  91 │ GW_Armando_plate2_JF26G02  GW_Armando_plate2_JF26G02  ST        plumb   ⋯
<span class="ansi-cyan-fg">                                                  39 columns and 70 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-gbi-plot-according-to-original-groups-and-plot-order-8" class="level3">
<h3 class="anchored" data-anchor-id="show-gbi-plot-according-to-original-groups-and-plot-order-8">show GBI plot according to original groups and plot order</h3>
<div id="6535a3b0" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb457-5"><a href="#cb457-5" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb457-6"><a href="#cb457-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-7"><a href="#cb457-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb457-8"><a href="#cb457-8" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb457-9"><a href="#cb457-9" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb457-10"><a href="#cb457-10" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb457-11"><a href="#cb457-11" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-168-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="168">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 1 1 … 0 0; 1 1 … 0 0], [5852400, 5876520, 5876593, 5882337, 5882559, 5893275, 5901011, 5923576, 5923618, 5932214  …  6525018, 6533933, 6538226, 6559702, 6559912, 6582488, 6582518, 6594141, 6611772, 6618858], <span class="ansi-bold">91×42 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   5 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v ⋯
   6 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis
   7 │ GW_Armando_plate1_AB1      GW_Armando_plate1_AB1      AB        vir
   8 │ GW_Lane5_TL10              GW_Lane5_TL10              TL        vir
   9 │ GW_Lane5_TL11              GW_Lane5_TL11              TL        vir     ⋯
  10 │ GW_Lane5_TL9               GW_Lane5_TL9               TL        vir
  11 │ GW_Armando_plate1_TL3      GW_Armando_plate1_TL3      TL        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  82 │ GW_Armando_plate1_JF12G01  GW_Armando_plate1_JF12G01  ST        plumb
  83 │ GW_Armando_plate2_JF24G03  GW_Armando_plate2_JF24G03  ST        plumb   ⋯
  84 │ GW_Armando_plate2_JF26G02  GW_Armando_plate2_JF26G02  ST        plumb
  85 │ GW_Armando_plate1_JF15G03  GW_Armando_plate1_JF15G03  DV        plumb
  86 │ GW_Armando_plate2_JF14G02  GW_Armando_plate2_JF14G02  DV        plumb
  87 │ GW_Armando_plate2_JF15G01  GW_Armando_plate2_JF15G01  DV        plumb   ⋯
  88 │ GW_Armando_plate1_JF23G01  GW_Armando_plate1_JF23G01  VB        plumb
  89 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
  90 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
  91 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  39 columns and 70 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-same-but-with-all-individuals-8" class="level3">
<h3 class="anchored" data-anchor-id="show-same-but-with-all-individuals-8">show same but with all individuals</h3>
<div id="c0083d25" class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.plot_order <span class="op">=</span> PCAmodelAll.metadata.original_plot_order</span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set no limit (or high limit anyway) on the number of individuals per group to plot</span></span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">1000</span>, <span class="fu">length</span>(clusterNamesWithHets))</span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHets, numIndsToPlotWithHets, </span>
<span id="cb459-7"><a href="#cb459-7" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs, PCAmodelAll.metadata;</span>
<span id="cb459-8"><a href="#cb459-8" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb459-9"><a href="#cb459-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-10"><a href="#cb459-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs,</span>
<span id="cb459-11"><a href="#cb459-11" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs, clusterNamesWithHets, clusterColorsWithHets;</span>
<span id="cb459-12"><a href="#cb459-12" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb459-13"><a href="#cb459-13" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb459-14"><a href="#cb459-14" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-169-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="169">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 0 0; 1 1 … 0 0], [5852400, 5876520, 5876593, 5882337, 5882559, 5893275, 5901011, 5923576, 5923618, 5932214  …  6525018, 6533933, 6538226, 6559702, 6559912, 6582488, 6582518, 6594141, 6611772, 6618858], <span class="ansi-bold">257×42 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK4               GW_Lane5_YK4               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 248 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb
 249 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb   ⋯
 250 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 251 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 252 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 253 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb   ⋯
 254 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 255 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 256 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 257 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 39 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-west-area-without-nitidus-9" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-west-area-without-nitidus-9">Show just the west area (without nitidus)</h3>
<div id="8ecb7799" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsWest <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud"</span>,</span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"ludHet"</span>,</span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud_troch"</span>,</span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>]</span>
<span id="cb461-6"><a href="#cb461-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-7"><a href="#cb461-7" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsWest <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb461-8"><a href="#cb461-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb461-9"><a href="#cb461-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"green"</span>,</span>
<span id="cb461-10"><a href="#cb461-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"seagreen"</span>,</span>
<span id="cb461-11"><a href="#cb461-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"yellow"</span>]</span>
<span id="cb461-12"><a href="#cb461-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-13"><a href="#cb461-13" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb461-14"><a href="#cb461-14" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb461-15"><a href="#cb461-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb461-16"><a href="#cb461-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb461-17"><a href="#cb461-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb461-18"><a href="#cb461-18" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsWest)</span>
<span id="cb461-19"><a href="#cb461-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb461-20"><a href="#cb461-20" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb461-21"><a href="#cb461-21" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb461-22"><a href="#cb461-22" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb461-23"><a href="#cb461-23" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb461-24"><a href="#cb461-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-25"><a href="#cb461-25" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsWest))</span>
<span id="cb461-26"><a href="#cb461-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-27"><a href="#cb461-27" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsWest, numIndsToPlotWithHets, </span>
<span id="cb461-28"><a href="#cb461-28" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb461-29"><a href="#cb461-29" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb461-30"><a href="#cb461-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-31"><a href="#cb461-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb461-32"><a href="#cb461-32" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsWest, clusterColorsWithHetsWest;</span>
<span id="cb461-33"><a href="#cb461-33" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb461-34"><a href="#cb461-34" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb461-35"><a href="#cb461-35" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-170-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="170">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], [5852400, 5876593, 5882559, 5901011, 5923576, 5923618, 5945810, 5966423, 5970604, 5986806  …  6459128, 6459167, 6465882, 6465908, 6472163, 6472190, 6538226, 6582488, 6594141, 6611772], <span class="ansi-bold">177×42 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 168 │ GW_Lane5_LN18              GW_Lane5_LN18              LN        troch_L
 169 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L ⋯
 170 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L
 171 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L
 172 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
 173 │ GW_Lane5_LN6               GW_Lane5_LN6               LN        troch_L ⋯
 174 │ GW_Lane5_LN7               GW_Lane5_LN7               LN        troch_L
 175 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L
 176 │ GW_Lane5_LN10              GW_Lane5_LN10              LN        troch_L
 177 │ GW_Lane5_LN12              GW_Lane5_LN12              LN        troch_L ⋯
<span class="ansi-cyan-fg">                                                 39 columns and 156 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-east-area-10" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-east-area-10">Show just the east area</h3>
<div id="79948bed" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsEast <span class="op">=</span> [<span class="st">"troch"</span>,</span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs"</span>,</span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"obs_plumb"</span>,</span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-6"><a href="#cb464-6" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsEast <span class="op">=</span> [<span class="st">"yellow"</span>,</span>
<span id="cb464-7"><a href="#cb464-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"orange"</span>,</span>
<span id="cb464-8"><a href="#cb464-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"darkorange1"</span>,</span>
<span id="cb464-9"><a href="#cb464-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb464-10"><a href="#cb464-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-11"><a href="#cb464-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb464-12"><a href="#cb464-12" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb464-13"><a href="#cb464-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb464-14"><a href="#cb464-14" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb464-15"><a href="#cb464-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb464-16"><a href="#cb464-16" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsEast)</span>
<span id="cb464-17"><a href="#cb464-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb464-18"><a href="#cb464-18" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb464-19"><a href="#cb464-19" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb464-20"><a href="#cb464-20" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb464-21"><a href="#cb464-21" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb464-22"><a href="#cb464-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-23"><a href="#cb464-23" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHetsEast <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsEast))</span>
<span id="cb464-24"><a href="#cb464-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-25"><a href="#cb464-25" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsEast, numIndsToPlotWithHetsEast, </span>
<span id="cb464-26"><a href="#cb464-26" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb464-27"><a href="#cb464-27" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb464-28"><a href="#cb464-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-29"><a href="#cb464-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb464-30"><a href="#cb464-30" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsEast, clusterColorsWithHetsEast;</span>
<span id="cb464-31"><a href="#cb464-31" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb464-32"><a href="#cb464-32" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb464-33"><a href="#cb464-33" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-171-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="171">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 1; 0 0 … 2 0; … ; 2 2 … 0 2; 2 2 … 2 2], [5876520, 5882337, 5893275, 5923576, 5923618, 5932416, 5945810, 5966423, 5989088, 6012800  …  6433886, 6433927, 6498576, 6525018, 6533933, 6559702, 6559912, 6582488, 6582518, 6611772], <span class="ansi-bold">139×42 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_TTGW70   GW_Armando_plate1_TTGW70   SA        lud_Sat ⋯
   2 │ GW_Armando_plate1_TTGW72   GW_Armando_plate1_TTGW72   SA        lud_Sat
   3 │ GW_Armando_plate1_TTGW78   GW_Armando_plate1_TTGW78   SA        lud_Sat
   4 │ GW_Armando_plate2_TTGW73   GW_Armando_plate2_TTGW73   SA        lud_Sat
   5 │ GW_Armando_plate2_TTGW75   GW_Armando_plate2_TTGW75   SA        lud_Sat ⋯
   6 │ GW_Armando_plate2_TTGW80   GW_Armando_plate2_TTGW80   SA        lud_Sat
   7 │ GW_Armando_plate1_TTGW11   GW_Armando_plate1_TTGW11   SU        lud_Suk
   8 │ GW_Armando_plate2_TTGW09   GW_Armando_plate2_TTGW09   SU        lud_Suk
   9 │ GW_Liz_GBS_Liz10045        GW_Liz_GBS_Liz10045        ML        lud     ⋯
  10 │ GW_Liz_GBS_Liz10094        GW_Liz_GBS_Liz10094        ML        lud
  11 │ GW_Liz_GBS_Liz5163         GW_Liz_GBS_Liz5163         ML        lud_chi
  ⋮  │             ⋮                          ⋮                 ⋮            ⋮ ⋱
 130 │ GW_Armando_plate1_JF23G02  GW_Armando_plate1_JF23G02  VB        plumb
 131 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb   ⋯
 132 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb
 133 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 134 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 135 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 136 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 137 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 138 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 139 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb   ⋯
<span class="ansi-cyan-fg">                                                 39 columns and 118 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="show-just-the-northern-area-10" class="level3">
<h3 class="anchored" data-anchor-id="show-just-the-northern-area-10">Show just the northern area</h3>
<div id="5c226c4b" class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a>clusterNamesWithHetsNorth <span class="op">=</span> [<span class="st">"vir"</span>,</span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"vir_plumb"</span>,</span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"plumb"</span>]</span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-5"><a href="#cb467-5" aria-hidden="true" tabindex="-1"></a>clusterColorsWithHetsNorth <span class="op">=</span> [<span class="st">"blue"</span>,</span>
<span id="cb467-6"><a href="#cb467-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"purple"</span>,</span>
<span id="cb467-7"><a href="#cb467-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"red"</span>]</span>
<span id="cb467-8"><a href="#cb467-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-9"><a href="#cb467-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the SNPs to those with variants greater than 50% in </span></span>
<span id="cb467-10"><a href="#cb467-10" aria-hidden="true" tabindex="-1"></a><span class="co"># at least one pop, and less than 50% in at least one pop.</span></span>
<span id="cb467-11"><a href="#cb467-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (So for each column in `freqs`, the maximum should be &gt; 0.5 </span></span>
<span id="cb467-12"><a href="#cb467-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the minimum should be &lt; 0.5)</span></span>
<span id="cb467-13"><a href="#cb467-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb467-14"><a href="#cb467-14" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genos_selectedSNPs, clusterMembershipWithHets, clusterNamesWithHetsNorth)</span>
<span id="cb467-15"><a href="#cb467-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb467-16"><a href="#cb467-16" aria-hidden="true" tabindex="-1"></a>selectedSNPs <span class="op">=</span> (<span class="fu">vec</span>(<span class="fu">maximum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&gt;</span> <span class="fl">0.5</span>) <span class="op">.&amp;</span> (<span class="fu">vec</span>(<span class="fu">minimum</span>(freqs, dims<span class="op">=</span><span class="fl">1</span>)) <span class="op">.&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb467-17"><a href="#cb467-17" aria-hidden="true" tabindex="-1"></a>genos_selectedSNPs2 <span class="op">=</span> genos_selectedSNPs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb467-18"><a href="#cb467-18" aria-hidden="true" tabindex="-1"></a>pos_selectedSNPs2 <span class="op">=</span> pos_selectedSNPs[selectedSNPs, <span class="op">:</span>]</span>
<span id="cb467-19"><a href="#cb467-19" aria-hidden="true" tabindex="-1"></a>freqs_selectedSNPs2 <span class="op">=</span> freqs[<span class="op">:</span>, selectedSNPs]</span>
<span id="cb467-20"><a href="#cb467-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-21"><a href="#cb467-21" aria-hidden="true" tabindex="-1"></a>numIndsToPlotWithHets <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">100</span>, <span class="fu">length</span>(clusterNamesWithHetsNorth))</span>
<span id="cb467-22"><a href="#cb467-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-23"><a href="#cb467-23" aria-hidden="true" tabindex="-1"></a>genosForGBI, indMetadataforGBI <span class="op">=</span> <span class="fu">limitIndsToPlot</span>(clusterNamesWithHetsNorth, numIndsToPlotWithHets, </span>
<span id="cb467-24"><a href="#cb467-24" aria-hidden="true" tabindex="-1"></a>                                            genos_selectedSNPs2, PCAmodelAll.metadata;</span>
<span id="cb467-25"><a href="#cb467-25" aria-hidden="true" tabindex="-1"></a>                                            sortByMissing <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb467-26"><a href="#cb467-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-27"><a href="#cb467-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plotGenotypeByIndividual</span>(regionInfo, pos_selectedSNPs2,</span>
<span id="cb467-28"><a href="#cb467-28" aria-hidden="true" tabindex="-1"></a>                genosForGBI, indMetadataforGBI, freqs_selectedSNPs2, clusterNamesWithHetsNorth, clusterColorsWithHetsNorth;</span>
<span id="cb467-29"><a href="#cb467-29" aria-hidden="true" tabindex="-1"></a>                missingFractionAllowed <span class="op">=</span> missingFractionAllowed,</span>
<span id="cb467-30"><a href="#cb467-30" aria-hidden="true" tabindex="-1"></a>                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb467-31"><a href="#cb467-31" aria-hidden="true" tabindex="-1"></a>                indColorRightProvided <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-172-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="172">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  2 Child Scenes:
    ├ Scene (768px, 960px)
    └ Scene (768px, 960px), Union{Missing, Int16}[0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 1 1 … 1 2], [5852400, 5876520, 5876593, 5882337, 5882559, 5893275, 5901011, 5970604, 5986806, 5994647  …  6459167, 6465882, 6465908, 6472163, 6472190, 6533933, 6538226, 6559702, 6559912, 6594141], <span class="ansi-bold">111×42 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK7               GW_Lane5_YK7               YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 102 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 103 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 104 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 105 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 106 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
 107 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb   ⋯
 108 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 109 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 110 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 111 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  39 columns and 90 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
</section>
<section id="try-chr-27" class="level2">
<h2 class="anchored" data-anchor-id="try-chr-27">Try chr 27</h2>
<div id="061e6135" class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose scaffold</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw27"</span></span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a>positionMin, positionMax, regionText, </span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb470-7"><a href="#cb470-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb470-8"><a href="#cb470-8" aria-hidden="true" tabindex="-1"></a>                            pos_SNP_filtered, </span>
<span id="cb470-9"><a href="#cb470-9" aria-hidden="true" tabindex="-1"></a>                            highViSHetRegions, chr;</span>
<span id="cb470-10"><a href="#cb470-10" aria-hidden="true" tabindex="-1"></a>                            windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb470-11"><a href="#cb470-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-12"><a href="#cb470-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect values for mean IndHetStan per individual for that high ViSHet region</span></span>
<span id="cb470-13"><a href="#cb470-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanAcrossRegionIndHetStan)</span>
<span id="cb470-14"><a href="#cb470-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-15"><a href="#cb470-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column to metadata containing the regionIndHetStan for this highHet region:</span></span>
<span id="cb470-16"><a href="#cb470-16" aria-hidden="true" tabindex="-1"></a>command <span class="op">=</span> <span class="st">"ind_with_metadata_included."</span> <span class="op">*</span> chr <span class="op">*</span> <span class="st">"_regionIndHetStan = meanAcrossRegionIndHetStan"</span></span>
<span id="cb470-17"><a href="#cb470-17" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb470-18"><a href="#cb470-18" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included.regionIndHetStan <span class="op">=</span> meanAcrossRegionIndHetStan</span>
<span id="cb470-19"><a href="#cb470-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-20"><a href="#cb470-20" aria-hidden="true" tabindex="-1"></a><span class="co">#names(ind_with_metadata_included)</span></span>
<span id="cb470-21"><a href="#cb470-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-22"><a href="#cb470-22" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether missing data related to heterozygosity (good news: not really)</span></span>
<span id="cb470-23"><a href="#cb470-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_with_metadata_included.numMissings, meanAcrossRegionIndHetStan)</span>
<span id="cb470-24"><a href="#cb470-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-25"><a href="#cb470-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA of all individuals:</span></span>
<span id="cb470-26"><a href="#cb470-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-27"><a href="#cb470-27" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="op">=</span> Impute.<span class="fu">svd</span>(<span class="fu">Matrix</span><span class="dt">{Union{Missing, Float32}}</span>(genos_highViSHetRegion))</span>
<span id="cb470-28"><a href="#cb470-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-29"><a href="#cb470-29" aria-hidden="true" tabindex="-1"></a>flipPC1 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb470-30"><a href="#cb470-30" aria-hidden="true" tabindex="-1"></a>flipPC2 <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb470-31"><a href="#cb470-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-32"><a href="#cb470-32" aria-hidden="true" tabindex="-1"></a>PCAmodelAll <span class="op">=</span> <span class="fu">plotPCA</span>(genos_highViSHetRegion_imputed, ind_with_metadata_included, </span>
<span id="cb470-33"><a href="#cb470-33" aria-hidden="true" tabindex="-1"></a>            groups_to_plot_PCA, group_colors_PCA; </span>
<span id="cb470-34"><a href="#cb470-34" aria-hidden="true" tabindex="-1"></a>            sampleSet <span class="op">=</span> <span class="st">"greenish warblers"</span>, regionText <span class="op">=</span> regionText,</span>
<span id="cb470-35"><a href="#cb470-35" aria-hidden="true" tabindex="-1"></a>            flip1 <span class="op">=</span> flipPC1, flip2 <span class="op">=</span> flipPC2,</span>
<span id="cb470-36"><a href="#cb470-36" aria-hidden="true" tabindex="-1"></a>            lineOpacity <span class="op">=</span> <span class="fl">0.7</span>, fillOpacity <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span id="cb470-37"><a href="#cb470-37" aria-hidden="true" tabindex="-1"></a>            symbolSize <span class="op">=</span> <span class="fl">14</span>, showTitle <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb470-38"><a href="#cb470-38" aria-hidden="true" tabindex="-1"></a>            xLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC1"</span>), yLabelText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Region PC2"</span>),</span>
<span id="cb470-39"><a href="#cb470-39" aria-hidden="true" tabindex="-1"></a>            showPlot <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb470-40"><a href="#cb470-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-41"><a href="#cb470-41" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(PCAmodelAll.PCAfig)</span>
<span id="cb470-42"><a href="#cb470-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-43"><a href="#cb470-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Add PC values to metadata for individuals included in PCA above:</span></span>
<span id="cb470-44"><a href="#cb470-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC1</span>
<span id="cb470-45"><a href="#cb470-45" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb470-46"><a href="#cb470-46" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb470-47"><a href="#cb470-47" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC1 <span class="op">=</span> PCAmodelAll.values[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb470-48"><a href="#cb470-48" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb470-49"><a href="#cb470-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> flipPC2</span>
<span id="cb470-50"><a href="#cb470-50" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">.*</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb470-51"><a href="#cb470-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb470-52"><a href="#cb470-52" aria-hidden="true" tabindex="-1"></a>    PCAmodelAll.metadata.PC2 <span class="op">=</span> PCAmodelAll.values[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb470-53"><a href="#cb470-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb470-54"><a href="#cb470-54" aria-hidden="true" tabindex="-1"></a>PCAmodelAll.metadata.PC3 <span class="op">=</span> PCAmodelAll.values[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb470-55"><a href="#cb470-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-56"><a href="#cb470-56" aria-hidden="true" tabindex="-1"></a><span class="co"># For the next bit to work with above, make sure that all individuals in the above `plotPCA` command</span></span>
<span id="cb470-57"><a href="#cb470-57" aria-hidden="true" tabindex="-1"></a><span class="co"># are included in the `groups_to_plot_PCA`</span></span>
<span id="cb470-58"><a href="#cb470-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-59"><a href="#cb470-59" aria-hidden="true" tabindex="-1"></a><span class="co"># choose inds with low IndHet in high ViSHet region:</span></span>
<span id="cb470-60"><a href="#cb470-60" aria-hidden="true" tabindex="-1"></a>indSelection_lowIndHetStan <span class="op">=</span> (meanAcrossRegionIndHetStan <span class="op">.&lt;</span> <span class="fl">1.4</span>) </span>
<span id="cb470-61"><a href="#cb470-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-62"><a href="#cb470-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot only the lowIndHetStan individuals:</span></span>
<span id="cb470-63"><a href="#cb470-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-64"><a href="#cb470-64" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>();</span>
<span id="cb470-65"><a href="#cb470-65" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb470-66"><a href="#cb470-66" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2, only low heterozygosity"</span>,</span>
<span id="cb470-67"><a href="#cb470-67" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb470-68"><a href="#cb470-68" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb470-69"><a href="#cb470-69" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb470-70"><a href="#cb470-70" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb470-71"><a href="#cb470-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb470-72"><a href="#cb470-72" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> (PCAmodelAll.metadata.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]) <span class="op">.&amp;</span> indSelection_lowIndHetStan</span>
<span id="cb470-73"><a href="#cb470-73" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCAmodelAll.metadata.PC1[selection], PCAmodelAll.metadata.PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb470-74"><a href="#cb470-74" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb470-75"><a href="#cb470-75" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238
┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-173-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-173-output-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="173">
<pre><code>CairoMakie.Screen{IMAGE}</code></pre>
</div>
</div>
</section>
<section id="tried-chr-1-but-some-unclean-distinguishing-of-ludlowi-clusters-no-wide-sharing-of-plumb" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-1-but-some-unclean-distinguishing-of-ludlowi-clusters-no-wide-sharing-of-plumb">Tried chr 1 but some unclean distinguishing of ludlowi clusters (no wide sharing of plumb)</h2>
</section>
<section id="included-chr-1a" class="level2">
<h2 class="anchored" data-anchor-id="included-chr-1a">Included chr 1A</h2>
</section>
<section id="tried-chr-2-but-some-unclean-distinguishing-of-ludlowi-clusters-with-some-sharing-of-plumb" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-2-but-some-unclean-distinguishing-of-ludlowi-clusters-with-some-sharing-of-plumb">Tried chr 2 but some unclean distinguishing of ludlowi clusters (with some sharing of plumb)</h2>
</section>
<section id="included-chr-3" class="level2">
<h2 class="anchored" data-anchor-id="included-chr-3">Included chr 3</h2>
</section>
<section id="tried-chr-4-but-not-clean-separation-of-high-vs.-low-indhet" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-4-but-not-clean-separation-of-high-vs.-low-indhet">Tried chr 4 but not clean separation of high vs.&nbsp;low IndHet</h2>
</section>
<section id="included-chr-4a" class="level2">
<h2 class="anchored" data-anchor-id="included-chr-4a">Included chr 4A</h2>
</section>
<section id="tried-chr-5-but-not-clean-separation-of-high-vs.-low-indhet" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-5-but-not-clean-separation-of-high-vs.-low-indhet">Tried chr 5 but not clean separation of high vs.&nbsp;low IndHet</h2>
</section>
<section id="tried-chr-6-but-not-clean-separation-of-high-vs.-low-indhet" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-6-but-not-clean-separation-of-high-vs.-low-indhet">Tried chr 6 but not clean separation of high vs.&nbsp;low IndHet</h2>
</section>
<section id="tried-chr-7-but-not-clean-separation-of-high-vs.-low-indhet-recomb-in-ludlowi" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-7-but-not-clean-separation-of-high-vs.-low-indhet-recomb-in-ludlowi">Tried chr 7 but not clean separation of high vs.&nbsp;low IndHet, recomb in ludlowi</h2>
</section>
<section id="tried-chr-8-but-not-clean-separation-of-high-vs.-low-indhet-recomb-in-ludlowi" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-8-but-not-clean-separation-of-high-vs.-low-indhet-recomb-in-ludlowi">Tried chr 8 but not clean separation of high vs.&nbsp;low IndHet, recomb in ludlowi</h2>
</section>
<section id="tried-chr-9-but-not-clean-separation-of-high-vs.-low-indhet" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-9-but-not-clean-separation-of-high-vs.-low-indhet">Tried chr 9 but not clean separation of high vs.&nbsp;low IndHet</h2>
</section>
<section id="tried-chr-10-but-not-clean-separation-of-high-vs.-low-indhet" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-10-but-not-clean-separation-of-high-vs.-low-indhet">Tried chr 10 but not clean separation of high vs.&nbsp;low IndHet</h2>
</section>
<section id="tried-chr-11-and-has-potential-and-shows-an-obs-with-two-plumb-types-but-ludlowi-not-cleanly-distinguished-into-types" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-11-and-has-potential-and-shows-an-obs-with-two-plumb-types-but-ludlowi-not-cleanly-distinguished-into-types">Tried chr 11 and has potential, and shows an obs with two plumb types, but ludlowi not cleanly distinguished into types</h2>
</section>
<section id="tried-chr-12-but-not-a-very-clear-separation-of-high-vs.-low-indhet-shows-a-lot-of-sharing-of-plumb-haps-in-ludlowi" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-12-but-not-a-very-clear-separation-of-high-vs.-low-indhet-shows-a-lot-of-sharing-of-plumb-haps-in-ludlowi">Tried chr 12 but not a very clear separation of high vs.&nbsp;low IndHet (shows a lot of sharing of plumb haps in ludlowi)</h2>
</section>
<section id="tried-chr-14-but-not-clean-separation-of-high-vs.-low-indhet-recomb-in-ludlowi" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-14-but-not-clean-separation-of-high-vs.-low-indhet-recomb-in-ludlowi">Tried chr 14 but not clean separation of high vs.&nbsp;low IndHet, recomb in ludlowi</h2>
</section>
<section id="included-chr-15" class="level2">
<h2 class="anchored" data-anchor-id="included-chr-15">Included chr 15</h2>
</section>
<section id="no-chr-16" class="level2">
<h2 class="anchored" data-anchor-id="no-chr-16">No chr 16</h2>
</section>
<section id="tried-chr-23-but-not-a-very-clear-separation-of-high-vs.-low-indhet" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-23-but-not-a-very-clear-separation-of-high-vs.-low-indhet">Tried chr 23 but not a very clear separation of high vs.&nbsp;low IndHet</h2>
</section>
<section id="included-chr-17-chr-18-chr-19-chr-20" class="level2">
<h2 class="anchored" data-anchor-id="included-chr-17-chr-18-chr-19-chr-20">Included chr 17, chr 18, chr 19, chr 20</h2>
</section>
<section id="tried-chr-21-but-not-a-very-clear-separation-of-high-vs.-low-indhet" class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-21-but-not-a-very-clear-separation-of-high-vs.-low-indhet">Tried chr 21 but not a very clear separation of high vs.&nbsp;low IndHet</h2>
</section>
<section id="tried-chr-22-but-not-a-very-clear-separation-of-high-vs.-low-indhet.-lud-is-all-over-the-place." class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-22-but-not-a-very-clear-separation-of-high-vs.-low-indhet.-lud-is-all-over-the-place.">Tried chr 22 but not a very clear separation of high vs.&nbsp;low IndHet. Lud is all over the place.</h2>
</section>
<section id="tried-chr-23-and-almost-included-but-a-few-inds-would-be-tough-to-categorize.-similar-pattern-as-some-others.-not-a-very-clear-separation-of-high-vs.-low-indhet." class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-23-and-almost-included-but-a-few-inds-would-be-tough-to-categorize.-similar-pattern-as-some-others.-not-a-very-clear-separation-of-high-vs.-low-indhet.">Tried chr 23 and almost included, but a few inds would be tough to categorize. Similar pattern as some others. Not a very clear separation of high vs.&nbsp;low IndHet.</h2>
</section>
<section id="tried-chr-24-but-not-a-very-clear-separation-of-high-vs.-low-indhet." class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-24-but-not-a-very-clear-separation-of-high-vs.-low-indhet.">Tried chr 24 but not a very clear separation of high vs.&nbsp;low IndHet.</h2>
</section>
<section id="tried-chr-25-but-not-a-very-clear-separation-of-high-vs.-low-indhet-and-hard-to-categorize-a-lot-of-inds." class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-25-but-not-a-very-clear-separation-of-high-vs.-low-indhet-and-hard-to-categorize-a-lot-of-inds.">Tried chr 25 but not a very clear separation of high vs.&nbsp;low IndHet, and hard to categorize a lot of inds.</h2>
</section>
<section id="included-chr-26" class="level2">
<h2 class="anchored" data-anchor-id="included-chr-26">Included chr 26</h2>
</section>
<section id="tried-chr-27-but-not-a-very-clear-separation-of-high-vs.-low-indhet." class="level2">
<h2 class="anchored" data-anchor-id="tried-chr-27-but-not-a-very-clear-separation-of-high-vs.-low-indhet.">Tried chr 27 but not a very clear separation of high vs.&nbsp;low IndHet.</h2>
</section>
<section id="included-chr-28" class="level2">
<h2 class="anchored" data-anchor-id="included-chr-28">Included chr 28</h2>
</section>
<section id="included-chr-z" class="level2">
<h2 class="anchored" data-anchor-id="included-chr-z">Included chr Z</h2>
</section>
<section id="make-a-summary-plot-for-the-cluster-types-at-different-chromosome-haploblocks-west-without-nitidus" class="level2">
<h2 class="anchored" data-anchor-id="make-a-summary-plot-for-the-cluster-types-at-different-chromosome-haploblocks-west-without-nitidus">Make a summary plot for the cluster types at different chromosome haploblocks (west without nitidus)</h2>
<p>Will modify the plotGenotypeByIndividual() function, but need to construct a genotype data structure based on the groups (determined above) for each haploblock.</p>
<p>For west side (without nitidus):</p>
<div id="650df18c" class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co">#= # For debugging function:</span></span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="co">indMetadata = ind_with_metadata_included</span></span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co">plotGroups = plotGroupsForSummary</span></span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a><span class="co">plotGroupColors = groupColorsForSummary</span></span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a><span class="co">regionNames = HaploblockRegions</span></span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a><span class="co">indFontSize = 10</span></span>
<span id="cb475-8"><a href="#cb475-8" aria-hidden="true" tabindex="-1"></a><span class="co">figureSize = (1200, 1200)</span></span>
<span id="cb475-9"><a href="#cb475-9" aria-hidden="true" tabindex="-1"></a><span class="co">plotTitle = nothing</span></span>
<span id="cb475-10"><a href="#cb475-10" aria-hidden="true" tabindex="-1"></a><span class="co">indColorLeftProvided = false</span></span>
<span id="cb475-11"><a href="#cb475-11" aria-hidden="true" tabindex="-1"></a><span class="co">indColorRightProvided = false =#</span></span>
<span id="cb475-12"><a href="#cb475-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-13"><a href="#cb475-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb475-14"><a href="#cb475-14" aria-hidden="true" tabindex="-1"></a><span class="st">    plotHaploblockSummary(genosSummary, indMetadata,</span></span>
<span id="cb475-15"><a href="#cb475-15" aria-hidden="true" tabindex="-1"></a><span class="st">                            plotGroups, plotGroupColors;</span></span>
<span id="cb475-16"><a href="#cb475-16" aria-hidden="true" tabindex="-1"></a><span class="st">                            regionNames,</span></span>
<span id="cb475-17"><a href="#cb475-17" aria-hidden="true" tabindex="-1"></a><span class="st">                            indFontSize=10, figureSize=(1200, 1200),</span></span>
<span id="cb475-18"><a href="#cb475-18" aria-hidden="true" tabindex="-1"></a><span class="st">                            plotTitle = nothing,</span></span>
<span id="cb475-19"><a href="#cb475-19" aria-hidden="true" tabindex="-1"></a><span class="st">                            indColorLeftProvided = false,</span></span>
<span id="cb475-20"><a href="#cb475-20" aria-hidden="true" tabindex="-1"></a><span class="st">                            indColorRightProvided = false)</span></span>
<span id="cb475-21"><a href="#cb475-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-22"><a href="#cb475-22" aria-hidden="true" tabindex="-1"></a><span class="st">Construct a genotype-by-individual plot, with option to filter out SNPs with too much missing data. </span></span>
<span id="cb475-23"><a href="#cb475-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-24"><a href="#cb475-24" aria-hidden="true" tabindex="-1"></a><span class="st">Under the default setting, alleles are colored (dark purple vs. light purple) according to whichever allele is designated as `group1`. </span></span>
<span id="cb475-25"><a href="#cb475-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-26"><a href="#cb475-26" aria-hidden="true" tabindex="-1"></a><span class="st">​# Arguments</span></span>
<span id="cb475-27"><a href="#cb475-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-28"><a href="#cb475-28" aria-hidden="true" tabindex="-1"></a><span class="st">- `genosSummary`: Matrix containing summary genotype data (individuals in rows, loci in columns).</span></span>
<span id="cb475-29"><a href="#cb475-29" aria-hidden="true" tabindex="-1"></a><span class="st">- `indMetadata`: Matrix of metadata for individuals; must contain `Fst_group` and `plot_order` columns.</span></span>
<span id="cb475-30"><a href="#cb475-30" aria-hidden="true" tabindex="-1"></a><span class="st">- `plotGroups`: Vector of group names to include in plot.</span></span>
<span id="cb475-31"><a href="#cb475-31" aria-hidden="true" tabindex="-1"></a><span class="st">- `plotGroupColors`: Vector of plotting colors corresponding to the groups.</span></span>
<span id="cb475-32"><a href="#cb475-32" aria-hidden="true" tabindex="-1"></a><span class="st">- `regionNames`: Optional; Names of the genotyped regions.</span></span>
<span id="cb475-33"><a href="#cb475-33" aria-hidden="true" tabindex="-1"></a><span class="st">- `indFontSize`: Optional; the font size of the individual ID labels.</span></span>
<span id="cb475-34"><a href="#cb475-34" aria-hidden="true" tabindex="-1"></a><span class="st">- `figureSize`: Optional; the size of the figure; default is `(1200, 1200)`.  </span></span>
<span id="cb475-35"><a href="#cb475-35" aria-hidden="true" tabindex="-1"></a><span class="st">- `plotTitle`: Optional; default will make a title. For no title, set to `""`.</span></span>
<span id="cb475-36"><a href="#cb475-36" aria-hidden="true" tabindex="-1"></a><span class="st">- `indColorLeftProvided`: Optional; Default is `false`. Set to `true` if there is a column labeled `indColorLeft` in the metadata providing color of each individual for plotting on left side.</span></span>
<span id="cb475-37"><a href="#cb475-37" aria-hidden="true" tabindex="-1"></a><span class="st">- `indColorRightProvided`: Optional; same as above but for right side (requires `indColorRight` column in metadata).</span></span>
<span id="cb475-38"><a href="#cb475-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-39"><a href="#cb475-39" aria-hidden="true" tabindex="-1"></a><span class="st"># Notes</span></span>
<span id="cb475-40"><a href="#cb475-40" aria-hidden="true" tabindex="-1"></a><span class="st">Returns a tuple containing:</span></span>
<span id="cb475-41"><a href="#cb475-41" aria-hidden="true" tabindex="-1"></a><span class="st">- the figure</span></span>
<span id="cb475-42"><a href="#cb475-42" aria-hidden="true" tabindex="-1"></a><span class="st">- the plotted genotypes</span></span>
<span id="cb475-43"><a href="#cb475-43" aria-hidden="true" tabindex="-1"></a><span class="st">- the sorted metadata matrix for the plotted individuals</span></span>
<span id="cb475-44"><a href="#cb475-44" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb475-45"><a href="#cb475-45" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">plotHaploblockSummary</span>(genosSummary, indMetadata,</span>
<span id="cb475-46"><a href="#cb475-46" aria-hidden="true" tabindex="-1"></a>                                plotGroups, plotGroupColors;</span>
<span id="cb475-47"><a href="#cb475-47" aria-hidden="true" tabindex="-1"></a>                                regionNames <span class="op">=</span> <span class="cn">nothing</span>,        </span>
<span id="cb475-48"><a href="#cb475-48" aria-hidden="true" tabindex="-1"></a>                                indFontSize<span class="op">=</span><span class="fl">10</span>, figureSize<span class="op">=</span>(<span class="fl">1200</span>, <span class="fl">1200</span>),</span>
<span id="cb475-49"><a href="#cb475-49" aria-hidden="true" tabindex="-1"></a>                                plotTitle <span class="op">=</span> <span class="cn">nothing</span>,</span>
<span id="cb475-50"><a href="#cb475-50" aria-hidden="true" tabindex="-1"></a>                                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb475-51"><a href="#cb475-51" aria-hidden="true" tabindex="-1"></a>                                indColorRightProvided <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb475-52"><a href="#cb475-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb475-53"><a href="#cb475-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if the genoData has missing values, then convert to -1:</span></span>
<span id="cb475-54"><a href="#cb475-54" aria-hidden="true" tabindex="-1"></a>    genosSummary[<span class="fu">ismissing</span>.(genosSummary)] <span class="op">.=</span> <span class="op">-</span><span class="fl">1</span></span>
<span id="cb475-55"><a href="#cb475-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-56"><a href="#cb475-56" aria-hidden="true" tabindex="-1"></a>    numRegions <span class="op">=</span> <span class="fu">size</span>(genosSummary, <span class="fl">2</span>)</span>
<span id="cb475-57"><a href="#cb475-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-58"><a href="#cb475-58" aria-hidden="true" tabindex="-1"></a>    genosSummary_subset <span class="op">=</span> genosSummary[indMetadata.Fst_group <span class="op">.∈</span> <span class="fu">Ref</span>(plotGroups), <span class="op">:</span>]</span>
<span id="cb475-59"><a href="#cb475-59" aria-hidden="true" tabindex="-1"></a>    indMetadata_subset <span class="op">=</span> indMetadata[indMetadata.Fst_group <span class="op">.∈</span> <span class="fu">Ref</span>(plotGroups), <span class="op">:</span>]</span>
<span id="cb475-60"><a href="#cb475-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-61"><a href="#cb475-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Choose sorting order by plot_order column in input metadata file</span></span>
<span id="cb475-62"><a href="#cb475-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-63"><a href="#cb475-63" aria-hidden="true" tabindex="-1"></a>    sorted_genosSummary_subset <span class="op">=</span> genosSummary_subset[<span class="fu">sortperm</span>(indMetadata_subset.plot_order, rev<span class="op">=</span><span class="cn">false</span>), <span class="op">:</span>]</span>
<span id="cb475-64"><a href="#cb475-64" aria-hidden="true" tabindex="-1"></a>    numInds <span class="op">=</span> <span class="fu">size</span>(sorted_genosSummary_subset, <span class="fl">1</span>)</span>
<span id="cb475-65"><a href="#cb475-65" aria-hidden="true" tabindex="-1"></a>    sorted_indMetadata_subset <span class="op">=</span> indMetadata_subset[<span class="fu">sortperm</span>(indMetadata_subset.plot_order, rev<span class="op">=</span><span class="cn">false</span>), <span class="op">:</span>]</span>
<span id="cb475-66"><a href="#cb475-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-67"><a href="#cb475-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the plot window:</span></span>
<span id="cb475-68"><a href="#cb475-68" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>(size<span class="op">=</span>figureSize)</span>
<span id="cb475-69"><a href="#cb475-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-70"><a href="#cb475-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">isnothing</span>(plotTitle)</span>
<span id="cb475-71"><a href="#cb475-71" aria-hidden="true" tabindex="-1"></a>        plotTitle <span class="op">=</span> <span class="st">"Summary of </span><span class="sc">$</span>numRegions<span class="st"> haploblock genotypes for </span><span class="sc">$</span>numInds<span class="st"> individuals"</span></span>
<span id="cb475-72"><a href="#cb475-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> </span>
<span id="cb475-73"><a href="#cb475-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-74"><a href="#cb475-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the main Axis: </span></span>
<span id="cb475-75"><a href="#cb475-75" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb475-76"><a href="#cb475-76" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> plotTitle,</span>
<span id="cb475-77"><a href="#cb475-77" aria-hidden="true" tabindex="-1"></a>        titlesize<span class="op">=</span><span class="fl">30</span>,</span>
<span id="cb475-78"><a href="#cb475-78" aria-hidden="true" tabindex="-1"></a>        limits<span class="op">=</span>(<span class="fl">0.5</span> <span class="op">-</span> <span class="fl">0.09</span> <span class="op">*</span> (numRegions), <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">1.09</span> <span class="op">*</span> (numRegions),</span>
<span id="cb475-79"><a href="#cb475-79" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.5</span> <span class="op">-</span> <span class="fl">0.3</span> <span class="op">*</span> numInds, <span class="fl">0.5</span> <span class="op">+</span> numInds)</span>
<span id="cb475-80"><a href="#cb475-80" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb475-81"><a href="#cb475-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hidedecorations!</span>(ax) <span class="co"># hide background lattice and axis labels</span></span>
<span id="cb475-82"><a href="#cb475-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hidespines!</span>(ax) <span class="co"># hide box around plot</span></span>
<span id="cb475-83"><a href="#cb475-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-84"><a href="#cb475-84" aria-hidden="true" tabindex="-1"></a>    genotypeColors <span class="op">=</span> [<span class="st">"#3f007d"</span>, <span class="st">"#807dba"</span>, <span class="st">"#dadaeb"</span>, <span class="st">"grey50"</span>]  <span class="co"># purple shades from colorbrewer</span></span>
<span id="cb475-85"><a href="#cb475-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-86"><a href="#cb475-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot evenly spaced by SNP order along chromosome:</span></span>
<span id="cb475-87"><a href="#cb475-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make top part of fig (genotypes for individuals)</span></span>
<span id="cb475-88"><a href="#cb475-88" aria-hidden="true" tabindex="-1"></a>    labelCushion <span class="op">=</span> numRegions <span class="op">/</span> <span class="fl">100</span></span>
<span id="cb475-89"><a href="#cb475-89" aria-hidden="true" tabindex="-1"></a>    label_x_left <span class="op">=</span> <span class="fl">0.5</span> <span class="op">-</span> labelCushion</span>
<span id="cb475-90"><a href="#cb475-90" aria-hidden="true" tabindex="-1"></a>    label_x_right <span class="op">=</span> <span class="fl">0.5</span> <span class="op">+</span> numRegions <span class="op">+</span> labelCushion</span>
<span id="cb475-91"><a href="#cb475-91" aria-hidden="true" tabindex="-1"></a>    colorBoxCushion <span class="op">=</span> <span class="fl">0.07</span> <span class="op">*</span> numRegions</span>
<span id="cb475-92"><a href="#cb475-92" aria-hidden="true" tabindex="-1"></a>    groupColorBox_x_left <span class="op">=</span> <span class="fl">0.5</span> <span class="op">-</span> colorBoxCushion</span>
<span id="cb475-93"><a href="#cb475-93" aria-hidden="true" tabindex="-1"></a>    groupColorBox_x_right <span class="op">=</span> <span class="fl">0.5</span> <span class="op">+</span> numRegions <span class="op">+</span> colorBoxCushion</span>
<span id="cb475-94"><a href="#cb475-94" aria-hidden="true" tabindex="-1"></a>    boxWidth <span class="op">=</span> <span class="fl">0.005</span> <span class="op">*</span> numRegions <span class="op">*</span> <span class="fl">2</span></span>
<span id="cb475-95"><a href="#cb475-95" aria-hidden="true" tabindex="-1"></a>    groupColorBox_x_left <span class="op">=</span> [<span class="op">-</span>boxWidth, <span class="op">-</span>boxWidth, boxWidth, boxWidth, <span class="op">-</span>boxWidth] <span class="op">.+</span> groupColorBox_x_left</span>
<span id="cb475-96"><a href="#cb475-96" aria-hidden="true" tabindex="-1"></a>    groupColorBox_x_right <span class="op">=</span> [<span class="op">-</span>boxWidth, <span class="op">-</span>boxWidth, boxWidth, boxWidth, <span class="op">-</span>boxWidth] <span class="op">.+</span> groupColorBox_x_right</span>
<span id="cb475-97"><a href="#cb475-97" aria-hidden="true" tabindex="-1"></a>    groupColorBox_y <span class="op">=</span> [<span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>]</span>
<span id="cb475-98"><a href="#cb475-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-99"><a href="#cb475-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numInds</span>
<span id="cb475-100"><a href="#cb475-100" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> numInds <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> i  <span class="co"># y is location for plotting; this reverses order of plot top-bottom</span></span>
<span id="cb475-101"><a href="#cb475-101" aria-hidden="true" tabindex="-1"></a>        labelText <span class="op">=</span> <span class="fu">last</span>(<span class="fu">split</span>(sorted_indMetadata_subset.ID[i], <span class="st">"_"</span>))  <span class="co"># this gets the last part of the sample ID (usually the main ID part)</span></span>
<span id="cb475-102"><a href="#cb475-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># put sample label on left side:</span></span>
<span id="cb475-103"><a href="#cb475-103" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">text!</span>(label_x_left, y; text<span class="op">=</span>labelText, align<span class="op">=</span>(<span class="op">:</span>right, <span class="op">:</span>center), fontsize<span class="op">=</span>indFontSize)</span>
<span id="cb475-104"><a href="#cb475-104" aria-hidden="true" tabindex="-1"></a>        <span class="co"># put sample label on left side:</span></span>
<span id="cb475-105"><a href="#cb475-105" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">text!</span>(label_x_right, y; text<span class="op">=</span>labelText, align<span class="op">=</span>(<span class="op">:</span>left, <span class="op">:</span>center), fontsize<span class="op">=</span>indFontSize)</span>
<span id="cb475-106"><a href="#cb475-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> indColorLeftProvided</span>
<span id="cb475-107"><a href="#cb475-107" aria-hidden="true" tabindex="-1"></a>            boxColorLeft <span class="op">=</span> sorted_indMetadata_subset.indColorLeft[i]</span>
<span id="cb475-108"><a href="#cb475-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb475-109"><a href="#cb475-109" aria-hidden="true" tabindex="-1"></a>            boxColorLeft <span class="op">=</span> plotGroupColors[<span class="fu">findfirst</span>(plotGroups <span class="op">.==</span> sorted_indMetadata_subset.Fst_group[i])]</span>
<span id="cb475-110"><a href="#cb475-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb475-111"><a href="#cb475-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> indColorRightProvided</span>
<span id="cb475-112"><a href="#cb475-112" aria-hidden="true" tabindex="-1"></a>            boxColorRight <span class="op">=</span> sorted_indMetadata_subset.indColorRight[i]</span>
<span id="cb475-113"><a href="#cb475-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb475-114"><a href="#cb475-114" aria-hidden="true" tabindex="-1"></a>            boxColorRight <span class="op">=</span> plotGroupColors[<span class="fu">findfirst</span>(plotGroups <span class="op">.==</span> sorted_indMetadata_subset.Fst_group[i])]</span>
<span id="cb475-115"><a href="#cb475-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb475-116"><a href="#cb475-116" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.(groupColorBox_x_left, (y <span class="op">.+</span> groupColorBox_y)), color<span class="op">=</span>boxColorLeft)</span>
<span id="cb475-117"><a href="#cb475-117" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.(groupColorBox_x_right, (y <span class="op">.+</span> groupColorBox_y)), color<span class="op">=</span>boxColorRight)</span>
<span id="cb475-118"><a href="#cb475-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb475-119"><a href="#cb475-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-120"><a href="#cb475-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate my own plotting symbol (a rectangle)</span></span>
<span id="cb475-121"><a href="#cb475-121" aria-hidden="true" tabindex="-1"></a>    box_x <span class="op">=</span> [<span class="op">-</span><span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>]</span>
<span id="cb475-122"><a href="#cb475-122" aria-hidden="true" tabindex="-1"></a>    <span class="co">#box_x = [-0.5, -0.5, 0.5, 0.5, -0.5]</span></span>
<span id="cb475-123"><a href="#cb475-123" aria-hidden="true" tabindex="-1"></a>    box_y <span class="op">=</span> [<span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>]</span>
<span id="cb475-124"><a href="#cb475-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate triangles for plotting heterozygotes</span></span>
<span id="cb475-125"><a href="#cb475-125" aria-hidden="true" tabindex="-1"></a>    triangle1_x <span class="op">=</span> [<span class="op">-</span><span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>]</span>
<span id="cb475-126"><a href="#cb475-126" aria-hidden="true" tabindex="-1"></a>    <span class="co">#triangle1_x = [-0.5, -0.5, 0.5, -0.5]</span></span>
<span id="cb475-127"><a href="#cb475-127" aria-hidden="true" tabindex="-1"></a>    triangle1_y <span class="op">=</span> [<span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>]</span>
<span id="cb475-128"><a href="#cb475-128" aria-hidden="true" tabindex="-1"></a>    triangle2_x <span class="op">=</span> [<span class="op">-</span><span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>]</span>
<span id="cb475-129"><a href="#cb475-129" aria-hidden="true" tabindex="-1"></a>    <span class="co">#triangle2_x = [-0.5, 0.5, 0.5, -0.5]</span></span>
<span id="cb475-130"><a href="#cb475-130" aria-hidden="true" tabindex="-1"></a>    triangle2_y <span class="op">=</span> [<span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>]</span>
<span id="cb475-131"><a href="#cb475-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cycle through individuals, graphing each type of genotype:</span></span>
<span id="cb475-132"><a href="#cb475-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numInds</span>
<span id="cb475-133"><a href="#cb475-133" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> numInds <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> i  <span class="co"># y is location for plotting; this reverses order of plot top-bottom</span></span>
<span id="cb475-134"><a href="#cb475-134" aria-hidden="true" tabindex="-1"></a>        <span class="co">#CairoMakie.lines!([0.5, numRegions + 0.5], [y, y], color="grey40") # for lines across the individual rows</span></span>
<span id="cb475-135"><a href="#cb475-135" aria-hidden="true" tabindex="-1"></a>        genotypes <span class="op">=</span> sorted_genosSummary_subset[i, <span class="op">:</span>]</span>
<span id="cb475-136"><a href="#cb475-136" aria-hidden="true" tabindex="-1"></a>        hom_ref_locs <span class="op">=</span> <span class="fu">findall</span>(genotypes <span class="op">.==</span> <span class="fl">0</span>)</span>
<span id="cb475-137"><a href="#cb475-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">length</span>(hom_ref_locs) <span class="op">&gt;</span> <span class="fl">0</span></span>
<span id="cb475-138"><a href="#cb475-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="fu">eachindex</span>(hom_ref_locs)</span>
<span id="cb475-139"><a href="#cb475-139" aria-hidden="true" tabindex="-1"></a>                CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.((hom_ref_locs[j] <span class="op">.+</span> box_x), (y <span class="op">.+</span> box_y)), color<span class="op">=</span>genotypeColors[<span class="fl">1</span>])</span>
<span id="cb475-140"><a href="#cb475-140" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb475-141"><a href="#cb475-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb475-142"><a href="#cb475-142" aria-hidden="true" tabindex="-1"></a>        het_locs <span class="op">=</span> <span class="fu">findall</span>(genotypes <span class="op">.==</span> <span class="fl">1</span>)</span>
<span id="cb475-143"><a href="#cb475-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">length</span>(het_locs) <span class="op">&gt;</span> <span class="fl">0</span></span>
<span id="cb475-144"><a href="#cb475-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="fu">eachindex</span>(het_locs)</span>
<span id="cb475-145"><a href="#cb475-145" aria-hidden="true" tabindex="-1"></a>                CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.((het_locs[j] <span class="op">.+</span> triangle1_x), (y <span class="op">.+</span> triangle1_y)), color<span class="op">=</span>genotypeColors[<span class="fl">1</span>])</span>
<span id="cb475-146"><a href="#cb475-146" aria-hidden="true" tabindex="-1"></a>                CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.((het_locs[j] <span class="op">.+</span> triangle2_x), (y <span class="op">.+</span> triangle2_y)), color<span class="op">=</span>genotypeColors[<span class="fl">3</span>])</span>
<span id="cb475-147"><a href="#cb475-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb475-148"><a href="#cb475-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb475-149"><a href="#cb475-149" aria-hidden="true" tabindex="-1"></a>        hom_alt_locs <span class="op">=</span> <span class="fu">findall</span>(genotypes <span class="op">.==</span> <span class="fl">2</span>)</span>
<span id="cb475-150"><a href="#cb475-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">length</span>(hom_alt_locs) <span class="op">&gt;</span> <span class="fl">0</span></span>
<span id="cb475-151"><a href="#cb475-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="fu">eachindex</span>(hom_alt_locs)</span>
<span id="cb475-152"><a href="#cb475-152" aria-hidden="true" tabindex="-1"></a>                CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.((hom_alt_locs[j] <span class="op">.+</span> box_x), (y <span class="op">.+</span> box_y)), color<span class="op">=</span>genotypeColors[<span class="fl">3</span>])</span>
<span id="cb475-153"><a href="#cb475-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb475-154"><a href="#cb475-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb475-155"><a href="#cb475-155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb475-156"><a href="#cb475-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-157"><a href="#cb475-157" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">isnothing</span>(regionNames)</span>
<span id="cb475-158"><a href="#cb475-158" aria-hidden="true" tabindex="-1"></a>        regionNames <span class="op">=</span> <span class="fu">string</span>.(<span class="fl">1</span><span class="op">:</span>numRegions)</span>
<span id="cb475-159"><a href="#cb475-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb475-160"><a href="#cb475-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-161"><a href="#cb475-161" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make labels on lower part</span></span>
<span id="cb475-162"><a href="#cb475-162" aria-hidden="true" tabindex="-1"></a>    y_label <span class="op">=</span> <span class="fl">0.5</span> <span class="op">-</span> <span class="fl">0.025</span>numInds</span>
<span id="cb475-163"><a href="#cb475-163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numRegions</span>
<span id="cb475-164"><a href="#cb475-164" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">text!</span>(i, y_label; text <span class="op">=</span> regionNames[i], align<span class="op">=</span>(<span class="op">:</span>center, <span class="op">:</span>center), fontsize<span class="op">=</span><span class="fl">30</span>)</span>
<span id="cb475-165"><a href="#cb475-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb475-166"><a href="#cb475-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-167"><a href="#cb475-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">display</span>(f)</span>
<span id="cb475-168"><a href="#cb475-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-169"><a href="#cb475-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f, sorted_genosSummary_subset, sorted_indMetadata_subset</span>
<span id="cb475-170"><a href="#cb475-170" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb475-171"><a href="#cb475-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-172"><a href="#cb475-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a data structure to store the key to converting, for each haploblock region, </span></span>
<span id="cb475-173"><a href="#cb475-173" aria-hidden="true" tabindex="-1"></a><span class="co"># the cluster names to genotype integers. This is a dictiionary of dictionaries:</span></span>
<span id="cb475-174"><a href="#cb475-174" aria-hidden="true" tabindex="-1"></a>regionHaplotypeCode_west <span class="op">=</span> <span class="fu">Dict</span><span class="dt">{String, Dict{String, Int}}</span>(</span>
<span id="cb475-175"><a href="#cb475-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw1A"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLud_troch"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"troch"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb475-176"><a href="#cb475-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw3"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLudHet"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLud_trochObs"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"trochObs"</span><span class="op">=&gt;</span><span class="fl">2</span>, <span class="st">"trochObsHet"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb475-177"><a href="#cb475-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw13"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLud_troch"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"troch"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb475-178"><a href="#cb475-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw15"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLud_troch"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"troch"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb475-179"><a href="#cb475-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw18"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLud_troch"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"troch"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb475-180"><a href="#cb475-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw19"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLudHet"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLud_trochObs"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"trochObs"</span><span class="op">=&gt;</span><span class="fl">2</span>, <span class="st">"trochObsHet"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb475-181"><a href="#cb475-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw26"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLud_troch"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"troch"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb475-182"><a href="#cb475-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw28"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLud_troch"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"troch"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb475-183"><a href="#cb475-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gwZ"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"vir"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"lud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"lud_troch"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"troch"</span><span class="op">=&gt;</span><span class="fl">2</span>)</span>
<span id="cb475-184"><a href="#cb475-184" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb475-185"><a href="#cb475-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-186"><a href="#cb475-186" aria-hidden="true" tabindex="-1"></a>haploblockRegions <span class="op">=</span> [<span class="st">"gw1A"</span>, <span class="st">"gw3"</span>, <span class="st">"gw13"</span>, <span class="st">"gw15"</span>, <span class="st">"gw18"</span>, <span class="st">"gw19"</span>, <span class="st">"gw26"</span>, <span class="st">"gw28"</span>, <span class="st">"gwZ"</span>]</span>
<span id="cb475-187"><a href="#cb475-187" aria-hidden="true" tabindex="-1"></a>numHaploblockRegions <span class="op">=</span> <span class="fu">length</span>(haploblockRegions)</span>
<span id="cb475-188"><a href="#cb475-188" aria-hidden="true" tabindex="-1"></a>numInds <span class="op">=</span> <span class="fu">size</span>(ind_with_metadata_included, <span class="fl">1</span>)</span>
<span id="cb475-189"><a href="#cb475-189" aria-hidden="true" tabindex="-1"></a><span class="co"># create genotype object and fill with missing (-1) genotypes</span></span>
<span id="cb475-190"><a href="#cb475-190" aria-hidden="true" tabindex="-1"></a>genosSummary <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">1</span>, (numInds, numHaploblockRegions)) </span>
<span id="cb475-191"><a href="#cb475-191" aria-hidden="true" tabindex="-1"></a><span class="co"># fill object with appropriate genotypes</span></span>
<span id="cb475-192"><a href="#cb475-192" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numHaploblockRegions</span>
<span id="cb475-193"><a href="#cb475-193" aria-hidden="true" tabindex="-1"></a>    region <span class="op">=</span> haploblockRegions[i]</span>
<span id="cb475-194"><a href="#cb475-194" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (key, value) <span class="kw">in</span> regionHaplotypeCode_west[region]</span>
<span id="cb475-195"><a href="#cb475-195" aria-hidden="true" tabindex="-1"></a>        command <span class="op">=</span> <span class="st">"""genosSummary[ind_with_metadata_included.</span><span class="sc">$</span>(region)<span class="st">_cluster .== "</span><span class="sc">$</span>(key)<span class="st">", </span><span class="sc">$</span>i<span class="st">] .= """</span> <span class="op">*</span> <span class="fu">string</span>(value)</span>
<span id="cb475-196"><a href="#cb475-196" aria-hidden="true" tabindex="-1"></a>        <span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb475-197"><a href="#cb475-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb475-198"><a href="#cb475-198" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb475-199"><a href="#cb475-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-200"><a href="#cb475-200" aria-hidden="true" tabindex="-1"></a><span class="co"># Must say I am pleased with the cleverness of above. Concise datastructure and code that does a lot. :) </span></span>
<span id="cb475-201"><a href="#cb475-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-202"><a href="#cb475-202" aria-hidden="true" tabindex="-1"></a>plotGroupsForSummaryWest <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_S"</span>,<span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>,<span class="st">"troch_west"</span>,<span class="st">"troch_LN"</span>]</span>
<span id="cb475-203"><a href="#cb475-203" aria-hidden="true" tabindex="-1"></a>groupColorsForSummaryWest <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>,<span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>] </span>
<span id="cb475-204"><a href="#cb475-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-205"><a href="#cb475-205" aria-hidden="true" tabindex="-1"></a><span class="fu">plotHaploblockSummary</span>(genosSummary, ind_with_metadata_included,</span>
<span id="cb475-206"><a href="#cb475-206" aria-hidden="true" tabindex="-1"></a>                            plotGroupsForSummaryWest, groupColorsForSummaryWest;</span>
<span id="cb475-207"><a href="#cb475-207" aria-hidden="true" tabindex="-1"></a>                            regionNames <span class="op">=</span> haploblockRegions,</span>
<span id="cb475-208"><a href="#cb475-208" aria-hidden="true" tabindex="-1"></a>                            indFontSize <span class="op">=</span> <span class="fl">8</span>, figureSize <span class="op">=</span> (<span class="fl">1200</span>, <span class="fl">1600</span>),</span>
<span id="cb475-209"><a href="#cb475-209" aria-hidden="true" tabindex="-1"></a>                            plotTitle <span class="op">=</span> <span class="cn">nothing</span>,</span>
<span id="cb475-210"><a href="#cb475-210" aria-hidden="true" tabindex="-1"></a>                            indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb475-211"><a href="#cb475-211" aria-hidden="true" tabindex="-1"></a>                            indColorRightProvided <span class="op">=</span> <span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-174-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="174">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  1 Child Scene:
    └ Scene (768px, 960px), [0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], <span class="ansi-bold">177×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 168 │ GW_Lane5_LN14              GW_Lane5_LN14              LN        troch_L
 169 │ GW_Lane5_LN16              GW_Lane5_LN16              LN        troch_L ⋯
 170 │ GW_Lane5_LN18              GW_Lane5_LN18              LN        troch_L
 171 │ GW_Lane5_LN19              GW_Lane5_LN19              LN        troch_L
 172 │ GW_Lane5_LN20              GW_Lane5_LN20              LN        troch_L
 173 │ GW_Lane5_LN3               GW_Lane5_LN3               LN        troch_L ⋯
 174 │ GW_Lane5_LN4               GW_Lane5_LN4               LN        troch_L
 175 │ GW_Lane5_LN6               GW_Lane5_LN6               LN        troch_L
 176 │ GW_Lane5_LN7               GW_Lane5_LN7               LN        troch_L
 177 │ GW_Lane5_LN8               GW_Lane5_LN8               LN        troch_L ⋯
<span class="ansi-cyan-fg">                                                 35 columns and 156 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="make-a-summary-plot-for-the-east-side" class="level2">
<h2 class="anchored" data-anchor-id="make-a-summary-plot-for-the-east-side">Make a summary plot for the east side</h2>
<div id="e96b816c" class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a data structure to store the key to converting, for each haploblock region, </span></span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the cluster names to genotype integers. This is a dictiionary of dictionaries:</span></span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a>regionHaplotypeCode_east <span class="op">=</span> <span class="fu">Dict</span><span class="dt">{String, Dict{String, Int}}</span>(</span>
<span id="cb477-4"><a href="#cb477-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw1A"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"obs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb477-5"><a href="#cb477-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw3"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"trochObs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"trochObsHet"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>, <span class="st">"plumbHet"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb477-6"><a href="#cb477-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw13"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"obs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>, <span class="st">"plumbHet"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb477-7"><a href="#cb477-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw15"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"obs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb477-8"><a href="#cb477-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw18"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"obs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"obs_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb477-9"><a href="#cb477-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw19"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"trochObs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"trochObs_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb477-10"><a href="#cb477-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw26"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"obs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"obs_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb477-11"><a href="#cb477-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw28"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"obs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"obsHet"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"obs_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb477-12"><a href="#cb477-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gwZ"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"obs"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>)</span>
<span id="cb477-13"><a href="#cb477-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb477-14"><a href="#cb477-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-15"><a href="#cb477-15" aria-hidden="true" tabindex="-1"></a>haploblockRegions <span class="op">=</span> [<span class="st">"gw1A"</span>, <span class="st">"gw3"</span>, <span class="st">"gw13"</span>, <span class="st">"gw15"</span>, <span class="st">"gw18"</span>, <span class="st">"gw19"</span>, <span class="st">"gw26"</span>, <span class="st">"gw28"</span>, <span class="st">"gwZ"</span>]</span>
<span id="cb477-16"><a href="#cb477-16" aria-hidden="true" tabindex="-1"></a>numHaploblockRegions <span class="op">=</span> <span class="fu">length</span>(haploblockRegions)</span>
<span id="cb477-17"><a href="#cb477-17" aria-hidden="true" tabindex="-1"></a>numInds <span class="op">=</span> <span class="fu">size</span>(ind_with_metadata_included, <span class="fl">1</span>)</span>
<span id="cb477-18"><a href="#cb477-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create genotype object and fill with missing (-1) genotypes</span></span>
<span id="cb477-19"><a href="#cb477-19" aria-hidden="true" tabindex="-1"></a>genosSummary <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">1</span>, (numInds, numHaploblockRegions)) </span>
<span id="cb477-20"><a href="#cb477-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fill object with appropriate genotypes</span></span>
<span id="cb477-21"><a href="#cb477-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numHaploblockRegions</span>
<span id="cb477-22"><a href="#cb477-22" aria-hidden="true" tabindex="-1"></a>    region <span class="op">=</span> haploblockRegions[i]</span>
<span id="cb477-23"><a href="#cb477-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (key, value) <span class="kw">in</span> regionHaplotypeCode_east[region]</span>
<span id="cb477-24"><a href="#cb477-24" aria-hidden="true" tabindex="-1"></a>        command <span class="op">=</span> <span class="st">"""genosSummary[ind_with_metadata_included.</span><span class="sc">$</span>(region)<span class="st">_cluster .== "</span><span class="sc">$</span>(key)<span class="st">", </span><span class="sc">$</span>i<span class="st">] .= """</span> <span class="op">*</span> <span class="fu">string</span>(value)</span>
<span id="cb477-25"><a href="#cb477-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb477-26"><a href="#cb477-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb477-27"><a href="#cb477-27" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb477-28"><a href="#cb477-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-29"><a href="#cb477-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Must say I am pleased with the cleverness of above. Concise datastructure and code that does a lot. :) </span></span>
<span id="cb477-30"><a href="#cb477-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-31"><a href="#cb477-31" aria-hidden="true" tabindex="-1"></a>plotGroupsForSummaryEast <span class="op">=</span> [<span class="st">"obs"</span>,<span class="st">"plumb_BJ"</span>,<span class="st">"plumb"</span>]</span>
<span id="cb477-32"><a href="#cb477-32" aria-hidden="true" tabindex="-1"></a>groupColorsForSummaryEast <span class="op">=</span> [<span class="st">"orange"</span>,<span class="st">"pink"</span>,<span class="st">"red"</span>] </span>
<span id="cb477-33"><a href="#cb477-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-34"><a href="#cb477-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plotHaploblockSummary</span>(genosSummary, ind_with_metadata_included,</span>
<span id="cb477-35"><a href="#cb477-35" aria-hidden="true" tabindex="-1"></a>                            plotGroupsForSummaryEast, groupColorsForSummaryEast;</span>
<span id="cb477-36"><a href="#cb477-36" aria-hidden="true" tabindex="-1"></a>                            regionNames <span class="op">=</span> haploblockRegions,</span>
<span id="cb477-37"><a href="#cb477-37" aria-hidden="true" tabindex="-1"></a>                            indFontSize <span class="op">=</span> <span class="fl">8</span>, figureSize <span class="op">=</span> (<span class="fl">1200</span>, <span class="fl">1600</span>),</span>
<span id="cb477-38"><a href="#cb477-38" aria-hidden="true" tabindex="-1"></a>                            plotTitle <span class="op">=</span> <span class="cn">nothing</span>,</span>
<span id="cb477-39"><a href="#cb477-39" aria-hidden="true" tabindex="-1"></a>                            indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb477-40"><a href="#cb477-40" aria-hidden="true" tabindex="-1"></a>                            indColorRightProvided <span class="op">=</span> <span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-175-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="175">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  1 Child Scene:
    └ Scene (768px, 960px), [0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 2 2 … 2 2], <span class="ansi-bold">76×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Lane5_DA2               GW_Lane5_DA2               XN        obs     ⋯
   2 │ GW_Lane5_DA3               GW_Lane5_DA3               XN        obs
   3 │ GW_Lane5_DA4               GW_Lane5_DA4               XN        obs
   4 │ GW_Lane5_DA7               GW_Lane5_DA7               XN        obs
   5 │ GW_Armando_plate1_RF20G01  GW_Armando_plate1_RF20G01  BJ        obs_plu ⋯
   6 │ GW_Armando_plate1_RF29G02  GW_Armando_plate1_RF29G02  BJ        obs_plu
   7 │ GW_Armando_plate2_RF29G01  GW_Armando_plate2_RF29G01  BJ        obs_plu
   8 │ GW_Lane5_BK2               GW_Lane5_BK2               BK        plumb
   9 │ GW_Lane5_BK3               GW_Lane5_BK3               BK        plumb   ⋯
  10 │ GW_Lane5_AN1               GW_Lane5_AN1               AN        plumb
  11 │ GW_Lane5_AN2               GW_Lane5_AN2               AN        plumb
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  67 │ GW_Armando_plate1_JF24G02  GW_Armando_plate1_JF24G02  VB        plumb
  68 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb   ⋯
  69 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb
  70 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  71 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  72 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb   ⋯
  73 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb
  74 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  75 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  76 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb   ⋯
<span class="ansi-cyan-fg">                                                  35 columns and 55 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="make-a-summary-plot-for-the-north-side" class="level2">
<h2 class="anchored" data-anchor-id="make-a-summary-plot-for-the-north-side">Make a summary plot for the north side</h2>
<div id="a50c523a" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a data structure to store the code to converting, for each haploblock region, </span></span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the cluster names to genotype integers. This is a dictiionary of dictionaries:</span></span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a>regionHaplotypeCode_north <span class="op">=</span> <span class="fu">Dict</span><span class="dt">{String, Dict{String, Int}}</span>(</span>
<span id="cb479-4"><a href="#cb479-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw1A"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"vir_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb479-5"><a href="#cb479-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw3"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLudHet"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"vir_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>, <span class="st">"plumbHet"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb479-6"><a href="#cb479-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw13"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"vir_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>, <span class="st">"plumbHet"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb479-7"><a href="#cb479-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw15"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"vir_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb479-8"><a href="#cb479-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw18"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"vir_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb479-9"><a href="#cb479-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw19"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"virLudHet"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"vir_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb479-10"><a href="#cb479-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw26"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"vir_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb479-11"><a href="#cb479-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw28"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"vir_plumb"</span><span class="op">=&gt;</span><span class="fl">1</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>),</span>
<span id="cb479-12"><a href="#cb479-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gwZ"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"vir"</span><span class="op">=&gt;</span><span class="fl">0</span>, <span class="st">"plumb"</span><span class="op">=&gt;</span><span class="fl">2</span>)</span>
<span id="cb479-13"><a href="#cb479-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb479-14"><a href="#cb479-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-15"><a href="#cb479-15" aria-hidden="true" tabindex="-1"></a>haploblockRegions <span class="op">=</span> [<span class="st">"gw1A"</span>, <span class="st">"gw3"</span>, <span class="st">"gw13"</span>, <span class="st">"gw15"</span>, <span class="st">"gw18"</span>, <span class="st">"gw19"</span>, <span class="st">"gw26"</span>, <span class="st">"gw28"</span>, <span class="st">"gwZ"</span>]</span>
<span id="cb479-16"><a href="#cb479-16" aria-hidden="true" tabindex="-1"></a>numHaploblockRegions <span class="op">=</span> <span class="fu">length</span>(haploblockRegions)</span>
<span id="cb479-17"><a href="#cb479-17" aria-hidden="true" tabindex="-1"></a>numInds <span class="op">=</span> <span class="fu">size</span>(ind_with_metadata_included, <span class="fl">1</span>)</span>
<span id="cb479-18"><a href="#cb479-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create genotype object and fill with missing (-1) genotypes</span></span>
<span id="cb479-19"><a href="#cb479-19" aria-hidden="true" tabindex="-1"></a>genosSummary <span class="op">=</span> <span class="fu">fill</span>(<span class="op">-</span><span class="fl">1</span>, (numInds, numHaploblockRegions)) </span>
<span id="cb479-20"><a href="#cb479-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fill object with appropriate genotypes</span></span>
<span id="cb479-21"><a href="#cb479-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numHaploblockRegions</span>
<span id="cb479-22"><a href="#cb479-22" aria-hidden="true" tabindex="-1"></a>    region <span class="op">=</span> haploblockRegions[i]</span>
<span id="cb479-23"><a href="#cb479-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (key, value) <span class="kw">in</span> regionHaplotypeCode_north[region]</span>
<span id="cb479-24"><a href="#cb479-24" aria-hidden="true" tabindex="-1"></a>        command <span class="op">=</span> <span class="st">"""genosSummary[ind_with_metadata_included.</span><span class="sc">$</span>(region)<span class="st">_cluster .== "</span><span class="sc">$</span>(key)<span class="st">", </span><span class="sc">$</span>i<span class="st">] .= """</span> <span class="op">*</span> <span class="fu">string</span>(value)</span>
<span id="cb479-25"><a href="#cb479-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb479-26"><a href="#cb479-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb479-27"><a href="#cb479-27" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb479-28"><a href="#cb479-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-29"><a href="#cb479-29" aria-hidden="true" tabindex="-1"></a>plotGroupsForSummaryNorth <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"plumb_vir"</span>,<span class="st">"plumb"</span>]</span>
<span id="cb479-30"><a href="#cb479-30" aria-hidden="true" tabindex="-1"></a>groupColorsForSummaryNorth <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"purple"</span>,<span class="st">"red"</span>] </span>
<span id="cb479-31"><a href="#cb479-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-32"><a href="#cb479-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plotHaploblockSummary</span>(genosSummary, ind_with_metadata_included,</span>
<span id="cb479-33"><a href="#cb479-33" aria-hidden="true" tabindex="-1"></a>                            plotGroupsForSummaryNorth, groupColorsForSummaryNorth;</span>
<span id="cb479-34"><a href="#cb479-34" aria-hidden="true" tabindex="-1"></a>                            regionNames <span class="op">=</span> haploblockRegions,</span>
<span id="cb479-35"><a href="#cb479-35" aria-hidden="true" tabindex="-1"></a>                            indFontSize <span class="op">=</span> <span class="fl">8</span>, figureSize <span class="op">=</span> (<span class="fl">1200</span>, <span class="fl">1600</span>),</span>
<span id="cb479-36"><a href="#cb479-36" aria-hidden="true" tabindex="-1"></a>                            plotTitle <span class="op">=</span> <span class="cn">nothing</span>,</span>
<span id="cb479-37"><a href="#cb479-37" aria-hidden="true" tabindex="-1"></a>                            indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb479-38"><a href="#cb479-38" aria-hidden="true" tabindex="-1"></a>                            indColorRightProvided <span class="op">=</span> <span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-176-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="176">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  1 Child Scene:
    └ Scene (768px, 960px), [0 0 … 0 0; 0 0 … 0 0; … ; 2 2 … 2 2; 1 2 … 1 2], <span class="ansi-bold">100×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
  91 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
  92 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
  93 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
  94 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
  95 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
  96 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
  97 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
  98 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
  99 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 100 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                  35 columns and 79 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="make-a-summary-plot-for-the-whole-ring" class="level2">
<h2 class="anchored" data-anchor-id="make-a-summary-plot-for-the-whole-ring">Make a summary plot for the whole ring</h2>
<div id="6570ee53" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a code converting integers to colors. </span></span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="co"># These will be used for all chromosome regions below.</span></span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true" tabindex="-1"></a>integerToColorCodes <span class="op">=</span> <span class="fu">Dict</span><span class="dt">{Int, String}</span>(</span>
<span id="cb481-5"><a href="#cb481-5" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1</span> <span class="op">=&gt;</span> <span class="st">"blue"</span>, <span class="co"># vir</span></span>
<span id="cb481-6"><a href="#cb481-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">2</span> <span class="op">=&gt;</span> <span class="st">"turquoise1"</span>, <span class="co"># vir south</span></span>
<span id="cb481-7"><a href="#cb481-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">3</span> <span class="op">=&gt;</span> <span class="st">"grey"</span>, <span class="co"># nit</span></span>
<span id="cb481-8"><a href="#cb481-8" aria-hidden="true" tabindex="-1"></a>    <span class="fl">4</span> <span class="op">=&gt;</span> <span class="st">"green"</span>, <span class="co"># lud</span></span>
<span id="cb481-9"><a href="#cb481-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">5</span> <span class="op">=&gt;</span> <span class="st">"yellow"</span>, <span class="co"># troch</span></span>
<span id="cb481-10"><a href="#cb481-10" aria-hidden="true" tabindex="-1"></a>    <span class="fl">6</span> <span class="op">=&gt;</span> <span class="st">"orange"</span>, <span class="co"># obs</span></span>
<span id="cb481-11"><a href="#cb481-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">7</span> <span class="op">=&gt;</span> <span class="st">"red"</span>, <span class="co"># plumb</span></span>
<span id="cb481-12"><a href="#cb481-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb481-13"><a href="#cb481-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-14"><a href="#cb481-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a data structure to store the code to converting, for each haploblock region, </span></span>
<span id="cb481-15"><a href="#cb481-15" aria-hidden="true" tabindex="-1"></a><span class="co"># the cluster names to genotype integers corresponding to colors above. This is a dictionary of dictionaries.</span></span>
<span id="cb481-16"><a href="#cb481-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Each genotype will be encoded with a tuple representing the alleles.</span></span>
<span id="cb481-17"><a href="#cb481-17" aria-hidden="true" tabindex="-1"></a>regionHaplotypeCode_all <span class="op">=</span> <span class="fu">Dict</span><span class="dt">{String, Dict{String, Tuple{Int, Int}}}</span>(</span>
<span id="cb481-18"><a href="#cb481-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw1A"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>), </span>
<span id="cb481-19"><a href="#cb481-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-20"><a href="#cb481-20" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_troch"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>), </span>
<span id="cb481-21"><a href="#cb481-21" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-22"><a href="#cb481-22" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-23"><a href="#cb481-23" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-24"><a href="#cb481-24" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-25"><a href="#cb481-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw3"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>), </span>
<span id="cb481-26"><a href="#cb481-26" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLudHet"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-27"><a href="#cb481-27" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-28"><a href="#cb481-28" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_trochObs"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>),</span>
<span id="cb481-29"><a href="#cb481-29" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"trochObs"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-30"><a href="#cb481-30" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"trochObsHet"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-31"><a href="#cb481-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-32"><a href="#cb481-32" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumbHet"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-33"><a href="#cb481-33" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-34"><a href="#cb481-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw4A"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-35"><a href="#cb481-35" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLudHet"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-36"><a href="#cb481-36" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-37"><a href="#cb481-37" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_troch"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>),</span>
<span id="cb481-38"><a href="#cb481-38" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-39"><a href="#cb481-39" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"trochHet"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-40"><a href="#cb481-40" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch_obsPlumb"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">7</span>),</span>
<span id="cb481-41"><a href="#cb481-41" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obsPlumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-42"><a href="#cb481-42" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obsPlumbHet"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-43"><a href="#cb481-43" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_obsPlumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-44"><a href="#cb481-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw13"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"vir"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-45"><a href="#cb481-45" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_lud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">4</span>),</span>
<span id="cb481-46"><a href="#cb481-46" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-47"><a href="#cb481-47" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"lud"</span><span class="op">=&gt;</span>(<span class="fl">4</span>,<span class="fl">4</span>),</span>
<span id="cb481-48"><a href="#cb481-48" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"lud_troch"</span><span class="op">=&gt;</span>(<span class="fl">4</span>,<span class="fl">5</span>),</span>
<span id="cb481-49"><a href="#cb481-49" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-50"><a href="#cb481-50" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-51"><a href="#cb481-51" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-52"><a href="#cb481-52" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumbHet"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-53"><a href="#cb481-53" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),      </span>
<span id="cb481-54"><a href="#cb481-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw15"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-55"><a href="#cb481-55" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-56"><a href="#cb481-56" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_troch"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>),</span>
<span id="cb481-57"><a href="#cb481-57" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-58"><a href="#cb481-58" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-59"><a href="#cb481-59" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-60"><a href="#cb481-60" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-61"><a href="#cb481-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw17"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-62"><a href="#cb481-62" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-63"><a href="#cb481-63" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_troch"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>),</span>
<span id="cb481-64"><a href="#cb481-64" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-65"><a href="#cb481-65" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_obs"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">6</span>),</span>
<span id="cb481-66"><a href="#cb481-66" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-67"><a href="#cb481-67" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch_plumb"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">7</span>),</span>
<span id="cb481-68"><a href="#cb481-68" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-69"><a href="#cb481-69" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-70"><a href="#cb481-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw18"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-71"><a href="#cb481-71" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-72"><a href="#cb481-72" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_troch"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>),</span>
<span id="cb481-73"><a href="#cb481-73" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-74"><a href="#cb481-74" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-75"><a href="#cb481-75" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs_plumb"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">7</span>),</span>
<span id="cb481-76"><a href="#cb481-76" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-77"><a href="#cb481-77" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-78"><a href="#cb481-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw19"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-79"><a href="#cb481-79" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLudHet"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-80"><a href="#cb481-80" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-81"><a href="#cb481-81" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_trochObs"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>),</span>
<span id="cb481-82"><a href="#cb481-82" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"trochObs"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-83"><a href="#cb481-83" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"trochObsHet"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-84"><a href="#cb481-84" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"trochObs_plumb"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">7</span>),</span>
<span id="cb481-85"><a href="#cb481-85" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-86"><a href="#cb481-86" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-87"><a href="#cb481-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw20"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"vir"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-88"><a href="#cb481-88" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-89"><a href="#cb481-89" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud"</span><span class="op">=&gt;</span>(<span class="fl">4</span>,<span class="fl">4</span>),</span>
<span id="cb481-90"><a href="#cb481-90" aria-hidden="true" tabindex="-1"></a>                <span class="st">"ludHet"</span><span class="op">=&gt;</span>(<span class="fl">4</span>,<span class="fl">4</span>),</span>
<span id="cb481-91"><a href="#cb481-91" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lud_troch"</span><span class="op">=&gt;</span>(<span class="fl">4</span>,<span class="fl">5</span>),</span>
<span id="cb481-92"><a href="#cb481-92" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-93"><a href="#cb481-93" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-94"><a href="#cb481-94" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs_plumb"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">7</span>),</span>
<span id="cb481-95"><a href="#cb481-95" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-96"><a href="#cb481-96" aria-hidden="true" tabindex="-1"></a>                <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-97"><a href="#cb481-97" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw26"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-98"><a href="#cb481-98" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-99"><a href="#cb481-99" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_troch"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>),</span>
<span id="cb481-100"><a href="#cb481-100" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-101"><a href="#cb481-101" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-102"><a href="#cb481-102" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs_plumb"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">7</span>),</span>
<span id="cb481-103"><a href="#cb481-103" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-104"><a href="#cb481-104" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-105"><a href="#cb481-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gw28"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"virLud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-106"><a href="#cb481-106" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_nit"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">3</span>),</span>
<span id="cb481-107"><a href="#cb481-107" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-108"><a href="#cb481-108" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"virLud_troch"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">5</span>),</span>
<span id="cb481-109"><a href="#cb481-109" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-110"><a href="#cb481-110" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-111"><a href="#cb481-111" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obsHet"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-112"><a href="#cb481-112" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs_plumb"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">7</span>),</span>
<span id="cb481-113"><a href="#cb481-113" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>),</span>
<span id="cb481-114"><a href="#cb481-114" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_plumb"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">7</span>)),</span>
<span id="cb481-115"><a href="#cb481-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gwZ"</span> <span class="op">=&gt;</span> <span class="fu">Dict</span>(<span class="st">"vir"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">1</span>),</span>
<span id="cb481-116"><a href="#cb481-116" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"vir_lud"</span><span class="op">=&gt;</span>(<span class="fl">1</span>,<span class="fl">4</span>),</span>
<span id="cb481-117"><a href="#cb481-117" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span><span class="op">=&gt;</span>(<span class="fl">3</span>,<span class="fl">3</span>),</span>
<span id="cb481-118"><a href="#cb481-118" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"lud"</span><span class="op">=&gt;</span>(<span class="fl">4</span>,<span class="fl">4</span>),</span>
<span id="cb481-119"><a href="#cb481-119" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"lud_troch"</span><span class="op">=&gt;</span>(<span class="fl">4</span>,<span class="fl">5</span>),</span>
<span id="cb481-120"><a href="#cb481-120" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"troch"</span><span class="op">=&gt;</span>(<span class="fl">5</span>,<span class="fl">5</span>),</span>
<span id="cb481-121"><a href="#cb481-121" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"obs"</span><span class="op">=&gt;</span>(<span class="fl">6</span>,<span class="fl">6</span>),</span>
<span id="cb481-122"><a href="#cb481-122" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span><span class="op">=&gt;</span>(<span class="fl">7</span>,<span class="fl">7</span>))</span>
<span id="cb481-123"><a href="#cb481-123" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb481-124"><a href="#cb481-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-125"><a href="#cb481-125" aria-hidden="true" tabindex="-1"></a>haploblockRegions <span class="op">=</span> [<span class="st">"gwZ"</span>, <span class="st">"gw1A"</span>, <span class="st">"gw3"</span>, <span class="st">"gw4A"</span>, <span class="st">"gw13"</span>, <span class="st">"gw15"</span>, <span class="st">"gw17"</span>, <span class="st">"gw18"</span>, <span class="st">"gw19"</span>, <span class="st">"gw20"</span>,<span class="st">"gw26"</span>, <span class="st">"gw28"</span>]</span>
<span id="cb481-126"><a href="#cb481-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-127"><a href="#cb481-127" aria-hidden="true" tabindex="-1"></a>numHaploblockRegions <span class="op">=</span> <span class="fu">length</span>(haploblockRegions)</span>
<span id="cb481-128"><a href="#cb481-128" aria-hidden="true" tabindex="-1"></a>numInds <span class="op">=</span> <span class="fu">size</span>(ind_with_metadata_included, <span class="fl">1</span>)</span>
<span id="cb481-129"><a href="#cb481-129" aria-hidden="true" tabindex="-1"></a><span class="co"># create genotype object and fill with missing (-1) genotypes</span></span>
<span id="cb481-130"><a href="#cb481-130" aria-hidden="true" tabindex="-1"></a>genosSummary <span class="op">=</span> <span class="fu">fill</span>((<span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>), numInds, numHaploblockRegions)</span>
<span id="cb481-131"><a href="#cb481-131" aria-hidden="true" tabindex="-1"></a><span class="co"># fill object with appropriate genotypes</span></span>
<span id="cb481-132"><a href="#cb481-132" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numHaploblockRegions</span>
<span id="cb481-133"><a href="#cb481-133" aria-hidden="true" tabindex="-1"></a>    region <span class="op">=</span> haploblockRegions[i]</span>
<span id="cb481-134"><a href="#cb481-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (key, value) <span class="kw">in</span> regionHaplotypeCode_all[region]</span>
<span id="cb481-135"><a href="#cb481-135" aria-hidden="true" tabindex="-1"></a>        command <span class="op">=</span> <span class="st">"""genosSummary[ind_with_metadata_included.</span><span class="sc">$</span>(region)<span class="st">_cluster .== "</span><span class="sc">$</span>(key)<span class="st">", </span><span class="sc">$</span>i<span class="st">] .= (</span><span class="sc">$</span>(<span class="fu">string</span>(value))<span class="st">,)"""</span>  <span class="co"># the construction at the end "protects" the tuple within a tuple, so it broadcasts correctly to each element on the left</span></span>
<span id="cb481-136"><a href="#cb481-136" aria-hidden="true" tabindex="-1"></a>        <span class="fu">eval</span>(<span class="bu">Meta</span>.<span class="fu">parse</span>(command)) <span class="co"># this executes the command constructed above</span></span>
<span id="cb481-137"><a href="#cb481-137" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb481-138"><a href="#cb481-138" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb481-139"><a href="#cb481-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-140"><a href="#cb481-140" aria-hidden="true" tabindex="-1"></a>plotGroupsForSummary_all <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_S"</span>,<span class="st">"nit"</span>, <span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>,<span class="st">"troch_west"</span>,<span class="st">"troch_LN"</span>,<span class="st">"troch_EM"</span>,<span class="st">"obs"</span>,<span class="st">"plumb_BJ"</span>,<span class="st">"plumb"</span>,<span class="st">"plumb_vir"</span>]</span>
<span id="cb481-141"><a href="#cb481-141" aria-hidden="true" tabindex="-1"></a>groupColorsForSummary_all <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>,<span class="st">"grey"</span>,<span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>,<span class="st">"gold"</span>,<span class="st">"orange"</span>,<span class="st">"pink"</span>,<span class="st">"red"</span>,<span class="st">"purple"</span>] </span>
<span id="cb481-142"><a href="#cb481-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-143"><a href="#cb481-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-144"><a href="#cb481-144" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb481-145"><a href="#cb481-145" aria-hidden="true" tabindex="-1"></a><span class="st">    plotHaploblockSummary(integerToColorCodes::Dict{Int, String},</span></span>
<span id="cb481-146"><a href="#cb481-146" aria-hidden="true" tabindex="-1"></a><span class="st">                            genosSummary::Matrix{Tuple{Int64, Int64}},</span></span>
<span id="cb481-147"><a href="#cb481-147" aria-hidden="true" tabindex="-1"></a><span class="st">                            indMetadata,</span></span>
<span id="cb481-148"><a href="#cb481-148" aria-hidden="true" tabindex="-1"></a><span class="st">                            plotGroups, plotGroupColors;</span></span>
<span id="cb481-149"><a href="#cb481-149" aria-hidden="true" tabindex="-1"></a><span class="st">                            regionNames,</span></span>
<span id="cb481-150"><a href="#cb481-150" aria-hidden="true" tabindex="-1"></a><span class="st">                            indFontSize=10, figureSize=(1200, 1200),</span></span>
<span id="cb481-151"><a href="#cb481-151" aria-hidden="true" tabindex="-1"></a><span class="st">                            plotTitle = nothing,</span></span>
<span id="cb481-152"><a href="#cb481-152" aria-hidden="true" tabindex="-1"></a><span class="st">                            indColorLeftProvided = false,</span></span>
<span id="cb481-153"><a href="#cb481-153" aria-hidden="true" tabindex="-1"></a><span class="st">                            indColorRightProvided = false)</span></span>
<span id="cb481-154"><a href="#cb481-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-155"><a href="#cb481-155" aria-hidden="true" tabindex="-1"></a><span class="st">Construct a genotype-by-individual plot, with option to filter out SNPs with too much missing data. </span></span>
<span id="cb481-156"><a href="#cb481-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-157"><a href="#cb481-157" aria-hidden="true" tabindex="-1"></a><span class="st">In this version, more than two haplotype alleles can be plotted, using colors provided according to the first argument.</span></span>
<span id="cb481-158"><a href="#cb481-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-159"><a href="#cb481-159" aria-hidden="true" tabindex="-1"></a><span class="st">​# Arguments</span></span>
<span id="cb481-160"><a href="#cb481-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-161"><a href="#cb481-161" aria-hidden="true" tabindex="-1"></a><span class="st">- `integerToColorCodes`: The code matching integer haploblock types to colors.</span></span>
<span id="cb481-162"><a href="#cb481-162" aria-hidden="true" tabindex="-1"></a><span class="st">- `genosSummary`: Matrix containing summary genotype data (individuals in rows, loci in columns), with each genotype represented by a tuple of 2 integers.</span></span>
<span id="cb481-163"><a href="#cb481-163" aria-hidden="true" tabindex="-1"></a><span class="st">- `indMetadata`: Matrix of metadata for individuals; must contain `Fst_group` and `plot_order` columns.</span></span>
<span id="cb481-164"><a href="#cb481-164" aria-hidden="true" tabindex="-1"></a><span class="st">- `plotGroups`: Vector of group names to include in plot.</span></span>
<span id="cb481-165"><a href="#cb481-165" aria-hidden="true" tabindex="-1"></a><span class="st">- `plotGroupColors`: Vector of plotting colors corresponding to the groups.</span></span>
<span id="cb481-166"><a href="#cb481-166" aria-hidden="true" tabindex="-1"></a><span class="st">- `regionNames`: Optional; Names of the genotyped regions.</span></span>
<span id="cb481-167"><a href="#cb481-167" aria-hidden="true" tabindex="-1"></a><span class="st">- `indFontSize`: Optional; the font size of the individual ID labels.</span></span>
<span id="cb481-168"><a href="#cb481-168" aria-hidden="true" tabindex="-1"></a><span class="st">- `figureSize`: Optional; the size of the figure; default is `(1200, 1200)`.  </span></span>
<span id="cb481-169"><a href="#cb481-169" aria-hidden="true" tabindex="-1"></a><span class="st">- `plotTitle`: Optional; default will make a title. For no title, set to `""`.</span></span>
<span id="cb481-170"><a href="#cb481-170" aria-hidden="true" tabindex="-1"></a><span class="st">- `indColorLeftProvided`: Optional; Default is `false`. Set to `true` if there is a column labeled `indColorLeft` in the metadata providing color of each individual for plotting on left side.</span></span>
<span id="cb481-171"><a href="#cb481-171" aria-hidden="true" tabindex="-1"></a><span class="st">- `indColorRightProvided`: Optional; same as above but for right side (requires `indColorRight` column in metadata).</span></span>
<span id="cb481-172"><a href="#cb481-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-173"><a href="#cb481-173" aria-hidden="true" tabindex="-1"></a><span class="st"># Notes</span></span>
<span id="cb481-174"><a href="#cb481-174" aria-hidden="true" tabindex="-1"></a><span class="st">Returns a tuple containing:</span></span>
<span id="cb481-175"><a href="#cb481-175" aria-hidden="true" tabindex="-1"></a><span class="st">- the figure</span></span>
<span id="cb481-176"><a href="#cb481-176" aria-hidden="true" tabindex="-1"></a><span class="st">- the plotted genotypes</span></span>
<span id="cb481-177"><a href="#cb481-177" aria-hidden="true" tabindex="-1"></a><span class="st">- the sorted metadata matrix for the plotted individuals</span></span>
<span id="cb481-178"><a href="#cb481-178" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb481-179"><a href="#cb481-179" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">plotHaploblockSummary</span>(integerToColorCodes<span class="op">::</span><span class="dt">Dict{Int, String}</span>,</span>
<span id="cb481-180"><a href="#cb481-180" aria-hidden="true" tabindex="-1"></a>                                genosSummary<span class="op">::</span><span class="dt">Matrix{Tuple{Int64, Int64}}</span>, </span>
<span id="cb481-181"><a href="#cb481-181" aria-hidden="true" tabindex="-1"></a>                                indMetadata,</span>
<span id="cb481-182"><a href="#cb481-182" aria-hidden="true" tabindex="-1"></a>                                plotGroups, plotGroupColors;</span>
<span id="cb481-183"><a href="#cb481-183" aria-hidden="true" tabindex="-1"></a>                                regionNames <span class="op">=</span> <span class="cn">nothing</span>,        </span>
<span id="cb481-184"><a href="#cb481-184" aria-hidden="true" tabindex="-1"></a>                                indFontSize<span class="op">=</span><span class="fl">10</span>, figureSize<span class="op">=</span>(<span class="fl">1200</span>, <span class="fl">1200</span>),</span>
<span id="cb481-185"><a href="#cb481-185" aria-hidden="true" tabindex="-1"></a>                                plotTitle <span class="op">=</span> <span class="cn">nothing</span>,</span>
<span id="cb481-186"><a href="#cb481-186" aria-hidden="true" tabindex="-1"></a>                                indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb481-187"><a href="#cb481-187" aria-hidden="true" tabindex="-1"></a>                                indColorRightProvided <span class="op">=</span> <span class="cn">false</span>)</span>
<span id="cb481-188"><a href="#cb481-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-189"><a href="#cb481-189" aria-hidden="true" tabindex="-1"></a>    numRegions <span class="op">=</span> <span class="fu">size</span>(genosSummary, <span class="fl">2</span>)</span>
<span id="cb481-190"><a href="#cb481-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-191"><a href="#cb481-191" aria-hidden="true" tabindex="-1"></a>    genosSummary_subset <span class="op">=</span> genosSummary[indMetadata.Fst_group <span class="op">.∈</span> <span class="fu">Ref</span>(plotGroups), <span class="op">:</span>]</span>
<span id="cb481-192"><a href="#cb481-192" aria-hidden="true" tabindex="-1"></a>    indMetadata_subset <span class="op">=</span> indMetadata[indMetadata.Fst_group <span class="op">.∈</span> <span class="fu">Ref</span>(plotGroups), <span class="op">:</span>]</span>
<span id="cb481-193"><a href="#cb481-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-194"><a href="#cb481-194" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Choose sorting order by plot_order column in input metadata file</span></span>
<span id="cb481-195"><a href="#cb481-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-196"><a href="#cb481-196" aria-hidden="true" tabindex="-1"></a>    sorted_genosSummary_subset <span class="op">=</span> genosSummary_subset[<span class="fu">sortperm</span>(indMetadata_subset.plot_order, rev<span class="op">=</span><span class="cn">false</span>), <span class="op">:</span>]</span>
<span id="cb481-197"><a href="#cb481-197" aria-hidden="true" tabindex="-1"></a>    numInds <span class="op">=</span> <span class="fu">size</span>(sorted_genosSummary_subset, <span class="fl">1</span>)</span>
<span id="cb481-198"><a href="#cb481-198" aria-hidden="true" tabindex="-1"></a>    sorted_indMetadata_subset <span class="op">=</span> indMetadata_subset[<span class="fu">sortperm</span>(indMetadata_subset.plot_order, rev<span class="op">=</span><span class="cn">false</span>), <span class="op">:</span>]</span>
<span id="cb481-199"><a href="#cb481-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-200"><a href="#cb481-200" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the plot window:</span></span>
<span id="cb481-201"><a href="#cb481-201" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>(size<span class="op">=</span>figureSize)</span>
<span id="cb481-202"><a href="#cb481-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-203"><a href="#cb481-203" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">isnothing</span>(plotTitle)</span>
<span id="cb481-204"><a href="#cb481-204" aria-hidden="true" tabindex="-1"></a>        plotTitle <span class="op">=</span> <span class="st">"Summary of </span><span class="sc">$</span>numRegions<span class="st"> haploblock genotypes for </span><span class="sc">$</span>numInds<span class="st"> individuals"</span></span>
<span id="cb481-205"><a href="#cb481-205" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> </span>
<span id="cb481-206"><a href="#cb481-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-207"><a href="#cb481-207" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the main Axis: </span></span>
<span id="cb481-208"><a href="#cb481-208" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb481-209"><a href="#cb481-209" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> plotTitle,</span>
<span id="cb481-210"><a href="#cb481-210" aria-hidden="true" tabindex="-1"></a>        titlesize<span class="op">=</span><span class="fl">30</span>,</span>
<span id="cb481-211"><a href="#cb481-211" aria-hidden="true" tabindex="-1"></a>        limits<span class="op">=</span>(<span class="fl">0.5</span> <span class="op">-</span> <span class="fl">0.09</span> <span class="op">*</span> (numRegions), <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">1.09</span> <span class="op">*</span> (numRegions),</span>
<span id="cb481-212"><a href="#cb481-212" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.5</span> <span class="op">-</span> <span class="fl">0.3</span> <span class="op">*</span> numInds, <span class="fl">0.5</span> <span class="op">+</span> numInds)</span>
<span id="cb481-213"><a href="#cb481-213" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb481-214"><a href="#cb481-214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hidedecorations!</span>(ax) <span class="co"># hide background lattice and axis labels</span></span>
<span id="cb481-215"><a href="#cb481-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hidespines!</span>(ax) <span class="co"># hide box around plot</span></span>
<span id="cb481-216"><a href="#cb481-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-217"><a href="#cb481-217" aria-hidden="true" tabindex="-1"></a>    genotypeColors <span class="op">=</span> [<span class="st">"#3f007d"</span>, <span class="st">"#807dba"</span>, <span class="st">"#dadaeb"</span>, <span class="st">"grey50"</span>]  <span class="co"># purple shades from colorbrewer</span></span>
<span id="cb481-218"><a href="#cb481-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-219"><a href="#cb481-219" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot evenly spaced by SNP order along chromosome:</span></span>
<span id="cb481-220"><a href="#cb481-220" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make top part of fig (genotypes for individuals)</span></span>
<span id="cb481-221"><a href="#cb481-221" aria-hidden="true" tabindex="-1"></a>    labelCushion <span class="op">=</span> numRegions <span class="op">/</span> <span class="fl">100</span></span>
<span id="cb481-222"><a href="#cb481-222" aria-hidden="true" tabindex="-1"></a>    label_x_left <span class="op">=</span> <span class="fl">0.5</span> <span class="op">-</span> labelCushion</span>
<span id="cb481-223"><a href="#cb481-223" aria-hidden="true" tabindex="-1"></a>    label_x_right <span class="op">=</span> <span class="fl">0.5</span> <span class="op">+</span> numRegions <span class="op">+</span> labelCushion</span>
<span id="cb481-224"><a href="#cb481-224" aria-hidden="true" tabindex="-1"></a>    colorBoxCushion <span class="op">=</span> <span class="fl">0.07</span> <span class="op">*</span> numRegions</span>
<span id="cb481-225"><a href="#cb481-225" aria-hidden="true" tabindex="-1"></a>    groupColorBox_x_left <span class="op">=</span> <span class="fl">0.5</span> <span class="op">-</span> colorBoxCushion</span>
<span id="cb481-226"><a href="#cb481-226" aria-hidden="true" tabindex="-1"></a>    groupColorBox_x_right <span class="op">=</span> <span class="fl">0.5</span> <span class="op">+</span> numRegions <span class="op">+</span> colorBoxCushion</span>
<span id="cb481-227"><a href="#cb481-227" aria-hidden="true" tabindex="-1"></a>    boxWidth <span class="op">=</span> <span class="fl">0.005</span> <span class="op">*</span> numRegions <span class="op">*</span> <span class="fl">2</span></span>
<span id="cb481-228"><a href="#cb481-228" aria-hidden="true" tabindex="-1"></a>    groupColorBox_x_left <span class="op">=</span> [<span class="op">-</span>boxWidth, <span class="op">-</span>boxWidth, boxWidth, boxWidth, <span class="op">-</span>boxWidth] <span class="op">.+</span> groupColorBox_x_left</span>
<span id="cb481-229"><a href="#cb481-229" aria-hidden="true" tabindex="-1"></a>    groupColorBox_x_right <span class="op">=</span> [<span class="op">-</span>boxWidth, <span class="op">-</span>boxWidth, boxWidth, boxWidth, <span class="op">-</span>boxWidth] <span class="op">.+</span> groupColorBox_x_right</span>
<span id="cb481-230"><a href="#cb481-230" aria-hidden="true" tabindex="-1"></a>    groupColorBox_y <span class="op">=</span> [<span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>]</span>
<span id="cb481-231"><a href="#cb481-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-232"><a href="#cb481-232" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numInds</span>
<span id="cb481-233"><a href="#cb481-233" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> numInds <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> i  <span class="co"># y is location for plotting; this reverses order of plot top-bottom</span></span>
<span id="cb481-234"><a href="#cb481-234" aria-hidden="true" tabindex="-1"></a>        labelText <span class="op">=</span> <span class="fu">last</span>(<span class="fu">split</span>(sorted_indMetadata_subset.ID[i], <span class="st">"_"</span>))  <span class="co"># this gets the last part of the sample ID (usually the main ID part)</span></span>
<span id="cb481-235"><a href="#cb481-235" aria-hidden="true" tabindex="-1"></a>        <span class="co"># put sample label on left side:</span></span>
<span id="cb481-236"><a href="#cb481-236" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">text!</span>(label_x_left, y; text<span class="op">=</span>labelText, align<span class="op">=</span>(<span class="op">:</span>right, <span class="op">:</span>center), fontsize<span class="op">=</span>indFontSize)</span>
<span id="cb481-237"><a href="#cb481-237" aria-hidden="true" tabindex="-1"></a>        <span class="co"># put sample label on left side:</span></span>
<span id="cb481-238"><a href="#cb481-238" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">text!</span>(label_x_right, y; text<span class="op">=</span>labelText, align<span class="op">=</span>(<span class="op">:</span>left, <span class="op">:</span>center), fontsize<span class="op">=</span>indFontSize)</span>
<span id="cb481-239"><a href="#cb481-239" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> indColorLeftProvided</span>
<span id="cb481-240"><a href="#cb481-240" aria-hidden="true" tabindex="-1"></a>            boxColorLeft <span class="op">=</span> sorted_indMetadata_subset.indColorLeft[i]</span>
<span id="cb481-241"><a href="#cb481-241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb481-242"><a href="#cb481-242" aria-hidden="true" tabindex="-1"></a>            boxColorLeft <span class="op">=</span> plotGroupColors[<span class="fu">findfirst</span>(plotGroups <span class="op">.==</span> sorted_indMetadata_subset.Fst_group[i])]</span>
<span id="cb481-243"><a href="#cb481-243" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb481-244"><a href="#cb481-244" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> indColorRightProvided</span>
<span id="cb481-245"><a href="#cb481-245" aria-hidden="true" tabindex="-1"></a>            boxColorRight <span class="op">=</span> sorted_indMetadata_subset.indColorRight[i]</span>
<span id="cb481-246"><a href="#cb481-246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb481-247"><a href="#cb481-247" aria-hidden="true" tabindex="-1"></a>            boxColorRight <span class="op">=</span> plotGroupColors[<span class="fu">findfirst</span>(plotGroups <span class="op">.==</span> sorted_indMetadata_subset.Fst_group[i])]</span>
<span id="cb481-248"><a href="#cb481-248" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb481-249"><a href="#cb481-249" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.(groupColorBox_x_left, (y <span class="op">.+</span> groupColorBox_y)), color<span class="op">=</span>boxColorLeft)</span>
<span id="cb481-250"><a href="#cb481-250" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.(groupColorBox_x_right, (y <span class="op">.+</span> groupColorBox_y)), color<span class="op">=</span>boxColorRight)</span>
<span id="cb481-251"><a href="#cb481-251" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb481-252"><a href="#cb481-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-253"><a href="#cb481-253" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate my own plotting symbol (a rectangle)</span></span>
<span id="cb481-254"><a href="#cb481-254" aria-hidden="true" tabindex="-1"></a>    box_x <span class="op">=</span> [<span class="op">-</span><span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>]</span>
<span id="cb481-255"><a href="#cb481-255" aria-hidden="true" tabindex="-1"></a>    <span class="co">#box_x = [-0.5, -0.5, 0.5, 0.5, -0.5]</span></span>
<span id="cb481-256"><a href="#cb481-256" aria-hidden="true" tabindex="-1"></a>    box_y <span class="op">=</span> [<span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>]</span>
<span id="cb481-257"><a href="#cb481-257" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate triangles for plotting heterozygotes</span></span>
<span id="cb481-258"><a href="#cb481-258" aria-hidden="true" tabindex="-1"></a>    triangle1_x <span class="op">=</span> [<span class="op">-</span><span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>]</span>
<span id="cb481-259"><a href="#cb481-259" aria-hidden="true" tabindex="-1"></a>    <span class="co">#triangle1_x = [-0.5, -0.5, 0.5, -0.5]</span></span>
<span id="cb481-260"><a href="#cb481-260" aria-hidden="true" tabindex="-1"></a>    triangle1_y <span class="op">=</span> [<span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>]</span>
<span id="cb481-261"><a href="#cb481-261" aria-hidden="true" tabindex="-1"></a>    triangle2_x <span class="op">=</span> [<span class="op">-</span><span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="fl">0.45</span>, <span class="op">-</span><span class="fl">0.45</span>]</span>
<span id="cb481-262"><a href="#cb481-262" aria-hidden="true" tabindex="-1"></a>    <span class="co">#triangle2_x = [-0.5, 0.5, 0.5, -0.5]</span></span>
<span id="cb481-263"><a href="#cb481-263" aria-hidden="true" tabindex="-1"></a>    triangle2_y <span class="op">=</span> [<span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.4</span>]</span>
<span id="cb481-264"><a href="#cb481-264" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cycle through individuals, graphing each type of genotype:</span></span>
<span id="cb481-265"><a href="#cb481-265" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numInds</span>
<span id="cb481-266"><a href="#cb481-266" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> numInds <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> i  <span class="co"># y is location for plotting; this reverses order of plot top-bottom</span></span>
<span id="cb481-267"><a href="#cb481-267" aria-hidden="true" tabindex="-1"></a>        <span class="co">#CairoMakie.lines!([0.5, numRegions + 0.5], [y, y], color="grey40") # for lines across the individual rows</span></span>
<span id="cb481-268"><a href="#cb481-268" aria-hidden="true" tabindex="-1"></a>        <span class="co"># cycle through regions for this individual</span></span>
<span id="cb481-269"><a href="#cb481-269" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numRegions</span>
<span id="cb481-270"><a href="#cb481-270" aria-hidden="true" tabindex="-1"></a>            genotype <span class="op">=</span> sorted_genosSummary_subset[i, j]</span>
<span id="cb481-271"><a href="#cb481-271" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> genotype[<span class="fl">1</span>] <span class="op">==</span> genotype[<span class="fl">2</span>]  <span class="co"># homozygous</span></span>
<span id="cb481-272"><a href="#cb481-272" aria-hidden="true" tabindex="-1"></a>                CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.((j <span class="op">.+</span> box_x), (y <span class="op">.+</span> box_y)), color<span class="op">=</span>integerToColorCodes[genotype[<span class="fl">1</span>]])</span>
<span id="cb481-273"><a href="#cb481-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="co"># heterozygous</span></span>
<span id="cb481-274"><a href="#cb481-274" aria-hidden="true" tabindex="-1"></a>                CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.((j <span class="op">.+</span> triangle1_x), (y <span class="op">.+</span> triangle1_y)), color<span class="op">=</span>integerToColorCodes[genotype[<span class="fl">1</span>]])</span>
<span id="cb481-275"><a href="#cb481-275" aria-hidden="true" tabindex="-1"></a>                CairoMakie.<span class="fu">poly!</span>(<span class="fu">Point2f</span>.((j <span class="op">.+</span> triangle2_x), (y <span class="op">.+</span> triangle2_y)), color<span class="op">=</span>integerToColorCodes[genotype[<span class="fl">2</span>]])</span>
<span id="cb481-276"><a href="#cb481-276" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb481-277"><a href="#cb481-277" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb481-278"><a href="#cb481-278" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb481-279"><a href="#cb481-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-280"><a href="#cb481-280" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">isnothing</span>(regionNames)</span>
<span id="cb481-281"><a href="#cb481-281" aria-hidden="true" tabindex="-1"></a>        regionNames <span class="op">=</span> <span class="fu">string</span>.(<span class="fl">1</span><span class="op">:</span>numRegions)</span>
<span id="cb481-282"><a href="#cb481-282" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb481-283"><a href="#cb481-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-284"><a href="#cb481-284" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make labels on lower part</span></span>
<span id="cb481-285"><a href="#cb481-285" aria-hidden="true" tabindex="-1"></a>    y_label <span class="op">=</span> <span class="fl">0.5</span> <span class="op">-</span> <span class="fl">0.025</span>numInds</span>
<span id="cb481-286"><a href="#cb481-286" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numRegions</span>
<span id="cb481-287"><a href="#cb481-287" aria-hidden="true" tabindex="-1"></a>        CairoMakie.<span class="fu">text!</span>(i, y_label; text <span class="op">=</span> regionNames[i], align<span class="op">=</span>(<span class="op">:</span>center, <span class="op">:</span>center), fontsize<span class="op">=</span><span class="fl">24</span>)</span>
<span id="cb481-288"><a href="#cb481-288" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb481-289"><a href="#cb481-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-290"><a href="#cb481-290" aria-hidden="true" tabindex="-1"></a>    <span class="fu">display</span>(f)</span>
<span id="cb481-291"><a href="#cb481-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-292"><a href="#cb481-292" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f, sorted_genosSummary_subset, sorted_indMetadata_subset</span>
<span id="cb481-293"><a href="#cb481-293" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb481-294"><a href="#cb481-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-295"><a href="#cb481-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-296"><a href="#cb481-296" aria-hidden="true" tabindex="-1"></a><span class="fu">plotHaploblockSummary</span>(integerToColorCodes,</span>
<span id="cb481-297"><a href="#cb481-297" aria-hidden="true" tabindex="-1"></a>                            genosSummary, </span>
<span id="cb481-298"><a href="#cb481-298" aria-hidden="true" tabindex="-1"></a>                            ind_with_metadata_included,</span>
<span id="cb481-299"><a href="#cb481-299" aria-hidden="true" tabindex="-1"></a>                            plotGroupsForSummary_all, groupColorsForSummary_all;</span>
<span id="cb481-300"><a href="#cb481-300" aria-hidden="true" tabindex="-1"></a>                            regionNames <span class="op">=</span> haploblockRegions,</span>
<span id="cb481-301"><a href="#cb481-301" aria-hidden="true" tabindex="-1"></a>                            indFontSize <span class="op">=</span> <span class="fl">8</span>, figureSize <span class="op">=</span> (<span class="fl">1000</span>, <span class="fl">2000</span>),</span>
<span id="cb481-302"><a href="#cb481-302" aria-hidden="true" tabindex="-1"></a>                            plotTitle <span class="op">=</span> <span class="cn">nothing</span>,</span>
<span id="cb481-303"><a href="#cb481-303" aria-hidden="true" tabindex="-1"></a>                            indColorLeftProvided <span class="op">=</span> <span class="cn">false</span>,</span>
<span id="cb481-304"><a href="#cb481-304" aria-hidden="true" tabindex="-1"></a>                            indColorRightProvided <span class="op">=</span> <span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-177-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="177">
<div class="ansi-escaped-output">
<pre>(Scene (768px, 960px):
  0 Plots
  1 Child Scene:
    └ Scene (768px, 960px), [(1, 1) (1, 1) … (1, 1) (1, 1); (1, 1) (1, 1) … (1, 1) (1, 1); … ; (7, 7) (7, 7) … (7, 7) (7, 7); (7, 7) (1, 7) … (1, 7) (1, 7)], <span class="ansi-bold">257×38 DataFrame</span>
<span class="ansi-bold"> Row </span>│<span class="ansi-bold"> ind                       </span><span class="ansi-bold"> ID                        </span><span class="ansi-bold"> location </span><span class="ansi-bold"> group  </span> ⋯
     │<span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String                    </span><span class="ansi-bright-black-fg"> String7  </span><span class="ansi-bright-black-fg"> String1</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_JF12G04  GW_Armando_plate1_JF12G04  ST_vi     vir     ⋯
   2 │ GW_Armando_plate2_JF03G01  GW_Armando_plate2_JF03G01  ST_vi     vir_mis
   3 │ GW_Armando_plate2_JF30G01  GW_Armando_plate2_JF30G01  ST_vi     vir_mis
   4 │ GW_Lane5_STvi1             GW_Lane5_STvi1             ST_vi     vir
   5 │ GW_Lane5_STvi2             GW_Lane5_STvi2             ST_vi     vir     ⋯
   6 │ GW_Lane5_STvi3             GW_Lane5_STvi3             ST_vi     vir
   7 │ GW_Armando_plate1_JF16G01  GW_Armando_plate1_JF16G01  DV_vi     plumb_v
   8 │ GW_Armando_plate2_JF16G02  GW_Armando_plate2_JF16G02  DV_vi     plumb_v
   9 │ GW_Armando_plate2_JE31G01  GW_Armando_plate2_JE31G01  VB_vi     vir_mis ⋯
  10 │ GW_Armando_plate2_JF03G02  GW_Armando_plate2_JF03G02  VB_vi     vir_mis
  11 │ GW_Lane5_YK11              GW_Lane5_YK11              YK        vir
  ⋮  │             ⋮                          ⋮                 ⋮          ⋮   ⋱
 248 │ GW_Armando_plate2_JF24G01  GW_Armando_plate2_JF24G01  VB        plumb
 249 │ GW_Armando_plate2_JF25G01  GW_Armando_plate2_JF25G01  VB        plumb   ⋯
 250 │ GW_Armando_plate1_JG02G02  GW_Armando_plate1_JG02G02  PR        plumb
 251 │ GW_Armando_plate1_JG02G04  GW_Armando_plate1_JG02G04  PR        plumb
 252 │ GW_Armando_plate2_JG01G01  GW_Armando_plate2_JG01G01  PR        plumb
 253 │ GW_Armando_plate2_JG02G01  GW_Armando_plate2_JG02G01  PR        plumb   ⋯
 254 │ GW_Armando_plate2_JG02G03  GW_Armando_plate2_JG02G03  PR        plumb
 255 │ GW_Lane5_SL1               GW_Lane5_SL1               SL        plumb
 256 │ GW_Lane5_SL2               GW_Lane5_SL2               SL        plumb
 257 │ GW_Armando_plate1_JF10G03  GW_Armando_plate1_JF10G03  ST        plumb_v ⋯
<span class="ansi-cyan-fg">                                                 35 columns and 236 rows omitted</span>)</pre>
</div>
</div>
</div>
</section>
<section id="produce-fst-plot-across-genome" class="level2">
<h2 class="anchored" data-anchor-id="produce-fst-plot-across-genome">Produce Fst plot across genome</h2>
<section id="calculate-allele-freqs-and-sample-sizes-use-column-fst_group" class="level4">
<h4 class="anchored" data-anchor-id="calculate-allele-freqs-and-sample-sizes-use-column-fst_group">Calculate allele freqs and sample sizes (use column Fst_group)</h4>
<div id="90c86ddb" class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"troch_LN"</span>,<span class="st">"plumb"</span>,<span class="st">"plumb_vir"</span>]</span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genosOnly_included, ind_with_metadata_included.Fst_group, groups)</span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes</code></pre>
</div>
</div>
</section>
<section id="calculate-fst-for-each-snp" class="level4">
<h4 class="anchored" data-anchor-id="calculate-fst-for-each-snp">calculate Fst for each SNP</h4>
<div id="96b37f3a" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseNamesFst <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, groups; among<span class="op">=</span><span class="cn">true</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated Fst values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated Fst values</code></pre>
</div>
</div>
</section>
<section id="make-list-of-main-scaffolds-to-include-in-fst-plot-across-genome" class="level4">
<h4 class="anchored" data-anchor-id="make-list-of-main-scaffolds-to-include-in-fst-plot-across-genome">Make list of main scaffolds to include in Fst plot across genome:</h4>
<div id="87bc45fe" class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a>scaffolds_for_Fst <span class="op">=</span> <span class="st">"gw"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fu">vcat</span>(<span class="fl">1</span>, <span class="st">"1A"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="st">"4A"</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">17</span><span class="op">:</span><span class="fl">28</span>, <span class="st">"Z"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="180">
<pre><code>30-element Vector{String}:
 "gw1"
 "gw1A"
 "gw2"
 "gw3"
 "gw4"
 "gw4A"
 "gw5"
 "gw6"
 "gw7"
 "gw8"
 "gw9"
 "gw10"
 "gw11"
 ⋮
 "gw18"
 "gw19"
 "gw20"
 "gw21"
 "gw22"
 "gw23"
 "gw24"
 "gw25"
 "gw26"
 "gw27"
 "gw28"
 "gwZ"</code></pre>
</div>
</div>
</section>
<section id="calculate-windowed-fst" class="level4">
<h4 class="anchored" data-anchor-id="calculate-windowed-fst">calculate windowed Fst</h4>
<p>This is calculated according to Weir&amp;Cockerham1984 (with sample size and pop number correction), calculated as windowed numerator over windowed denominator, in whole windows starting on left side of chromosome.</p>
<div id="5f5c8903" class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb489"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a>windowSize <span class="op">=</span> <span class="fl">500</span></span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate windowed Fst across all scaffolds:</span></span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-5"><a href="#cb489-5" aria-hidden="true" tabindex="-1"></a>windowed_pos_all <span class="op">=</span> <span class="fu">DataFrame</span>(chrom <span class="op">=</span> <span class="dt">String</span>[], mean_position <span class="op">=</span> <span class="dt">Float64</span>[])</span>
<span id="cb489-6"><a href="#cb489-6" aria-hidden="true" tabindex="-1"></a>windowed_Fst_all <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Float32, 2}</span>(<span class="cn">undef</span>, <span class="fu">size</span>(FstNumerator, <span class="fl">1</span>), <span class="fl">0</span>)</span>
<span id="cb489-7"><a href="#cb489-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chrom <span class="kw">in</span> scaffolds_for_Fst</span>
<span id="cb489-8"><a href="#cb489-8" aria-hidden="true" tabindex="-1"></a>    regionText <span class="op">=</span> <span class="fu">string</span>(<span class="st">"chr"</span>, chrom)</span>
<span id="cb489-9"><a href="#cb489-9" aria-hidden="true" tabindex="-1"></a>    loci_selection <span class="op">=</span> (pos_SNP_filtered.chrom <span class="op">.==</span> chrom)</span>
<span id="cb489-10"><a href="#cb489-10" aria-hidden="true" tabindex="-1"></a>    pos_region <span class="op">=</span> pos_SNP_filtered[loci_selection, <span class="op">:</span>]</span>
<span id="cb489-11"><a href="#cb489-11" aria-hidden="true" tabindex="-1"></a>    FstNumerator_region <span class="op">=</span> FstNumerator[<span class="op">:</span>, loci_selection]</span>
<span id="cb489-12"><a href="#cb489-12" aria-hidden="true" tabindex="-1"></a>    FstDenominator_region <span class="op">=</span> FstDenominator[<span class="op">:</span>, loci_selection]</span>
<span id="cb489-13"><a href="#cb489-13" aria-hidden="true" tabindex="-1"></a>    windowedPos, windowedFst <span class="op">=</span> <span class="fu">getWindowedFst</span>(FstNumerator_region, FstDenominator_region, pos_region, windowSize)</span>
<span id="cb489-14"><a href="#cb489-14" aria-hidden="true" tabindex="-1"></a>    windowed_pos_chrom <span class="op">=</span> <span class="fu">DataFrame</span>(chrom <span class="op">=</span> <span class="fu">repeat</span>([chrom], <span class="fu">length</span>(windowedPos)), mean_position <span class="op">=</span> windowedPos)</span>
<span id="cb489-15"><a href="#cb489-15" aria-hidden="true" tabindex="-1"></a>    windowed_pos_all <span class="op">=</span> <span class="fu">vcat</span>(windowed_pos_all, windowed_pos_chrom)</span>
<span id="cb489-16"><a href="#cb489-16" aria-hidden="true" tabindex="-1"></a>    windowed_Fst_all <span class="op">=</span> <span class="fu">hcat</span>(windowed_Fst_all, windowedFst)</span>
<span id="cb489-17"><a href="#cb489-17" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb489-18"><a href="#cb489-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-19"><a href="#cb489-19" aria-hidden="true" tabindex="-1"></a><span class="co"># The below is just a test plot, showing nothing useful really (as it overlaps all chromosomes onto one x axis):</span></span>
<span id="cb489-20"><a href="#cb489-20" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(windowed_pos_all.mean_position, windowed_Fst_all[1,:])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above has produced windowed Fst values across the whole genome, for each population comparison. These are stored in <code>windowed_Fst_all</code> and the location info is stored in <code>windowed_pos_all</code>.</p>
<p>Now make a plot of windowed Fst across all scaffolds:</p>
<div id="edd15ea2" class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a>scaffolds_to_plot <span class="op">=</span> scaffolds_for_Fst</span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a>groupsToPlotFst <span class="op">=</span> [<span class="st">"vir_troch_LN"</span>, <span class="st">"troch_LN_plumb"</span>, <span class="st">"vir_plumb"</span>]</span>
<span id="cb490-4"><a href="#cb490-4" aria-hidden="true" tabindex="-1"></a>groupColorsFst <span class="op">=</span> [<span class="st">"green3"</span>, <span class="st">"orange"</span>, <span class="st">"purple"</span>]</span>
<span id="cb490-5"><a href="#cb490-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb490-6"><a href="#cb490-6" aria-hidden="true" tabindex="-1"></a>figHandle_GenomeFst3 <span class="op">=</span> <span class="fu">plotGenomeFst</span>(scaffolds_to_plot, </span>
<span id="cb490-7"><a href="#cb490-7" aria-hidden="true" tabindex="-1"></a>                                    windowed_Fst_all,</span>
<span id="cb490-8"><a href="#cb490-8" aria-hidden="true" tabindex="-1"></a>                                    pairwiseNamesFst,</span>
<span id="cb490-9"><a href="#cb490-9" aria-hidden="true" tabindex="-1"></a>                                    windowed_pos_all,</span>
<span id="cb490-10"><a href="#cb490-10" aria-hidden="true" tabindex="-1"></a>                                    groupsToPlotFst,</span>
<span id="cb490-11"><a href="#cb490-11" aria-hidden="true" tabindex="-1"></a>                                    groupColorsFst;</span>
<span id="cb490-12"><a href="#cb490-12" aria-hidden="true" tabindex="-1"></a>                                    lineTransparency <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span id="cb490-13"><a href="#cb490-13" aria-hidden="true" tabindex="-1"></a>                                    fillTransparency <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span id="cb490-14"><a href="#cb490-14" aria-hidden="true" tabindex="-1"></a>                                    figureSize<span class="op">=</span>(<span class="fl">1200</span>, <span class="fl">1200</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[["gw1", "gw4A", "gw6"], ["gw1A", "gw4", "gw9"], ["gw2", "gw8"], ["gw3", "gw5"], ["gw7", "gw10", "gw11", "gw12", "gw13", "gw14"], ["gw15", "gw17", "gw18", "gw19", "gw20", "gw21", "gw22", "gw23", "gw24", "gw25"], ["gw26", "gw27", "gw28", "gwZ"]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-182-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="182">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-182-output-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now do one with just the vir_plumb connection</p>
<div id="f6125dbb" class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a>groupsToPlotFst <span class="op">=</span> [<span class="st">"vir_plumb"</span>]</span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a>groupColorsFst <span class="op">=</span> [<span class="st">"purple"</span>]</span>
<span id="cb493-3"><a href="#cb493-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-4"><a href="#cb493-4" aria-hidden="true" tabindex="-1"></a>figHandle_GenomeFst1 <span class="op">=</span> <span class="fu">plotGenomeFst</span>(scaffolds_to_plot, </span>
<span id="cb493-5"><a href="#cb493-5" aria-hidden="true" tabindex="-1"></a>                                    windowed_Fst_all,</span>
<span id="cb493-6"><a href="#cb493-6" aria-hidden="true" tabindex="-1"></a>                                    pairwiseNamesFst,</span>
<span id="cb493-7"><a href="#cb493-7" aria-hidden="true" tabindex="-1"></a>                                    windowed_pos_all,</span>
<span id="cb493-8"><a href="#cb493-8" aria-hidden="true" tabindex="-1"></a>                                    groupsToPlotFst,</span>
<span id="cb493-9"><a href="#cb493-9" aria-hidden="true" tabindex="-1"></a>                                    groupColorsFst;</span>
<span id="cb493-10"><a href="#cb493-10" aria-hidden="true" tabindex="-1"></a>                                    lineTransparency <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span id="cb493-11"><a href="#cb493-11" aria-hidden="true" tabindex="-1"></a>                                    fillTransparency <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span id="cb493-12"><a href="#cb493-12" aria-hidden="true" tabindex="-1"></a>                                    figureSize<span class="op">=</span>(<span class="fl">1200</span>, <span class="fl">800</span>))</span>
<span id="cb493-13"><a href="#cb493-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-14"><a href="#cb493-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">true</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb493-15"><a href="#cb493-15" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="fu">string</span>(<span class="st">"FigureS33_GenomeFst_fromJulia.png"</span>)</span>
<span id="cb493-16"><a href="#cb493-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(filename, figHandle_GenomeFst1, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb493-17"><a href="#cb493-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Saved "</span>, filename)</span>
<span id="cb493-18"><a href="#cb493-18" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[["gw1", "gw4A", "gw6"], ["gw1A", "gw4", "gw9"], ["gw2", "gw8"], ["gw3", "gw5"], ["gw7", "gw10", "gw11", "gw12", "gw13", "gw14"], ["gw15", "gw17", "gw18", "gw19", "gw20", "gw21", "gw22", "gw23", "gw24", "gw25"], ["gw26", "gw27", "gw28", "gwZ"]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-183-output-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved FigureS33_GenomeFst_fromJulia.png</code></pre>
</div>
</div>
</section>
</section>
<section id="plot-vishet-vs.-fst" class="level2">
<h2 class="anchored" data-anchor-id="plot-vishet-vs.-fst">Plot ViSHet vs.&nbsp;Fst</h2>
<div id="03f8ad99" class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a>groupsToCompareUsingFst <span class="op">=</span> <span class="st">"vir_plumb"</span></span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true" tabindex="-1"></a>FstRow <span class="op">=</span> <span class="fu">findfirst</span>(pairwiseNamesFst <span class="op">.==</span> groupsToCompareUsingFst)</span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true" tabindex="-1"></a>windowedFstValues <span class="op">=</span> windowed_Fst_all[FstRow, <span class="op">:</span>]</span>
<span id="cb497-4"><a href="#cb497-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(windowedFstValues, windowed_ViSHet_all)</span></span>
<span id="cb497-5"><a href="#cb497-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-6"><a href="#cb497-6" aria-hidden="true" tabindex="-1"></a>fillOpacity <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb497-7"><a href="#cb497-7" aria-hidden="true" tabindex="-1"></a>lineOpacity <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb497-8"><a href="#cb497-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-9"><a href="#cb497-9" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fu">Figure</span>()</span>
<span id="cb497-10"><a href="#cb497-10" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb497-11"><a href="#cb497-11" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"windowed Fst"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb497-12"><a href="#cb497-12" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"windowed VisHet"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>)</span>
<span id="cb497-13"><a href="#cb497-13" aria-hidden="true" tabindex="-1"></a><span class="co"># hidedecorations!(ax, label = false, ticklabels = false, ticks = false) # hide background lattice</span></span>
<span id="cb497-14"><a href="#cb497-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(ax, windowedFstValues, windowed_ViSHet_all,</span>
<span id="cb497-15"><a href="#cb497-15" aria-hidden="true" tabindex="-1"></a>    marker <span class="op">=</span> <span class="op">:</span>circle, color <span class="op">=</span> (<span class="st">"black"</span>, fillOpacity), markersize <span class="op">=</span> <span class="fl">8</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, lineOpacity))</span>
<span id="cb497-16"><a href="#cb497-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-17"><a href="#cb497-17" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span>
<span id="cb497-18"><a href="#cb497-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-19"><a href="#cb497-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="cn">true</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb497-20"><a href="#cb497-20" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="fu">string</span>(<span class="st">"FigureS34_windowedFstvViSHet_fromJulia.png"</span>)</span>
<span id="cb497-21"><a href="#cb497-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(filename, f, px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb497-22"><a href="#cb497-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Saved "</span>, filename)</span>
<span id="cb497-23"><a href="#cb497-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> </span>
<span id="cb497-24"><a href="#cb497-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-25"><a href="#cb497-25" aria-hidden="true" tabindex="-1"></a><span class="co"># to see histograms of each distribution:</span></span>
<span id="cb497-26"><a href="#cb497-26" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(windowedFstValues)</span></span>
<span id="cb497-27"><a href="#cb497-27" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(windowed_ViSHet_all)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-184-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved FigureS34_windowedFstvViSHet_fromJulia.png</code></pre>
</div>
</div>
</section>
<section id="examine-chromosome-4a-large-haploblock-region-lhbr-with-invariant-sites-included" class="level2">
<h2 class="anchored" data-anchor-id="examine-chromosome-4a-large-haploblock-region-lhbr-with-invariant-sites-included">Examine chromosome 4A Large HaploBlock Region (LHBR) with invariant sites included</h2>
<p>Before running below, I need to change format of 012NA file to # Before running below, changed 012NA file back into 012minus1 file, using commands like below, so can be read as integer:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /Users/darrenirwin/GW_data_from_cedar_Feb2024/GW2022_cedar/infoSites_vcfs/GW2022_all4plates.genotypes.allSites.chrgw4A.infoSites.max2allele_noindel.maxmiss60.MQ20.lowHet.tab.012NA <span class="kw">|</span> <span class="fu">sed</span> <span class="st">'s/NA/-1/g'</span> <span class="op">&gt;</span> /Users/darrenirwin/GW_data_from_cedar_Feb2024/GW2022_cedar/infoSites_vcfs/GW2022_all4plates.genotypes.allSites.chrgw4A.infoSites.max2allele_noindel.maxmiss60.MQ20.lowHet.tab.012minus1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="f5bef6e7" class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb501"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a>baseName <span class="op">=</span> <span class="st">"/Users/darrenirwin/GW_data_from_cedar_Feb2024/GW2022_cedar/infoSites_vcfs/GW2022_all4plates.genotypes.allSites.chrgw4A.infoSites.max2allele_noindel.maxmiss60.MQ20.lowHet.tab"</span></span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load metadata</span></span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cd</span>(dataDirectory)</span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true" tabindex="-1"></a>metadata_chr4A <span class="op">=</span> <span class="fu">DataFrame</span>(CSV.<span class="fu">File</span>(metadataFile)) <span class="co"># the CSV.File function interprets the correct delimiter</span></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true" tabindex="-1"></a>num_metadata_cols_chr4A <span class="op">=</span> <span class="fu">ncol</span>(metadata_chr4A)</span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true" tabindex="-1"></a>num_individuals_chr4A <span class="op">=</span> <span class="fu">nrow</span>(metadata_chr4A) </span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="co"># read in individual names for this dataset</span></span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true" tabindex="-1"></a>individuals_file_name_chr4A <span class="op">=</span> <span class="fu">string</span>(baseName, <span class="st">".012.indv"</span>)</span>
<span id="cb501-9"><a href="#cb501-9" aria-hidden="true" tabindex="-1"></a>ind_chr4A <span class="op">=</span> <span class="fu">DataFrame</span>(CSV.<span class="fu">File</span>(individuals_file_name_chr4A; header<span class="op">=</span>[<span class="st">"ind"</span>], types<span class="op">=</span>[<span class="dt">String</span>])) </span>
<span id="cb501-10"><a href="#cb501-10" aria-hidden="true" tabindex="-1"></a>indNum_chr4A <span class="op">=</span> <span class="fu">size</span>(ind_chr4A, <span class="fl">1</span>) <span class="co"># number of individuals</span></span>
<span id="cb501-11"><a href="#cb501-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> num_individuals_chr4A <span class="op">!=</span> indNum_chr4A</span>
<span id="cb501-12"><a href="#cb501-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"WARNING: number of rows in metadata file different than number of individuals in .indv file"</span>)</span>
<span id="cb501-13"><a href="#cb501-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb501-14"><a href="#cb501-14" aria-hidden="true" tabindex="-1"></a><span class="co"># read in position data for this dataset</span></span>
<span id="cb501-15"><a href="#cb501-15" aria-hidden="true" tabindex="-1"></a>position_file_name_chr4A <span class="op">=</span> <span class="fu">string</span>(baseName, <span class="st">".012.pos"</span>)</span>
<span id="cb501-16"><a href="#cb501-16" aria-hidden="true" tabindex="-1"></a>pos_chr4A <span class="op">=</span> <span class="fu">DataFrame</span>(CSV.<span class="fu">File</span>(position_file_name_chr4A; header<span class="op">=</span>[<span class="st">"chrom"</span>, <span class="st">"position"</span>], types<span class="op">=</span>[<span class="dt">String</span>, <span class="dt">Int</span>]))</span>
<span id="cb501-17"><a href="#cb501-17" aria-hidden="true" tabindex="-1"></a><span class="co"># read in genotype data</span></span>
<span id="cb501-18"><a href="#cb501-18" aria-hidden="true" tabindex="-1"></a>genotype_file_name_chr4A <span class="op">=</span> <span class="fu">string</span>(baseName, <span class="st">".012minus1"</span>) </span>
<span id="cb501-19"><a href="#cb501-19" aria-hidden="true" tabindex="-1"></a><span class="pp">@time</span> <span class="cf">if</span> <span class="fl">1</span> <span class="op">&lt;=</span> indNum_chr4A <span class="op">&lt;=</span> <span class="fl">127</span>   </span>
<span id="cb501-20"><a href="#cb501-20" aria-hidden="true" tabindex="-1"></a>    geno_chr4A <span class="op">=</span> <span class="fu">readdlm</span>(genotype_file_name_chr4A, <span class="ch">'\t'</span>, <span class="dt">Int8</span>, <span class="ch">'\n'</span>); <span class="co"># this has been sped up dramatically, by first converting "NA" to -1</span></span>
<span id="cb501-21"><a href="#cb501-21" aria-hidden="true" tabindex="-1"></a><span class="cf">elseif</span> <span class="fl">128</span> <span class="op">&lt;=</span> indNum_chr4A <span class="op">&lt;=</span> <span class="fl">32767</span></span>
<span id="cb501-22"><a href="#cb501-22" aria-hidden="true" tabindex="-1"></a>    geno_chr4A <span class="op">=</span> <span class="fu">readdlm</span>(genotype_file_name_chr4A, <span class="ch">'\t'</span>, <span class="dt">Int16</span>, <span class="ch">'\n'</span>); <span class="co"># this needed for first column, which is number of individual; Int16 not much slower on import than Int8</span></span>
<span id="cb501-23"><a href="#cb501-23" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb501-24"><a href="#cb501-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Error: Number of individuals in .indv appears outside of range from 1 to 32767"</span>)</span>
<span id="cb501-25"><a href="#cb501-25" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb501-26"><a href="#cb501-26" aria-hidden="true" tabindex="-1"></a>loci_count_chr4A <span class="op">=</span> <span class="fu">size</span>(geno_chr4A, <span class="fl">2</span>) <span class="op">-</span> <span class="fl">1</span>   <span class="co"># because the first column is not a SNP (just a count from zero)</span></span>
<span id="cb501-27"><a href="#cb501-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">string</span>(<span class="st">"Read in genotypic data at "</span>, loci_count_chr4A,<span class="st">" loci for "</span>, indNum_chr4A, <span class="st">" individuals. </span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 66.450320 seconds (340.61 M allocations: 9.785 GiB, 75.80% gc time, 1.12% compilation time)
Read in genotypic data at 364640 loci for 310 individuals. </code></pre>
</div>
</div>
<section id="check-that-individuals-are-same-in-genotype-data-and-metadata" class="level3">
<h3 class="anchored" data-anchor-id="check-that-individuals-are-same-in-genotype-data-and-metadata">Check that individuals are same in genotype data and metadata</h3>
<div id="73bcbba4" class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb503"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chr4A <span class="op">=</span> <span class="fu">hcat</span>(ind_chr4A, metadata_chr4A)</span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(ind_with_metadata_chr4A)</span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>()  <span class="co"># prints a line break </span></span>
<span id="cb503-4"><a href="#cb503-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">isequal</span>(ind_with_metadata_chr4A.ind, ind_with_metadata_chr4A.ID)</span>
<span id="cb503-5"><a href="#cb503-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"GOOD NEWS: names of individuals in metadata file and genotype ind file match perfectly."</span>)</span>
<span id="cb503-6"><a href="#cb503-6" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb503-7"><a href="#cb503-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"WARNING: names of individuals in metadata file and genotype ind file do not completely match."</span>)</span>
<span id="cb503-8"><a href="#cb503-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>310×6 DataFrame
 Row │ ind                             ID                              location  group           Fst_group       plot_order 
     │ String                          String31                        String7   String15        String15        Float64    
─────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1           GW_Armando_plate1_AB1           AB        vir             vir                 20.01
   2 │ GW_Armando_plate1_JF07G02       GW_Armando_plate1_JF07G02       ST        plumb           plumb              108.0
   3 │ GW_Armando_plate1_JF07G03       GW_Armando_plate1_JF07G03       ST        plumb           plumb              109.0
   4 │ GW_Armando_plate1_JF07G04       GW_Armando_plate1_JF07G04       ST        plumb           plumb              110.0
   5 │ GW_Armando_plate1_JF08G02       GW_Armando_plate1_JF08G02       ST        plumb           plumb              111.0
   6 │ GW_Armando_plate1_JF09G01       GW_Armando_plate1_JF09G01       ST        plumb           plumb              112.0
   7 │ GW_Armando_plate1_JF09G02       GW_Armando_plate1_JF09G02       ST        plumb           plumb              113.0
   8 │ GW_Armando_plate1_JF10G03       GW_Armando_plate1_JF10G03       ST        plumb_vir       plumb_vir          170.0
   9 │ GW_Armando_plate1_JF11G01       GW_Armando_plate1_JF11G01       ST        plumb           plumb              114.0
  10 │ GW_Armando_plate1_JF12G01       GW_Armando_plate1_JF12G01       ST        plumb           plumb              115.0
  11 │ GW_Armando_plate1_JF12G02       GW_Armando_plate1_JF12G02       ST        plumb           plumb              116.0
  12 │ GW_Armando_plate1_JF12G04       GW_Armando_plate1_JF12G04       ST_vi     vir             vir                 24.001
  13 │ GW_Armando_plate1_JF13G01       GW_Armando_plate1_JF13G01       ST        plumb           plumb              117.0
  14 │ GW_Armando_plate1_JF15G03       GW_Armando_plate1_JF15G03       DV        plumb           plumb              103.0
  15 │ GW_Armando_plate1_JF16G01       GW_Armando_plate1_JF16G01       DV_vi     plumb_vir       vir                 24.041
  16 │ GW_Armando_plate1_JF20G01       GW_Armando_plate1_JF20G01       MB        plumb           plumb               94.0
  17 │ GW_Armando_plate1_JF22G01       GW_Armando_plate1_JF22G01       MB        plumb           plumb               95.0
  18 │ GW_Armando_plate1_JF23G01       GW_Armando_plate1_JF23G01       VB        plumb           plumb               98.0
  19 │ GW_Armando_plate1_JF23G02       GW_Armando_plate1_JF23G02       VB        plumb           plumb               99.0
  20 │ GW_Armando_plate1_JF24G02       GW_Armando_plate1_JF24G02       VB        plumb           plumb              100.0
  21 │ GW_Armando_plate1_JF26G01       GW_Armando_plate1_JF26G01       ST        plumb           plumb              118.0
  22 │ GW_Armando_plate1_JF27G01       GW_Armando_plate1_JF27G01       ST        plumb           plumb              119.0
  23 │ GW_Armando_plate1_JF29G01       GW_Armando_plate1_JF29G01       ST        plumb           plumb              120.0
  24 │ GW_Armando_plate1_JF29G02       GW_Armando_plate1_JF29G02       ST        plumb           plumb              121.0
  25 │ GW_Armando_plate1_JF29G03       GW_Armando_plate1_JF29G03       ST        plumb           plumb              122.0
  26 │ GW_Armando_plate1_JG02G02       GW_Armando_plate1_JG02G02       PR        plumb           plumb              145.0
  27 │ GW_Armando_plate1_JG02G04       GW_Armando_plate1_JG02G04       PR        plumb           plumb              146.0
  28 │ GW_Armando_plate1_JG08G01       GW_Armando_plate1_JG08G01       ST        plumb           plumb              123.0
  29 │ GW_Armando_plate1_JG08G02       GW_Armando_plate1_JG08G02       ST        plumb           plumb              124.0
  30 │ GW_Armando_plate1_JG10G01       GW_Armando_plate1_JG10G01       ST        plumb           plumb              125.0
  31 │ GW_Armando_plate1_JG12G01       GW_Armando_plate1_JG12G01       ST        plumb           plumb              126.0
  32 │ GW_Armando_plate1_JG17G01       GW_Armando_plate1_JG17G01       ST        plumb_vir       plumb              127.0
  33 │ GW_Armando_plate1_NO_BC_TTGW05  GW_Armando_plate1_NO_BC_TTGW05  blank     blank           blank              -99.0
  34 │ GW_Armando_plate1_NO_DNA        GW_Armando_plate1_NO_DNA        blank     blank           blank              -99.0
  35 │ GW_Armando_plate1_RF20G01       GW_Armando_plate1_RF20G01       BJ        obs_plumb       plumb_BJ            77.501
  36 │ GW_Armando_plate1_RF29G02       GW_Armando_plate1_RF29G02       BJ        obs_plumb       plumb_BJ            77.502
  37 │ GW_Armando_plate1_TL3           GW_Armando_plate1_TL3           TL        vir             vir                 11.01
  38 │ GW_Armando_plate1_TTGW01        GW_Armando_plate1_TTGW01        MN        troch_MN        troch_west          53.0
  39 │ GW_Armando_plate1_TTGW05_rep1   GW_Armando_plate1_TTGW05_rep1   MN_rep    troch_MN_rep    troch_west_rep      53.0
  40 │ GW_Armando_plate1_TTGW05_rep2   GW_Armando_plate1_TTGW05_rep2   MN        troch_MN        troch_west          53.0
  41 │ GW_Armando_plate1_TTGW06        GW_Armando_plate1_TTGW06        SU        lud_Sukhto      lud_central         47.0
  42 │ GW_Armando_plate1_TTGW07        GW_Armando_plate1_TTGW07        SU        lud_Sukhto      lud_central         47.0
  43 │ GW_Armando_plate1_TTGW10        GW_Armando_plate1_TTGW10        SU        lud_Sukhto      lud_central         47.0
  44 │ GW_Armando_plate1_TTGW11        GW_Armando_plate1_TTGW11        SU        lud_Sukhto      lud_central         47.0
  45 │ GW_Armando_plate1_TTGW13        GW_Armando_plate1_TTGW13        TH        lud_Thallighar  lud_central         43.0
  46 │ GW_Armando_plate1_TTGW17        GW_Armando_plate1_TTGW17        TH        lud_Thallighar  lud_central         43.0
  47 │ GW_Armando_plate1_TTGW19        GW_Armando_plate1_TTGW19        TH        lud_Thallighar  lud_central         43.0
  48 │ GW_Armando_plate1_TTGW21        GW_Armando_plate1_TTGW21        SR        lud_Sural       lud_central         45.0
  49 │ GW_Armando_plate1_TTGW22        GW_Armando_plate1_TTGW22        SR        lud_Sural       lud_central         45.0
  50 │ GW_Armando_plate1_TTGW23        GW_Armando_plate1_TTGW23        SR        lud_Sural       lud_central         45.0
  51 │ GW_Armando_plate1_TTGW29        GW_Armando_plate1_TTGW29        SR        lud_Sural       lud_central         45.0
  52 │ GW_Armando_plate1_TTGW52        GW_Armando_plate1_TTGW52        NG        lud_Nainaghar   lud_central         49.0
  53 │ GW_Armando_plate1_TTGW53        GW_Armando_plate1_TTGW53        NG        lud_Nainaghar   lud_central         49.0
  54 │ GW_Armando_plate1_TTGW55        GW_Armando_plate1_TTGW55        NG        lud_Nainaghar   lud_central         49.0
  55 │ GW_Armando_plate1_TTGW57        GW_Armando_plate1_TTGW57        NG        lud_Nainaghar   lud_central         49.0
  56 │ GW_Armando_plate1_TTGW58        GW_Armando_plate1_TTGW58        NG        lud_Nainaghar   lud_central         49.0
  57 │ GW_Armando_plate1_TTGW59        GW_Armando_plate1_TTGW59        NG        lud_Nainaghar   lud_central         49.0
  58 │ GW_Armando_plate1_TTGW63        GW_Armando_plate1_TTGW63        SP        lud_Spiti       troch_west          55.0
  59 │ GW_Armando_plate1_TTGW64        GW_Armando_plate1_TTGW64        SP        lud_Spiti       troch_west          55.0
  60 │ GW_Armando_plate1_TTGW65        GW_Armando_plate1_TTGW65        SP        lud_Spiti       troch_west          55.0
  61 │ GW_Armando_plate1_TTGW66        GW_Armando_plate1_TTGW66        SP        lud_Spiti       troch_west          55.0
  62 │ GW_Armando_plate1_TTGW68        GW_Armando_plate1_TTGW68        SP        lud_Spiti       troch_west          55.0
  63 │ GW_Armando_plate1_TTGW70        GW_Armando_plate1_TTGW70        SA        lud_Sathrundi   lud_Sath            41.0
  64 │ GW_Armando_plate1_TTGW71        GW_Armando_plate1_TTGW71        SA        lud_Sathrundi   lud_Sath            41.0
  65 │ GW_Armando_plate1_TTGW72        GW_Armando_plate1_TTGW72        SA        lud_Sathrundi   lud_Sath            41.0
  66 │ GW_Armando_plate1_TTGW74        GW_Armando_plate1_TTGW74        SA        lud_Sathrundi   lud_Sath            41.0
  67 │ GW_Armando_plate1_TTGW78        GW_Armando_plate1_TTGW78        SA        lud_Sathrundi   lud_Sath            41.0
  68 │ GW_Armando_plate1_TTGW_15_05    GW_Armando_plate1_TTGW_15_05    SR        lud_Sural       lud_central         45.0
  69 │ GW_Armando_plate1_TTGW_15_07    GW_Armando_plate1_TTGW_15_07    SR        lud_Sural       lud_central         45.0
  70 │ GW_Armando_plate1_TTGW_15_08    GW_Armando_plate1_TTGW_15_08    SR        lud_Sural       lud_central         45.0
  71 │ GW_Armando_plate1_TTGW_15_09    GW_Armando_plate1_TTGW_15_09    SR        lud_Sural       lud_central         45.0
  72 │ GW_Armando_plate1_UY1           GW_Armando_plate1_UY1           UY        plumb           plumb               87.0
  73 │ GW_Armando_plate2_IL2           GW_Armando_plate2_IL2           IL_rep    plumb_rep       plumb_rep           84.0
  74 │ GW_Armando_plate2_JE31G01       GW_Armando_plate2_JE31G01       VB_vi     vir_misID       vir                 24.002
  75 │ GW_Armando_plate2_JF03G01       GW_Armando_plate2_JF03G01       ST_vi     vir_misID       vir                 24.003
  76 │ GW_Armando_plate2_JF03G02       GW_Armando_plate2_JF03G02       VB_vi     vir_misID       vir                 24.004
  77 │ GW_Armando_plate2_JF07G01       GW_Armando_plate2_JF07G01       ST        plumb           plumb              128.0
  78 │ GW_Armando_plate2_JF08G04       GW_Armando_plate2_JF08G04       ST        plumb           plumb              129.0
  79 │ GW_Armando_plate2_JF10G02       GW_Armando_plate2_JF10G02       ST        plumb           plumb              130.0
  80 │ GW_Armando_plate2_JF11G02       GW_Armando_plate2_JF11G02       ST        plumb           plumb              131.0
  81 │ GW_Armando_plate2_JF12G03       GW_Armando_plate2_JF12G03       ST        plumb           plumb              132.0
  82 │ GW_Armando_plate2_JF12G05       GW_Armando_plate2_JF12G05       ST        plumb           plumb              133.0
  83 │ GW_Armando_plate2_JF13G02       GW_Armando_plate2_JF13G02       ST        plumb           plumb              134.0
  84 │ GW_Armando_plate2_JF14G01       GW_Armando_plate2_JF14G01       DV        plumb           plumb              104.0
  85 │ GW_Armando_plate2_JF14G02       GW_Armando_plate2_JF14G02       DV        plumb           plumb              105.0
  86 │ GW_Armando_plate2_JF15G01       GW_Armando_plate2_JF15G01       DV        plumb           plumb              106.0
  87 │ GW_Armando_plate2_JF15G02       GW_Armando_plate2_JF15G02       DV        plumb           plumb              107.0
  88 │ GW_Armando_plate2_JF16G02       GW_Armando_plate2_JF16G02       DV_vi     plumb_vir       vir                 24.042
  89 │ GW_Armando_plate2_JF19G01       GW_Armando_plate2_JF19G01       MB        plumb           plumb               96.0
  90 │ GW_Armando_plate2_JF20G02       GW_Armando_plate2_JF20G02       MB        plumb           plumb               97.0
  91 │ GW_Armando_plate2_JF24G01       GW_Armando_plate2_JF24G01       VB        plumb           plumb              101.0
  92 │ GW_Armando_plate2_JF24G03       GW_Armando_plate2_JF24G03       ST        plumb           plumb              135.0
  93 │ GW_Armando_plate2_JF25G01       GW_Armando_plate2_JF25G01       VB        plumb           plumb              102.0
  94 │ GW_Armando_plate2_JF26G02       GW_Armando_plate2_JF26G02       ST        plumb           plumb              136.0
  95 │ GW_Armando_plate2_JF27G02       GW_Armando_plate2_JF27G02       ST        plumb           plumb              137.0
  96 │ GW_Armando_plate2_JF30G01       GW_Armando_plate2_JF30G01       ST_vi     vir_misID       vir                 24.005
  97 │ GW_Armando_plate2_JG01G01       GW_Armando_plate2_JG01G01       PR        plumb           plumb              147.0
  98 │ GW_Armando_plate2_JG02G01       GW_Armando_plate2_JG02G01       PR        plumb           plumb              148.0
  99 │ GW_Armando_plate2_JG02G03       GW_Armando_plate2_JG02G03       PR        plumb           plumb              149.0
 100 │ GW_Armando_plate2_JG10G02       GW_Armando_plate2_JG10G02       ST        plumb           plumb              138.0
 101 │ GW_Armando_plate2_JG10G03       GW_Armando_plate2_JG10G03       ST        plumb           plumb              139.0
 102 │ GW_Armando_plate2_JG12G02       GW_Armando_plate2_JG12G02       ST        plumb           plumb              140.0
 103 │ GW_Armando_plate2_JG12G03       GW_Armando_plate2_JG12G03       ST        plumb           plumb              141.0
 104 │ GW_Armando_plate2_LN11          GW_Armando_plate2_LN11          LN_rep    troch_LN_rep    troch_LN_rep        65.01
 105 │ GW_Armando_plate2_LN2           GW_Armando_plate2_LN2           LN        troch_LN        troch_LN            58.01
 106 │ GW_Armando_plate2_NO_BC_TTGW05  GW_Armando_plate2_NO_BC_TTGW05  blank     blank           blank              -99.0
 107 │ GW_Armando_plate2_NO_DNA        GW_Armando_plate2_NO_DNA        blank     blank           blank              -99.0
 108 │ GW_Armando_plate2_RF29G01       GW_Armando_plate2_RF29G01       BJ        obs_plumb       plumb_BJ            77.503
 109 │ GW_Armando_plate2_TTGW02        GW_Armando_plate2_TTGW02        MN        troch_MN        troch_west          53.0
 110 │ GW_Armando_plate2_TTGW03        GW_Armando_plate2_TTGW03        MN        troch_MN        troch_west          53.0
 111 │ GW_Armando_plate2_TTGW05_rep3   GW_Armando_plate2_TTGW05_rep3   MN_rep    troch_MN_rep    troch_west_rep      53.0
 112 │ GW_Armando_plate2_TTGW05_rep4   GW_Armando_plate2_TTGW05_rep4   MN_rep    troch_MN_rep    troch_west_rep      53.0
 113 │ GW_Armando_plate2_TTGW08        GW_Armando_plate2_TTGW08        SU        lud_Sukhto      lud_central         47.0
 114 │ GW_Armando_plate2_TTGW09        GW_Armando_plate2_TTGW09        SU        lud_Sukhto      lud_central         47.0
 115 │ GW_Armando_plate2_TTGW12        GW_Armando_plate2_TTGW12        TH        lud_Thallighar  lud_central         43.0
 116 │ GW_Armando_plate2_TTGW14        GW_Armando_plate2_TTGW14        TH        lud_Thallighar  lud_central         43.0
 117 │ GW_Armando_plate2_TTGW15        GW_Armando_plate2_TTGW15        TH        lud_Thallighar  lud_central         43.0
 118 │ GW_Armando_plate2_TTGW16        GW_Armando_plate2_TTGW16        TH        lud_Thallighar  lud_central         43.0
 119 │ GW_Armando_plate2_TTGW18        GW_Armando_plate2_TTGW18        TH        lud_Thallighar  lud_central         43.0
 120 │ GW_Armando_plate2_TTGW20        GW_Armando_plate2_TTGW20        SR        lud_Sural       lud_central         45.0
 121 │ GW_Armando_plate2_TTGW24        GW_Armando_plate2_TTGW24        SR        lud_Sural       lud_central         45.0
 122 │ GW_Armando_plate2_TTGW25        GW_Armando_plate2_TTGW25        SR        lud_Sural       lud_central         45.0
 123 │ GW_Armando_plate2_TTGW27        GW_Armando_plate2_TTGW27        SR        lud_Sural       lud_central         45.0
 124 │ GW_Armando_plate2_TTGW28        GW_Armando_plate2_TTGW28        SR        lud_Sural       lud_central         45.0
 125 │ GW_Armando_plate2_TTGW50        GW_Armando_plate2_TTGW50        NG        lud_Nainaghar   lud_central         49.0
 126 │ GW_Armando_plate2_TTGW51        GW_Armando_plate2_TTGW51        NG        lud_Nainaghar   lud_central         49.0
 127 │ GW_Armando_plate2_TTGW54        GW_Armando_plate2_TTGW54        NG        lud_Nainaghar   lud_central         49.0
 128 │ GW_Armando_plate2_TTGW56        GW_Armando_plate2_TTGW56        NG        lud_Nainaghar   lud_central         49.0
 129 │ GW_Armando_plate2_TTGW60        GW_Armando_plate2_TTGW60        SP        lud_Spiti       troch_west          55.0
 130 │ GW_Armando_plate2_TTGW61        GW_Armando_plate2_TTGW61        SP        lud_Spiti       troch_west          55.0
 131 │ GW_Armando_plate2_TTGW62        GW_Armando_plate2_TTGW62        SP        lud_Spiti       troch_west          55.0
 132 │ GW_Armando_plate2_TTGW67        GW_Armando_plate2_TTGW67        SP        lud_Spiti       troch_west          55.0
 133 │ GW_Armando_plate2_TTGW69        GW_Armando_plate2_TTGW69        SP        lud_Spiti       troch_west          55.0
 134 │ GW_Armando_plate2_TTGW73        GW_Armando_plate2_TTGW73        SA        lud_Sathrundi   lud_Sath            41.0
 135 │ GW_Armando_plate2_TTGW75        GW_Armando_plate2_TTGW75        SA        lud_Sathrundi   lud_Sath            41.0
 136 │ GW_Armando_plate2_TTGW77        GW_Armando_plate2_TTGW77        SA        lud_Sathrundi   lud_Sath            41.0
 137 │ GW_Armando_plate2_TTGW79        GW_Armando_plate2_TTGW79        SA        lud_Sathrundi   lud_Sath            41.0
 138 │ GW_Armando_plate2_TTGW80        GW_Armando_plate2_TTGW80        SA        lud_Sathrundi   lud_Sath            41.0
 139 │ GW_Armando_plate2_TTGW_15_01    GW_Armando_plate2_TTGW_15_01    SR        lud_Sural       lud_central         45.0
 140 │ GW_Armando_plate2_TTGW_15_02    GW_Armando_plate2_TTGW_15_02    SR        lud_Sural       lud_central         45.0
 141 │ GW_Armando_plate2_TTGW_15_03    GW_Armando_plate2_TTGW_15_03    SR        lud_Sural       lud_central         45.0
 142 │ GW_Armando_plate2_TTGW_15_04    GW_Armando_plate2_TTGW_15_04    SR        lud_Sural       lud_central         45.0
 143 │ GW_Armando_plate2_TTGW_15_06    GW_Armando_plate2_TTGW_15_06    SR        lud_Sural       lud_central         45.0
 144 │ GW_Armando_plate2_TTGW_15_10    GW_Armando_plate2_TTGW_15_10    SR        lud_Sural       lud_central         45.0
 145 │ GW_Lane5_AA1                    GW_Lane5_AA1                    AA        vir_S           vir_S               25.0
 146 │ GW_Lane5_AA10                   GW_Lane5_AA10                   AA        vir_S           vir_S               33.0
 147 │ GW_Lane5_AA11                   GW_Lane5_AA11                   AA        vir_S           vir_S               34.0
 148 │ GW_Lane5_AA3                    GW_Lane5_AA3                    AA        vir_S           vir_S               26.0
 149 │ GW_Lane5_AA4                    GW_Lane5_AA4                    AA        vir_S           vir_S               27.0
 150 │ GW_Lane5_AA5                    GW_Lane5_AA5                    AA        vir_S           vir_S               28.0
 151 │ GW_Lane5_AA6                    GW_Lane5_AA6                    AA        vir_S           vir_S               29.0
 152 │ GW_Lane5_AA7                    GW_Lane5_AA7                    AA        vir_S           vir_S               30.0
 153 │ GW_Lane5_AA8                    GW_Lane5_AA8                    AA        vir_S           vir_S               31.0
 154 │ GW_Lane5_AA9                    GW_Lane5_AA9                    AA        vir_S           vir_S               32.0
 155 │ GW_Lane5_AB1                    GW_Lane5_AB1                    AB_rep    vir_rep         vir_rep             20.0
 156 │ GW_Lane5_AB2                    GW_Lane5_AB2                    AB        vir             vir                 21.0
 157 │ GW_Lane5_AN1                    GW_Lane5_AN1                    AN        plumb           plumb               80.0
 158 │ GW_Lane5_AN2                    GW_Lane5_AN2                    AN        plumb           plumb               81.0
 159 │ GW_Lane5_BK2                    GW_Lane5_BK2                    BK        plumb           plumb               78.0
 160 │ GW_Lane5_BK3                    GW_Lane5_BK3                    BK        plumb           plumb               79.0
 161 │ GW_Lane5_DA2                    GW_Lane5_DA2                    XN        obs             obs                 73.0
 162 │ GW_Lane5_DA3                    GW_Lane5_DA3                    XN        obs             obs                 74.0
 163 │ GW_Lane5_DA4                    GW_Lane5_DA4                    XN        obs             obs                 75.0
 164 │ GW_Lane5_DA6                    GW_Lane5_DA6                    XN        obs             low_reads           76.0
 165 │ GW_Lane5_DA7                    GW_Lane5_DA7                    XN        obs             obs                 77.0
 166 │ GW_Lane5_EM1                    GW_Lane5_EM1                    EM        troch_EM        troch_EM            72.0
 167 │ GW_Lane5_IL1                    GW_Lane5_IL1                    IL        plumb           plumb               82.0
 168 │ GW_Lane5_IL2                    GW_Lane5_IL2                    IL_rep    plumb_rep       plumb_rep           85.0
 169 │ GW_Lane5_IL4                    GW_Lane5_IL4                    IL        plumb           plumb               83.0
 170 │ GW_Lane5_KS1                    GW_Lane5_KS1                    OV        lud_KS          lud_KS              40.0
 171 │ GW_Lane5_KS2                    GW_Lane5_KS2                    OV        lud_KS          lud_KS              40.0
 172 │ GW_Lane5_LN1                    GW_Lane5_LN1                    LN        troch_LN        troch_LN            57.0
 173 │ GW_Lane5_LN10                   GW_Lane5_LN10                   LN        troch_LN        troch_LN            64.0
 174 │ GW_Lane5_LN11                   GW_Lane5_LN11                   LN        troch_LN        troch_LN            65.0
 175 │ GW_Lane5_LN12                   GW_Lane5_LN12                   LN        troch_LN        troch_LN            66.0
 176 │ GW_Lane5_LN14                   GW_Lane5_LN14                   LN        troch_LN        troch_LN            67.0
 177 │ GW_Lane5_LN16                   GW_Lane5_LN16                   LN        troch_LN        troch_LN            68.0
 178 │ GW_Lane5_LN18                   GW_Lane5_LN18                   LN        troch_LN        troch_LN            69.0
 179 │ GW_Lane5_LN19                   GW_Lane5_LN19                   LN        troch_LN        troch_LN            70.0
 180 │ GW_Lane5_LN2                    GW_Lane5_LN2                    LN_rep    troch_LN_rep    troch_LN_rep        58.0
 181 │ GW_Lane5_LN20                   GW_Lane5_LN20                   LN        troch_LN        troch_LN            71.0
 182 │ GW_Lane5_LN3                    GW_Lane5_LN3                    LN        troch_LN        troch_LN            59.0
 183 │ GW_Lane5_LN4                    GW_Lane5_LN4                    LN        troch_LN        troch_LN            60.0
 184 │ GW_Lane5_LN6                    GW_Lane5_LN6                    LN        troch_LN        troch_LN            61.0
 185 │ GW_Lane5_LN7                    GW_Lane5_LN7                    LN        troch_LN        troch_LN            62.0
 186 │ GW_Lane5_LN8                    GW_Lane5_LN8                    LN        troch_LN        troch_LN            63.0
 187 │ GW_Lane5_MN1                    GW_Lane5_MN1                    MN        troch_MN        troch_west          51.0
 188 │ GW_Lane5_MN12                   GW_Lane5_MN12                   MN        troch_MN        troch_west          56.0
 189 │ GW_Lane5_MN3                    GW_Lane5_MN3                    MN        troch_MN        troch_west          52.0
 190 │ GW_Lane5_MN5                    GW_Lane5_MN5                    MN        troch_MN        troch_west          53.0
 191 │ GW_Lane5_MN8                    GW_Lane5_MN8                    MN        troch_MN        troch_west          54.0
 192 │ GW_Lane5_MN9                    GW_Lane5_MN9                    MN        troch_MN        troch_west          55.0
 193 │ GW_Lane5_NA1                    GW_Lane5_NA1                    NR        lud_PK          lud_PK              39.2
 194 │ GW_Lane5_NA3-3ul                GW_Lane5_NA3-3ul                NR        lud_PK          lud_PK              39.2
 195 │ GW_Lane5_PT11                   GW_Lane5_PT11                   KL        lud_KL          lud_central         42.0
 196 │ GW_Lane5_PT12                   GW_Lane5_PT12                   KL        lud_KL          lud_central         42.0
 197 │ GW_Lane5_PT2                    GW_Lane5_PT2                    ML        lud_ML          lud_ML              51.0
 198 │ GW_Lane5_PT3                    GW_Lane5_PT3                    PA        lud_PA          lud_central         46.0
 199 │ GW_Lane5_PT4                    GW_Lane5_PT4                    PA        lud_PA          lud_central         46.0
 200 │ GW_Lane5_PT6                    GW_Lane5_PT6                    KL        lud_KL          lud_central         42.0
 201 │ GW_Lane5_SH1                    GW_Lane5_SH1                    SH        lud_PK          lud_PK              39.1
 202 │ GW_Lane5_SH2                    GW_Lane5_SH2                    SH        lud_PK          lud_PK              39.1
 203 │ GW_Lane5_SH4                    GW_Lane5_SH4                    SH        lud_PK          lud_PK              39.1
 204 │ GW_Lane5_SH5                    GW_Lane5_SH5                    SH        lud_PK          lud_PK              39.1
 205 │ GW_Lane5_SL1                    GW_Lane5_SL1                    SL        plumb           plumb              150.0
 206 │ GW_Lane5_SL2                    GW_Lane5_SL2                    SL        plumb           plumb              151.0
 207 │ GW_Lane5_ST1                    GW_Lane5_ST1                    ST        plumb           plumb              142.0
 208 │ GW_Lane5_ST12                   GW_Lane5_ST12                   ST        plumb           plumb              144.0
 209 │ GW_Lane5_ST3                    GW_Lane5_ST3                    ST        plumb           plumb              143.0
 210 │ GW_Lane5_STvi1                  GW_Lane5_STvi1                  ST_vi     vir             vir                 22.0
 211 │ GW_Lane5_STvi2                  GW_Lane5_STvi2                  ST_vi     vir             vir                 23.0
 212 │ GW_Lane5_STvi3                  GW_Lane5_STvi3                  ST_vi     vir             vir                 24.0
 213 │ GW_Lane5_TA1                    GW_Lane5_TA1                    TA        plumb           plumb               86.0
 214 │ GW_Lane5_TL1                    GW_Lane5_TL1                    TL        vir             vir                  9.0
 215 │ GW_Lane5_TL10                   GW_Lane5_TL10                   TL        vir             vir                 17.0
 216 │ GW_Lane5_TL11                   GW_Lane5_TL11                   TL        vir             vir                 18.0
 217 │ GW_Lane5_TL12                   GW_Lane5_TL12                   TL        vir             vir                 19.0
 218 │ GW_Lane5_TL2                    GW_Lane5_TL2                    TL        vir             vir                 10.0
 219 │ GW_Lane5_TL3                    GW_Lane5_TL3                    TL_rep    vir_rep         vir_rep             11.0
 220 │ GW_Lane5_TL4                    GW_Lane5_TL4                    TL        vir             vir                 12.0
 221 │ GW_Lane5_TL5                    GW_Lane5_TL5                    TL        vir             vir                 13.0
 222 │ GW_Lane5_TL7                    GW_Lane5_TL7                    TL        vir             vir                 14.0
 223 │ GW_Lane5_TL8                    GW_Lane5_TL8                    TL        vir             vir                 15.0
 224 │ GW_Lane5_TL9                    GW_Lane5_TL9                    TL        vir             vir                 16.0
 225 │ GW_Lane5_TU1                    GW_Lane5_TU1                    TU        nit             nit                 35.0
 226 │ GW_Lane5_TU2                    GW_Lane5_TU2                    TU        nit             nit                 36.0
 227 │ GW_Lane5_UY1                    GW_Lane5_UY1                    UY_rep    plumb_rep       plumb_rep           93.0
 228 │ GW_Lane5_UY2                    GW_Lane5_UY2                    UY        plumb           plumb               88.0
 229 │ GW_Lane5_UY3                    GW_Lane5_UY3                    UY        plumb           plumb               89.0
 230 │ GW_Lane5_UY4                    GW_Lane5_UY4                    UY        plumb           plumb               90.0
 231 │ GW_Lane5_UY5                    GW_Lane5_UY5                    UY        plumb           plumb               91.0
 232 │ GW_Lane5_UY6                    GW_Lane5_UY6                    UY        plumb           plumb               92.0
 233 │ GW_Lane5_YK1                    GW_Lane5_YK1                    YK        vir             vir                  1.0
 234 │ GW_Lane5_YK11                   GW_Lane5_YK11                   YK        vir             vir                  8.0
 235 │ GW_Lane5_YK3                    GW_Lane5_YK3                    YK        vir             vir                  2.0
 236 │ GW_Lane5_YK4                    GW_Lane5_YK4                    YK        vir             vir                  3.0
 237 │ GW_Lane5_YK5                    GW_Lane5_YK5                    YK        vir             vir                  4.0
 238 │ GW_Lane5_YK6                    GW_Lane5_YK6                    YK        vir             vir                  5.0
 239 │ GW_Lane5_YK7                    GW_Lane5_YK7                    YK        vir             vir                  6.0
 240 │ GW_Lane5_YK9                    GW_Lane5_YK9                    YK        vir             vir                  7.0
 241 │ GW_Liz_GBS_Liz10045             GW_Liz_GBS_Liz10045             ML        lud             lud_ML              51.01
 242 │ GW_Liz_GBS_Liz10094             GW_Liz_GBS_Liz10094             ML        lud             lud_ML              51.02
 243 │ GW_Liz_GBS_Liz5101              GW_Liz_GBS_Liz5101              ML        lud             lud_ML              51.03
 244 │ GW_Liz_GBS_Liz5101_R            GW_Liz_GBS_Liz5101_R            ML_rep    lud_rep         lud_ML_rep          51.04
 245 │ GW_Liz_GBS_Liz5118              GW_Liz_GBS_Liz5118              ML        lud             lud_ML              51.05
 246 │ GW_Liz_GBS_Liz5139              GW_Liz_GBS_Liz5139              ML        lud             lud_ML              51.06
 247 │ GW_Liz_GBS_Liz5142              GW_Liz_GBS_Liz5142              ML        lud             lud_ML              51.07
 248 │ GW_Liz_GBS_Liz5144              GW_Liz_GBS_Liz5144              ML        lud             lud_ML              51.08
 249 │ GW_Liz_GBS_Liz5150              GW_Liz_GBS_Liz5150              ML        lud             lud_ML              51.09
 250 │ GW_Liz_GBS_Liz5159              GW_Liz_GBS_Liz5159              ML        lud_chick       lud_ML              51.1
 251 │ GW_Liz_GBS_Liz5162              GW_Liz_GBS_Liz5162              ML        lud_chick       lud_ML              51.11
 252 │ GW_Liz_GBS_Liz5163              GW_Liz_GBS_Liz5163              ML        lud_chick       lud_ML              51.12
 253 │ GW_Liz_GBS_Liz5164              GW_Liz_GBS_Liz5164              ML        lud_chick       lud_ML              51.13
 254 │ GW_Liz_GBS_Liz5165              GW_Liz_GBS_Liz5165              ML        lud             lud_ML              51.14
 255 │ GW_Liz_GBS_Liz5167              GW_Liz_GBS_Liz5167              ML        lud_chick       lud_ML              51.15
 256 │ GW_Liz_GBS_Liz5168              GW_Liz_GBS_Liz5168              ML        lud_chick       lud_ML              51.16
 257 │ GW_Liz_GBS_Liz5169              GW_Liz_GBS_Liz5169              ML        lud_chick       lud_ML              51.17
 258 │ GW_Liz_GBS_Liz5171              GW_Liz_GBS_Liz5171              ML        lud             lud_ML              51.18
 259 │ GW_Liz_GBS_Liz5172              GW_Liz_GBS_Liz5172              ML        lud_chick       lud_ML              51.19
 260 │ GW_Liz_GBS_Liz5173              GW_Liz_GBS_Liz5173              ML        lud_chick       lud_ML              51.2
 261 │ GW_Liz_GBS_Liz5174              GW_Liz_GBS_Liz5174              ML        lud             lud_ML              51.21
 262 │ GW_Liz_GBS_Liz5175              GW_Liz_GBS_Liz5175              ML        lud             lud_ML              51.22
 263 │ GW_Liz_GBS_Liz5176              GW_Liz_GBS_Liz5176              ML        lud             lud_ML              51.23
 264 │ GW_Liz_GBS_Liz5177              GW_Liz_GBS_Liz5177              ML        lud_chick       lud_ML              51.24
 265 │ GW_Liz_GBS_Liz5178              GW_Liz_GBS_Liz5178              ML        lud_chick       lud_ML              51.25
 266 │ GW_Liz_GBS_Liz5179              GW_Liz_GBS_Liz5179              ML        lud_chick       lud_ML              51.26
 267 │ GW_Liz_GBS_Liz5180              GW_Liz_GBS_Liz5180              ML        lud             lud_ML              51.27
 268 │ GW_Liz_GBS_Liz5182              GW_Liz_GBS_Liz5182              ML        lud_chick       lud_ML              51.28
 269 │ GW_Liz_GBS_Liz5184              GW_Liz_GBS_Liz5184              ML        lud_chick       lud_ML              51.29
 270 │ GW_Liz_GBS_Liz5185              GW_Liz_GBS_Liz5185              ML        lud             lud_ML              51.3
 271 │ GW_Liz_GBS_Liz5186              GW_Liz_GBS_Liz5186              ML        lud_chick       lud_ML              51.31
 272 │ GW_Liz_GBS_Liz5187              GW_Liz_GBS_Liz5187              ML        lud_chick       lud_ML              51.32
 273 │ GW_Liz_GBS_Liz5188              GW_Liz_GBS_Liz5188              ML        lud             lud_ML              51.33
 274 │ GW_Liz_GBS_Liz5189              GW_Liz_GBS_Liz5189              ML        lud_chick       lud_ML              51.34
 275 │ GW_Liz_GBS_Liz5190              GW_Liz_GBS_Liz5190              ML        lud_chick       lud_ML              51.35
 276 │ GW_Liz_GBS_Liz5191              GW_Liz_GBS_Liz5191              ML        lud_chick       lud_ML              51.36
 277 │ GW_Liz_GBS_Liz5192              GW_Liz_GBS_Liz5192              ML        lud_chick       lud_ML              51.37
 278 │ GW_Liz_GBS_Liz5193              GW_Liz_GBS_Liz5193              ML        lud_chick       lud_ML              51.38
 279 │ GW_Liz_GBS_Liz5194              GW_Liz_GBS_Liz5194              ML        lud_chick       lud_ML              51.39
 280 │ GW_Liz_GBS_Liz5195              GW_Liz_GBS_Liz5195              ML        lud             lud_ML              51.4
 281 │ GW_Liz_GBS_Liz5197              GW_Liz_GBS_Liz5197              ML        lud             lud_ML              51.41
 282 │ GW_Liz_GBS_Liz5199              GW_Liz_GBS_Liz5199              ML        lud_chick       lud_ML              51.42
 283 │ GW_Liz_GBS_Liz6002              GW_Liz_GBS_Liz6002              ML        lud             lud_ML              51.43
 284 │ GW_Liz_GBS_Liz6006              GW_Liz_GBS_Liz6006              ML        lud             lud_ML              51.44
 285 │ GW_Liz_GBS_Liz6008              GW_Liz_GBS_Liz6008              ML        lud             lud_ML              51.45
 286 │ GW_Liz_GBS_Liz6009              GW_Liz_GBS_Liz6009              ML        lud             lud_ML              51.46
 287 │ GW_Liz_GBS_Liz6010              GW_Liz_GBS_Liz6010              ML        lud             lud_ML              51.47
 288 │ GW_Liz_GBS_Liz6012              GW_Liz_GBS_Liz6012              ML        lud             lud_ML              51.48
 289 │ GW_Liz_GBS_Liz6014              GW_Liz_GBS_Liz6014              ML        lud             lud_ML              51.49
 290 │ GW_Liz_GBS_Liz6055              GW_Liz_GBS_Liz6055              ML        lud             lud_ML              51.5
 291 │ GW_Liz_GBS_Liz6057              GW_Liz_GBS_Liz6057              ML        lud             lud_ML              51.51
 292 │ GW_Liz_GBS_Liz6060              GW_Liz_GBS_Liz6060              ML        lud             lud_ML              51.52
 293 │ GW_Liz_GBS_Liz6062              GW_Liz_GBS_Liz6062              ML        lud             lud_ML              51.53
 294 │ GW_Liz_GBS_Liz6063              GW_Liz_GBS_Liz6063              ML        lud             lud_ML              51.54
 295 │ GW_Liz_GBS_Liz6066              GW_Liz_GBS_Liz6066              ML        lud             lud_ML              51.55
 296 │ GW_Liz_GBS_Liz6072              GW_Liz_GBS_Liz6072              ML        lud             lud_ML              51.56
 297 │ GW_Liz_GBS_Liz6079              GW_Liz_GBS_Liz6079              ML        lud             lud_ML              51.57
 298 │ GW_Liz_GBS_Liz6203              GW_Liz_GBS_Liz6203              ML        lud_chick       lud_ML              51.58
 299 │ GW_Liz_GBS_Liz6204              GW_Liz_GBS_Liz6204              ML        lud_chick       lud_ML              51.59
 300 │ GW_Liz_GBS_Liz6461              GW_Liz_GBS_Liz6461              ML        lud             lud_ML              51.6
 301 │ GW_Liz_GBS_Liz6472              GW_Liz_GBS_Liz6472              ML        lud             lud_ML              51.61
 302 │ GW_Liz_GBS_Liz6478              GW_Liz_GBS_Liz6478              ML        lud             lud_ML              51.62
 303 │ GW_Liz_GBS_Liz6766              GW_Liz_GBS_Liz6766              ML        lud             lud_ML              51.63
 304 │ GW_Liz_GBS_Liz6776              GW_Liz_GBS_Liz6776              ML        lud             lud_ML              51.64
 305 │ GW_Liz_GBS_Liz6794              GW_Liz_GBS_Liz6794              ML        lud             lud_ML              51.65
 306 │ GW_Liz_GBS_P_fusc               GW_Liz_GBS_P_fusc               fusc      fusc            fusc               201.0
 307 │ GW_Liz_GBS_P_h_man              GW_Liz_GBS_P_h_man              hmand     hmand           hmand              202.0
 308 │ GW_Liz_GBS_P_humei              GW_Liz_GBS_P_humei              hume      hume            hume               203.0
 309 │ GW_Liz_GBS_P_inor               GW_Liz_GBS_P_inor               inor      inor            inor               204.0
 310 │ GW_Liz_GBS_S_burk               GW_Liz_GBS_S_burk               burk      burk            burk               205.0

GOOD NEWS: names of individuals in metadata file and genotype ind file match perfectly.</code></pre>
</div>
</div>
</section>
<section id="polish-a-few-individual-names-to-match-those-in-other-metadata-object-above-and-make-more-readable-graphs" class="level3">
<h3 class="anchored" data-anchor-id="polish-a-few-individual-names-to-match-those-in-other-metadata-object-above-and-make-more-readable-graphs">Polish a few individual names (to match those in other metadata object above, and make more readable graphs):</h3>
<div id="18fe79be" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb505"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chr4A.ind <span class="op">=</span> <span class="fu">correctNames</span>(ind_with_metadata_chr4A.ind)</span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chr4A.ID <span class="op">=</span> <span class="fu">correctNames</span>(ind_with_metadata_chr4A.ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>310-element Vector{String}:
 "GW_Armando_plate1_AB1"
 "GW_Armando_plate1_JF07G02"
 "GW_Armando_plate1_JF07G03"
 "GW_Armando_plate1_JF07G04"
 "GW_Armando_plate1_JF08G02"
 "GW_Armando_plate1_JF09G01"
 "GW_Armando_plate1_JF09G02"
 "GW_Armando_plate1_JF10G03"
 "GW_Armando_plate1_JF11G01"
 "GW_Armando_plate1_JF12G01"
 "GW_Armando_plate1_JF12G02"
 "GW_Armando_plate1_JF12G04"
 "GW_Armando_plate1_JF13G01"
 ⋮
 "GW_Liz_GBS_Liz6204"
 "GW_Liz_GBS_Liz6461"
 "GW_Liz_GBS_Liz6472"
 "GW_Liz_GBS_Liz6478"
 "GW_Liz_GBS_Liz6766"
 "GW_Liz_GBS_Liz6776"
 "GW_Liz_GBS_Liz6794"
 "GW_Liz_GBS_P_fusc"
 "GW_Liz_GBS_P_h_man"
 "GW_Liz_GBS_P_humei"
 "GW_Liz_GBS_P_inor"
 "GW_Liz_GBS_S_burk"</code></pre>
</div>
</div>
</section>
<section id="filter-to-just-the-individuals-also-included-in-the-analysis-of-lhbrs-above" class="level3">
<h3 class="anchored" data-anchor-id="filter-to-just-the-individuals-also-included-in-the-analysis-of-lhbrs-above">Filter to just the individuals also included in the analysis of LHBRs above</h3>
<div id="4dbec075" class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb507"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> <span class="fu">map</span>(<span class="fu">in</span>(ind_with_metadata_included.ind), ind_with_metadata_chr4A.ind)</span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chr4A_included <span class="op">=</span> ind_with_metadata_chr4A[selection, <span class="op">:</span>]</span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-5"><a href="#cb507-5" aria-hidden="true" tabindex="-1"></a><span class="co"># select genotypes of just the included individuals, and ignore first column</span></span>
<span id="cb507-6"><a href="#cb507-6" aria-hidden="true" tabindex="-1"></a>geno_chr4A_included <span class="op">=</span> geno_chr4A[selection, <span class="fl">2</span><span class="op">:</span><span class="kw">end</span>]</span>
<span id="cb507-7"><a href="#cb507-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-8"><a href="#cb507-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb507-9"><a href="#cb507-9" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(ind_with_metadata_included.gw4A_cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>["virLud", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "virLud_obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "virLud", "virLud", "obsPlumb", "virLud", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "virLud_obsPlumb", "virLud_obsPlumb", "obsPlumb", "virLud_obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "virLudHet", "troch", "virLud_troch", "obsPlumb", "virLud_troch", "troch_obsPlumb", "troch_obsPlumb", "troch_obsPlumb", "virLudHet", "virLud_obsPlumb", "virLudHet", "obsPlumb", "virLud_obsPlumb", "virLud_troch", "virLud_obsPlumb", "obsPlumb", "troch_obsPlumb", "troch_obsPlumb", "troch_obsPlumb", "troch", "troch_obsPlumb", "troch", "troch", "troch", "virLud_troch", "troch", "trochHet", "virLud_obsPlumb", "obsPlumb", "obsPlumb", "virLud_obsPlumb", "obsPlumb", "virLud", "virLud", "virLud", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "virLud", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "virLud", "virLud_obsPlumb", "obsPlumb", "obsPlumbHet", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "troch", "obsPlumb", "troch", "troch", "troch_obsPlumb", "virLud_troch", "obsPlumb", "obsPlumb", "obsPlumb", "virLud_obsPlumb", "virLud_obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "troch_obsPlumb", "obsPlumb", "virLud_obsPlumb", "trochHet", "troch", "troch", "troch_obsPlumb", "troch", "troch", "troch", "troch", "troch", "troch", "virLud_obsPlumb", "virLud_troch", "virLud_obsPlumb", "obsPlumb", "virLud_obsPlumb", "virLud_obsPlumb", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "troch_obsPlumb", "obsPlumb", "obsPlumb", "virLud_obsPlumb", "virLud_obsPlumb", "troch", "troch", "troch", "trochHet", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "troch", "virLud", "obsPlumb", "virLud", "obsPlumb", "troch", "obsPlumb", "obsPlumb", "virLud_obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "obsPlumb", "virLud", "virLud", "virLud", "obsPlumb", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "nit", "nit", "obsPlumb", "obsPlumb", "virLud_obsPlumb", "obsPlumb", "obsPlumb", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "troch_obsPlumb", "troch", "troch", "troch", "troch_obsPlumb", "troch", "troch", "troch", "troch", "troch", "troch", "troch_obsPlumb", "troch", "troch", "troch_obsPlumb", "troch_obsPlumb", "troch", "troch_obsPlumb", "troch", "virLud_obsPlumb", "troch_obsPlumb", "troch_obsPlumb", "troch", "virLud_troch", "troch", "troch_obsPlumb", "troch", "virLud_troch", "virLud_troch", "troch_obsPlumb", "troch", "troch", "virLud_troch", "troch", "troch_obsPlumb", "troch", "troch", "troch", "trochHet", "troch", "troch", "troch", "troch"]</code></pre>
</div>
</div>
</section>
<section id="look-up-the-chr4a-individual-membership-in-homozygous-clusters-and-calculate-pi-and-dxy" class="level3">
<h3 class="anchored" data-anchor-id="look-up-the-chr4a-individual-membership-in-homozygous-clusters-and-calculate-pi-and-dxy">Look up the chr4A individual membership in homozygous clusters, and calculate pi and Dxy</h3>
<div id="3962c2ec" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb509"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a>indClusterMembership_gw4A <span class="op">=</span> ind_with_metadata_included.gw4A_cluster</span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a>clusterNames_gw4A <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"nit"</span>,</span>
<span id="cb509-5"><a href="#cb509-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"troch"</span>,</span>
<span id="cb509-6"><a href="#cb509-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obsPlumb"</span>]</span>
<span id="cb509-7"><a href="#cb509-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-8"><a href="#cb509-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get boundaries of gw4A LHBR:</span></span>
<span id="cb509-9"><a href="#cb509-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-10"><a href="#cb509-10" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw4A"</span></span>
<span id="cb509-11"><a href="#cb509-11" aria-hidden="true" tabindex="-1"></a>positionMin_chr4A_LHBR, positionMax_chr4A_LHBR, regionText, </span>
<span id="cb509-12"><a href="#cb509-12" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb509-13"><a href="#cb509-13" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb509-14"><a href="#cb509-14" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb509-15"><a href="#cb509-15" aria-hidden="true" tabindex="-1"></a>                                                    pos_SNP_filtered, </span>
<span id="cb509-16"><a href="#cb509-16" aria-hidden="true" tabindex="-1"></a>                                                    highViSHetRegions, chr;</span>
<span id="cb509-17"><a href="#cb509-17" aria-hidden="true" tabindex="-1"></a>                                                    windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb509-18"><a href="#cb509-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-19"><a href="#cb509-19" aria-hidden="true" tabindex="-1"></a><span class="co"># select the loci within the gw4A LHBR:</span></span>
<span id="cb509-20"><a href="#cb509-20" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> (positionMin_chr4A_LHBR <span class="op">.&lt;=</span> pos_chr4A.position <span class="op">.&lt;=</span> positionMax_chr4A_LHBR) </span>
<span id="cb509-21"><a href="#cb509-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-22"><a href="#cb509-22" aria-hidden="true" tabindex="-1"></a>geno_chr4A_included_LHBR <span class="op">=</span> geno_chr4A_included[<span class="op">:</span>, selection]</span>
<span id="cb509-23"><a href="#cb509-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-24"><a href="#cb509-24" aria-hidden="true" tabindex="-1"></a>pos_chr4A_LHBR <span class="op">=</span> pos_chr4A[selection, <span class="op">:</span>]</span>
<span id="cb509-25"><a href="#cb509-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-26"><a href="#cb509-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb509-27"><a href="#cb509-27" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(geno_chr4A_included_LHBR, indClusterMembership_gw4A, clusterNames_gw4A)</span>
<span id="cb509-28"><a href="#cb509-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-29"><a href="#cb509-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb509-30"><a href="#cb509-30" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb509-31"><a href="#cb509-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-32"><a href="#cb509-32" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb509-33"><a href="#cb509-33" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames_gw4A)</span>
<span id="cb509-34"><a href="#cb509-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-35"><a href="#cb509-35" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames_gw4A; among<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb509-36"><a href="#cb509-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-37"><a href="#cb509-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb509-38"><a href="#cb509-38" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames_gw4A, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb509-39"><a href="#cb509-39" aria-hidden="true" tabindex="-1"></a><span class="co">#= 4×2 DataFrame</span></span>
<span id="cb509-40"><a href="#cb509-40" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster   pi          </span></span>
<span id="cb509-41"><a href="#cb509-41" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String    Float64     </span></span>
<span id="cb509-42"><a href="#cb509-42" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼───────────────────────</span></span>
<span id="cb509-43"><a href="#cb509-43" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud    0.000956575</span></span>
<span id="cb509-44"><a href="#cb509-44" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit       0.000332204</span></span>
<span id="cb509-45"><a href="#cb509-45" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch     0.000613901</span></span>
<span id="cb509-46"><a href="#cb509-46" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obsPlumb  0.000261819 =#</span></span>
<span id="cb509-47"><a href="#cb509-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-48"><a href="#cb509-48" aria-hidden="true" tabindex="-1"></a><span class="co"># average pi (for chr 4A LHBR) among three major groups:</span></span>
<span id="cb509-49"><a href="#cb509-49" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.000956575</span> <span class="op">+</span> <span class="fl">0.000613901</span> <span class="op">+</span> <span class="fl">0.000261819</span>) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb509-50"><a href="#cb509-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.000610765</span></span>
<span id="cb509-51"><a href="#cb509-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-52"><a href="#cb509-52" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb509-53"><a href="#cb509-53" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb509-54"><a href="#cb509-54" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair     Dxy        </span></span>
<span id="cb509-55"><a href="#cb509-55" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String           Float64    </span></span>
<span id="cb509-56"><a href="#cb509-56" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────────</span></span>
<span id="cb509-57"><a href="#cb509-57" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit       0.00325609</span></span>
<span id="cb509-58"><a href="#cb509-58" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch     0.0031813</span></span>
<span id="cb509-59"><a href="#cb509-59" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obsPlumb  0.00241666</span></span>
<span id="cb509-60"><a href="#cb509-60" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ nit_troch        0.00286634</span></span>
<span id="cb509-61"><a href="#cb509-61" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_obsPlumb     0.00249507</span></span>
<span id="cb509-62"><a href="#cb509-62" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ troch_obsPlumb   0.00305931 =#</span></span>
<span id="cb509-63"><a href="#cb509-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-64"><a href="#cb509-64" aria-hidden="true" tabindex="-1"></a><span class="co"># average Dxy (for chr 4A LHBR) among three major groups:</span></span>
<span id="cb509-65"><a href="#cb509-65" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.0031813</span> <span class="op">+</span> <span class="fl">0.00241666</span> <span class="op">+</span> <span class="fl">0.00305931</span>) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb509-66"><a href="#cb509-66" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.0028857566666666674</span></span>
<span id="cb509-67"><a href="#cb509-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-68"><a href="#cb509-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Drawing phylogeny (in Illustrator) based on above, between three major groups.</span></span>
<span id="cb509-69"><a href="#cb509-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Ignoring nit, the most recent connection is between virLud and obsPlumb (0.00241666).</span></span>
<span id="cb509-70"><a href="#cb509-70" aria-hidden="true" tabindex="-1"></a><span class="co"># For deeper branch length, am using: </span></span>
<span id="cb509-71"><a href="#cb509-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculation for average Dxy between troch and (virLud, obsPlumb):</span></span>
<span id="cb509-72"><a href="#cb509-72" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.0031813</span> <span class="op">+</span> <span class="fl">0.00305931</span>) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb509-73"><a href="#cb509-73" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.003120305</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good news: 1 region on that scaffold</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="189">
<pre><code>0.0031203050000000003</code></pre>
</div>
</div>
<p>Wow, that is an amazing difference between pi within the obsPlumb haplotype and Dxy between that and others (roughly 10x).</p>
</section>
<section id="calculate-pi-and-dxy-outside-of-the-chr-4a-lhbr-grouped-by-the-lhbr-homozygous-groups" class="level3">
<h3 class="anchored" data-anchor-id="calculate-pi-and-dxy-outside-of-the-chr-4a-lhbr-grouped-by-the-lhbr-homozygous-groups">Calculate pi and Dxy outside of the chr 4A LHBR (grouped by the LHBR homozygous groups)</h3>
<div id="467fbb56" class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the loci outside of the gw4A LHBR:</span></span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> .!(positionMin_chr4A_LHBR <span class="op">.&lt;=</span> pos_chr4A.position <span class="op">.&lt;=</span> positionMax_chr4A_LHBR) </span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a>geno_chr4A_included_nonLHBR <span class="op">=</span> geno_chr4A_included[<span class="op">:</span>, selection]</span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a>pos_chr4A_nonLHBR <span class="op">=</span> pos_chr4A[selection, <span class="op">:</span>]</span>
<span id="cb512-7"><a href="#cb512-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-8"><a href="#cb512-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb512-9"><a href="#cb512-9" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(geno_chr4A_included_nonLHBR, indClusterMembership_gw4A, clusterNames_gw4A)</span>
<span id="cb512-10"><a href="#cb512-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-11"><a href="#cb512-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb512-12"><a href="#cb512-12" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb512-13"><a href="#cb512-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-14"><a href="#cb512-14" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb512-15"><a href="#cb512-15" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames_gw4A)</span>
<span id="cb512-16"><a href="#cb512-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-17"><a href="#cb512-17" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames_gw4A; among<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb512-18"><a href="#cb512-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-19"><a href="#cb512-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb512-20"><a href="#cb512-20" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames_gw4A, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb512-21"><a href="#cb512-21" aria-hidden="true" tabindex="-1"></a><span class="co">#= 4×2 DataFrame</span></span>
<span id="cb512-22"><a href="#cb512-22" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster   pi         </span></span>
<span id="cb512-23"><a href="#cb512-23" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String    Float64    </span></span>
<span id="cb512-24"><a href="#cb512-24" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼──────────────────────</span></span>
<span id="cb512-25"><a href="#cb512-25" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud    0.0041321</span></span>
<span id="cb512-26"><a href="#cb512-26" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit       0.00196343</span></span>
<span id="cb512-27"><a href="#cb512-27" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ troch     0.00551821</span></span>
<span id="cb512-28"><a href="#cb512-28" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ obsPlumb  0.0055897 =#</span></span>
<span id="cb512-29"><a href="#cb512-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-30"><a href="#cb512-30" aria-hidden="true" tabindex="-1"></a><span class="co"># average pi (for chr 4A NOT in LHBR) among three major groups:</span></span>
<span id="cb512-31"><a href="#cb512-31" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.0041321</span> <span class="op">+</span> <span class="fl">0.00551821</span> <span class="op">+</span> <span class="fl">0.0055897</span>) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb512-32"><a href="#cb512-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.005080003333333333</span></span>
<span id="cb512-33"><a href="#cb512-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-34"><a href="#cb512-34" aria-hidden="true" tabindex="-1"></a><span class="co">#ratio of average pi outside to average pi within chr 4A LHBR:</span></span>
<span id="cb512-35"><a href="#cb512-35" aria-hidden="true" tabindex="-1"></a><span class="fl">0.005080003333333333</span> <span class="op">/</span> <span class="fl">0.000610765</span></span>
<span id="cb512-36"><a href="#cb512-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 8.317443424776032</span></span>
<span id="cb512-37"><a href="#cb512-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-38"><a href="#cb512-38" aria-hidden="true" tabindex="-1"></a><span class="co"># percent lower that average pi is within compared to outside LHBR:</span></span>
<span id="cb512-39"><a href="#cb512-39" aria-hidden="true" tabindex="-1"></a><span class="fl">100</span> <span class="op">*</span> (<span class="fl">8.317443424776032</span> <span class="op">-</span> <span class="fl">1</span>) <span class="op">/</span> <span class="fl">8.317443424776032</span></span>
<span id="cb512-40"><a href="#cb512-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 87.97707481819238</span></span>
<span id="cb512-41"><a href="#cb512-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-42"><a href="#cb512-42" aria-hidden="true" tabindex="-1"></a><span class="co"># for obsPlumb haplotype, ratio of pi outside to pi within chr 4A LHBR:</span></span>
<span id="cb512-43"><a href="#cb512-43" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0055897</span> <span class="op">/</span> <span class="fl">0.000261819</span></span>
<span id="cb512-44"><a href="#cb512-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 21.349481893980194</span></span>
<span id="cb512-45"><a href="#cb512-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-46"><a href="#cb512-46" aria-hidden="true" tabindex="-1"></a><span class="co"># percent lower that pi of obsPlumb haplotype is within vs. outside of HLBR:</span></span>
<span id="cb512-47"><a href="#cb512-47" aria-hidden="true" tabindex="-1"></a><span class="fl">100</span> <span class="op">*</span> (<span class="fl">21.349481893980194</span> <span class="op">-</span> <span class="fl">1</span>) <span class="op">/</span> <span class="fl">21.349481893980194</span></span>
<span id="cb512-48"><a href="#cb512-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 95.31604558384171</span></span>
<span id="cb512-49"><a href="#cb512-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-50"><a href="#cb512-50" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb512-51"><a href="#cb512-51" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb512-52"><a href="#cb512-52" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair     Dxy        </span></span>
<span id="cb512-53"><a href="#cb512-53" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String           Float64    </span></span>
<span id="cb512-54"><a href="#cb512-54" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────────</span></span>
<span id="cb512-55"><a href="#cb512-55" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit       0.00440681</span></span>
<span id="cb512-56"><a href="#cb512-56" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_troch     0.0055599</span></span>
<span id="cb512-57"><a href="#cb512-57" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_obsPlumb  0.00556595</span></span>
<span id="cb512-58"><a href="#cb512-58" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ nit_troch        0.00520058</span></span>
<span id="cb512-59"><a href="#cb512-59" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_obsPlumb     0.00548082</span></span>
<span id="cb512-60"><a href="#cb512-60" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ troch_obsPlumb   0.00601295 =#</span></span>
<span id="cb512-61"><a href="#cb512-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-62"><a href="#cb512-62" aria-hidden="true" tabindex="-1"></a><span class="co"># average Dxy (for OUTSIDE of chr 4A LHBR) among three major groups:</span></span>
<span id="cb512-63"><a href="#cb512-63" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.0055599</span> <span class="op">+</span> <span class="fl">0.00556595</span> <span class="op">+</span> <span class="fl">0.00601295</span>) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb512-64"><a href="#cb512-64" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.005712933333333333</span></span>
<span id="cb512-65"><a href="#cb512-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-66"><a href="#cb512-66" aria-hidden="true" tabindex="-1"></a><span class="co">#ratio of average Dxy outside to average Dxy within chr 4A LHBR among 3 major groups:</span></span>
<span id="cb512-67"><a href="#cb512-67" aria-hidden="true" tabindex="-1"></a><span class="fl">0.005712933333333333</span> <span class="op">/</span> <span class="fl">0.0028857566666666674</span></span>
<span id="cb512-68"><a href="#cb512-68" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.9797002981309344</span></span>
<span id="cb512-69"><a href="#cb512-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-70"><a href="#cb512-70" aria-hidden="true" tabindex="-1"></a><span class="co"># percent lower that average Dxy is within compared to outside LHBR:</span></span>
<span id="cb512-71"><a href="#cb512-71" aria-hidden="true" tabindex="-1"></a><span class="fl">100</span> <span class="op">*</span> (<span class="fl">1.9797002981309344</span> <span class="op">-</span> <span class="fl">1</span>) <span class="op">/</span> <span class="fl">1.9797002981309344</span></span>
<span id="cb512-72"><a href="#cb512-72" aria-hidden="true" tabindex="-1"></a><span class="co"># 49.487303661866626</span></span>
<span id="cb512-73"><a href="#cb512-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-74"><a href="#cb512-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Drawing phylogeny (in Illustrator) based on above, between three major groups.</span></span>
<span id="cb512-75"><a href="#cb512-75" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, the virLud_troch is the lower Dxy so am connecting those more recently.</span></span>
<span id="cb512-76"><a href="#cb512-76" aria-hidden="true" tabindex="-1"></a><span class="co"># For deeper brancha length, using this:</span></span>
<span id="cb512-77"><a href="#cb512-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculation of average distance between obsPlumb and (virLud, troch)</span></span>
<span id="cb512-78"><a href="#cb512-78" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.00556595</span> <span class="op">+</span> <span class="fl">0.00601295</span>) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb512-79"><a href="#cb512-79" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.00578945</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="190">
<pre><code>0.00578945</code></pre>
</div>
</div>
<p>Remarkable differences between pi and Dxy in the gw4A LHBR, and between LHBR and non-LHBR part of that chromosome!</p>
<p>Do same with chr 3, which also shows 3 clear haplotype groups, but a very different biogeographic pattern than 4A:</p>
</section>
</section>
<section id="examine-chromosome-3-large-haploblock-region-lhbr-with-invariant-sites-included" class="level2">
<h2 class="anchored" data-anchor-id="examine-chromosome-3-large-haploblock-region-lhbr-with-invariant-sites-included">Examine chromosome 3 Large HaploBlock Region (LHBR) with invariant sites included</h2>
<p>Before running below, I need to change format of 012NA file to # Before running below, changed 012NA file back into 012minus1 file, using commands like below, so can be read as integer:</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /Users/darrenirwin/GW_data_from_cedar_Feb2024/GW2022_cedar/infoSites_vcfs/GW2022_all4plates.genotypes.allSites.chrgw3.infoSites.max2allele_noindel.maxmiss60.MQ20.lowHet.tab.012NA <span class="kw">|</span> <span class="fu">sed</span> <span class="st">'s/NA/-1/g'</span> <span class="op">&gt;</span> /Users/darrenirwin/GW_data_from_cedar_Feb2024/GW2022_cedar/infoSites_vcfs/GW2022_all4plates.genotypes.allSites.chrgw3.infoSites.max2allele_noindel.maxmiss60.MQ20.lowHet.tab.012minus1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="0a8613b8" class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb515"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a>baseName <span class="op">=</span> <span class="st">"/Users/darrenirwin/GW_data_from_cedar_Feb2024/GW2022_cedar/infoSites_vcfs/GW2022_all4plates.genotypes.allSites.chrgw3.infoSites.max2allele_noindel.maxmiss60.MQ20.lowHet.tab"</span></span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load metadata</span></span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cd</span>(dataDirectory)</span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true" tabindex="-1"></a>metadata_chr3 <span class="op">=</span> <span class="fu">DataFrame</span>(CSV.<span class="fu">File</span>(metadataFile)) <span class="co"># the CSV.File function interprets the correct delimiter</span></span>
<span id="cb515-5"><a href="#cb515-5" aria-hidden="true" tabindex="-1"></a>num_metadata_cols_chr3 <span class="op">=</span> <span class="fu">ncol</span>(metadata_chr3)</span>
<span id="cb515-6"><a href="#cb515-6" aria-hidden="true" tabindex="-1"></a>num_individuals_chr3 <span class="op">=</span> <span class="fu">nrow</span>(metadata_chr3) </span>
<span id="cb515-7"><a href="#cb515-7" aria-hidden="true" tabindex="-1"></a><span class="co"># read in individual names for this dataset</span></span>
<span id="cb515-8"><a href="#cb515-8" aria-hidden="true" tabindex="-1"></a>individuals_file_name_chr3 <span class="op">=</span> <span class="fu">string</span>(baseName, <span class="st">".012.indv"</span>)</span>
<span id="cb515-9"><a href="#cb515-9" aria-hidden="true" tabindex="-1"></a>ind_chr3 <span class="op">=</span> <span class="fu">DataFrame</span>(CSV.<span class="fu">File</span>(individuals_file_name_chr3; header<span class="op">=</span>[<span class="st">"ind"</span>], types<span class="op">=</span>[<span class="dt">String</span>])) </span>
<span id="cb515-10"><a href="#cb515-10" aria-hidden="true" tabindex="-1"></a>indNum_chr3 <span class="op">=</span> <span class="fu">size</span>(ind_chr3, <span class="fl">1</span>) <span class="co"># number of individuals</span></span>
<span id="cb515-11"><a href="#cb515-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> num_individuals_chr3 <span class="op">!=</span> indNum_chr3</span>
<span id="cb515-12"><a href="#cb515-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"WARNING: number of rows in metadata file different than number of individuals in .indv file"</span>)</span>
<span id="cb515-13"><a href="#cb515-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb515-14"><a href="#cb515-14" aria-hidden="true" tabindex="-1"></a><span class="co"># read in position data for this dataset</span></span>
<span id="cb515-15"><a href="#cb515-15" aria-hidden="true" tabindex="-1"></a>position_file_name_chr3 <span class="op">=</span> <span class="fu">string</span>(baseName, <span class="st">".012.pos"</span>)</span>
<span id="cb515-16"><a href="#cb515-16" aria-hidden="true" tabindex="-1"></a>pos_chr3 <span class="op">=</span> <span class="fu">DataFrame</span>(CSV.<span class="fu">File</span>(position_file_name_chr3; header<span class="op">=</span>[<span class="st">"chrom"</span>, <span class="st">"position"</span>], types<span class="op">=</span>[<span class="dt">String</span>, <span class="dt">Int</span>]))</span>
<span id="cb515-17"><a href="#cb515-17" aria-hidden="true" tabindex="-1"></a><span class="co"># read in genotype data</span></span>
<span id="cb515-18"><a href="#cb515-18" aria-hidden="true" tabindex="-1"></a>genotype_file_name_chr3 <span class="op">=</span> <span class="fu">string</span>(baseName, <span class="st">".012minus1"</span>) </span>
<span id="cb515-19"><a href="#cb515-19" aria-hidden="true" tabindex="-1"></a><span class="pp">@time</span> <span class="cf">if</span> <span class="fl">1</span> <span class="op">&lt;=</span> indNum_chr3 <span class="op">&lt;=</span> <span class="fl">127</span>   </span>
<span id="cb515-20"><a href="#cb515-20" aria-hidden="true" tabindex="-1"></a>    geno_chr3 <span class="op">=</span> <span class="fu">readdlm</span>(genotype_file_name_chr3, <span class="ch">'\t'</span>, <span class="dt">Int8</span>, <span class="ch">'\n'</span>); <span class="co"># this has been sped up dramatically, by first converting "NA" to -1</span></span>
<span id="cb515-21"><a href="#cb515-21" aria-hidden="true" tabindex="-1"></a><span class="cf">elseif</span> <span class="fl">128</span> <span class="op">&lt;=</span> indNum_chr3 <span class="op">&lt;=</span> <span class="fl">32767</span></span>
<span id="cb515-22"><a href="#cb515-22" aria-hidden="true" tabindex="-1"></a>    geno_chr3 <span class="op">=</span> <span class="fu">readdlm</span>(genotype_file_name_chr3, <span class="ch">'\t'</span>, <span class="dt">Int16</span>, <span class="ch">'\n'</span>); <span class="co"># this needed for first column, which is number of individual; Int16 not much slower on import than Int8</span></span>
<span id="cb515-23"><a href="#cb515-23" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb515-24"><a href="#cb515-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Error: Number of individuals in .indv appears outside of range from 1 to 32767"</span>)</span>
<span id="cb515-25"><a href="#cb515-25" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb515-26"><a href="#cb515-26" aria-hidden="true" tabindex="-1"></a>loci_count_chr3 <span class="op">=</span> <span class="fu">size</span>(geno_chr3, <span class="fl">2</span>) <span class="op">-</span> <span class="fl">1</span>   <span class="co"># because the first column is not a SNP (just a count from zero)</span></span>
<span id="cb515-27"><a href="#cb515-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">string</span>(<span class="st">"Read in genotypic data at "</span>, loci_count_chr3,<span class="st">" loci for "</span>, indNum_chr3, <span class="st">" individuals. </span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 51.827697 seconds (2.97 M allocations: 15.221 GiB, 8.00% gc time, 0.34% compilation time)
Read in genotypic data at 1855532 loci for 310 individuals. </code></pre>
</div>
</div>
<section id="check-that-individuals-are-same-in-genotype-data-and-metadata-1" class="level3">
<h3 class="anchored" data-anchor-id="check-that-individuals-are-same-in-genotype-data-and-metadata-1">Check that individuals are same in genotype data and metadata</h3>
<div id="51fb00e8" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chr3 <span class="op">=</span> <span class="fu">hcat</span>(ind_chr3, metadata_chr3)</span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(ind_with_metadata_chr3)</span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>()  <span class="co"># prints a line break </span></span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">isequal</span>(ind_with_metadata_chr3.ind, ind_with_metadata_chr3.ID)</span>
<span id="cb517-5"><a href="#cb517-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"GOOD NEWS: names of individuals in metadata file and genotype ind file match perfectly."</span>)</span>
<span id="cb517-6"><a href="#cb517-6" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb517-7"><a href="#cb517-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"WARNING: names of individuals in metadata file and genotype ind file do not completely match."</span>)</span>
<span id="cb517-8"><a href="#cb517-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>310×6 DataFrame
 Row │ ind                             ID                              location  group           Fst_group       plot_order 
     │ String                          String31                        String7   String15        String15        Float64    
─────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ GW_Armando_plate1_AB1           GW_Armando_plate1_AB1           AB        vir             vir                 20.01
   2 │ GW_Armando_plate1_JF07G02       GW_Armando_plate1_JF07G02       ST        plumb           plumb              108.0
   3 │ GW_Armando_plate1_JF07G03       GW_Armando_plate1_JF07G03       ST        plumb           plumb              109.0
   4 │ GW_Armando_plate1_JF07G04       GW_Armando_plate1_JF07G04       ST        plumb           plumb              110.0
   5 │ GW_Armando_plate1_JF08G02       GW_Armando_plate1_JF08G02       ST        plumb           plumb              111.0
   6 │ GW_Armando_plate1_JF09G01       GW_Armando_plate1_JF09G01       ST        plumb           plumb              112.0
   7 │ GW_Armando_plate1_JF09G02       GW_Armando_plate1_JF09G02       ST        plumb           plumb              113.0
   8 │ GW_Armando_plate1_JF10G03       GW_Armando_plate1_JF10G03       ST        plumb_vir       plumb_vir          170.0
   9 │ GW_Armando_plate1_JF11G01       GW_Armando_plate1_JF11G01       ST        plumb           plumb              114.0
  10 │ GW_Armando_plate1_JF12G01       GW_Armando_plate1_JF12G01       ST        plumb           plumb              115.0
  11 │ GW_Armando_plate1_JF12G02       GW_Armando_plate1_JF12G02       ST        plumb           plumb              116.0
  12 │ GW_Armando_plate1_JF12G04       GW_Armando_plate1_JF12G04       ST_vi     vir             vir                 24.001
  13 │ GW_Armando_plate1_JF13G01       GW_Armando_plate1_JF13G01       ST        plumb           plumb              117.0
  14 │ GW_Armando_plate1_JF15G03       GW_Armando_plate1_JF15G03       DV        plumb           plumb              103.0
  15 │ GW_Armando_plate1_JF16G01       GW_Armando_plate1_JF16G01       DV_vi     plumb_vir       vir                 24.041
  16 │ GW_Armando_plate1_JF20G01       GW_Armando_plate1_JF20G01       MB        plumb           plumb               94.0
  17 │ GW_Armando_plate1_JF22G01       GW_Armando_plate1_JF22G01       MB        plumb           plumb               95.0
  18 │ GW_Armando_plate1_JF23G01       GW_Armando_plate1_JF23G01       VB        plumb           plumb               98.0
  19 │ GW_Armando_plate1_JF23G02       GW_Armando_plate1_JF23G02       VB        plumb           plumb               99.0
  20 │ GW_Armando_plate1_JF24G02       GW_Armando_plate1_JF24G02       VB        plumb           plumb              100.0
  21 │ GW_Armando_plate1_JF26G01       GW_Armando_plate1_JF26G01       ST        plumb           plumb              118.0
  22 │ GW_Armando_plate1_JF27G01       GW_Armando_plate1_JF27G01       ST        plumb           plumb              119.0
  23 │ GW_Armando_plate1_JF29G01       GW_Armando_plate1_JF29G01       ST        plumb           plumb              120.0
  24 │ GW_Armando_plate1_JF29G02       GW_Armando_plate1_JF29G02       ST        plumb           plumb              121.0
  25 │ GW_Armando_plate1_JF29G03       GW_Armando_plate1_JF29G03       ST        plumb           plumb              122.0
  26 │ GW_Armando_plate1_JG02G02       GW_Armando_plate1_JG02G02       PR        plumb           plumb              145.0
  27 │ GW_Armando_plate1_JG02G04       GW_Armando_plate1_JG02G04       PR        plumb           plumb              146.0
  28 │ GW_Armando_plate1_JG08G01       GW_Armando_plate1_JG08G01       ST        plumb           plumb              123.0
  29 │ GW_Armando_plate1_JG08G02       GW_Armando_plate1_JG08G02       ST        plumb           plumb              124.0
  30 │ GW_Armando_plate1_JG10G01       GW_Armando_plate1_JG10G01       ST        plumb           plumb              125.0
  31 │ GW_Armando_plate1_JG12G01       GW_Armando_plate1_JG12G01       ST        plumb           plumb              126.0
  32 │ GW_Armando_plate1_JG17G01       GW_Armando_plate1_JG17G01       ST        plumb_vir       plumb              127.0
  33 │ GW_Armando_plate1_NO_BC_TTGW05  GW_Armando_plate1_NO_BC_TTGW05  blank     blank           blank              -99.0
  34 │ GW_Armando_plate1_NO_DNA        GW_Armando_plate1_NO_DNA        blank     blank           blank              -99.0
  35 │ GW_Armando_plate1_RF20G01       GW_Armando_plate1_RF20G01       BJ        obs_plumb       plumb_BJ            77.501
  36 │ GW_Armando_plate1_RF29G02       GW_Armando_plate1_RF29G02       BJ        obs_plumb       plumb_BJ            77.502
  37 │ GW_Armando_plate1_TL3           GW_Armando_plate1_TL3           TL        vir             vir                 11.01
  38 │ GW_Armando_plate1_TTGW01        GW_Armando_plate1_TTGW01        MN        troch_MN        troch_west          53.0
  39 │ GW_Armando_plate1_TTGW05_rep1   GW_Armando_plate1_TTGW05_rep1   MN_rep    troch_MN_rep    troch_west_rep      53.0
  40 │ GW_Armando_plate1_TTGW05_rep2   GW_Armando_plate1_TTGW05_rep2   MN        troch_MN        troch_west          53.0
  41 │ GW_Armando_plate1_TTGW06        GW_Armando_plate1_TTGW06        SU        lud_Sukhto      lud_central         47.0
  42 │ GW_Armando_plate1_TTGW07        GW_Armando_plate1_TTGW07        SU        lud_Sukhto      lud_central         47.0
  43 │ GW_Armando_plate1_TTGW10        GW_Armando_plate1_TTGW10        SU        lud_Sukhto      lud_central         47.0
  44 │ GW_Armando_plate1_TTGW11        GW_Armando_plate1_TTGW11        SU        lud_Sukhto      lud_central         47.0
  45 │ GW_Armando_plate1_TTGW13        GW_Armando_plate1_TTGW13        TH        lud_Thallighar  lud_central         43.0
  46 │ GW_Armando_plate1_TTGW17        GW_Armando_plate1_TTGW17        TH        lud_Thallighar  lud_central         43.0
  47 │ GW_Armando_plate1_TTGW19        GW_Armando_plate1_TTGW19        TH        lud_Thallighar  lud_central         43.0
  48 │ GW_Armando_plate1_TTGW21        GW_Armando_plate1_TTGW21        SR        lud_Sural       lud_central         45.0
  49 │ GW_Armando_plate1_TTGW22        GW_Armando_plate1_TTGW22        SR        lud_Sural       lud_central         45.0
  50 │ GW_Armando_plate1_TTGW23        GW_Armando_plate1_TTGW23        SR        lud_Sural       lud_central         45.0
  51 │ GW_Armando_plate1_TTGW29        GW_Armando_plate1_TTGW29        SR        lud_Sural       lud_central         45.0
  52 │ GW_Armando_plate1_TTGW52        GW_Armando_plate1_TTGW52        NG        lud_Nainaghar   lud_central         49.0
  53 │ GW_Armando_plate1_TTGW53        GW_Armando_plate1_TTGW53        NG        lud_Nainaghar   lud_central         49.0
  54 │ GW_Armando_plate1_TTGW55        GW_Armando_plate1_TTGW55        NG        lud_Nainaghar   lud_central         49.0
  55 │ GW_Armando_plate1_TTGW57        GW_Armando_plate1_TTGW57        NG        lud_Nainaghar   lud_central         49.0
  56 │ GW_Armando_plate1_TTGW58        GW_Armando_plate1_TTGW58        NG        lud_Nainaghar   lud_central         49.0
  57 │ GW_Armando_plate1_TTGW59        GW_Armando_plate1_TTGW59        NG        lud_Nainaghar   lud_central         49.0
  58 │ GW_Armando_plate1_TTGW63        GW_Armando_plate1_TTGW63        SP        lud_Spiti       troch_west          55.0
  59 │ GW_Armando_plate1_TTGW64        GW_Armando_plate1_TTGW64        SP        lud_Spiti       troch_west          55.0
  60 │ GW_Armando_plate1_TTGW65        GW_Armando_plate1_TTGW65        SP        lud_Spiti       troch_west          55.0
  61 │ GW_Armando_plate1_TTGW66        GW_Armando_plate1_TTGW66        SP        lud_Spiti       troch_west          55.0
  62 │ GW_Armando_plate1_TTGW68        GW_Armando_plate1_TTGW68        SP        lud_Spiti       troch_west          55.0
  63 │ GW_Armando_plate1_TTGW70        GW_Armando_plate1_TTGW70        SA        lud_Sathrundi   lud_Sath            41.0
  64 │ GW_Armando_plate1_TTGW71        GW_Armando_plate1_TTGW71        SA        lud_Sathrundi   lud_Sath            41.0
  65 │ GW_Armando_plate1_TTGW72        GW_Armando_plate1_TTGW72        SA        lud_Sathrundi   lud_Sath            41.0
  66 │ GW_Armando_plate1_TTGW74        GW_Armando_plate1_TTGW74        SA        lud_Sathrundi   lud_Sath            41.0
  67 │ GW_Armando_plate1_TTGW78        GW_Armando_plate1_TTGW78        SA        lud_Sathrundi   lud_Sath            41.0
  68 │ GW_Armando_plate1_TTGW_15_05    GW_Armando_plate1_TTGW_15_05    SR        lud_Sural       lud_central         45.0
  69 │ GW_Armando_plate1_TTGW_15_07    GW_Armando_plate1_TTGW_15_07    SR        lud_Sural       lud_central         45.0
  70 │ GW_Armando_plate1_TTGW_15_08    GW_Armando_plate1_TTGW_15_08    SR        lud_Sural       lud_central         45.0
  71 │ GW_Armando_plate1_TTGW_15_09    GW_Armando_plate1_TTGW_15_09    SR        lud_Sural       lud_central         45.0
  72 │ GW_Armando_plate1_UY1           GW_Armando_plate1_UY1           UY        plumb           plumb               87.0
  73 │ GW_Armando_plate2_IL2           GW_Armando_plate2_IL2           IL_rep    plumb_rep       plumb_rep           84.0
  74 │ GW_Armando_plate2_JE31G01       GW_Armando_plate2_JE31G01       VB_vi     vir_misID       vir                 24.002
  75 │ GW_Armando_plate2_JF03G01       GW_Armando_plate2_JF03G01       ST_vi     vir_misID       vir                 24.003
  76 │ GW_Armando_plate2_JF03G02       GW_Armando_plate2_JF03G02       VB_vi     vir_misID       vir                 24.004
  77 │ GW_Armando_plate2_JF07G01       GW_Armando_plate2_JF07G01       ST        plumb           plumb              128.0
  78 │ GW_Armando_plate2_JF08G04       GW_Armando_plate2_JF08G04       ST        plumb           plumb              129.0
  79 │ GW_Armando_plate2_JF10G02       GW_Armando_plate2_JF10G02       ST        plumb           plumb              130.0
  80 │ GW_Armando_plate2_JF11G02       GW_Armando_plate2_JF11G02       ST        plumb           plumb              131.0
  81 │ GW_Armando_plate2_JF12G03       GW_Armando_plate2_JF12G03       ST        plumb           plumb              132.0
  82 │ GW_Armando_plate2_JF12G05       GW_Armando_plate2_JF12G05       ST        plumb           plumb              133.0
  83 │ GW_Armando_plate2_JF13G02       GW_Armando_plate2_JF13G02       ST        plumb           plumb              134.0
  84 │ GW_Armando_plate2_JF14G01       GW_Armando_plate2_JF14G01       DV        plumb           plumb              104.0
  85 │ GW_Armando_plate2_JF14G02       GW_Armando_plate2_JF14G02       DV        plumb           plumb              105.0
  86 │ GW_Armando_plate2_JF15G01       GW_Armando_plate2_JF15G01       DV        plumb           plumb              106.0
  87 │ GW_Armando_plate2_JF15G02       GW_Armando_plate2_JF15G02       DV        plumb           plumb              107.0
  88 │ GW_Armando_plate2_JF16G02       GW_Armando_plate2_JF16G02       DV_vi     plumb_vir       vir                 24.042
  89 │ GW_Armando_plate2_JF19G01       GW_Armando_plate2_JF19G01       MB        plumb           plumb               96.0
  90 │ GW_Armando_plate2_JF20G02       GW_Armando_plate2_JF20G02       MB        plumb           plumb               97.0
  91 │ GW_Armando_plate2_JF24G01       GW_Armando_plate2_JF24G01       VB        plumb           plumb              101.0
  92 │ GW_Armando_plate2_JF24G03       GW_Armando_plate2_JF24G03       ST        plumb           plumb              135.0
  93 │ GW_Armando_plate2_JF25G01       GW_Armando_plate2_JF25G01       VB        plumb           plumb              102.0
  94 │ GW_Armando_plate2_JF26G02       GW_Armando_plate2_JF26G02       ST        plumb           plumb              136.0
  95 │ GW_Armando_plate2_JF27G02       GW_Armando_plate2_JF27G02       ST        plumb           plumb              137.0
  96 │ GW_Armando_plate2_JF30G01       GW_Armando_plate2_JF30G01       ST_vi     vir_misID       vir                 24.005
  97 │ GW_Armando_plate2_JG01G01       GW_Armando_plate2_JG01G01       PR        plumb           plumb              147.0
  98 │ GW_Armando_plate2_JG02G01       GW_Armando_plate2_JG02G01       PR        plumb           plumb              148.0
  99 │ GW_Armando_plate2_JG02G03       GW_Armando_plate2_JG02G03       PR        plumb           plumb              149.0
 100 │ GW_Armando_plate2_JG10G02       GW_Armando_plate2_JG10G02       ST        plumb           plumb              138.0
 101 │ GW_Armando_plate2_JG10G03       GW_Armando_plate2_JG10G03       ST        plumb           plumb              139.0
 102 │ GW_Armando_plate2_JG12G02       GW_Armando_plate2_JG12G02       ST        plumb           plumb              140.0
 103 │ GW_Armando_plate2_JG12G03       GW_Armando_plate2_JG12G03       ST        plumb           plumb              141.0
 104 │ GW_Armando_plate2_LN11          GW_Armando_plate2_LN11          LN_rep    troch_LN_rep    troch_LN_rep        65.01
 105 │ GW_Armando_plate2_LN2           GW_Armando_plate2_LN2           LN        troch_LN        troch_LN            58.01
 106 │ GW_Armando_plate2_NO_BC_TTGW05  GW_Armando_plate2_NO_BC_TTGW05  blank     blank           blank              -99.0
 107 │ GW_Armando_plate2_NO_DNA        GW_Armando_plate2_NO_DNA        blank     blank           blank              -99.0
 108 │ GW_Armando_plate2_RF29G01       GW_Armando_plate2_RF29G01       BJ        obs_plumb       plumb_BJ            77.503
 109 │ GW_Armando_plate2_TTGW02        GW_Armando_plate2_TTGW02        MN        troch_MN        troch_west          53.0
 110 │ GW_Armando_plate2_TTGW03        GW_Armando_plate2_TTGW03        MN        troch_MN        troch_west          53.0
 111 │ GW_Armando_plate2_TTGW05_rep3   GW_Armando_plate2_TTGW05_rep3   MN_rep    troch_MN_rep    troch_west_rep      53.0
 112 │ GW_Armando_plate2_TTGW05_rep4   GW_Armando_plate2_TTGW05_rep4   MN_rep    troch_MN_rep    troch_west_rep      53.0
 113 │ GW_Armando_plate2_TTGW08        GW_Armando_plate2_TTGW08        SU        lud_Sukhto      lud_central         47.0
 114 │ GW_Armando_plate2_TTGW09        GW_Armando_plate2_TTGW09        SU        lud_Sukhto      lud_central         47.0
 115 │ GW_Armando_plate2_TTGW12        GW_Armando_plate2_TTGW12        TH        lud_Thallighar  lud_central         43.0
 116 │ GW_Armando_plate2_TTGW14        GW_Armando_plate2_TTGW14        TH        lud_Thallighar  lud_central         43.0
 117 │ GW_Armando_plate2_TTGW15        GW_Armando_plate2_TTGW15        TH        lud_Thallighar  lud_central         43.0
 118 │ GW_Armando_plate2_TTGW16        GW_Armando_plate2_TTGW16        TH        lud_Thallighar  lud_central         43.0
 119 │ GW_Armando_plate2_TTGW18        GW_Armando_plate2_TTGW18        TH        lud_Thallighar  lud_central         43.0
 120 │ GW_Armando_plate2_TTGW20        GW_Armando_plate2_TTGW20        SR        lud_Sural       lud_central         45.0
 121 │ GW_Armando_plate2_TTGW24        GW_Armando_plate2_TTGW24        SR        lud_Sural       lud_central         45.0
 122 │ GW_Armando_plate2_TTGW25        GW_Armando_plate2_TTGW25        SR        lud_Sural       lud_central         45.0
 123 │ GW_Armando_plate2_TTGW27        GW_Armando_plate2_TTGW27        SR        lud_Sural       lud_central         45.0
 124 │ GW_Armando_plate2_TTGW28        GW_Armando_plate2_TTGW28        SR        lud_Sural       lud_central         45.0
 125 │ GW_Armando_plate2_TTGW50        GW_Armando_plate2_TTGW50        NG        lud_Nainaghar   lud_central         49.0
 126 │ GW_Armando_plate2_TTGW51        GW_Armando_plate2_TTGW51        NG        lud_Nainaghar   lud_central         49.0
 127 │ GW_Armando_plate2_TTGW54        GW_Armando_plate2_TTGW54        NG        lud_Nainaghar   lud_central         49.0
 128 │ GW_Armando_plate2_TTGW56        GW_Armando_plate2_TTGW56        NG        lud_Nainaghar   lud_central         49.0
 129 │ GW_Armando_plate2_TTGW60        GW_Armando_plate2_TTGW60        SP        lud_Spiti       troch_west          55.0
 130 │ GW_Armando_plate2_TTGW61        GW_Armando_plate2_TTGW61        SP        lud_Spiti       troch_west          55.0
 131 │ GW_Armando_plate2_TTGW62        GW_Armando_plate2_TTGW62        SP        lud_Spiti       troch_west          55.0
 132 │ GW_Armando_plate2_TTGW67        GW_Armando_plate2_TTGW67        SP        lud_Spiti       troch_west          55.0
 133 │ GW_Armando_plate2_TTGW69        GW_Armando_plate2_TTGW69        SP        lud_Spiti       troch_west          55.0
 134 │ GW_Armando_plate2_TTGW73        GW_Armando_plate2_TTGW73        SA        lud_Sathrundi   lud_Sath            41.0
 135 │ GW_Armando_plate2_TTGW75        GW_Armando_plate2_TTGW75        SA        lud_Sathrundi   lud_Sath            41.0
 136 │ GW_Armando_plate2_TTGW77        GW_Armando_plate2_TTGW77        SA        lud_Sathrundi   lud_Sath            41.0
 137 │ GW_Armando_plate2_TTGW79        GW_Armando_plate2_TTGW79        SA        lud_Sathrundi   lud_Sath            41.0
 138 │ GW_Armando_plate2_TTGW80        GW_Armando_plate2_TTGW80        SA        lud_Sathrundi   lud_Sath            41.0
 139 │ GW_Armando_plate2_TTGW_15_01    GW_Armando_plate2_TTGW_15_01    SR        lud_Sural       lud_central         45.0
 140 │ GW_Armando_plate2_TTGW_15_02    GW_Armando_plate2_TTGW_15_02    SR        lud_Sural       lud_central         45.0
 141 │ GW_Armando_plate2_TTGW_15_03    GW_Armando_plate2_TTGW_15_03    SR        lud_Sural       lud_central         45.0
 142 │ GW_Armando_plate2_TTGW_15_04    GW_Armando_plate2_TTGW_15_04    SR        lud_Sural       lud_central         45.0
 143 │ GW_Armando_plate2_TTGW_15_06    GW_Armando_plate2_TTGW_15_06    SR        lud_Sural       lud_central         45.0
 144 │ GW_Armando_plate2_TTGW_15_10    GW_Armando_plate2_TTGW_15_10    SR        lud_Sural       lud_central         45.0
 145 │ GW_Lane5_AA1                    GW_Lane5_AA1                    AA        vir_S           vir_S               25.0
 146 │ GW_Lane5_AA10                   GW_Lane5_AA10                   AA        vir_S           vir_S               33.0
 147 │ GW_Lane5_AA11                   GW_Lane5_AA11                   AA        vir_S           vir_S               34.0
 148 │ GW_Lane5_AA3                    GW_Lane5_AA3                    AA        vir_S           vir_S               26.0
 149 │ GW_Lane5_AA4                    GW_Lane5_AA4                    AA        vir_S           vir_S               27.0
 150 │ GW_Lane5_AA5                    GW_Lane5_AA5                    AA        vir_S           vir_S               28.0
 151 │ GW_Lane5_AA6                    GW_Lane5_AA6                    AA        vir_S           vir_S               29.0
 152 │ GW_Lane5_AA7                    GW_Lane5_AA7                    AA        vir_S           vir_S               30.0
 153 │ GW_Lane5_AA8                    GW_Lane5_AA8                    AA        vir_S           vir_S               31.0
 154 │ GW_Lane5_AA9                    GW_Lane5_AA9                    AA        vir_S           vir_S               32.0
 155 │ GW_Lane5_AB1                    GW_Lane5_AB1                    AB_rep    vir_rep         vir_rep             20.0
 156 │ GW_Lane5_AB2                    GW_Lane5_AB2                    AB        vir             vir                 21.0
 157 │ GW_Lane5_AN1                    GW_Lane5_AN1                    AN        plumb           plumb               80.0
 158 │ GW_Lane5_AN2                    GW_Lane5_AN2                    AN        plumb           plumb               81.0
 159 │ GW_Lane5_BK2                    GW_Lane5_BK2                    BK        plumb           plumb               78.0
 160 │ GW_Lane5_BK3                    GW_Lane5_BK3                    BK        plumb           plumb               79.0
 161 │ GW_Lane5_DA2                    GW_Lane5_DA2                    XN        obs             obs                 73.0
 162 │ GW_Lane5_DA3                    GW_Lane5_DA3                    XN        obs             obs                 74.0
 163 │ GW_Lane5_DA4                    GW_Lane5_DA4                    XN        obs             obs                 75.0
 164 │ GW_Lane5_DA6                    GW_Lane5_DA6                    XN        obs             low_reads           76.0
 165 │ GW_Lane5_DA7                    GW_Lane5_DA7                    XN        obs             obs                 77.0
 166 │ GW_Lane5_EM1                    GW_Lane5_EM1                    EM        troch_EM        troch_EM            72.0
 167 │ GW_Lane5_IL1                    GW_Lane5_IL1                    IL        plumb           plumb               82.0
 168 │ GW_Lane5_IL2                    GW_Lane5_IL2                    IL_rep    plumb_rep       plumb_rep           85.0
 169 │ GW_Lane5_IL4                    GW_Lane5_IL4                    IL        plumb           plumb               83.0
 170 │ GW_Lane5_KS1                    GW_Lane5_KS1                    OV        lud_KS          lud_KS              40.0
 171 │ GW_Lane5_KS2                    GW_Lane5_KS2                    OV        lud_KS          lud_KS              40.0
 172 │ GW_Lane5_LN1                    GW_Lane5_LN1                    LN        troch_LN        troch_LN            57.0
 173 │ GW_Lane5_LN10                   GW_Lane5_LN10                   LN        troch_LN        troch_LN            64.0
 174 │ GW_Lane5_LN11                   GW_Lane5_LN11                   LN        troch_LN        troch_LN            65.0
 175 │ GW_Lane5_LN12                   GW_Lane5_LN12                   LN        troch_LN        troch_LN            66.0
 176 │ GW_Lane5_LN14                   GW_Lane5_LN14                   LN        troch_LN        troch_LN            67.0
 177 │ GW_Lane5_LN16                   GW_Lane5_LN16                   LN        troch_LN        troch_LN            68.0
 178 │ GW_Lane5_LN18                   GW_Lane5_LN18                   LN        troch_LN        troch_LN            69.0
 179 │ GW_Lane5_LN19                   GW_Lane5_LN19                   LN        troch_LN        troch_LN            70.0
 180 │ GW_Lane5_LN2                    GW_Lane5_LN2                    LN_rep    troch_LN_rep    troch_LN_rep        58.0
 181 │ GW_Lane5_LN20                   GW_Lane5_LN20                   LN        troch_LN        troch_LN            71.0
 182 │ GW_Lane5_LN3                    GW_Lane5_LN3                    LN        troch_LN        troch_LN            59.0
 183 │ GW_Lane5_LN4                    GW_Lane5_LN4                    LN        troch_LN        troch_LN            60.0
 184 │ GW_Lane5_LN6                    GW_Lane5_LN6                    LN        troch_LN        troch_LN            61.0
 185 │ GW_Lane5_LN7                    GW_Lane5_LN7                    LN        troch_LN        troch_LN            62.0
 186 │ GW_Lane5_LN8                    GW_Lane5_LN8                    LN        troch_LN        troch_LN            63.0
 187 │ GW_Lane5_MN1                    GW_Lane5_MN1                    MN        troch_MN        troch_west          51.0
 188 │ GW_Lane5_MN12                   GW_Lane5_MN12                   MN        troch_MN        troch_west          56.0
 189 │ GW_Lane5_MN3                    GW_Lane5_MN3                    MN        troch_MN        troch_west          52.0
 190 │ GW_Lane5_MN5                    GW_Lane5_MN5                    MN        troch_MN        troch_west          53.0
 191 │ GW_Lane5_MN8                    GW_Lane5_MN8                    MN        troch_MN        troch_west          54.0
 192 │ GW_Lane5_MN9                    GW_Lane5_MN9                    MN        troch_MN        troch_west          55.0
 193 │ GW_Lane5_NA1                    GW_Lane5_NA1                    NR        lud_PK          lud_PK              39.2
 194 │ GW_Lane5_NA3-3ul                GW_Lane5_NA3-3ul                NR        lud_PK          lud_PK              39.2
 195 │ GW_Lane5_PT11                   GW_Lane5_PT11                   KL        lud_KL          lud_central         42.0
 196 │ GW_Lane5_PT12                   GW_Lane5_PT12                   KL        lud_KL          lud_central         42.0
 197 │ GW_Lane5_PT2                    GW_Lane5_PT2                    ML        lud_ML          lud_ML              51.0
 198 │ GW_Lane5_PT3                    GW_Lane5_PT3                    PA        lud_PA          lud_central         46.0
 199 │ GW_Lane5_PT4                    GW_Lane5_PT4                    PA        lud_PA          lud_central         46.0
 200 │ GW_Lane5_PT6                    GW_Lane5_PT6                    KL        lud_KL          lud_central         42.0
 201 │ GW_Lane5_SH1                    GW_Lane5_SH1                    SH        lud_PK          lud_PK              39.1
 202 │ GW_Lane5_SH2                    GW_Lane5_SH2                    SH        lud_PK          lud_PK              39.1
 203 │ GW_Lane5_SH4                    GW_Lane5_SH4                    SH        lud_PK          lud_PK              39.1
 204 │ GW_Lane5_SH5                    GW_Lane5_SH5                    SH        lud_PK          lud_PK              39.1
 205 │ GW_Lane5_SL1                    GW_Lane5_SL1                    SL        plumb           plumb              150.0
 206 │ GW_Lane5_SL2                    GW_Lane5_SL2                    SL        plumb           plumb              151.0
 207 │ GW_Lane5_ST1                    GW_Lane5_ST1                    ST        plumb           plumb              142.0
 208 │ GW_Lane5_ST12                   GW_Lane5_ST12                   ST        plumb           plumb              144.0
 209 │ GW_Lane5_ST3                    GW_Lane5_ST3                    ST        plumb           plumb              143.0
 210 │ GW_Lane5_STvi1                  GW_Lane5_STvi1                  ST_vi     vir             vir                 22.0
 211 │ GW_Lane5_STvi2                  GW_Lane5_STvi2                  ST_vi     vir             vir                 23.0
 212 │ GW_Lane5_STvi3                  GW_Lane5_STvi3                  ST_vi     vir             vir                 24.0
 213 │ GW_Lane5_TA1                    GW_Lane5_TA1                    TA        plumb           plumb               86.0
 214 │ GW_Lane5_TL1                    GW_Lane5_TL1                    TL        vir             vir                  9.0
 215 │ GW_Lane5_TL10                   GW_Lane5_TL10                   TL        vir             vir                 17.0
 216 │ GW_Lane5_TL11                   GW_Lane5_TL11                   TL        vir             vir                 18.0
 217 │ GW_Lane5_TL12                   GW_Lane5_TL12                   TL        vir             vir                 19.0
 218 │ GW_Lane5_TL2                    GW_Lane5_TL2                    TL        vir             vir                 10.0
 219 │ GW_Lane5_TL3                    GW_Lane5_TL3                    TL_rep    vir_rep         vir_rep             11.0
 220 │ GW_Lane5_TL4                    GW_Lane5_TL4                    TL        vir             vir                 12.0
 221 │ GW_Lane5_TL5                    GW_Lane5_TL5                    TL        vir             vir                 13.0
 222 │ GW_Lane5_TL7                    GW_Lane5_TL7                    TL        vir             vir                 14.0
 223 │ GW_Lane5_TL8                    GW_Lane5_TL8                    TL        vir             vir                 15.0
 224 │ GW_Lane5_TL9                    GW_Lane5_TL9                    TL        vir             vir                 16.0
 225 │ GW_Lane5_TU1                    GW_Lane5_TU1                    TU        nit             nit                 35.0
 226 │ GW_Lane5_TU2                    GW_Lane5_TU2                    TU        nit             nit                 36.0
 227 │ GW_Lane5_UY1                    GW_Lane5_UY1                    UY_rep    plumb_rep       plumb_rep           93.0
 228 │ GW_Lane5_UY2                    GW_Lane5_UY2                    UY        plumb           plumb               88.0
 229 │ GW_Lane5_UY3                    GW_Lane5_UY3                    UY        plumb           plumb               89.0
 230 │ GW_Lane5_UY4                    GW_Lane5_UY4                    UY        plumb           plumb               90.0
 231 │ GW_Lane5_UY5                    GW_Lane5_UY5                    UY        plumb           plumb               91.0
 232 │ GW_Lane5_UY6                    GW_Lane5_UY6                    UY        plumb           plumb               92.0
 233 │ GW_Lane5_YK1                    GW_Lane5_YK1                    YK        vir             vir                  1.0
 234 │ GW_Lane5_YK11                   GW_Lane5_YK11                   YK        vir             vir                  8.0
 235 │ GW_Lane5_YK3                    GW_Lane5_YK3                    YK        vir             vir                  2.0
 236 │ GW_Lane5_YK4                    GW_Lane5_YK4                    YK        vir             vir                  3.0
 237 │ GW_Lane5_YK5                    GW_Lane5_YK5                    YK        vir             vir                  4.0
 238 │ GW_Lane5_YK6                    GW_Lane5_YK6                    YK        vir             vir                  5.0
 239 │ GW_Lane5_YK7                    GW_Lane5_YK7                    YK        vir             vir                  6.0
 240 │ GW_Lane5_YK9                    GW_Lane5_YK9                    YK        vir             vir                  7.0
 241 │ GW_Liz_GBS_Liz10045             GW_Liz_GBS_Liz10045             ML        lud             lud_ML              51.01
 242 │ GW_Liz_GBS_Liz10094             GW_Liz_GBS_Liz10094             ML        lud             lud_ML              51.02
 243 │ GW_Liz_GBS_Liz5101              GW_Liz_GBS_Liz5101              ML        lud             lud_ML              51.03
 244 │ GW_Liz_GBS_Liz5101_R            GW_Liz_GBS_Liz5101_R            ML_rep    lud_rep         lud_ML_rep          51.04
 245 │ GW_Liz_GBS_Liz5118              GW_Liz_GBS_Liz5118              ML        lud             lud_ML              51.05
 246 │ GW_Liz_GBS_Liz5139              GW_Liz_GBS_Liz5139              ML        lud             lud_ML              51.06
 247 │ GW_Liz_GBS_Liz5142              GW_Liz_GBS_Liz5142              ML        lud             lud_ML              51.07
 248 │ GW_Liz_GBS_Liz5144              GW_Liz_GBS_Liz5144              ML        lud             lud_ML              51.08
 249 │ GW_Liz_GBS_Liz5150              GW_Liz_GBS_Liz5150              ML        lud             lud_ML              51.09
 250 │ GW_Liz_GBS_Liz5159              GW_Liz_GBS_Liz5159              ML        lud_chick       lud_ML              51.1
 251 │ GW_Liz_GBS_Liz5162              GW_Liz_GBS_Liz5162              ML        lud_chick       lud_ML              51.11
 252 │ GW_Liz_GBS_Liz5163              GW_Liz_GBS_Liz5163              ML        lud_chick       lud_ML              51.12
 253 │ GW_Liz_GBS_Liz5164              GW_Liz_GBS_Liz5164              ML        lud_chick       lud_ML              51.13
 254 │ GW_Liz_GBS_Liz5165              GW_Liz_GBS_Liz5165              ML        lud             lud_ML              51.14
 255 │ GW_Liz_GBS_Liz5167              GW_Liz_GBS_Liz5167              ML        lud_chick       lud_ML              51.15
 256 │ GW_Liz_GBS_Liz5168              GW_Liz_GBS_Liz5168              ML        lud_chick       lud_ML              51.16
 257 │ GW_Liz_GBS_Liz5169              GW_Liz_GBS_Liz5169              ML        lud_chick       lud_ML              51.17
 258 │ GW_Liz_GBS_Liz5171              GW_Liz_GBS_Liz5171              ML        lud             lud_ML              51.18
 259 │ GW_Liz_GBS_Liz5172              GW_Liz_GBS_Liz5172              ML        lud_chick       lud_ML              51.19
 260 │ GW_Liz_GBS_Liz5173              GW_Liz_GBS_Liz5173              ML        lud_chick       lud_ML              51.2
 261 │ GW_Liz_GBS_Liz5174              GW_Liz_GBS_Liz5174              ML        lud             lud_ML              51.21
 262 │ GW_Liz_GBS_Liz5175              GW_Liz_GBS_Liz5175              ML        lud             lud_ML              51.22
 263 │ GW_Liz_GBS_Liz5176              GW_Liz_GBS_Liz5176              ML        lud             lud_ML              51.23
 264 │ GW_Liz_GBS_Liz5177              GW_Liz_GBS_Liz5177              ML        lud_chick       lud_ML              51.24
 265 │ GW_Liz_GBS_Liz5178              GW_Liz_GBS_Liz5178              ML        lud_chick       lud_ML              51.25
 266 │ GW_Liz_GBS_Liz5179              GW_Liz_GBS_Liz5179              ML        lud_chick       lud_ML              51.26
 267 │ GW_Liz_GBS_Liz5180              GW_Liz_GBS_Liz5180              ML        lud             lud_ML              51.27
 268 │ GW_Liz_GBS_Liz5182              GW_Liz_GBS_Liz5182              ML        lud_chick       lud_ML              51.28
 269 │ GW_Liz_GBS_Liz5184              GW_Liz_GBS_Liz5184              ML        lud_chick       lud_ML              51.29
 270 │ GW_Liz_GBS_Liz5185              GW_Liz_GBS_Liz5185              ML        lud             lud_ML              51.3
 271 │ GW_Liz_GBS_Liz5186              GW_Liz_GBS_Liz5186              ML        lud_chick       lud_ML              51.31
 272 │ GW_Liz_GBS_Liz5187              GW_Liz_GBS_Liz5187              ML        lud_chick       lud_ML              51.32
 273 │ GW_Liz_GBS_Liz5188              GW_Liz_GBS_Liz5188              ML        lud             lud_ML              51.33
 274 │ GW_Liz_GBS_Liz5189              GW_Liz_GBS_Liz5189              ML        lud_chick       lud_ML              51.34
 275 │ GW_Liz_GBS_Liz5190              GW_Liz_GBS_Liz5190              ML        lud_chick       lud_ML              51.35
 276 │ GW_Liz_GBS_Liz5191              GW_Liz_GBS_Liz5191              ML        lud_chick       lud_ML              51.36
 277 │ GW_Liz_GBS_Liz5192              GW_Liz_GBS_Liz5192              ML        lud_chick       lud_ML              51.37
 278 │ GW_Liz_GBS_Liz5193              GW_Liz_GBS_Liz5193              ML        lud_chick       lud_ML              51.38
 279 │ GW_Liz_GBS_Liz5194              GW_Liz_GBS_Liz5194              ML        lud_chick       lud_ML              51.39
 280 │ GW_Liz_GBS_Liz5195              GW_Liz_GBS_Liz5195              ML        lud             lud_ML              51.4
 281 │ GW_Liz_GBS_Liz5197              GW_Liz_GBS_Liz5197              ML        lud             lud_ML              51.41
 282 │ GW_Liz_GBS_Liz5199              GW_Liz_GBS_Liz5199              ML        lud_chick       lud_ML              51.42
 283 │ GW_Liz_GBS_Liz6002              GW_Liz_GBS_Liz6002              ML        lud             lud_ML              51.43
 284 │ GW_Liz_GBS_Liz6006              GW_Liz_GBS_Liz6006              ML        lud             lud_ML              51.44
 285 │ GW_Liz_GBS_Liz6008              GW_Liz_GBS_Liz6008              ML        lud             lud_ML              51.45
 286 │ GW_Liz_GBS_Liz6009              GW_Liz_GBS_Liz6009              ML        lud             lud_ML              51.46
 287 │ GW_Liz_GBS_Liz6010              GW_Liz_GBS_Liz6010              ML        lud             lud_ML              51.47
 288 │ GW_Liz_GBS_Liz6012              GW_Liz_GBS_Liz6012              ML        lud             lud_ML              51.48
 289 │ GW_Liz_GBS_Liz6014              GW_Liz_GBS_Liz6014              ML        lud             lud_ML              51.49
 290 │ GW_Liz_GBS_Liz6055              GW_Liz_GBS_Liz6055              ML        lud             lud_ML              51.5
 291 │ GW_Liz_GBS_Liz6057              GW_Liz_GBS_Liz6057              ML        lud             lud_ML              51.51
 292 │ GW_Liz_GBS_Liz6060              GW_Liz_GBS_Liz6060              ML        lud             lud_ML              51.52
 293 │ GW_Liz_GBS_Liz6062              GW_Liz_GBS_Liz6062              ML        lud             lud_ML              51.53
 294 │ GW_Liz_GBS_Liz6063              GW_Liz_GBS_Liz6063              ML        lud             lud_ML              51.54
 295 │ GW_Liz_GBS_Liz6066              GW_Liz_GBS_Liz6066              ML        lud             lud_ML              51.55
 296 │ GW_Liz_GBS_Liz6072              GW_Liz_GBS_Liz6072              ML        lud             lud_ML              51.56
 297 │ GW_Liz_GBS_Liz6079              GW_Liz_GBS_Liz6079              ML        lud             lud_ML              51.57
 298 │ GW_Liz_GBS_Liz6203              GW_Liz_GBS_Liz6203              ML        lud_chick       lud_ML              51.58
 299 │ GW_Liz_GBS_Liz6204              GW_Liz_GBS_Liz6204              ML        lud_chick       lud_ML              51.59
 300 │ GW_Liz_GBS_Liz6461              GW_Liz_GBS_Liz6461              ML        lud             lud_ML              51.6
 301 │ GW_Liz_GBS_Liz6472              GW_Liz_GBS_Liz6472              ML        lud             lud_ML              51.61
 302 │ GW_Liz_GBS_Liz6478              GW_Liz_GBS_Liz6478              ML        lud             lud_ML              51.62
 303 │ GW_Liz_GBS_Liz6766              GW_Liz_GBS_Liz6766              ML        lud             lud_ML              51.63
 304 │ GW_Liz_GBS_Liz6776              GW_Liz_GBS_Liz6776              ML        lud             lud_ML              51.64
 305 │ GW_Liz_GBS_Liz6794              GW_Liz_GBS_Liz6794              ML        lud             lud_ML              51.65
 306 │ GW_Liz_GBS_P_fusc               GW_Liz_GBS_P_fusc               fusc      fusc            fusc               201.0
 307 │ GW_Liz_GBS_P_h_man              GW_Liz_GBS_P_h_man              hmand     hmand           hmand              202.0
 308 │ GW_Liz_GBS_P_humei              GW_Liz_GBS_P_humei              hume      hume            hume               203.0
 309 │ GW_Liz_GBS_P_inor               GW_Liz_GBS_P_inor               inor      inor            inor               204.0
 310 │ GW_Liz_GBS_S_burk               GW_Liz_GBS_S_burk               burk      burk            burk               205.0

GOOD NEWS: names of individuals in metadata file and genotype ind file match perfectly.</code></pre>
</div>
</div>
</section>
<section id="polish-a-few-individual-names-to-match-those-in-other-metadata-object-above-and-make-more-readable-graphs-1" class="level3">
<h3 class="anchored" data-anchor-id="polish-a-few-individual-names-to-match-those-in-other-metadata-object-above-and-make-more-readable-graphs-1">Polish a few individual names (to match those in other metadata object above, and make more readable graphs):</h3>
<div id="4114e49c" class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb519"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chr3.ind <span class="op">=</span> <span class="fu">correctNames</span>(ind_with_metadata_chr3.ind)</span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-3"><a href="#cb519-3" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chr3.ID <span class="op">=</span> <span class="fu">correctNames</span>(ind_with_metadata_chr3.ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="193">
<pre><code>310-element Vector{String}:
 "GW_Armando_plate1_AB1"
 "GW_Armando_plate1_JF07G02"
 "GW_Armando_plate1_JF07G03"
 "GW_Armando_plate1_JF07G04"
 "GW_Armando_plate1_JF08G02"
 "GW_Armando_plate1_JF09G01"
 "GW_Armando_plate1_JF09G02"
 "GW_Armando_plate1_JF10G03"
 "GW_Armando_plate1_JF11G01"
 "GW_Armando_plate1_JF12G01"
 "GW_Armando_plate1_JF12G02"
 "GW_Armando_plate1_JF12G04"
 "GW_Armando_plate1_JF13G01"
 ⋮
 "GW_Liz_GBS_Liz6204"
 "GW_Liz_GBS_Liz6461"
 "GW_Liz_GBS_Liz6472"
 "GW_Liz_GBS_Liz6478"
 "GW_Liz_GBS_Liz6766"
 "GW_Liz_GBS_Liz6776"
 "GW_Liz_GBS_Liz6794"
 "GW_Liz_GBS_P_fusc"
 "GW_Liz_GBS_P_h_man"
 "GW_Liz_GBS_P_humei"
 "GW_Liz_GBS_P_inor"
 "GW_Liz_GBS_S_burk"</code></pre>
</div>
</div>
</section>
<section id="filter-to-just-the-individuals-also-included-in-the-analysis-of-lhbrs-above-1" class="level3">
<h3 class="anchored" data-anchor-id="filter-to-just-the-individuals-also-included-in-the-analysis-of-lhbrs-above-1">Filter to just the individuals also included in the analysis of LHBRs above</h3>
<div id="323dc979" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb521"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> <span class="fu">map</span>(<span class="fu">in</span>(ind_with_metadata_included.ind), ind_with_metadata_chr3.ind)</span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chr3_included <span class="op">=</span> ind_with_metadata_chr3[selection, <span class="op">:</span>]</span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-5"><a href="#cb521-5" aria-hidden="true" tabindex="-1"></a><span class="co"># select genotypes of just the included individuals, and ignore first column</span></span>
<span id="cb521-6"><a href="#cb521-6" aria-hidden="true" tabindex="-1"></a>geno_chr3_included <span class="op">=</span> geno_chr3[selection, <span class="fl">2</span><span class="op">:</span><span class="kw">end</span>]</span>
<span id="cb521-7"><a href="#cb521-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-8"><a href="#cb521-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb521-9"><a href="#cb521-9" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(ind_with_metadata_included.gw3_cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>["virLud", "plumb", "plumb", "plumb", "plumb", "plumb", "plumbHet", "plumb", "plumb", "plumbHet", "plumb", "virLud", "plumb", "plumb", "virLud", "plumb", "plumb", "plumb", "plumb", "plumb", "plumb", "plumb", "plumb", "plumb", "plumb", "vir_plumb", "plumb", "plumb", "plumb", "plumb", "plumb", "plumb", "virLud", "trochObs", "trochObs", "virLud", "virLud_trochObs", "virLud_trochObs", "virLud_trochObs", "virLud_trochObs", "virLud", "virLud_trochObs", "virLud_trochObs", "virLud_trochObs", "virLud_trochObs", "virLud_trochObs", "virLud_trochObs", "trochObs", "virLud", "virLudHet", "virLud_trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "virLud_trochObs", "virLud_trochObs", "virLud", "virLud_trochObs", "plumb", "virLud", "virLudHet", "virLud", "plumb", "plumb", "plumb", "plumbHet", "plumb", "plumb", "plumb", "plumb", "vir_plumb", "plumb", "plumb", "virLud", "plumb", "plumb", "plumbHet", "plumb", "plumbHet", "plumbHet", "plumb", "virLud", "plumbHet", "plumb", "plumb", "plumb", "vir_plumb", "plumb", "plumb", "trochObs", "plumb", "trochObs", "trochObs", "virLudHet", "virLud_trochObs", "virLudHet", "virLud_trochObs", "virLud", "virLud", "virLud", "virLudHet", "virLud", "virLudHet", "virLudHet", "virLud_trochObs", "virLud", "virLud", "trochObsHet", "trochObs", "trochObs", "trochObs", "trochObs", "trochObsHet", "trochObs", "trochObs", "trochObs", "trochObs", "virLud", "virLud", "virLud", "virLud", "virLud_trochObs", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "plumb", "plumb", "plumb", "plumb", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "plumb", "plumb", "virLud", "virLud", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "virLud_trochObs", "trochObs", "trochObs", "virLud", "virLud", "virLud_trochObs", "virLud", "trochObs", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "plumb", "plumb", "plumb", "plumb", "plumb", "virLud", "virLud", "virLud", "plumb", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "nit", "nit", "plumb", "plumb", "plumb", "plumb", "plumb", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "virLud", "trochObs", "trochObs", "trochObs", "trochObs", "virLud_trochObs", "virLud_trochObs", "trochObs", "virLud_trochObs", "trochObs", "virLud_trochObs", "virLud_trochObs", "virLud_trochObs", "trochObs", "virLud_trochObs", "trochObs", "virLud_trochObs", "trochObs", "trochObs", "virLud_trochObs", "trochObsHet", "trochObs", "virLud_trochObs", "virLud_trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "virLud_trochObs", "virLud_trochObs", "virLud_trochObs", "trochObs", "virLud_trochObs", "trochObs", "trochObs", "trochObs", "virLud_trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs", "trochObs"]</code></pre>
</div>
</div>
</section>
<section id="look-up-the-chr-3-individual-membership-in-homozygous-clusters-and-calculate-pi-and-dxy" class="level3">
<h3 class="anchored" data-anchor-id="look-up-the-chr-3-individual-membership-in-homozygous-clusters-and-calculate-pi-and-dxy">Look up the chr 3 individual membership in homozygous clusters, and calculate pi and Dxy</h3>
<div id="17d780e2" class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>indClusterMembership_gw3 <span class="op">=</span> ind_with_metadata_included.gw3_cluster</span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true" tabindex="-1"></a>clusterNames_gw3 <span class="op">=</span> [<span class="st">"virLud"</span>,</span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"nit"</span>,</span>
<span id="cb523-5"><a href="#cb523-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"trochObs"</span>,</span>
<span id="cb523-6"><a href="#cb523-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"plumb"</span>]</span>
<span id="cb523-7"><a href="#cb523-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-8"><a href="#cb523-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get boundaries of gw3 LHBR:</span></span>
<span id="cb523-9"><a href="#cb523-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-10"><a href="#cb523-10" aria-hidden="true" tabindex="-1"></a>chr <span class="op">=</span> <span class="st">"gw3"</span></span>
<span id="cb523-11"><a href="#cb523-11" aria-hidden="true" tabindex="-1"></a>positionMin_chr3_LHBR, positionMax_chr3_LHBR, regionText, </span>
<span id="cb523-12"><a href="#cb523-12" aria-hidden="true" tabindex="-1"></a>    windowedIndHetStanRegion, meanAcrossRegionIndHetStan,</span>
<span id="cb523-13"><a href="#cb523-13" aria-hidden="true" tabindex="-1"></a>    genos_highViSHetRegion, pos_highViSHetRegion, regionInfo <span class="op">=</span> </span>
<span id="cb523-14"><a href="#cb523-14" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">getWindowedIndHetStanRegion</span>(genosOnly_included, </span>
<span id="cb523-15"><a href="#cb523-15" aria-hidden="true" tabindex="-1"></a>                                                    pos_SNP_filtered, </span>
<span id="cb523-16"><a href="#cb523-16" aria-hidden="true" tabindex="-1"></a>                                                    highViSHetRegions, chr;</span>
<span id="cb523-17"><a href="#cb523-17" aria-hidden="true" tabindex="-1"></a>                                                    windowSize <span class="op">=</span> <span class="fl">500</span>)</span>
<span id="cb523-18"><a href="#cb523-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-19"><a href="#cb523-19" aria-hidden="true" tabindex="-1"></a><span class="co"># select the loci within the gw3 LHBR:</span></span>
<span id="cb523-20"><a href="#cb523-20" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> (positionMin_chr3_LHBR <span class="op">.&lt;=</span> pos_chr3.position <span class="op">.&lt;=</span> positionMax_chr3_LHBR) </span>
<span id="cb523-21"><a href="#cb523-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-22"><a href="#cb523-22" aria-hidden="true" tabindex="-1"></a>geno_chr3_included_LHBR <span class="op">=</span> geno_chr3_included[<span class="op">:</span>, selection]</span>
<span id="cb523-23"><a href="#cb523-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-24"><a href="#cb523-24" aria-hidden="true" tabindex="-1"></a>pos_chr3_LHBR <span class="op">=</span> pos_chr3[selection, <span class="op">:</span>]</span>
<span id="cb523-25"><a href="#cb523-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-26"><a href="#cb523-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb523-27"><a href="#cb523-27" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(geno_chr3_included_LHBR, indClusterMembership_gw3, clusterNames_gw3)</span>
<span id="cb523-28"><a href="#cb523-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-29"><a href="#cb523-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb523-30"><a href="#cb523-30" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb523-31"><a href="#cb523-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-32"><a href="#cb523-32" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb523-33"><a href="#cb523-33" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames_gw3)</span>
<span id="cb523-34"><a href="#cb523-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-35"><a href="#cb523-35" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames_gw3; among<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb523-36"><a href="#cb523-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-37"><a href="#cb523-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for chr 3 LHBR:</span></span>
<span id="cb523-38"><a href="#cb523-38" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames_gw3, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb523-39"><a href="#cb523-39" aria-hidden="true" tabindex="-1"></a><span class="co">#= 4×2 DataFrame</span></span>
<span id="cb523-40"><a href="#cb523-40" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster   pi          </span></span>
<span id="cb523-41"><a href="#cb523-41" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String    Float64     </span></span>
<span id="cb523-42"><a href="#cb523-42" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼───────────────────────</span></span>
<span id="cb523-43"><a href="#cb523-43" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud    0.0012486</span></span>
<span id="cb523-44"><a href="#cb523-44" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit       0.000697639</span></span>
<span id="cb523-45"><a href="#cb523-45" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ trochObs  0.00136251</span></span>
<span id="cb523-46"><a href="#cb523-46" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ plumb     0.00111764 =#</span></span>
<span id="cb523-47"><a href="#cb523-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-48"><a href="#cb523-48" aria-hidden="true" tabindex="-1"></a><span class="co"># average pi (for chr 3 LHBR) among three major groups:</span></span>
<span id="cb523-49"><a href="#cb523-49" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.0012486</span> <span class="op">+</span> <span class="fl">0.00136251</span> <span class="op">+</span> <span class="fl">0.00111764</span>) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb523-50"><a href="#cb523-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.0012429166</span></span>
<span id="cb523-51"><a href="#cb523-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-52"><a href="#cb523-52" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb523-53"><a href="#cb523-53" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb523-54"><a href="#cb523-54" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair     Dxy        </span></span>
<span id="cb523-55"><a href="#cb523-55" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String           Float64    </span></span>
<span id="cb523-56"><a href="#cb523-56" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────────</span></span>
<span id="cb523-57"><a href="#cb523-57" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit       0.0026694</span></span>
<span id="cb523-58"><a href="#cb523-58" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_trochObs  0.00354486</span></span>
<span id="cb523-59"><a href="#cb523-59" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_plumb     0.00398499</span></span>
<span id="cb523-60"><a href="#cb523-60" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ nit_trochObs     0.00335481</span></span>
<span id="cb523-61"><a href="#cb523-61" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_plumb        0.00400019</span></span>
<span id="cb523-62"><a href="#cb523-62" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ trochObs_plumb   0.00328016 =#</span></span>
<span id="cb523-63"><a href="#cb523-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-64"><a href="#cb523-64" aria-hidden="true" tabindex="-1"></a><span class="co"># average Dxy (for chr 3 LHBR) among three major groups:</span></span>
<span id="cb523-65"><a href="#cb523-65" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.00354486</span> <span class="op">+</span> <span class="fl">0.00398499</span> <span class="op">+</span> <span class="fl">0.00328016</span>) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb523-66"><a href="#cb523-66" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.0036033366666666663</span></span>
<span id="cb523-67"><a href="#cb523-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-68"><a href="#cb523-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Drawing phylogeny (in Illustrator) based on above, between three major groups.</span></span>
<span id="cb523-69"><a href="#cb523-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Lowest Dxy is between trochObs and plumb (0.00328016).</span></span>
<span id="cb523-70"><a href="#cb523-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculation of deepest split, an average of virLud diff with (trochObs, plumb):</span></span>
<span id="cb523-71"><a href="#cb523-71" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.00354486</span> <span class="op">+</span> <span class="fl">0.00398499</span>) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb523-72"><a href="#cb523-72" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.003764925</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>More than 1 region on that scaffold. Using just the longest one.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><div style="float: left;"><span>2×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionChrom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionStart</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">regionEnd</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">gw3</td>
<td style="text-align: right;">101192949</td>
<td style="text-align: right;">103495514</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">gw3</td>
<td style="text-align: right;">104554714</td>
<td style="text-align: right;">108279595</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="195">
<pre><code>0.0037649249999999997</code></pre>
</div>
</div>
</section>
<section id="calculate-pi-and-dxy-outside-of-the-chr-3-lhbr-grouped-by-the-lhbr-homozygous-groups" class="level3">
<h3 class="anchored" data-anchor-id="calculate-pi-and-dxy-outside-of-the-chr-3-lhbr-grouped-by-the-lhbr-homozygous-groups">Calculate pi and Dxy outside of the chr 3 LHBR (grouped by the LHBR homozygous groups)</h3>
<div id="6a227f2d" class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the loci outside of the gw3 LHBR:</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> .!(positionMin_chr3_LHBR <span class="op">.&lt;=</span> pos_chr3.position <span class="op">.&lt;=</span> positionMax_chr3_LHBR) </span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a>geno_chr3_included_nonLHBR <span class="op">=</span> geno_chr3_included[<span class="op">:</span>, selection]</span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true" tabindex="-1"></a>pos_chr3_nonLHBR <span class="op">=</span> pos_chr3[selection, <span class="op">:</span>]</span>
<span id="cb526-7"><a href="#cb526-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-8"><a href="#cb526-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes</span></span>
<span id="cb526-9"><a href="#cb526-9" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(geno_chr3_included_nonLHBR, indClusterMembership_gw3, clusterNames_gw3)</span>
<span id="cb526-10"><a href="#cb526-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-11"><a href="#cb526-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate per-site pi (within-group nucleotide distance)</span></span>
<span id="cb526-12"><a href="#cb526-12" aria-hidden="true" tabindex="-1"></a>sitePi <span class="op">=</span> <span class="fu">getSitePi</span>(freqs, sampleSizes)</span>
<span id="cb526-13"><a href="#cb526-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-14"><a href="#cb526-14" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pairwise Dxy per site, using data in "freqs" and groups in "groups"</span></span>
<span id="cb526-15"><a href="#cb526-15" aria-hidden="true" tabindex="-1"></a>Dxy, pairwiseDxyClusterNames <span class="op">=</span> <span class="fu">getDxy</span>(freqs, clusterNames_gw3)</span>
<span id="cb526-16"><a href="#cb526-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-17"><a href="#cb526-17" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseFstClusterNames <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, clusterNames_gw3; among<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb526-18"><a href="#cb526-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-19"><a href="#cb526-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get averages of pi and Dxy for whole region:</span></span>
<span id="cb526-20"><a href="#cb526-20" aria-hidden="true" tabindex="-1"></a>regionPiTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster <span class="op">=</span> clusterNames_gw3, <span class="cn">pi</span> <span class="op">=</span> <span class="fu">getRegionPi</span>(sitePi))</span>
<span id="cb526-21"><a href="#cb526-21" aria-hidden="true" tabindex="-1"></a><span class="co">#= 4×2 DataFrame</span></span>
<span id="cb526-22"><a href="#cb526-22" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster   pi         </span></span>
<span id="cb526-23"><a href="#cb526-23" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String    Float64    </span></span>
<span id="cb526-24"><a href="#cb526-24" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼──────────────────────</span></span>
<span id="cb526-25"><a href="#cb526-25" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud    0.00456714</span></span>
<span id="cb526-26"><a href="#cb526-26" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ nit       0.00161186</span></span>
<span id="cb526-27"><a href="#cb526-27" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ trochObs  0.00568622</span></span>
<span id="cb526-28"><a href="#cb526-28" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ plumb     0.00554501 =#</span></span>
<span id="cb526-29"><a href="#cb526-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-30"><a href="#cb526-30" aria-hidden="true" tabindex="-1"></a><span class="co"># average pi (for chr 3 NOT in LHBR) among three major groups:</span></span>
<span id="cb526-31"><a href="#cb526-31" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.00456714</span> <span class="op">+</span> <span class="fl">0.00568622</span> <span class="op">+</span> <span class="fl">0.00554501</span>) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb526-32"><a href="#cb526-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.005266123</span></span>
<span id="cb526-33"><a href="#cb526-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-34"><a href="#cb526-34" aria-hidden="true" tabindex="-1"></a><span class="co">#ratio of average pi outside to average pi within chr 3 LHBR:</span></span>
<span id="cb526-35"><a href="#cb526-35" aria-hidden="true" tabindex="-1"></a><span class="fl">0.005266123</span> <span class="op">/</span> <span class="fl">0.0012429166</span></span>
<span id="cb526-36"><a href="#cb526-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.236907769998406</span></span>
<span id="cb526-37"><a href="#cb526-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-38"><a href="#cb526-38" aria-hidden="true" tabindex="-1"></a><span class="co"># percent lower that average pi is within compared to outside LHBR:</span></span>
<span id="cb526-39"><a href="#cb526-39" aria-hidden="true" tabindex="-1"></a><span class="fl">100</span> <span class="op">*</span> (<span class="fl">4.2369078</span> <span class="op">-</span> <span class="fl">1</span>) <span class="op">/</span> <span class="fl">4.2369078</span></span>
<span id="cb526-40"><a href="#cb526-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 76.39788149272448</span></span>
<span id="cb526-41"><a href="#cb526-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-42"><a href="#cb526-42" aria-hidden="true" tabindex="-1"></a><span class="co">#ratio of pi outside to within LHBR:</span></span>
<span id="cb526-43"><a href="#cb526-43" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00456714</span> <span class="op">/</span> <span class="fl">0.0012486</span></span>
<span id="cb526-44"><a href="#cb526-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.6578087457952906</span></span>
<span id="cb526-45"><a href="#cb526-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-46"><a href="#cb526-46" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00568622</span> <span class="op">/</span> <span class="fl">0.00136251</span></span>
<span id="cb526-47"><a href="#cb526-47" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.173341847032315</span></span>
<span id="cb526-48"><a href="#cb526-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-49"><a href="#cb526-49" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00554501</span> <span class="op">/</span> <span class="fl">0.00111764</span></span>
<span id="cb526-50"><a href="#cb526-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.961356071722558</span></span>
<span id="cb526-51"><a href="#cb526-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-52"><a href="#cb526-52" aria-hidden="true" tabindex="-1"></a>((<span class="fl">0.00456714</span> <span class="op">/</span> <span class="fl">0.0012486</span>) <span class="op">+</span> (<span class="fl">0.00568622</span> <span class="op">/</span> <span class="fl">0.00136251</span>) <span class="op">+</span> (<span class="fl">0.00554501</span> <span class="op">/</span> <span class="fl">0.00111764</span>)) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb526-53"><a href="#cb526-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.264168888183388</span></span>
<span id="cb526-54"><a href="#cb526-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-55"><a href="#cb526-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-56"><a href="#cb526-56" aria-hidden="true" tabindex="-1"></a>regionDxyTable <span class="op">=</span> <span class="fu">DataFrame</span>(cluster_pair <span class="op">=</span> pairwiseDxyClusterNames, Dxy <span class="op">=</span> <span class="fu">getRegionDxy</span>(Dxy))</span>
<span id="cb526-57"><a href="#cb526-57" aria-hidden="true" tabindex="-1"></a><span class="co">#= 6×2 DataFrame</span></span>
<span id="cb526-58"><a href="#cb526-58" aria-hidden="true" tabindex="-1"></a><span class="co"> Row │ cluster_pair     Dxy        </span></span>
<span id="cb526-59"><a href="#cb526-59" aria-hidden="true" tabindex="-1"></a><span class="co">     │ String           Float64    </span></span>
<span id="cb526-60"><a href="#cb526-60" aria-hidden="true" tabindex="-1"></a><span class="co">─────┼─────────────────────────────</span></span>
<span id="cb526-61"><a href="#cb526-61" aria-hidden="true" tabindex="-1"></a><span class="co">   1 │ virLud_nit       0.00439336</span></span>
<span id="cb526-62"><a href="#cb526-62" aria-hidden="true" tabindex="-1"></a><span class="co">   2 │ virLud_trochObs  0.0059857</span></span>
<span id="cb526-63"><a href="#cb526-63" aria-hidden="true" tabindex="-1"></a><span class="co">   3 │ virLud_plumb     0.00660034</span></span>
<span id="cb526-64"><a href="#cb526-64" aria-hidden="true" tabindex="-1"></a><span class="co">   4 │ nit_trochObs     0.00548855</span></span>
<span id="cb526-65"><a href="#cb526-65" aria-hidden="true" tabindex="-1"></a><span class="co">   5 │ nit_plumb        0.00608182</span></span>
<span id="cb526-66"><a href="#cb526-66" aria-hidden="true" tabindex="-1"></a><span class="co">   6 │ trochObs_plumb   0.00652593 =#</span></span>
<span id="cb526-67"><a href="#cb526-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-68"><a href="#cb526-68" aria-hidden="true" tabindex="-1"></a><span class="co"># average Dxy (for OUTSIDE of chr 3 LHBR) among three major groups:</span></span>
<span id="cb526-69"><a href="#cb526-69" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.0059857</span> <span class="op">+</span> <span class="fl">0.00660034</span> <span class="op">+</span> <span class="fl">0.00652593</span>) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb526-70"><a href="#cb526-70" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.006370656666666666</span></span>
<span id="cb526-71"><a href="#cb526-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-72"><a href="#cb526-72" aria-hidden="true" tabindex="-1"></a><span class="co">#ratio of average Dxy outside to average Dxy within LHBR among 3 major groups:</span></span>
<span id="cb526-73"><a href="#cb526-73" aria-hidden="true" tabindex="-1"></a><span class="fl">0.006370656666666666</span> <span class="op">/</span> <span class="fl">0.0036033366666666663</span></span>
<span id="cb526-74"><a href="#cb526-74" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.76798818872508</span></span>
<span id="cb526-75"><a href="#cb526-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-76"><a href="#cb526-76" aria-hidden="true" tabindex="-1"></a><span class="co"># percent lower that average Dxy is within compared to outside LHBR:</span></span>
<span id="cb526-77"><a href="#cb526-77" aria-hidden="true" tabindex="-1"></a><span class="fl">100</span> <span class="op">*</span> (<span class="fl">1.76798818872508</span> <span class="op">-</span> <span class="fl">1</span>) <span class="op">/</span> <span class="fl">1.76798818872508</span></span>
<span id="cb526-78"><a href="#cb526-78" aria-hidden="true" tabindex="-1"></a><span class="co"># 43.43853616346196</span></span>
<span id="cb526-79"><a href="#cb526-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-80"><a href="#cb526-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Drawing phylogeny (in Illustrator) based on above, between three major groups.</span></span>
<span id="cb526-81"><a href="#cb526-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Lowest Dxy is between virLud and trochObs (0.0059857).</span></span>
<span id="cb526-82"><a href="#cb526-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculation of deepest split, an average of plumb diff with (virLud, trochObs):</span></span>
<span id="cb526-83"><a href="#cb526-83" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.00660034</span> <span class="op">+</span> <span class="fl">0.00652593</span>) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb526-84"><a href="#cb526-84" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.006563135</span></span>
<span id="cb526-85"><a href="#cb526-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-86"><a href="#cb526-86" aria-hidden="true" tabindex="-1"></a>((<span class="fl">0.00354486</span> <span class="op">/</span> <span class="fl">0.0059857</span>) <span class="op">+</span> (<span class="fl">0.00328016</span> <span class="op">/</span> <span class="fl">0.00652593</span>) <span class="op">+</span> (<span class="fl">0.00398499</span> <span class="op">/</span> <span class="fl">0.00660034</span>)) <span class="op">/</span> <span class="fl">3</span></span>
<span id="cb526-87"><a href="#cb526-87" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5662038652462132</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="196">
<pre><code>0.5662038652462132</code></pre>
</div>
</div>
<p>Really neat results above. More diversity at chr 3 LHBR than at 4A.</p>
</section>
<section id="copying-from-the-main-page-and-modifying-the-bit-below-to-make-supplemental-gbi-plots" class="level3">
<h3 class="anchored" data-anchor-id="copying-from-the-main-page-and-modifying-the-bit-below-to-make-supplemental-gbi-plots">Copying (from the main page) and modifying the bit below to make Supplemental GBI plots</h3>
<section id="make-list-of-scaffolds-to-plot-1" class="level5">
<h5 class="anchored" data-anchor-id="make-list-of-scaffolds-to-plot-1">Make list of scaffolds to plot:</h5>
<div id="d599c8b6" class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a>scaffolds_to_plot <span class="op">=</span> <span class="st">"gw"</span> <span class="op">.*</span> <span class="fu">string</span>.(<span class="fu">vcat</span>(<span class="fl">28</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">17</span>, <span class="fl">15</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>))</span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="fu">push!</span>(scaffolds_to_plot, <span class="st">"gw1A"</span>, <span class="st">"gw4A"</span>)  <span class="co"># add two other scaffolds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre><code>29-element Vector{String}:
 "gw28"
 "gw27"
 "gw26"
 "gw25"
 "gw24"
 "gw23"
 "gw22"
 "gw21"
 "gw20"
 "gw19"
 "gw18"
 "gw17"
 "gw15"
 ⋮
 "gw10"
 "gw9"
 "gw8"
 "gw7"
 "gw6"
 "gw5"
 "gw4"
 "gw3"
 "gw2"
 "gw1"
 "gw1A"
 "gw4A"</code></pre>
</div>
</div>
</section>
<section id="do-other-setup" class="level5">
<h5 class="anchored" data-anchor-id="do-other-setup">Do other setup:</h5>
<div id="6f172dd6" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a>groups_to_plot_all <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"vir_S"</span>,<span class="st">"nit"</span>, <span class="st">"lud_PK"</span>, <span class="st">"lud_KS"</span>, <span class="st">"lud_central"</span>, <span class="st">"lud_Sath"</span>, <span class="st">"lud_ML"</span>,<span class="st">"troch_west"</span>,<span class="st">"troch_LN"</span>,<span class="st">"troch_EM"</span>,<span class="st">"obs"</span>,<span class="st">"plumb_BJ"</span>,<span class="st">"plumb"</span>,<span class="st">"plumb_vir"</span>]</span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a>group_colors_all <span class="op">=</span> [<span class="st">"blue"</span>,<span class="st">"turquoise1"</span>,<span class="st">"grey"</span>,<span class="st">"seagreen4"</span>,<span class="st">"seagreen3"</span>,<span class="st">"seagreen2"</span>,<span class="st">"olivedrab3"</span>,<span class="st">"olivedrab2"</span>,<span class="st">"olivedrab1"</span>,<span class="st">"yellow"</span>,<span class="st">"gold"</span>,<span class="st">"orange"</span>,<span class="st">"pink"</span>,<span class="st">"red"</span>,<span class="st">"purple"</span>];</span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-4"><a href="#cb530-4" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> [<span class="st">"vir"</span>,<span class="st">"troch_LN"</span>,<span class="st">"plumb"</span>] <span class="co"># for purpose of calculating pairwise Fst and Fst_group (to determine SNPs)   </span></span>
<span id="cb530-5"><a href="#cb530-5" aria-hidden="true" tabindex="-1"></a>plotGroups <span class="op">=</span> groups_to_plot_all </span>
<span id="cb530-6"><a href="#cb530-6" aria-hidden="true" tabindex="-1"></a>plotGroupColors <span class="op">=</span> group_colors_all</span>
<span id="cb530-7"><a href="#cb530-7" aria-hidden="true" tabindex="-1"></a>group1 <span class="op">=</span> <span class="st">"vir"</span>   <span class="co"># these groups will determine the color used in the graph</span></span>
<span id="cb530-8"><a href="#cb530-8" aria-hidden="true" tabindex="-1"></a>group2 <span class="op">=</span> <span class="st">"plumb"</span></span>
<span id="cb530-9"><a href="#cb530-9" aria-hidden="true" tabindex="-1"></a>groupsToCompare <span class="op">=</span> [<span class="st">"vir_plumb"</span>, <span class="st">"vir_troch_LN"</span>, <span class="st">"troch_LN_plumb"</span>]     <span class="co"># "Fst_among" #"vir_plumb" </span></span>
<span id="cb530-10"><a href="#cb530-10" aria-hidden="true" tabindex="-1"></a>missingFractionAllowed <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># only show SNPs with less than this fraction of missing data among individuals</span></span>
<span id="cb530-11"><a href="#cb530-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-12"><a href="#cb530-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele freqs and sample sizes (use column Fst_group)</span></span>
<span id="cb530-13"><a href="#cb530-13" aria-hidden="true" tabindex="-1"></a>freqs, sampleSizes <span class="op">=</span> <span class="fu">getFreqsAndSampleSizes</span>(genosOnly_with_missing, ind_with_metadata_indFiltered.Fst_group, groups)</span>
<span id="cb530-14"><a href="#cb530-14" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated population allele frequencies and sample sizes"</span>)</span>
<span id="cb530-15"><a href="#cb530-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-16"><a href="#cb530-16" aria-hidden="true" tabindex="-1"></a>Fst, FstNumerator, FstDenominator, pairwiseNamesFst <span class="op">=</span> <span class="fu">getFst</span>(freqs, sampleSizes, groups; among<span class="op">=</span><span class="cn">true</span>)  <span class="co"># set among to FALSE if no among Fst wanted (some things won't work without it) </span></span>
<span id="cb530-17"><a href="#cb530-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Calculated Fst values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated population allele frequencies and sample sizes
Calculated Fst values</code></pre>
</div>
</div>
</section>
<section id="loop-through-scaffolds-and-make-plots-and-adding-a-line-for-the-lhbrs" class="level5">
<h5 class="anchored" data-anchor-id="loop-through-scaffolds-and-make-plots-and-adding-a-line-for-the-lhbrs">Loop through scaffolds and make plots, and adding a line for the LHBRs:</h5>
<p>Making inactive because plots were already made:</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for autosomes, Fst &gt; 0.8</span></span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a>Fst_cutoff <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb532-3"><a href="#cb532-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(scaffolds_to_plot)</span>
<span id="cb532-4"><a href="#cb532-4" aria-hidden="true" tabindex="-1"></a>    chr <span class="op">=</span> scaffolds_to_plot[i]</span>
<span id="cb532-5"><a href="#cb532-5" aria-hidden="true" tabindex="-1"></a>    regionInfo <span class="op">=</span> <span class="fu">chooseChrRegion</span>(pos_SNP_filtered, chr; positionMin<span class="op">=</span><span class="fl">1</span>, positionMax<span class="op">=</span>scaffold_lengths[chr]) <span class="co"># this gets the maximum position for the chromosome</span></span>
<span id="cb532-6"><a href="#cb532-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get info for lines for LHBRs</span></span>
<span id="cb532-7"><a href="#cb532-7" aria-hidden="true" tabindex="-1"></a>    highViSHetRegions_thisScaffold <span class="op">=</span> highViSHetRegions[highViSHetRegions.regionChrom <span class="op">.==</span> chr, <span class="op">:</span>]</span>
<span id="cb532-8"><a href="#cb532-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-9"><a href="#cb532-9" aria-hidden="true" tabindex="-1"></a>    plotInfo <span class="op">=</span> <span class="fu">plotGenotypeByIndividualWithFst</span>(groupsToCompare, Fst_cutoff, </span>
<span id="cb532-10"><a href="#cb532-10" aria-hidden="true" tabindex="-1"></a>        missingFractionAllowed, regionInfo,</span>
<span id="cb532-11"><a href="#cb532-11" aria-hidden="true" tabindex="-1"></a>        pos_SNP_filtered, Fst, pairwiseNamesFst, </span>
<span id="cb532-12"><a href="#cb532-12" aria-hidden="true" tabindex="-1"></a>        genosOnly_with_missing, ind_with_metadata_indFiltered, freqs, </span>
<span id="cb532-13"><a href="#cb532-13" aria-hidden="true" tabindex="-1"></a>        plotGroups, plotGroupColors;</span>
<span id="cb532-14"><a href="#cb532-14" aria-hidden="true" tabindex="-1"></a>        indFontSize<span class="op">=</span><span class="fl">4</span>, figureSize<span class="op">=</span>(<span class="fl">1200</span>,<span class="fl">1600</span>), plotTitle <span class="op">=</span> <span class="st">""</span>,</span>
<span id="cb532-15"><a href="#cb532-15" aria-hidden="true" tabindex="-1"></a>        highlightRegionStarts <span class="op">=</span> highViSHetRegions_thisScaffold.regionStart,</span>
<span id="cb532-16"><a href="#cb532-16" aria-hidden="true" tabindex="-1"></a>        highlightRegionEnds <span class="op">=</span> highViSHetRegions_thisScaffold.regionEnd,</span>
<span id="cb532-17"><a href="#cb532-17" aria-hidden="true" tabindex="-1"></a>        highlightRegionColor <span class="op">=</span> <span class="st">"magenta"</span>)</span>
<span id="cb532-18"><a href="#cb532-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-19"><a href="#cb532-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Completed the figure for "</span>, chr, <span class="st">"."</span>)</span>
<span id="cb532-20"><a href="#cb532-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="cn">true</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb532-21"><a href="#cb532-21" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Figure_"</span>, chr, <span class="st">"_Fst3groupsGBIallInds_Fst"</span>,Fst_cutoff,<span class="st">"_fromJulia.png"</span>)</span>
<span id="cb532-22"><a href="#cb532-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">save</span>(filename, plotInfo[<span class="fl">1</span>], px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb532-23"><a href="#cb532-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"Saved "</span>, filename)</span>
<span id="cb532-24"><a href="#cb532-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> </span>
<span id="cb532-25"><a href="#cb532-25" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="now-for-z-chromosome-with-fst-0.9" class="level5">
<h5 class="anchored" data-anchor-id="now-for-z-chromosome-with-fst-0.9">Now for Z chromosome, with Fst &gt; 0.9</h5>
<div id="178758b4" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb533"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a>scaffolds_to_plot <span class="op">=</span> [<span class="st">"gwZ"</span>]; Fst_cutoff <span class="op">=</span> <span class="fl">0.9</span></span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(scaffolds_to_plot)</span>
<span id="cb533-3"><a href="#cb533-3" aria-hidden="true" tabindex="-1"></a>    chr <span class="op">=</span> scaffolds_to_plot[i]</span>
<span id="cb533-4"><a href="#cb533-4" aria-hidden="true" tabindex="-1"></a>    regionInfo <span class="op">=</span> <span class="fu">chooseChrRegion</span>(pos_SNP_filtered, chr; positionMin<span class="op">=</span><span class="fl">1</span>, positionMax<span class="op">=</span>scaffold_lengths[chr]) <span class="co"># this gets the maximum position for the chromosome</span></span>
<span id="cb533-5"><a href="#cb533-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get info for lines for LHBRs</span></span>
<span id="cb533-6"><a href="#cb533-6" aria-hidden="true" tabindex="-1"></a>    highViSHetRegions_thisScaffold <span class="op">=</span> highViSHetRegions[highViSHetRegions.regionChrom <span class="op">.==</span> chr, <span class="op">:</span>]</span>
<span id="cb533-7"><a href="#cb533-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-8"><a href="#cb533-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#= ##### for testing function</span></span>
<span id="cb533-9"><a href="#cb533-9" aria-hidden="true" tabindex="-1"></a><span class="co">    pos=pos_SNP_filtered</span></span>
<span id="cb533-10"><a href="#cb533-10" aria-hidden="true" tabindex="-1"></a><span class="co">    genoData=genosOnly_with_missing</span></span>
<span id="cb533-11"><a href="#cb533-11" aria-hidden="true" tabindex="-1"></a><span class="co">    indMetadata= ind_with_metadata_indFiltered</span></span>
<span id="cb533-12"><a href="#cb533-12" aria-hidden="true" tabindex="-1"></a><span class="co">    colorAllelesByGroup = true</span></span>
<span id="cb533-13"><a href="#cb533-13" aria-hidden="true" tabindex="-1"></a><span class="co">    group1 = plotGroups[1]</span></span>
<span id="cb533-14"><a href="#cb533-14" aria-hidden="true" tabindex="-1"></a><span class="co">    indFontSize=4</span></span>
<span id="cb533-15"><a href="#cb533-15" aria-hidden="true" tabindex="-1"></a><span class="co">    figureSize=(1200,1600)</span></span>
<span id="cb533-16"><a href="#cb533-16" aria-hidden="true" tabindex="-1"></a><span class="co">    show_SNP_density = true </span></span>
<span id="cb533-17"><a href="#cb533-17" aria-hidden="true" tabindex="-1"></a><span class="co">    densityPlotColor = :steelblue1</span></span>
<span id="cb533-18"><a href="#cb533-18" aria-hidden="true" tabindex="-1"></a><span class="co">    plotTitle = ""</span></span>
<span id="cb533-19"><a href="#cb533-19" aria-hidden="true" tabindex="-1"></a><span class="co">    highlightRegionStarts = highViSHetRegions_thisScaffold.regionStart</span></span>
<span id="cb533-20"><a href="#cb533-20" aria-hidden="true" tabindex="-1"></a><span class="co">    highlightRegionEnds = highViSHetRegions_thisScaffold.regionEnd</span></span>
<span id="cb533-21"><a href="#cb533-21" aria-hidden="true" tabindex="-1"></a><span class="co">    ############ =#</span></span>
<span id="cb533-22"><a href="#cb533-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-23"><a href="#cb533-23" aria-hidden="true" tabindex="-1"></a>    plotInfo <span class="op">=</span> <span class="fu">plotGenotypeByIndividualWithFst</span>(groupsToCompare, Fst_cutoff, </span>
<span id="cb533-24"><a href="#cb533-24" aria-hidden="true" tabindex="-1"></a>        missingFractionAllowed, regionInfo,</span>
<span id="cb533-25"><a href="#cb533-25" aria-hidden="true" tabindex="-1"></a>        pos_SNP_filtered, Fst, pairwiseNamesFst, </span>
<span id="cb533-26"><a href="#cb533-26" aria-hidden="true" tabindex="-1"></a>        genosOnly_with_missing, ind_with_metadata_indFiltered, freqs, </span>
<span id="cb533-27"><a href="#cb533-27" aria-hidden="true" tabindex="-1"></a>        plotGroups, plotGroupColors;</span>
<span id="cb533-28"><a href="#cb533-28" aria-hidden="true" tabindex="-1"></a>        indFontSize<span class="op">=</span><span class="fl">4</span>, figureSize<span class="op">=</span>(<span class="fl">1200</span>,<span class="fl">1600</span>), plotTitle <span class="op">=</span> <span class="st">""</span>,</span>
<span id="cb533-29"><a href="#cb533-29" aria-hidden="true" tabindex="-1"></a>        highlightRegionStarts <span class="op">=</span> highViSHetRegions_thisScaffold.regionStart,</span>
<span id="cb533-30"><a href="#cb533-30" aria-hidden="true" tabindex="-1"></a>        highlightRegionEnds <span class="op">=</span> highViSHetRegions_thisScaffold.regionEnd,</span>
<span id="cb533-31"><a href="#cb533-31" aria-hidden="true" tabindex="-1"></a>        highlightRegionColor <span class="op">=</span> <span class="st">"magenta"</span>)</span>
<span id="cb533-32"><a href="#cb533-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-33"><a href="#cb533-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Completed the figure for "</span>, chr, <span class="st">"."</span>)</span>
<span id="cb533-34"><a href="#cb533-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="cn">true</span>  <span class="co"># set to true to save plot</span></span>
<span id="cb533-35"><a href="#cb533-35" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Figure_"</span>, chr, <span class="st">"_Fst3groupsGBIallInds_fromJulia.png"</span>)</span>
<span id="cb533-36"><a href="#cb533-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">save</span>(filename, plotInfo[<span class="fl">1</span>], px_per_unit <span class="op">=</span> <span class="fl">2.0</span>)</span>
<span id="cb533-37"><a href="#cb533-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"Saved "</span>, filename)</span>
<span id="cb533-38"><a href="#cb533-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> </span>
<span id="cb533-39"><a href="#cb533-39" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/pFPBw/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GW_Heterozygosity_Variance_files/figure-html/cell-199-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed the figure for gwZ.
Saved Figure_gwZ_Fst3groupsGBIallInds_fromJulia.png</code></pre>
</div>
</div>
</section>
</section>
<section id="old-stuff-below-can-probably-delete-but-might-be-some-good-bits-to-keep" class="level3">
<h3 class="anchored" data-anchor-id="old-stuff-below-can-probably-delete-but-might-be-some-good-bits-to-keep">OLD STUFF BELOW (CAN PROBABLY DELETE, BUT MIGHT BE SOME GOOD BITS TO KEEP)</h3>
</section>
<section id="actually-new-plan-just-do-the-pca-on-all-individuals-then-show-a-graph-without-the-heterozygotes.-will-do-this-above." class="level3">
<h3 class="anchored" data-anchor-id="actually-new-plan-just-do-the-pca-on-all-individuals-then-show-a-graph-without-the-heterozygotes.-will-do-this-above.">Actually new plan: Just do the PCA on all individuals, then show a graph without the heterozygotes. Will do this above.</h3>
</section>
</section>
<section id="adding-28june2024-starting-with-pca-of-just-the-homozygotes-above-apply-those-axes-to-other-individuals-to-add-them-to-the-pca" class="level1">
<h1>Adding 28June2024: starting with PCA of just the homozygotes (above), apply those axes to other individuals to add them to the PCA:</h1>
<div class="sourceCode" id="cb536"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_included <span class="co"># this is the list of all individuals prior to choosing low IndHet</span></span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-4"><a href="#cb536-4" aria-hidden="true" tabindex="-1"></a>genos_highViSHetRegion_imputed <span class="co"># these are the genotypes of all individuals (imputed)</span></span>
<span id="cb536-5"><a href="#cb536-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-6"><a href="#cb536-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-7"><a href="#cb536-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the key command, from another place in my code (to expand to multiple samples, matrix should have individuals as columns):</span></span>
<span id="cb536-8"><a href="#cb536-8" aria-hidden="true" tabindex="-1"></a>matrixForPCAplot <span class="op">=</span> <span class="fu">Matrix</span><span class="dt">{Float32}</span>(<span class="fu">transpose</span>(genos_highViSHetRegion_imputed))</span>
<span id="cb536-9"><a href="#cb536-9" aria-hidden="true" tabindex="-1"></a>PCvalues <span class="op">=</span> <span class="fu">transpose</span>(<span class="fu">predict</span>(PCAmodel.model, matrixForPCAplot))</span>
<span id="cb536-10"><a href="#cb536-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-11"><a href="#cb536-11" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb536-12"><a href="#cb536-12" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb536-13"><a href="#cb536-13" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"PC1 vs. PC2"</span>,</span>
<span id="cb536-14"><a href="#cb536-14" aria-hidden="true" tabindex="-1"></a>    xlabel <span class="op">=</span> <span class="st">"Region PC1"</span>, xlabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb536-15"><a href="#cb536-15" aria-hidden="true" tabindex="-1"></a>    ylabel <span class="op">=</span> <span class="st">"Region PC2"</span>, ylabelsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span id="cb536-16"><a href="#cb536-16" aria-hidden="true" tabindex="-1"></a>    autolimitaspect <span class="op">=</span> <span class="fl">1</span>)</span>
<span id="cb536-17"><a href="#cb536-17" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb536-18"><a href="#cb536-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb536-19"><a href="#cb536-19" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> ind_with_metadata_included.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb536-20"><a href="#cb536-20" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PCvalues[selection, <span class="fl">1</span>], PCvalues[selection, <span class="fl">2</span>], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], <span class="fl">0.6</span>), markersize <span class="op">=</span> <span class="fl">14</span>, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, <span class="fl">0.7</span>))</span>
<span id="cb536-21"><a href="#cb536-21" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb536-22"><a href="#cb536-22" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="section-1" class="level10">
<p class="heading"></p>
</section>
</section>
<section id="below-what-i-tried-first-here-is-to-calculate-a-matrix-of-pairwise-genetic-distances-and-then-use-principal-coordinates-analysis-metric-multidimensional-scaling.-the-below-works.-then-i-realized-that-it-is-perhaps-better-to-stick-with-pca-like-in-the-rest-of-the-paper.-so-will-do-that-above." class="level1">
<h1>Below, what I tried first here is to calculate a matrix of pairwise genetic distances and then use Principal Coordinates Analysis (Metric Multidimensional Scaling). The below works. Then I realized that it is perhaps better to stick with PCA like in the rest of the paper. So will do that above.</h1>
<div class="sourceCode" id="cb537"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a>indGenDistances <span class="op">=</span> <span class="fu">getIndGenDistances</span>(genos_lowIndHetStan)</span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true" tabindex="-1"></a>mds <span class="op">=</span> <span class="fu">fit</span>(MDS, indGenDistances; distances<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb537-4"><a href="#cb537-4" aria-hidden="true" tabindex="-1"></a>pco_coords <span class="op">=</span> <span class="fu">predict</span>(mds)</span>
<span id="cb537-5"><a href="#cb537-5" aria-hidden="true" tabindex="-1"></a>PCO1 <span class="op">=</span> pco_coords[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb537-6"><a href="#cb537-6" aria-hidden="true" tabindex="-1"></a>PCO2 <span class="op">=</span> pco_coords[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb537-7"><a href="#cb537-7" aria-hidden="true" tabindex="-1"></a>PCO3 <span class="op">=</span> pco_coords[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb537-8"><a href="#cb537-8" aria-hidden="true" tabindex="-1"></a>PCO4 <span class="op">=</span> pco_coords[<span class="fl">4</span>,<span class="op">:</span>]</span>
<span id="cb537-9"><a href="#cb537-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-10"><a href="#cb537-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-11"><a href="#cb537-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PCO1, PCO2)</span>
<span id="cb537-12"><a href="#cb537-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-13"><a href="#cb537-13" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(PCO1, PCO3)</span></span>
<span id="cb537-14"><a href="#cb537-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-15"><a href="#cb537-15" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(PCO1, PCO4)</span></span>
<span id="cb537-16"><a href="#cb537-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-17"><a href="#cb537-17" aria-hidden="true" tabindex="-1"></a>pcoResults <span class="op">=</span> <span class="fu">DataFrame</span>(ind <span class="op">=</span> ind_with_metadata_lowIndHetStan.ind, Fst_group <span class="op">=</span> ind_with_metadata_lowIndHetStan.Fst_group, PCo1 <span class="op">=</span> PCO1, PCo2 <span class="op">=</span> PCO2)</span>
<span id="cb537-18"><a href="#cb537-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-19"><a href="#cb537-19" aria-hidden="true" tabindex="-1"></a><span class="co"># code taken from GenomicDiversity.plotPCA :</span></span>
<span id="cb537-20"><a href="#cb537-20" aria-hidden="true" tabindex="-1"></a>autolimitaspect_setting <span class="op">=</span> <span class="fl">1</span>; lineOpacity <span class="op">=</span> <span class="fl">0.8</span>; fillOpacity <span class="op">=</span> <span class="fl">0.2</span>;</span>
<span id="cb537-21"><a href="#cb537-21" aria-hidden="true" tabindex="-1"></a>    symbolSize <span class="op">=</span> <span class="fl">10</span>; plotTitle <span class="op">=</span> <span class="st">"PCo plot"</span>; showTitle <span class="op">=</span> <span class="cn">true</span>;</span>
<span id="cb537-22"><a href="#cb537-22" aria-hidden="true" tabindex="-1"></a>    xLabelText <span class="op">=</span> <span class="st">"Genomic PC1"</span>; yLabelText <span class="op">=</span> <span class="st">"Genomic PC2"</span>;</span>
<span id="cb537-23"><a href="#cb537-23" aria-hidden="true" tabindex="-1"></a>    labelSize <span class="op">=</span> <span class="fl">24</span></span>
<span id="cb537-24"><a href="#cb537-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-25"><a href="#cb537-25" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_forPlot <span class="op">=</span> ind_with_metadata_lowIndHetStan</span>
<span id="cb537-26"><a href="#cb537-26" aria-hidden="true" tabindex="-1"></a>PC1 <span class="op">=</span> PCO1; PC2 <span class="op">=</span> PCO2</span>
<span id="cb537-27"><a href="#cb537-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-28"><a href="#cb537-28" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> CairoMakie.<span class="fu">Figure</span>()</span>
<span id="cb537-29"><a href="#cb537-29" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(f[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb537-30"><a href="#cb537-30" aria-hidden="true" tabindex="-1"></a>            title <span class="op">=</span> plotTitle,</span>
<span id="cb537-31"><a href="#cb537-31" aria-hidden="true" tabindex="-1"></a>            xlabel <span class="op">=</span> xLabelText, xlabelsize <span class="op">=</span> labelSize,</span>
<span id="cb537-32"><a href="#cb537-32" aria-hidden="true" tabindex="-1"></a>            ylabel <span class="op">=</span> yLabelText, ylabelsize <span class="op">=</span> labelSize,</span>
<span id="cb537-33"><a href="#cb537-33" aria-hidden="true" tabindex="-1"></a>            autolimitaspect <span class="op">=</span> autolimitaspect_setting)</span>
<span id="cb537-34"><a href="#cb537-34" aria-hidden="true" tabindex="-1"></a><span class="fu">hidedecorations!</span>(ax, label <span class="op">=</span> <span class="cn">false</span>, ticklabels <span class="op">=</span> <span class="cn">false</span>, ticks <span class="op">=</span> <span class="cn">false</span>) <span class="co"># hide background lattice</span></span>
<span id="cb537-35"><a href="#cb537-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fu">eachindex</span>(groups_to_plot_PCA) </span>
<span id="cb537-36"><a href="#cb537-36" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> ind_with_metadata_forPlot.Fst_group <span class="op">.==</span> groups_to_plot_PCA[i]</span>
<span id="cb537-37"><a href="#cb537-37" aria-hidden="true" tabindex="-1"></a>    CairoMakie.<span class="fu">scatter!</span>(ax, PC1[selection], PC2[selection], marker <span class="op">=</span> <span class="op">:</span>diamond, color <span class="op">=</span> (group_colors_PCA[i], fillOpacity), markersize <span class="op">=</span> symbolSize, strokewidth<span class="op">=</span><span class="fl">0.5</span>, strokecolor <span class="op">=</span> (<span class="st">"black"</span>, lineOpacity))</span>
<span id="cb537-38"><a href="#cb537-38" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb537-39"><a href="#cb537-39" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="notes" class="level4">
<h4 class="anchored" data-anchor-id="notes">Notes:</h4>
</section>
</section>
<section id="get-all-samples-with-regionindhetstan-.-0.75-or-maybe-another-value" class="level1">
<h1>- Get all samples with regionIndHetStan .&lt; 0.75 (or maybe another value)</h1>
</section>
<section id="construct-distance-matrix" class="level1">
<h1>- Construct distance matrix</h1>
</section>
<section id="do-pcoa-on-distance-matrix-also-known-as-metric-multidimensional-scaling" class="level1">
<h1>- Do PCoA on distance matrix (also known as Metric Multidimensional Scaling)</h1>
</section>
<section id="mds-fitmds-d-distancestrue-maxoutdimsized1-1" class="level1">
<h1>mds = fit(MDS, D; distances=true, maxoutdim=size(D,1)-1)</h1>
</section>
<section id="httpsjuliastats.orgmultivariatestats.jldevmds" class="level1">
<h1>https://juliastats.org/MultivariateStats.jl/dev/mds/</h1>
</section>
<section id="pick-a-small-set-of-individuals-to-examine-genetic-distances" class="level1">
<h1>Pick a small set of individuals to examine genetic distances</h1>
<div class="sourceCode" id="cb538"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for demonstration haplotypes, choose individuals with numMissings &lt; 200_000</span></span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and regionIndHetStan &lt; 0.5:</span></span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> (ind_with_metadata_included.numMissings <span class="op">.&lt;</span> <span class="fl">200_000</span>) <span class="op">.&amp;</span> (ind_with_metadata_included.regionIndHetStan <span class="op">.&lt;</span> <span class="fl">0.75</span>)</span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_haplotypeCandidates <span class="op">=</span> ind_with_metadata_included[selection, <span class="op">:</span>]</span>
<span id="cb538-7"><a href="#cb538-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-8"><a href="#cb538-8" aria-hidden="true" tabindex="-1"></a><span class="co"># But the above cuts out the obscuratus and nitidus individuals (which have about 700k missing genome-wide at least in early filtering calculations)</span></span>
<span id="cb538-9"><a href="#cb538-9" aria-hidden="true" tabindex="-1"></a><span class="co"># So don't worry about missings for now--just sort and choose low ones for each haplogroup:</span></span>
<span id="cb538-10"><a href="#cb538-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-11"><a href="#cb538-11" aria-hidden="true" tabindex="-1"></a><span class="co"># GW_Armando_plate2_TTGW73  #lud_Sath</span></span>
<span id="cb538-12"><a href="#cb538-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-13"><a href="#cb538-13" aria-hidden="true" tabindex="-1"></a><span class="co"># GW_Armando_plate2_LN2 #troch_LN</span></span>
<span id="cb538-14"><a href="#cb538-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-15"><a href="#cb538-15" aria-hidden="true" tabindex="-1"></a><span class="co"># GW_Armando_plate2_TTGW-15-04 #lud_Sural</span></span>
<span id="cb538-16"><a href="#cb538-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-17"><a href="#cb538-17" aria-hidden="true" tabindex="-1"></a><span class="co"># GW_Armando_plate1_JG02G02 #plumb</span></span>
<span id="cb538-18"><a href="#cb538-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-19"><a href="#cb538-19" aria-hidden="true" tabindex="-1"></a><span class="co"># GW_Armando_plate2_JE31G01 #vir</span></span>
<span id="cb538-20"><a href="#cb538-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-21"><a href="#cb538-21" aria-hidden="true" tabindex="-1"></a><span class="co"># GW_Armando_plate1_RF20G01 #plumb_BJ</span></span>
<span id="cb538-22"><a href="#cb538-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-23"><a href="#cb538-23" aria-hidden="true" tabindex="-1"></a><span class="co"># GW_Lane5_TU1 #nit</span></span>
<span id="cb538-24"><a href="#cb538-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-25"><a href="#cb538-25" aria-hidden="true" tabindex="-1"></a>indsToChoose <span class="op">=</span> [<span class="st">"GW_Armando_plate2_TTGW73"</span>,</span>
<span id="cb538-26"><a href="#cb538-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GW_Armando_plate2_LN2"</span>,</span>
<span id="cb538-27"><a href="#cb538-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GW_Armando_plate2_TTGW-15-04"</span>,</span>
<span id="cb538-28"><a href="#cb538-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GW_Armando_plate1_JG02G02"</span>,</span>
<span id="cb538-29"><a href="#cb538-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GW_Armando_plate2_JE31G01"</span>,</span>
<span id="cb538-30"><a href="#cb538-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GW_Armando_plate1_RF20G01"</span>,</span>
<span id="cb538-31"><a href="#cb538-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GW_Lane5_TU1"</span>]</span>
<span id="cb538-32"><a href="#cb538-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-33"><a href="#cb538-33" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> <span class="fu">map</span>(<span class="fu">in</span>(indsToChoose), ind_with_metadata_included.ind)</span>
<span id="cb538-34"><a href="#cb538-34" aria-hidden="true" tabindex="-1"></a>filtered_in <span class="op">=</span> ind_with_metadata_included.ind[selection]</span>
<span id="cb538-35"><a href="#cb538-35" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chosenInds <span class="op">=</span> ind_with_metadata_included[selection, <span class="op">:</span>]</span>
<span id="cb538-36"><a href="#cb538-36" aria-hidden="true" tabindex="-1"></a>geno_indFiltered <span class="op">=</span> <span class="fu">view</span>(genotypes_region, selection, <span class="op">:</span>)</span>
<span id="cb538-37"><a href="#cb538-37" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Specific individuals chosen as requested: "</span>)</span>
<span id="cb538-38"><a href="#cb538-38" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(filtered_in)</span>
<span id="cb538-39"><a href="#cb538-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-40"><a href="#cb538-40" aria-hidden="true" tabindex="-1"></a><span class="co"># choose the loci in the high ViSHet region:</span></span>
<span id="cb538-41"><a href="#cb538-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-42"><a href="#cb538-42" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> (positionMin <span class="op">.&lt;</span> pos_region.position <span class="op">.&lt;</span> positionMax)</span>
<span id="cb538-43"><a href="#cb538-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-44"><a href="#cb538-44" aria-hidden="true" tabindex="-1"></a>geno_indFiltered_highViSHetRegion <span class="op">=</span> geno_indFiltered[<span class="op">:</span>, selection]</span>
<span id="cb538-45"><a href="#cb538-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-46"><a href="#cb538-46" aria-hidden="true" tabindex="-1"></a><span class="co"># put in plot order:</span></span>
<span id="cb538-47"><a href="#cb538-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-48"><a href="#cb538-48" aria-hidden="true" tabindex="-1"></a>indexOrder <span class="op">=</span> <span class="fu">sortperm</span>(ind_with_metadata_chosenInds.plot_order)</span>
<span id="cb538-49"><a href="#cb538-49" aria-hidden="true" tabindex="-1"></a>geno_indFiltered_highViSHetRegion_ordered <span class="op">=</span> geno_indFiltered_highViSHetRegion[indexOrder, <span class="op">:</span>]</span>
<span id="cb538-50"><a href="#cb538-50" aria-hidden="true" tabindex="-1"></a>ind_with_metadata_chosenInds_ordered <span class="op">=</span> ind_with_metadata_chosenInds[indexOrder, <span class="op">:</span>]</span>
<span id="cb538-51"><a href="#cb538-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-52"><a href="#cb538-52" aria-hidden="true" tabindex="-1"></a><span class="co"># ABOVE HAVE GENOTYPES FOR JUST THESE INDIVIDUALS IN JUST THE HIGH ViSHet REGION ON THE ONE CHR. NEXT DO GENETIC DISTANCE BETWEEN ALL PAIRS OF INDIVIDUALS FOR THIS REGION. </span></span>
<span id="cb538-53"><a href="#cb538-53" aria-hidden="true" tabindex="-1"></a><span class="co"># count mismatches and divide by total number of sites.</span></span>
<span id="cb538-54"><a href="#cb538-54" aria-hidden="true" tabindex="-1"></a><span class="co"># mismatches of genotype 0 to genotype 2 count as 1 mismatch.</span></span>
<span id="cb538-55"><a href="#cb538-55" aria-hidden="true" tabindex="-1"></a><span class="co"># genotype 0 or 2 to genotype 1 (het) counts as 0.5 mismatch.</span></span>
<span id="cb538-56"><a href="#cb538-56" aria-hidden="true" tabindex="-1"></a><span class="co"># genotype 1 to genotype 1 counts as 0 mismatch (debatable whether it should be 0 or 0.5, but I want F1 hybrids to not have distance between them).</span></span>
<span id="cb538-57"><a href="#cb538-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-58"><a href="#cb538-58" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getIndGenDistances</span>(genotypeMatrix)</span>
<span id="cb538-59"><a href="#cb538-59" aria-hidden="true" tabindex="-1"></a>    genotypeMatrix[<span class="fu">ismissing</span>.(genotypeMatrix)] <span class="op">.=</span> <span class="op">-</span><span class="fl">1</span> <span class="co"># converts `missing` to -1</span></span>
<span id="cb538-60"><a href="#cb538-60" aria-hidden="true" tabindex="-1"></a>    numInds <span class="op">=</span> <span class="fu">size</span>(genotypeMatrix)[<span class="fl">1</span>]</span>
<span id="cb538-61"><a href="#cb538-61" aria-hidden="true" tabindex="-1"></a>    distanceMatrix <span class="op">=</span> <span class="fu">Matrix</span><span class="dt">{Float64}</span>(<span class="cn">undef</span>, numInds, numInds)</span>
<span id="cb538-62"><a href="#cb538-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numInds</span>
<span id="cb538-63"><a href="#cb538-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>numInds</span>
<span id="cb538-64"><a href="#cb538-64" aria-hidden="true" tabindex="-1"></a>            firstGeno <span class="op">=</span> genotypeMatrix[i,<span class="op">:</span>]</span>
<span id="cb538-65"><a href="#cb538-65" aria-hidden="true" tabindex="-1"></a>            secondGeno <span class="op">=</span> genotypeMatrix[j,<span class="op">:</span>]</span>
<span id="cb538-66"><a href="#cb538-66" aria-hidden="true" tabindex="-1"></a>            fullMismatches <span class="op">=</span> <span class="fu">sum</span>((firstGeno <span class="op">.==</span> <span class="fl">0</span> <span class="op">.&amp;&amp;</span> secondGeno <span class="op">.==</span> <span class="fl">2</span>) <span class="op">.||</span></span>
<span id="cb538-67"><a href="#cb538-67" aria-hidden="true" tabindex="-1"></a>                                (firstGeno <span class="op">.==</span> <span class="fl">2</span> <span class="op">.&amp;&amp;</span> secondGeno <span class="op">.==</span> <span class="fl">0</span>))</span>
<span id="cb538-68"><a href="#cb538-68" aria-hidden="true" tabindex="-1"></a>            partialMismatches <span class="op">=</span> <span class="fu">sum</span>((firstGeno <span class="op">.==</span> <span class="fl">0</span> <span class="op">.&amp;&amp;</span> secondGeno <span class="op">.==</span> <span class="fl">1</span>) <span class="op">.||</span> </span>
<span id="cb538-69"><a href="#cb538-69" aria-hidden="true" tabindex="-1"></a>                                    (firstGeno <span class="op">.==</span> <span class="fl">1</span> <span class="op">.&amp;&amp;</span> secondGeno <span class="op">.==</span> <span class="fl">0</span>) <span class="op">.||</span> </span>
<span id="cb538-70"><a href="#cb538-70" aria-hidden="true" tabindex="-1"></a>                                    (firstGeno <span class="op">.==</span> <span class="fl">2</span> <span class="op">.&amp;&amp;</span> secondGeno <span class="op">.==</span> <span class="fl">1</span>) <span class="op">.||</span> </span>
<span id="cb538-71"><a href="#cb538-71" aria-hidden="true" tabindex="-1"></a>                                    (firstGeno <span class="op">.==</span> <span class="fl">1</span> <span class="op">.&amp;&amp;</span> secondGeno <span class="op">.==</span> <span class="fl">2</span>))</span>
<span id="cb538-72"><a href="#cb538-72" aria-hidden="true" tabindex="-1"></a>            bothHet <span class="op">=</span> <span class="fu">sum</span>(firstGeno <span class="op">.==</span> <span class="fl">1</span> <span class="op">.&amp;&amp;</span> secondGeno <span class="op">.==</span> <span class="fl">1</span>)</span>
<span id="cb538-73"><a href="#cb538-73" aria-hidden="true" tabindex="-1"></a>            nonMissingGenotypes <span class="op">=</span> <span class="fu">sum</span>((firstGeno <span class="op">.!=</span> <span class="op">-</span><span class="fl">1</span>) <span class="op">.&amp;&amp;</span> (secondGeno <span class="op">.!=</span> <span class="op">-</span><span class="fl">1</span>))</span>
<span id="cb538-74"><a href="#cb538-74" aria-hidden="true" tabindex="-1"></a>            distanceMatrix[i,j] <span class="op">=</span> (fullMismatches <span class="op">+</span> <span class="fl">0.5</span>partialMismatches <span class="op">+</span> <span class="fl">0</span><span class="op">*</span>bothHet) <span class="op">/</span> nonMissingGenotypes</span>
<span id="cb538-75"><a href="#cb538-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb538-76"><a href="#cb538-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb538-77"><a href="#cb538-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distanceMatrix</span>
<span id="cb538-78"><a href="#cb538-78" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb538-79"><a href="#cb538-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-80"><a href="#cb538-80" aria-hidden="true" tabindex="-1"></a>indGenDistances <span class="op">=</span> <span class="fu">getIndGenDistances</span>(geno_indFiltered_highViSHetRegion_ordered)</span>
<span id="cb538-81"><a href="#cb538-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-82"><a href="#cb538-82" aria-hidden="true" tabindex="-1"></a>mds <span class="op">=</span> <span class="fu">fit</span>(MDS, indGenDistances; distances<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb538-83"><a href="#cb538-83" aria-hidden="true" tabindex="-1"></a>pco_coords <span class="op">=</span> <span class="fu">predict</span>(mds)</span>
<span id="cb538-84"><a href="#cb538-84" aria-hidden="true" tabindex="-1"></a>PCO1 <span class="op">=</span> pco_coords[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb538-85"><a href="#cb538-85" aria-hidden="true" tabindex="-1"></a>PCO2 <span class="op">=</span> pco_coords[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb538-86"><a href="#cb538-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-87"><a href="#cb538-87" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PCO1, PCO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>